<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>图像处理之图像复原[逆滤波、维纳滤波、约束最小二乘法、Lucy-Richardson和盲解卷积复原] - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="图像处理之图像复原[逆滤波、维纳滤波、约束最小二乘法、Lucy-Richardson和盲解卷积复原]" />
<meta property="og:description" content="一、图像复原与图像增强的区别
图像增强的目的是消除噪声，显现那些被模糊了的细节或简单地突出一幅图像中读者感兴趣的特征，不考虑图像质量下降的原因。图像复原是利用退化现象的某种先验知识，建立退化现象的数学模型，再根据模型进行反向的推演运算，以恢复原来的景物图像。因此图像复原可以理解为图像降质过程的反向过程。建立图像复原的反向过程的数学模型是图像复原的主要任务。
二、逆滤波复原
1、基本原理
f(x,y)表示输入图像，即理想的、没有退化的图像，g(x,y) 是退化后观察得到的图像，n(x,y)为加性噪声。通过傅立叶变换到频域后为：
图像复原的目的是给定G(u,v)和退化函数H(u,v),以及关于加性噪声的相关知识，得到原图像F(u,v)的估计图像F’(u,v),使该图像尽可能地逼近原图像F(u,v)。用于复原一幅图像的最简单的方法是构造如下的公式：
然后通过F’(u,v)的傅立叶反变换得到图像的估计值，称为逆滤波。逆滤波是一种非约束复原方法。非约束复原是指在已知退化图像G(u,v)的情况下，根据对退化模型H(u,v)和噪声N(u,v)的一些知识，做出对原图像的估计F’(u,v),使得某种事先确定的误差准则为最小。在得到误差最小的解的过程中，没有任何约束条件。对于直接逆滤波，由于存在噪声的影响，退化图像的估计公式为：
在进行逆滤波时，如果某个区域H(u,v)为0或非常小，而N(u,v)不为0且不是很小，则上式中的第2项往往比第1项大得多，从而使噪声放大，产生较大的误差。为了避免H(u,v)的值太小，可以在逆滤波时加一些限制，只在原点附近的有限邻域内进行复原，称为伪逆滤波。
2、matlab实现
% 通过逆滤波器对图像进行复原 close all; clear all; clc; I=imread(&#39;cameraman.tif&#39;); I=im2double(I); % 构造高斯低通滤波器 s=fftshift(fft2(im2double(I))); [a,b]=size(s); D0=100; % 将高斯低通滤波器的截止频率D0设置为100 a0=round(a/2); b0=round(b/2); H=zeros(a,b); for i=1:a for j=1:b distance=sqrt((i-a0)^2&#43;(j-b0)^2); % 根据高斯低通滤波器公式H(u,v)=e^-[D^2(u,v)/2*D0^2] H(i,j)=exp(-(distance^2)/(2*(D0^2))); % exp表示以e为底的指数函数 end end N=0.01*ones(a,b); % 本例中a=b=256,此处亦有a=size(I,1),b=size(I,2) N=imnoise(N,&#39;gaussian&#39;,0,0.001); % 添加高斯噪声 J=fftfilter(I,H)&#43;N; % 调用频域滤波函数并加入噪声 figure; subplot(121),imshow(I); title(&#39;原始图像&#39;); subplot(122),imshow(J,[]); % 显示退化图像(采用高斯低通滤波器对图像进行退化,并添加均值为0,方差为0.001的高斯噪声进一步对图像进行退化) title(&#39;退化图像&#39;); HC=zeros(a,b); M1=H&gt;0.1; HC(M1)=1./H(M1); K=fftfilter(J,HC);% 逆滤波操作 HC=zeros(a,b); M2=H&gt;0.01; HC(M2)=1./H(M2); L=fftfilter(J,HC);% 逆滤波操作 figure; subplot(121),imshow(K,[]);% 逆滤波复原,频率大 title(&#39;逆滤波时频率范围较大得到的图像&#39;); subplot(122),imshow(L,[]);% 逆滤波复原,频率小 title(&#39;逆滤波时频率范围较小得到的图像&#39;); function Z = fftfilter(X,H) % 图像的频域滤波处理 % X为输入图像 % H为滤波器 % Z为输出图像 F=fft2(X,size(H,1),size(H,2));% 傅里叶变换 Z=H." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e00ffa0618128e4f145969bce3fe9480/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-20T16:10:39+08:00" />
<meta property="article:modified_time" content="2022-08-20T16:10:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">图像处理之图像复原[逆滤波、维纳滤波、约束最小二乘法、Lucy-Richardson和盲解卷积复原]</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong><font size="5">一、图像复原与图像增强的区别</font></strong></p> 
<p><strong>图像增强的目的是消除噪声，显现那些被模糊了的细节或简单地突出一幅图像中读者感兴趣的特征，不考虑图像质量下降的原因。图像复原是利用退化现象的某种先验知识，建立退化现象的数学模型，再根据模型进行反向的推演运算，以恢复原来的景物图像</strong>。因此图像复原可以理解为图像降质过程的反向过程。建立图像复原的反向过程的数学模型是图像复原的主要任务。</p> 
<p><strong><font size="5">二、逆滤波复原</font></strong></p> 
<p><strong>1、基本原理</strong></p> 
<p>f(x,y)表示输入图像，即理想的、没有退化的图像，g(x,y) 是退化后观察得到的图像，n(x,y)为加性噪声。通过傅立叶变换到频域后为：<br> <img src="https://images2.imgbox.com/9d/35/4DBeVAYI_o.png" alt="在这里插入图片描述"></p> 
<p>图像复原的目的是给定G(u,v)和退化函数H(u,v),以及关于加性噪声的相关知识，得到原图像F(u,v)的估计图像F’(u,v),使该图像尽可能地逼近原图像F(u,v)。用于复原一幅图像的最简单的方法是构造如下的公式：<br> <img src="https://images2.imgbox.com/fd/17/9454SzyI_o.png" alt="在这里插入图片描述"><br> 然后通过F’(u,v)的傅立叶反变换得到图像的估计值，称为逆滤波。逆滤波是一种非约束复原方法。非约束复原是指在已知退化图像G(u,v)的情况下，根据对退化模型H(u,v)和噪声N(u,v)的一些知识，做出对原图像的估计F’(u,v),使得某种事先确定的误差准则为最小。在得到误差最小的解的过程中，没有任何约束条件。对于直接逆滤波，由于存在噪声的影响，退化图像的估计公式为：<br> <img src="https://images2.imgbox.com/32/d7/f1Odi6F5_o.png" alt="在这里插入图片描述"><br> 在进行逆滤波时，如果某个区域H(u,v)为0或非常小，而N(u,v)不为0且不是很小，则上式中的第2项往往比第1项大得多，从而使噪声放大，产生较大的误差。为了避免H(u,v)的值太小，可以在逆滤波时加一些限制，只在原点附近的有限邻域内进行复原，称为伪逆滤波。</p> 
<p><strong>2、matlab实现</strong></p> 
<pre><code class="prism language-java"><span class="token operator">%</span> 通过逆滤波器对图像进行复原
close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'cameraman<span class="token punctuation">.</span>tif'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span> 构造高斯低通滤波器
s<span class="token operator">=</span><span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft2</span><span class="token punctuation">(</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
D0<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">%</span> 将高斯低通滤波器的截止频率D0设置为<span class="token number">100</span>
a0<span class="token operator">=</span><span class="token function">round</span><span class="token punctuation">(</span>a<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
b0<span class="token operator">=</span><span class="token function">round</span><span class="token punctuation">(</span>b<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">H</span><span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>a
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>b
        distance<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">-</span>a0<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>j<span class="token operator">-</span>b0<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">%</span> 根据高斯低通滤波器公式<span class="token class-name">H</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token operator">=</span>e<span class="token operator">^</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token class-name">D</span><span class="token operator">^</span><span class="token function">2</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span>D0<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">]</span> 
        <span class="token class-name">H</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>distance<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>D0<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> exp表示以e为底的指数函数
    end
end

<span class="token class-name">N</span><span class="token operator">=</span><span class="token number">0.01</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span> 本例中a<span class="token operator">=</span>b<span class="token operator">=</span><span class="token number">256</span><span class="token punctuation">,</span>此处亦有a<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token class-name">N</span><span class="token operator">=</span><span class="token function">imnoise</span><span class="token punctuation">(</span><span class="token class-name">N</span><span class="token punctuation">,</span>'gaussian'<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 添加高斯噪声
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">fftfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span><span class="token class-name">H</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token class-name">N</span><span class="token punctuation">;</span> <span class="token operator">%</span> 调用频域滤波函数并加入噪声

figure<span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 显示退化图像<span class="token punctuation">(</span>采用高斯低通滤波器对图像进行退化<span class="token punctuation">,</span>并添加均值为<span class="token number">0</span><span class="token punctuation">,</span>方差为<span class="token number">0.001</span>的高斯噪声进一步对图像进行退化<span class="token punctuation">)</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

HC<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
M1<span class="token operator">=</span><span class="token class-name">H</span><span class="token operator">&gt;</span><span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token function">HC</span><span class="token punctuation">(</span>M1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token class-name">H</span><span class="token punctuation">(</span>M1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">fftfilter</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>HC<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 逆滤波操作

HC<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
M2<span class="token operator">=</span><span class="token class-name">H</span><span class="token operator">&gt;</span><span class="token number">0.01</span><span class="token punctuation">;</span>
<span class="token function">HC</span><span class="token punctuation">(</span>M2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token class-name">H</span><span class="token punctuation">(</span>M2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">L</span><span class="token operator">=</span><span class="token function">fftfilter</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>HC<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 逆滤波操作

figure<span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 逆滤波复原<span class="token punctuation">,</span>频率大
<span class="token function">title</span><span class="token punctuation">(</span>'逆滤波时频率范围较大得到的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 逆滤波复原<span class="token punctuation">,</span>频率小
<span class="token function">title</span><span class="token punctuation">(</span>'逆滤波时频率范围较小得到的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>


function <span class="token class-name">Z</span> <span class="token operator">=</span> <span class="token function">fftfilter</span><span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">,</span><span class="token class-name">H</span><span class="token punctuation">)</span>
<span class="token operator">%</span> 图像的频域滤波处理
<span class="token operator">%</span> <span class="token class-name">X</span>为输入图像
<span class="token operator">%</span> <span class="token class-name">H</span>为滤波器
<span class="token operator">%</span> <span class="token class-name">Z</span>为输出图像
<span class="token class-name">F</span><span class="token operator">=</span><span class="token function">fft2</span><span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">H</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">H</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 傅里叶变换
<span class="token class-name">Z</span><span class="token operator">=</span><span class="token class-name">H</span><span class="token punctuation">.</span>*<span class="token class-name">F</span><span class="token punctuation">;</span>                       <span class="token operator">%</span> 频域滤波
<span class="token class-name">Z</span><span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">ifft2</span><span class="token punctuation">(</span><span class="token function">ifftshift</span><span class="token punctuation">(</span><span class="token class-name">Z</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span> 傅里叶反变换
<span class="token class-name">Z</span><span class="token operator">=</span><span class="token class-name">Z</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">X</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/f7/2f/0LgfK1Vv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c0/a6/PfXJFhZu_o.png" alt="在这里插入图片描述"></p> 
<p><strong><font size="5">三、维纳滤波复原</font></strong></p> 
<p><strong>1、基本原理</strong></p> 
<p>维纳滤波最早由Wiener首先提出，并应用于一维信号，取得了很好的效果。后来该算法又被引入二维信号处理，也取得相当满意的效果，尤其是在图像复原领域。由于维纳滤波器的复原效果好，计算量较低，并且抗噪性能优良，因而在图像复原领域得到了广泛的应用。</p> 
<p>在MATLAB软件中，<strong>采用函数deconvwnr()进行图像的维纳滤波复原</strong>。该函数的调用格式如下：<br> <img src="https://images2.imgbox.com/4c/69/wSUY38CE_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2、matlab实现</strong></p> 
<p>（1）通过维纳滤波对运动模糊图像进行复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'onion<span class="token punctuation">.</span>png'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">rgb2gray</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 注意一定要将图像类型转换为<span class="token keyword">double</span>类型<span class="token punctuation">,</span>方便函数deconvwnr使用
LEN<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>
THETA<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>len<span class="token punctuation">,</span>theta<span class="token punctuation">)</span>返回一个过滤器<span class="token punctuation">,</span>使其在与图像卷积后近似相机的线性运动
<span class="token operator">%</span> len指定运动的长度<span class="token punctuation">,</span>theta指定逆时针方向的运动角度（以度为单位）
<span class="token operator">%</span> 过滤器将成为水平和垂直运动的矢量。默认的len是<span class="token number">9</span><span class="token punctuation">,</span>默认的theta是<span class="token number">0</span><span class="token punctuation">,</span>其对应于<span class="token number">9</span>个像素的水平运动
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>LEN<span class="token punctuation">,</span>THETA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token char">'conv'</span><span class="token punctuation">,</span>'circular'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 表示加入运动模糊
NSR<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token operator">%</span> 采用函数<span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>进行图像的维纳滤波复原
<span class="token operator">%</span> 调用格式为<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NSR<span class="token punctuation">)</span>其中PSF为点扩展函数<span class="token punctuation">,</span>NSR为信噪比<span class="token punctuation">(</span>电子设备中的信号与噪声的比例<span class="token punctuation">)</span>
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NSR<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'运动模糊图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'维纳滤波复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/94/a9/yk4WbG73_o.png" alt="在这里插入图片描述"><br> （2）通过维纳滤波对含有噪声的运动模糊图像进行复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'cameraman<span class="token punctuation">.</span>tif'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
LEN<span class="token operator">=</span><span class="token number">21</span><span class="token punctuation">;</span>
THETA<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>len<span class="token punctuation">,</span>theta<span class="token punctuation">)</span>返回一个过滤器<span class="token punctuation">,</span>使其在与图像卷积后近似相机的线性运动
<span class="token operator">%</span> len指定运动的长度<span class="token punctuation">,</span>theta指定逆时针方向的运动角度（以度为单位）
<span class="token operator">%</span> 过滤器将成为水平和垂直运动的矢量。默认的len是<span class="token number">9</span><span class="token punctuation">,</span>默认的theta是<span class="token number">0</span><span class="token punctuation">,</span>其对应于<span class="token number">9</span>个像素的水平运动
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>LEN<span class="token punctuation">,</span>THETA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token char">'conv'</span><span class="token punctuation">,</span>'circular'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 表示加入运动模糊
noise_mean<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
noise_var<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">;</span>
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">imnoise</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>'gaussian'<span class="token punctuation">,</span>noise_mean<span class="token punctuation">,</span>noise_var<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 给运动模糊图像添加均值为<span class="token number">0</span><span class="token punctuation">,</span>方差为<span class="token number">0.0001</span>的高斯噪声

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'运动模糊和添加噪声图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>

NSR1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
L1<span class="token operator">=</span><span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NSR1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> L1为NSR为<span class="token number">0</span>时得到的复原图像
NSR2<span class="token operator">=</span>noise_var<span class="token operator">/</span><span class="token keyword">var</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 加入的高斯噪声方差<span class="token number">0.0001</span>与原始灰度图像的方差<span class="token number">0.0598</span>之比
L2<span class="token operator">=</span><span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NSR2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> L2为采用真实NSR时得到的复原图像

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>L1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'NSR为<span class="token number">0</span>时的复原图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>L2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'NSR为真实值时的复原图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/55/85/Te4FBvTn_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/97/5f/1TYop9TF_o.png" alt="在这里插入图片描述"><br> （3）通过图像的自相关信息进行图像复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'rice<span class="token punctuation">.</span>png'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
LEN<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
THETA<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>len<span class="token punctuation">,</span>theta<span class="token punctuation">)</span>返回一个过滤器<span class="token punctuation">,</span>使其在与图像卷积后近似相机的线性运动
<span class="token operator">%</span> len指定运动的长度<span class="token punctuation">,</span>theta指定逆时针方向的运动角度（以度为单位）
<span class="token operator">%</span> 过滤器将成为水平和垂直运动的矢量。默认的len是<span class="token number">9</span><span class="token punctuation">,</span>默认的theta是<span class="token number">0</span><span class="token punctuation">,</span>其对应于<span class="token number">9</span>个像素的水平运动
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>LEN<span class="token punctuation">,</span>THETA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token char">'conv'</span><span class="token punctuation">,</span>'circular'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 表示加入运动模糊

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'运动模糊图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

noise<span class="token operator">=</span><span class="token number">0.03</span><span class="token operator">*</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 返回一个n<span class="token operator">*</span>n从标准正态分布中得到的随机项的矩阵
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">imadd</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>noise<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 可以使用函数<span class="token function">imadd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>为图像添加通用噪声<span class="token punctuation">(</span>imnoise函数可以用来为图像添加特定噪声比如高斯<span class="token operator">/</span>泊松<span class="token operator">/</span>斑点<span class="token operator">/</span>椒盐噪声<span class="token punctuation">)</span>
<span class="token operator">%</span> fft2<span class="token operator">-</span>傅里叶变换、ifft2<span class="token operator">-</span>傅里叶反变换、fftshift<span class="token operator">-</span>将零频分量移到频谱中心、ifftshift<span class="token operator">-</span>逆零频平移
<span class="token operator">%</span> fft2和fftshift配合使用<span class="token punctuation">,</span>ifft2和ifftshift配合使用<span class="token punctuation">,</span>两个变换方向相反
<span class="token operator">%</span> 一般都是先使用fft2或ifft2后再使用abs最后使用fftshift或ifftshift
NP<span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">fft2</span><span class="token punctuation">(</span>noise<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>^<span class="token number">2</span><span class="token punctuation">;</span>
NCORR<span class="token operator">=</span><span class="token function">ifftshift</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span><span class="token function">ifft2</span><span class="token punctuation">(</span>NP<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 噪声的自相关函数

IP<span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">fft2</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>^<span class="token number">2</span><span class="token punctuation">;</span>
ICORR<span class="token operator">=</span><span class="token function">ifftshift</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span><span class="token function">ifft2</span><span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 图像的自相关函数
<span class="token operator">%</span> <span class="token class-name">L</span><span class="token operator">=</span><span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NCORR<span class="token punctuation">,</span>ICORR<span class="token punctuation">)</span>该函数中参数NCORR为噪声的自相关函数<span class="token punctuation">,</span>ICORR为原始图像的自相关函数
<span class="token class-name">L</span><span class="token operator">=</span><span class="token function">deconvwnr</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NCORR<span class="token punctuation">,</span>ICORR<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'运动模糊和添加噪声图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'维纳滤波复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/0a/a6/F67KPW5P_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/00/c4/w5KY68Xv_o.png" alt="在这里插入图片描述"><br> <strong><font size="5">四、约束最小二乘法复原</font></strong></p> 
<p><strong>1、基本原理</strong></p> 
<p>在MATLAB软件中，<strong>采用函数deconvreg()进行图像的约束最小二乘法复原</strong>。该函数的调用格式如下：<br> <img src="https://images2.imgbox.com/52/25/lqieZ9yV_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2、matlab实现</strong></p> 
<p>（1）通过约束最下二乘法进行图像复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'rice<span class="token punctuation">.</span>png'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span>'gaussian'<span class="token punctuation">,</span>hsize<span class="token punctuation">,</span>sigma<span class="token punctuation">)</span>返回大小为hsize且具有标准偏差sigma的旋转对称高斯低通滤波器。
<span class="token operator">%</span> hsize表示过滤器大小<span class="token punctuation">,</span>默认值为<span class="token number">3</span><span class="token operator">*</span><span class="token function">3</span><span class="token punctuation">(</span>本例中过滤器大小为<span class="token number">8</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sigma为滤波器的标准值<span class="token punctuation">,</span>单位为像素<span class="token punctuation">,</span>默认值为 <span class="token number">0.5</span>
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span>'gaussian'<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> g<span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>w<span class="token punctuation">,</span>filtering_mode<span class="token punctuation">,</span>boundary_options<span class="token punctuation">,</span>size_options<span class="token punctuation">)</span>
<span class="token operator">%</span> f为输入图像<span class="token punctuation">,</span>w为滤波掩模<span class="token punctuation">,</span>g为滤波后图像<span class="token punctuation">.</span>filtering_mode用于指定在滤波过程中是使用“<span class="token function">corr</span><span class="token punctuation">(</span>相关<span class="token operator">-</span>默认<span class="token punctuation">)</span>”还是“<span class="token function">conv</span><span class="token punctuation">(</span>卷积<span class="token punctuation">)</span>”<span class="token punctuation">.</span>boundary_options用于处理边界充零问题<span class="token punctuation">,</span>边界的大小由滤波器的大小确定
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token char">'conv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示退化后的图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

v<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">;</span>
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">imnoise</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>'gaussian'<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 添加高斯噪声
NP<span class="token operator">=</span>v<span class="token operator">*</span><span class="token function">numel</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 返回数组元素的数目<span class="token punctuation">,</span>等同于<span class="token function">prod</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>prod用于表示数组元素的乘积<span class="token punctuation">)</span>
<span class="token operator">%</span> <span class="token class-name">J</span><span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NOISERPOWER<span class="token punctuation">)</span>可用于图像的约束最小二乘法复原<span class="token punctuation">,</span>其中PSF为扩展函数<span class="token punctuation">,</span>NOISEPOWER为噪声强度<span class="token punctuation">,</span>默认为<span class="token number">0</span>
<span class="token class-name">L</span><span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NP<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'添加噪声的退化图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'约束最小二乘法复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/36/a9/OBVl9PcU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/43/0e/WjidIQKb_o.png" alt="在这里插入图片描述"></p> 
<p>（2）通过拉格朗日算子进行图像复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'rice<span class="token punctuation">.</span>png'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span>'gaussian'<span class="token punctuation">,</span>hsize<span class="token punctuation">,</span>sigma<span class="token punctuation">)</span>返回大小为hsize且具有标准偏差sigma的旋转对称高斯低通滤波器。
<span class="token operator">%</span> hsize表示过滤器大小<span class="token punctuation">,</span>默认值为<span class="token number">3</span><span class="token operator">*</span><span class="token function">3</span><span class="token punctuation">(</span>本例中过滤器大小为<span class="token number">10</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sigma为滤波器的标准值<span class="token punctuation">,</span>单位为像素<span class="token punctuation">,</span>默认值为 <span class="token number">0.5</span>
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span>'gaussian'<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> g<span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>w<span class="token punctuation">,</span>filtering_mode<span class="token punctuation">,</span>boundary_options<span class="token punctuation">,</span>size_options<span class="token punctuation">)</span>
<span class="token operator">%</span> f为输入图像<span class="token punctuation">,</span>w为滤波掩模<span class="token punctuation">,</span>g为滤波后图像<span class="token punctuation">.</span>filtering_mode用于指定在滤波过程中是使用“<span class="token function">corr</span><span class="token punctuation">(</span>相关<span class="token operator">-</span>默认<span class="token punctuation">)</span>”还是“<span class="token function">conv</span><span class="token punctuation">(</span>卷积<span class="token punctuation">)</span>”<span class="token punctuation">.</span>boundary_options用于处理边界充零问题<span class="token punctuation">,</span>边界的大小由滤波器的大小确定
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token char">'conv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">;</span>
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">imnoise</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>'gaussian'<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 添加高斯噪声
NP<span class="token operator">=</span>v<span class="token operator">*</span><span class="token function">numel</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 返回数组元素的数目<span class="token punctuation">,</span>等同于<span class="token function">prod</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>prod用于表示数组元素的乘积<span class="token punctuation">)</span>
<span class="token operator">%</span> <span class="token punctuation">[</span><span class="token class-name">J</span><span class="token punctuation">,</span>LAGRA<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>该函数返回LAGRA为最终采用的拉格朗日算子<span class="token punctuation">(</span>NP指的是噪声强度<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token class-name">L</span><span class="token punctuation">,</span>LAGRA<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> edgetaper函数用于对图像边缘进行模糊处理
edged<span class="token operator">=</span><span class="token function">edgetaper</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示退化图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>edged<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示图像边缘
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像边缘'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token class-name">J</span><span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NOISEPOWER<span class="token punctuation">,</span>LRANGE<span class="token punctuation">)</span>该函数中对参数LRANGE进行设置<span class="token punctuation">,</span>其为拉格朗日算子搜索范围
M1<span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span>edged<span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>LAGRA<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">%</span> 图像复原
M2<span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span>edged<span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>LAGRA<span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 增大拉格朗日算子
M3<span class="token operator">=</span><span class="token function">deconvreg</span><span class="token punctuation">(</span>edged<span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>LAGRA<span class="token operator">/</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 减小拉格朗日算子

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>M1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'采用拉格朗日算子复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>M2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'增大拉格朗日算子复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>M3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'缩小拉格朗日算子复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/44/9e/mbK5dZpm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e4/d4/HHXXZ7NQ_o.png" alt="在这里插入图片描述"><br> <strong><font size="5">五、Lucy-Richardson复原</font></strong></p> 
<p><strong>1、基本原理</strong></p> 
<p>在MATLAB软件中，<strong>函数deconvlucy0)采用加速收敛的Lucy-Richardson算法对图像进行复原</strong>。该函数的详细调用格式如下：<br> <img src="https://images2.imgbox.com/6e/11/D58urr2v_o.png" alt="在这里插入图片描述"><br> <strong>2、matlab实现</strong></p> 
<p>（1）对运动模糊图像采用Lucy-Richardson算法进行复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'rice<span class="token punctuation">.</span>png'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
LEN<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span>
THETA<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>len<span class="token punctuation">,</span>theta<span class="token punctuation">)</span>返回一个过滤器<span class="token punctuation">,</span>使其在与图像卷积后近似相机的线性运动
<span class="token operator">%</span> len指定运动的长度<span class="token punctuation">,</span>theta指定逆时针方向的运动角度（以度为单位）
<span class="token operator">%</span> 过滤器将成为水平和垂直运动的矢量。默认的len是<span class="token number">9</span><span class="token punctuation">,</span>默认的theta是<span class="token number">0</span><span class="token punctuation">,</span>其对应于<span class="token number">9</span>个像素的水平运动
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>LEN<span class="token punctuation">,</span>THETA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>'circular<span class="token char">','</span>conv'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 表示加入运动模糊

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示退化图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> 函数deconvlucy采用加速收敛的<span class="token class-name">Lucy</span><span class="token operator">-</span><span class="token class-name">Richardson</span>算法对图像进行复原
<span class="token operator">%</span> <span class="token class-name">J</span><span class="token operator">=</span><span class="token function">deconvlucy</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NUMIT<span class="token punctuation">)</span>该函数中参数NUMIT为算法的迭代次数<span class="token punctuation">,</span>默认值为<span class="token number">10</span>
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">deconvlucy</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 复原<span class="token punctuation">,</span>迭代次数为<span class="token number">5</span>
<span class="token class-name">L</span><span class="token operator">=</span><span class="token function">deconvlucy</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 复原<span class="token punctuation">,</span>迭代次数为<span class="token function">15</span><span class="token punctuation">(</span>增加迭代次数后图像变得更加清晰<span class="token punctuation">)</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'<span class="token number">5</span>次迭代后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'<span class="token number">15</span>次迭代后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/e9/3d/pXhiKGpq_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/58/5a/DUoDijoP_o.png" alt="在这里插入图片描述"><br> （2）对高斯噪声采用Lucy-Richardson算法进行图像复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'cameraman<span class="token punctuation">.</span>tif'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span>'gaussian'<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span> 产生<span class="token class-name">PSF</span>
v<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imnoise</span><span class="token punctuation">(</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">)</span><span class="token punctuation">,</span>'gaussian'<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 添加高斯噪声

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示退化图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

WT<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">WT</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span>end<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span>end<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span> 设置参数WEIGHT的数值
<span class="token operator">%</span> <span class="token class-name">J</span><span class="token operator">=</span><span class="token function">deconvlucy</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span>NUMIT<span class="token punctuation">,</span>DAMPAR<span class="token punctuation">,</span>WEIGHT<span class="token punctuation">)</span>中NUMIT为算法迭代次数<span class="token punctuation">(</span>本例为<span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>DAMPAR为偏差阈值默认为<span class="token number">0</span><span class="token punctuation">,</span>WEIGHT为像素加权值默认为原始图像的数值
<span class="token class-name">K</span><span class="token operator">=</span><span class="token function">deconvlucy</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token function">sqrt</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">L</span><span class="token operator">=</span><span class="token function">deconvlucy</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token function">sqrt</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>WT<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'WEIGHT为默认值时复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span>'WEIGHT设置复原后的图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/43/14/PzuEpqQx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c8/cd/BGq8Msik_o.png" alt="在这里插入图片描述"></p> 
<p><strong><font size="5">六、盲解卷积复原</font></strong></p> 
<p><strong>1、基本原理</strong></p> 
<p>前面介绍的图像复原方法，需要预先知道退化图像的PSF。在实际应用中，经常在不知道PSF的情况下对图像进行复原。<strong>盲解卷积复原方法，不需要预先知道PSF，而且可以对PSF进行估计</strong>。盲解卷积复原算法的优点是在对退化图像无先验知识的情况下，仍然能够进行复原。</p> 
<p>在MATLAB软件中，<strong>采用函数deconvblind()度退化的模糊图像进行盲解卷积复原</strong>。该函数的详细调用格式如下：<br> <img src="https://images2.imgbox.com/67/4b/Gp6qUDSb_o.png" alt="在这里插入图片描述"><br> <strong>2、matlab实现</strong></p> 
<p>（1）对运动模糊图像采用盲解卷积算法进行复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">imread</span><span class="token punctuation">(</span>'cameraman<span class="token punctuation">.</span>tif'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">im2double</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
LEN<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>
THETA<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">;</span>
<span class="token operator">%</span> h <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>len<span class="token punctuation">,</span>theta<span class="token punctuation">)</span>返回一个过滤器<span class="token punctuation">,</span>使其在与图像卷积后近似相机的线性运动
<span class="token operator">%</span> len指定运动的长度<span class="token punctuation">,</span>theta指定逆时针方向的运动角度（以度为单位）
<span class="token operator">%</span> 过滤器将成为水平和垂直运动的矢量。默认的len是<span class="token number">9</span><span class="token punctuation">,</span>默认的theta是<span class="token number">0</span><span class="token punctuation">,</span>其对应于<span class="token number">9</span>个像素的水平运动
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token char">'motion'</span><span class="token punctuation">,</span>LEN<span class="token punctuation">,</span>THETA<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token char">'conv'</span><span class="token punctuation">,</span>'circular'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 表示加入运动模糊
<span class="token operator">%</span> <span class="token punctuation">[</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">deconvblind</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>INITPSF<span class="token punctuation">,</span>NUMIT<span class="token punctuation">)</span><span class="token punctuation">,</span>其中输入参数INITPSF为PSF的估计值
<span class="token operator">%</span> 输出参数PSF为算法实际采用的PSF值<span class="token punctuation">,</span>NUMIT为算法的迭代次数默认为<span class="token number">10</span>
<span class="token punctuation">[</span><span class="token class-name">K</span><span class="token punctuation">,</span>PSF2<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">deconvblind</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>PSF<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示原<span class="token class-name">PSF</span>
<span class="token function">title</span><span class="token punctuation">(</span>'原PSF显示为图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>PSF2<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示估计的<span class="token class-name">PSF</span>
<span class="token function">title</span><span class="token punctuation">(</span>'估计得到的PSF显示为图像'<span class="token punctuation">)</span><span class="token punctuation">;</span>
axis auto<span class="token punctuation">;</span><span class="token operator">%</span> axis auto表示根据x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z的范围自动确定坐标轴的显示范围

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示退化图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示复原图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'复原图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/bf/c2/S245uU07_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f3/72/uuq9G6rQ_o.png" alt="在这里插入图片描述"><br> （2）% 对退化图像采用盲解卷积算法进行复原</p> 
<pre><code class="prism language-java">close all<span class="token punctuation">;</span>
clear all<span class="token punctuation">;</span>
clc<span class="token punctuation">;</span>
<span class="token class-name">I</span><span class="token operator">=</span><span class="token function">checkerboard</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> checkerboard函数用于创建棋盘图像<span class="token punctuation">,</span><span class="token class-name">I</span><span class="token operator">=</span><span class="token function">checkerboard</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>指定棋盘图像中每个单元的边长为n个像素
PSF<span class="token operator">=</span><span class="token function">fspecial</span><span class="token punctuation">(</span>'gaussian'<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">;</span>
<span class="token class-name">J</span><span class="token operator">=</span><span class="token function">imnoise</span><span class="token punctuation">(</span><span class="token function">imfilter</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>PSF<span class="token punctuation">)</span><span class="token punctuation">,</span>'gaussian'<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 添加高斯噪声
WT<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">WT</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">:</span>end<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">:</span>end<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">%</span> <span class="token punctuation">[</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">deconvblind</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">,</span>INITPSF<span class="token punctuation">,</span>NUMIT<span class="token punctuation">,</span>DAMPAR<span class="token punctuation">,</span>WEIGHT<span class="token punctuation">)</span><span class="token punctuation">,</span>其中输入参数INITPSF为PSF的估计值
<span class="token operator">%</span> 输出参数PSF为算法实际采用的PSF值<span class="token punctuation">,</span>NUMIT为算法的迭代次数默认为<span class="token number">10</span>
<span class="token operator">%</span> DAMPAR为偏移阈值默认值为<span class="token number">0</span><span class="token punctuation">,</span>WEIGHT为像素的加权值默认为原始图像的数值
<span class="token punctuation">[</span><span class="token class-name">K</span><span class="token punctuation">,</span>PFS2<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">deconvblind</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">,</span>PSF<span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span><span class="token function">sqrt</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">,</span>WT<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'原始图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">J</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示退化图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'退化图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 显示复原图像
<span class="token function">title</span><span class="token punctuation">(</span><span class="token char">'复原图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>实现效果：<br> <img src="https://images2.imgbox.com/bd/62/6LXWAAw6_o.png" alt="在这里插入图片描述"><br> 参考博客：<br> （1）<a href="https://blog.csdn.net/qq_43493788/article/details/110202792?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E7%A9%BA%E5%9F%9F%E5%86%85%E7%9A%84%E6%BB%A4%E6%B3%A2%E5%A4%8D%E5%8E%9F&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-110202792.142%5Ev42%5Epc_rank_34_2,185%5Ev2%5Econtrol&amp;spm=1018.2226.3001.4187">基于MATLAB的常见图像处理技术–图像复原技术</a><br> （2）<a href="https://blog.csdn.net/weixin_44378835/article/details/109155577?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166097654116782246414430%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166097654116782246414430&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-109155577-null-null.142%5Ev42%5Epc_rank_34_2,185%5Ev2%5Econtrol&amp;utm_term=%E5%9B%BE%E5%83%8F%E5%A4%8D%E5%8E%9F&amp;spm=1018.2226.3001.4187">【数字图像处理】图像复原</a><br> <strong>（第二篇强烈建议阅读，博主将各种图像复原方法的真正函数体使用matlab进行了实现）</strong></p> 
<p>由于刚刚开始学习图像处理，对于很多知识理解不到位。如有错误，恳请指正，任重而道远，慢慢加油！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a04cf24a9cf6ec3e0e1fc366312a55ac/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">openbmc开发50：旧版本更新换到新版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f291e98333c664dc1d99c744cc0bb646/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">（硅谷课堂项目）Java开发笔记5：讲师管理模块前端</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>