<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>afl覆盖率统计工具afl-cov常见问题总结 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="afl覆盖率统计工具afl-cov常见问题总结" />
<meta property="og:description" content="“官网”http://cipherdyne.com/afl-cov/ https://github.com/mrash/afl-cov编译
需要使用gcc -fprofile-arcs -ftest-coverage test.c (-o cov.out)对源码进行插桩从而支持覆盖率的统计C&#43;&#43; lcov reached unexpected end of file问题
A：将编译信息清空make clean all
ref：https://stackoverflow.com/questions/35965415/c-lcov-reached-unexpected-end-of-file对afl覆盖统计命令 afl-cov -d /path/to/afl-fuzz-output/ --live --coverage-cmd \ &#34;cat AFL_FILE | LD_LIBRARY_PATH=./lib/.libs ./bin/.libs/somebin -a -b -c&#34; \ --code-dir . 先执行afl-cov，再执行afl，afl-cov将读取afl output/queue中的所有文件，--live将实时读取新生成的文件。 --coverage-cmd里面用带覆盖率插桩的可执行文件“./cov.out AFL_FILE&#34;. AFL_FILE为固定写法，代表从queue中读取到的文件。 如果使用stdin读取输入，需要使用cat。 对klee覆盖统计命令
afl-cov -d klee-last --live --coverage-cmd &#34;cat AFL_FILE | ./gcccov.out&#34; --code-dir . --klee --overwrite覆盖路径、时间
在kleetmp-cov和afltmp-cov文件夹中*.extra的文件对于klee-last/testxxx, afl/output/queue/xxx，可以在python中用pickle处理文件
注意：afl-cov一开始执行就会计时，统计覆盖信息会等klee/afl生成测试用例，后者开始的时间影响覆盖计时。Non-zero exit status &#39;1&#39; for CMD: /usr/bin/readelf -a cat Could not find an executable binary with code coverage support (&#39;-fprofile-arcs -ftest-coverage&#39; ) in --coverage-cmd &#39;cat -A AFL_FILE|." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e19c9ed29d8150eb3bca5a946c46322d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-29T21:34:46+08:00" />
<meta property="article:modified_time" content="2020-05-29T21:34:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">afl覆盖率统计工具afl-cov常见问题总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <ol><li>“官网”<a href="http://cipherdyne.com/afl-cov/" rel="nofollow">http://cipherdyne.com/afl-cov/</a>    <a href="https://github.com/mrash/afl-cov">https://github.com/mrash/afl-cov</a></li><li>编译<br> 需要使用gcc <em>-fprofile-arcs -ftest-coverage test.c (-o cov.out)</em>对源码进行插桩从而支持覆盖率的统计</li><li>C++ lcov reached unexpected end of file问题<br> A：将编译信息清空make clean all<br> ref：<a href="https://stackoverflow.com/questions/35965415/c-lcov-reached-unexpected-end-of-file" rel="nofollow">https://stackoverflow.com/questions/35965415/c-lcov-reached-unexpected-end-of-file</a></li><li>对afl覆盖统计命令 <pre><code class="language-html">afl-cov -d /path/to/afl-fuzz-output/ --live --coverage-cmd \
"cat AFL_FILE | LD_LIBRARY_PATH=./lib/.libs ./bin/.libs/somebin -a -b -c" \
--code-dir .
先执行afl-cov，再执行afl，afl-cov将读取afl output/queue中的所有文件，--live将实时读取新生成的文件。
--coverage-cmd里面用带覆盖率插桩的可执行文件“./cov.out AFL_FILE".
AFL_FILE为固定写法，代表从queue中读取到的文件。
如果使用stdin读取输入，需要使用cat。
</code></pre> </li><li>对klee覆盖统计命令<br> afl-cov -d klee-last --live --coverage-cmd "cat AFL_FILE | ./gcccov.out" --code-dir . --klee --overwrite</li><li>覆盖路径、时间<br> 在kleetmp-cov和afltmp-cov文件夹中*.extra的文件对于klee-last/testxxx, afl/output/queue/xxx，可以在python中用pickle处理文件<br> 注意：afl-cov一开始执行就会计时，统计覆盖信息会等klee/afl生成测试用例，后者开始的时间影响覆盖计时。</li><li>Non-zero exit status '1' for CMD: /usr/bin/readelf -a cat Could not find an executable binary with code coverage support ('-fprofile-arcs -ftest-coverage' ) in --coverage-cmd 'cat -A AFL_FILE|./gcccov.out'<br> A:注意 管道|前后加空格，注意gcccov.out使用gcc -fprofile-arcs -ftest-coverage，afl-gcc不可以<br> 对于stdin做输入：afl-cov -d ./output --live --coverage-cmd "cat -A AFL_FILE  |  ./gcccov.out" --code-dir .<br> 对于file做输入：afl-cov -d ./output --live --coverage-cmd "./gcccov.out AFL_FILE" --code-dir .</li><li> lcov: ERROR: no valid records found in tracefile问题<br> A：重新gcc <em>-fprofile-arcs -ftest-coverage test.c (-o cov.out)</em>试试，不仅.out需要覆盖插桩对版本，还有包括.gcda .gcdo等文件</li><li>覆盖结果查看<br> The code coverage results in <em>/path/to/afl-fuzz-output/cov/web/lcov-web-final</em> represent cumulative code coverage across all AFL test cases. <br> 执行过程中也会窗口打印<br><img alt="" height="814" src="https://images2.imgbox.com/29/fb/zRpg2VD5_o.png" width="1052"></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/00cc6eb7ce42f3f1483c314d4b837b6a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">矩阵可对角化的条件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/90200d3cb230fde5a3497bf089214526/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">idea创建Maven报错Cannot resolve plugin org.apache.maven.plugins:maven-compiler-plugin:3.1</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>