<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>手把手教你编写Python抢购脚本 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="手把手教你编写Python抢购脚本" />
<meta property="og:description" content="想买苹果手机，但总是抢不到，所以想试着能不能写个脚本代码。
第一步：把想要抢购的商品加进购物车，注意：脚本是对购物车内全部商品进行下单操作，所以不够买的商品最好先从购物车内删除。
第二步：写好Python脚本，在抢购之前运行，并设置好抢购时间。
Python脚本实现 安装Python。我安装的是anaconda安装webdriver扩展。它是Selenium模块的一部分。Selenium是一个用于Web应用程序测试的工具，用于测试你的应用程序看是否能够很好得工作在不同浏览器和操作系统之上。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。所以其实就是安装Selenium：Win&#43;R，输入cmd，在命令行中输入pipshow selenium安装chrome浏览器（因为我用的是谷歌）安装chromedriver。它是chrome的插件，是为了webDriver能通过操作chromedriver来控制chrome浏览器自动操作，如打开网页，点击按钮等操作。 下载地址：
http://chromedriver.storage.googleapis.com/index.html或https://npm.taobao.org/mirrors/chromedriver/
**注意：下载时要根据电脑系统和chrome浏览器版本来选择对应的chromedriver版本。**可以通过浏览器右上角的三点→帮助→关于Google Chrome来查看自己的chrome版本。
下载chromedriver安装包后，进行解压，放在chrome安装的同级目录下，同时在环境变量PATH中添加路径。
然后用以下代码检验是否安装成功：
然鹅，此时我遇到了错误，如下
于是，我把chromedriver.exe放到了我python脚本的文件夹后，就完美解决问题了！
【补充】
我知道自己为什么出现上面那个错误了，因为路径没输入！
在下图所示红框处输入自己的下载的chromedriver安装路径即可成功运行。
完整的Python脚本代码如下：
```python # coding=utf-8 import os from selenium import webdriver import datetime import time from os import path #此处chromedriver改为自己下载解压的chromedriver的路径 driver = webdriver.Chrome(&#34;E:/JupyterNotebookSavePath/chromedriver&#34;) #driver.maximize_window() def login(): #打开淘宝首页，扫码登陆淘宝 driver.get(&#34;https://www.taobao.com&#34;) time.sleep(3) if driver.find_element_by_link_text(&#34;亲，请登录&#34;): driver.find_element_by_link_text(&#34;亲，请登录&#34;).click() print(&#34;请在15秒内完成扫码&#34;) time.sleep(15) #打开购物车列表首页 driver.get(&#34;https://cart.taobao.com/cart.htm&#34;) time.sleep(3) #全选购物车 if driver.find_element_by_id(&#34;J_SelectAll1&#34;): driver.find_element_by_id(&#34;J_SelectAll1&#34;).click() now = datetime.datetime.now() print(&#34;login success:&#34;, now.strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)) def buy(times): while True: #记录当前时间，使用datatime内置模块 now = datetime." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1ca46591083066a8721ae29e7e60c829/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T19:09:07+08:00" />
<meta property="article:modified_time" content="2024-01-05T19:09:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">手把手教你编写Python抢购脚本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>想买苹果手机，但总是抢不到，所以想试着能不能写个脚本代码。</strong></p> 
<p>第一步：把想要抢购的商品加进购物车，注意：脚本是对购物车内全部商品进行下单操作，所以不够买的商品最好先从购物车内删除。<br> 第二步：写好Python脚本，在抢购之前运行，并设置好抢购时间。</p> 
<h3><a id="Python_5"></a>Python脚本实现</h3> 
<ul><li>安装Python。我安装的是anaconda</li><li>安装webdriver扩展。它是Selenium模块的一部分。Selenium是一个用于Web应用程序测试的工具，用于测试你的应用程序看是否能够很好得工作在不同浏览器和操作系统之上。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。所以其实就是安装Selenium：Win+R，输入cmd，在命令行中输入pipshow selenium</li><li>安装chrome浏览器（因为我用的是谷歌）</li><li>安装chromedriver。它是chrome的插件，是为了webDriver能通过操作chromedriver来控制chrome浏览器自动操作，如打开网页，点击按钮等操作。</li></ul> 
<p>下载地址：</p> 
<blockquote> 
 <p>http://chromedriver.storage.googleapis.com/index.html或https://npm.taobao.org/mirrors/chromedriver/</p> 
</blockquote> 
<p>**注意：下载时要根据电脑系统和chrome浏览器版本来选择对应的chromedriver版本。**可以通过浏览器右上角的三点→帮助→关于Google Chrome来查看自己的chrome版本。<br> <img src="https://images2.imgbox.com/79/8b/MTSfaA2d_o.png" alt="在这里插入图片描述"><br> 下载chromedriver安装包后，进行解压，放在chrome安装的同级目录下，同时在环境变量PATH中添加路径。<br> <img src="https://images2.imgbox.com/99/f3/7uU1tQBy_o.png" alt="在这里插入图片描述"><br> 然后用以下代码检验是否安装成功：</p> 
<p>然鹅，此时我遇到了错误，如下</p> 
<p>于是，我把chromedriver.exe放到了我python脚本的文件夹后，就完美解决问题了！</p> 
<p>【补充】<br> 我知道自己为什么出现上面那个错误了，因为路径没输入！<br> 在下图所示红框处输入自己的下载的chromedriver安装路径即可成功运行。<br> <img src="https://images2.imgbox.com/a1/06/kDFDVIjr_o.png" alt="在这里插入图片描述"><br> 完整的Python脚本代码如下：</p> 
<pre><code class="prism language-cpp">```python
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">coding</span><span class="token expression"><span class="token operator">=</span>utf<span class="token operator">-</span><span class="token number">8</span></span></span>
<span class="token keyword">import</span> <span class="token module">os</span>
from selenium <span class="token keyword">import</span> <span class="token module">webdriver</span>
<span class="token keyword">import</span> <span class="token module">datetime</span>
<span class="token keyword">import</span> <span class="token module">time</span>
from os <span class="token keyword">import</span> <span class="token module">path</span>

#此处chromedriver改为自己下载解压的chromedriver的路径
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span><span class="token function">Chrome</span><span class="token punctuation">(</span><span class="token string">"E:/JupyterNotebookSavePath/chromedriver"</span><span class="token punctuation">)</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">driver</span><span class="token expression"><span class="token punctuation">.</span><span class="token function">maximize_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>

def <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
    #打开淘宝首页，扫码登陆淘宝
    driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.taobao.com"</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> driver<span class="token punctuation">.</span><span class="token function">find_element_by_link_text</span><span class="token punctuation">(</span><span class="token string">"亲，请登录"</span><span class="token punctuation">)</span><span class="token operator">:</span>
        driver<span class="token punctuation">.</span><span class="token function">find_element_by_link_text</span><span class="token punctuation">(</span><span class="token string">"亲，请登录"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"请在15秒内完成扫码"</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
        #打开购物车列表首页
        driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://cart.taobao.com/cart.htm"</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        #全选购物车
    <span class="token keyword">if</span> driver<span class="token punctuation">.</span><span class="token function">find_element_by_id</span><span class="token punctuation">(</span><span class="token string">"J_SelectAll1"</span><span class="token punctuation">)</span><span class="token operator">:</span>
        driver<span class="token punctuation">.</span><span class="token function">find_element_by_id</span><span class="token punctuation">(</span><span class="token string">"J_SelectAll1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"login success:"</span><span class="token punctuation">,</span> now<span class="token punctuation">.</span><span class="token function">strftime</span><span class="token punctuation">(</span><span class="token string">"%Y-%m-%d %H:%M:%S"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

def <span class="token function">buy</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">while</span> True<span class="token operator">:</span>
        #记录当前时间，使用datatime内置模块
        now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strftime</span><span class="token punctuation">(</span><span class="token string">"%Y-%m-%d %H:%M:%S"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span>
        # 对比时间，时间到的话就点击结算
        <span class="token keyword">if</span> now <span class="token operator">==</span> times<span class="token operator">:</span>
            <span class="token keyword">try</span><span class="token operator">:</span>
                <span class="token keyword">if</span> driver<span class="token punctuation">.</span><span class="token function">find_element_by_id</span><span class="token punctuation">(</span><span class="token string">"J_Go"</span><span class="token punctuation">)</span><span class="token operator">:</span>
                    driver<span class="token punctuation">.</span><span class="token function">find_element_by_id</span><span class="token punctuation">(</span><span class="token string">"J_Go"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    driver<span class="token punctuation">.</span><span class="token function">find_element_by_link_text</span><span class="token punctuation">(</span><span class="token char">'提交订单'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'抢购成功，请尽快付款'</span><span class="token punctuation">)</span>
            except<span class="token operator">:</span>
                 <span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'请再次尝试提交订单'</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token operator">:</span>
    times <span class="token operator">=</span> <span class="token function">input</span><span class="token punctuation">(</span><span class="token string">"请输入抢购时间(例如格式：2021-02-01 00:00:00):"</span><span class="token punctuation">)</span>
    <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">buy</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span>
</code></pre> 
<p><strong>另外怕大家不会使用，直接给大家准备了写好的，直接下载打开即可使用！</strong><br> <strong>源码放在百度云盘上了需要可以微信扫描下方CSDN官方认证二维码免费领取</strong></p> 
<center> 
 <img src="https://images2.imgbox.com/30/4c/33cxQPCj_o.png"> 
 <center> 
 </center> 
</center> 
<h2><a id="_87"></a>学习资源推荐</h2> 
<p><strong>上面都是一些软技能的干货分享，希望可以帮到正在入门学习 Python 的小伙伴们，下面是整理好的一些资料分享。</strong><br> <img src="https://images2.imgbox.com/bf/f7/9pWaP5wn_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4c/58/5zAwyoyU_o.jpg" alt="在这里插入图片描述"></p> 
<h4><a id="python_92"></a>python副业兼职与全职路线</h4> 
<p><img src="https://images2.imgbox.com/c1/2d/RLdybZ70_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ec/5e/OojkfUxv_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>👉<a href="https://mp.weixin.qq.com/s/ZxS5RO3rb59V5z2G4hLRUA" rel="nofollow">[[<font color="red">CSDN大礼包：</font>《python兼职资源&amp;全套学习资料》免费分享]]</a><font color="green">（<strong>安全链接，放心点击</strong>）</font></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/319984890dfdbdc3290b6e8e8bafcdbb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Pycharm下载安装详细教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/141999d2a95e983c491da08163837388/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何访问GitHub快的飞起？两步解决访问超时GitHub，无法访问GitHub的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>