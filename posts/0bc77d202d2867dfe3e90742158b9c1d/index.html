<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MindOpt APL：一款适合优化问题数学建模的编程语言 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MindOpt APL：一款适合优化问题数学建模的编程语言" />
<meta property="og:description" content="什么是建模语言 建模语言是一种描述信息或模型的编程语言，在运筹优化领域，一般是指代数建模语言。
比如要写一个线性规划问题的建模和求解，可以采用C、Python、Java等通用编程语言来实现计算机编程（码代码），也可以换采用建模语言。
本文将以阿里达摩院研发的MindOpt建模语言(MindOpt Algebra Programming Language, MindOptAPL，简称为MAPL)来讲解。MAPL是一种高效且通用的代数建模语言，当前主要用于数学规划问题的建模，并支持调用多种求解器求解。
代数建模语言工作原理 在数学规划领域，遇到一个实际问题时候，我们需要数学建模成优化问题模型、然后编程、然后计算优化结果，得到这个实际问题的解决方案。
在这个编程过程中，可以根据选用的计算工具——优化求解器提供的通用编程语言的API来编写代码，也可以采用建模语言来编写代码。如下示例，就是一个利用MAPL建模语言来进行一个优化问题码的代码。
左边是数学模型，三要素：两个变量xa和xb，目标函数是最大化一个公式，约束是最下面两行，限定取值关系。中间是用MAPL建模语言编的代码。可以看到前面4行就表达清楚了左边的数学公式。最后“option solver mindopt；”是设置计算这个问题的求解器为mindopt求解器，“solve；”是执行求解。右边就是求解器的计算结果，xa = 3，xb=5，此时目标函数最大，是1050。 为什么要用建模语言 语法更简单（代码对比） 从上面我们可以看到建模语言可以方便地进行数学建模和求解的代码。这里我们对比一下建模语言和通用的编程语言，来看看用建模语言优势。
以下面这个问题为示例：
| 线性规划模型：
max x0 &#43; 2 * x1 &#43; 3 * x2 &#43; x3
s.t. (-1) * x0 &#43; x1 &#43; 3 * x2 &#43; 10 * x3 &lt;= 20
x0 - 3 * x1 &#43; x2 = 30
x1 - 3.5 * x3 = 0
0 ≤ x0 ≤ 40" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0bc77d202d2867dfe3e90742158b9c1d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T16:54:54+08:00" />
<meta property="article:modified_time" content="2023-12-08T16:54:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MindOpt APL：一款适合优化问题数学建模的编程语言</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>什么是建模语言</h3> 
<p>建模语言是一种描述信息或模型的编程语言，在运筹优化领域，一般是指代数建模语言。<br> 比如要写一个线性规划问题的建模和求解，可以采用C、Python、Java等通用编程语言来实现计算机编程（码代码），也可以换采用建模语言。<br> 本文将以阿里达摩院研发的MindOpt建模语言(MindOpt Algebra Programming Language, MindOptAPL，<strong>简称为MAPL</strong>)来讲解。MAPL是一种高效且通用的代数建模语言，当前主要用于数学规划问题的建模，并支持调用多种求解器求解。</p> 
<h3><a id="_6"></a>代数建模语言工作原理</h3> 
<p>在数学规划领域，遇到一个实际问题时候，我们需要数学建模成优化问题模型、然后编程、然后计算优化结果，得到这个实际问题的解决方案。<br> 在这个编程过程中，可以根据选用的计算工具——优化求解器提供的通用编程语言的API来编写代码，也可以采用建模语言来编写代码。如下示例，就是一个利用MAPL建模语言来进行一个优化问题码的代码。<br> <img src="https://images2.imgbox.com/c4/7e/luug1SSq_o.png" alt="image.png"></p> 
<ul><li>左边是数学模型，三要素：两个变量xa和xb，目标函数是最大化一个公式，约束是最下面两行，限定取值关系。</li><li>中间是用MAPL建模语言编的代码。可以看到前面4行就表达清楚了左边的数学公式。最后“option solver mindopt；”是设置计算这个问题的求解器为mindopt求解器，“solve；”是执行求解。</li><li>右边就是求解器的计算结果，xa = 3，xb=5，此时目标函数最大，是1050。</li></ul> 
<h3><a id="_16"></a>为什么要用建模语言</h3> 
<h4><a id="_18"></a>语法更简单（代码对比）</h4> 
<p>从上面我们可以看到建模语言可以方便地进行数学建模和求解的代码。这里我们对比一下建模语言和通用的编程语言，来看看用建模语言优势。<br> 以下面这个问题为示例：</p> 
<p>| 线性规划模型：<br> max x0 + 2 * x1 + 3 * x2 + x3<br> s.t. (-1) * x0 + x1 + 3 * x2 + 10 * x3 &lt;= 20<br> x0 - 3 * x1 + x2 = 30<br> x1 - 3.5 * x3 = 0<br> 0 ≤ x0 ≤ 40<br> 0 ≤ x1<br> 0 ≤ x2<br> 2 ≤ x3 ≤ 3</p> 
<p>我们使用 MindOpt APL 建模语言 和 MindOpt 求解器的 Python APIs，分别对上面的线性规划模型建模，并求解模型。</p> 
<p>MAPL代码：</p> 
<pre><code class="prism language-shell"><span class="token function">clear</span> model<span class="token punctuation">;</span>  <span class="token comment">#清除model，多次run的时候使用</span>
option modelname <span class="token builtin class-name">test</span><span class="token punctuation">;</span> <span class="token comment">#运行完代码之后会自动生成.nl和.sol文件  model是存放的地址，test是文件名</span>

<span class="token comment">#--------------------------</span>
<span class="token comment"># twoTask.mapl</span>
var x0 <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment"># 声明决策变量xa |</span>
var x1 <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
var x2 <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
var x3 <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
maximize Reward: x0 + <span class="token number">2</span> * x1 + <span class="token number">3</span> * x2 + x3<span class="token punctuation">;</span>  <span class="token comment"># 声明目标函数</span>
subto c1: <span class="token punctuation">(</span>-1<span class="token punctuation">)</span> * x0 + x1 + <span class="token number">3</span> * x2 + <span class="token number">10</span> * x3 <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">;</span>       <span class="token comment"># 声明约束</span>
subto c2: x0 - <span class="token number">3</span> * x1 + x2 <span class="token operator">&lt;=</span> <span class="token number">30</span><span class="token punctuation">;</span>
subto c3: x1 - <span class="token number">3.5</span> * x3 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
subto c4: x0 <span class="token operator">&lt;=</span> <span class="token number">40</span><span class="token punctuation">;</span>
subto c5: x3 <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token comment">#--------------------------</span>


option solver mindopt<span class="token punctuation">;</span>     <span class="token comment"># （可选）指定求解用的求解器，默认是MindOpt</span>
solve<span class="token punctuation">;</span>         <span class="token comment"># 求解</span>

print <span class="token string">"-----------------Display---------------"</span><span class="token punctuation">;</span>
display<span class="token punctuation">;</span>        <span class="token comment"># 展示结果</span>
print <span class="token string">"目标函数值 = "</span>,x0 + <span class="token number">2</span> * x1 + <span class="token number">3</span> * x2 + x3<span class="token punctuation">;</span>
</code></pre> 
<p>Python代码：</p> 
<pre><code class="prism language-shell">from mindoptpy <span class="token function">import</span> *

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token builtin class-name">:</span>

    <span class="token comment"># Step 1. Create model.</span>
    model <span class="token operator">=</span> Model<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span>

    try:
        <span class="token comment"># Step 2. Input model.</span>
        <span class="token comment"># Change to minimization problem.</span>
        model.ModelSense <span class="token operator">=</span> MDO.MAXIMIZE

        <span class="token comment"># Add variables.</span>
        x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        x.append<span class="token punctuation">(</span>model.addVar<span class="token punctuation">(</span><span class="token number">0.0</span>,         <span class="token number">40.0</span>, <span class="token number">1.0</span>, <span class="token string">'C'</span>, <span class="token string">"x0"</span><span class="token punctuation">))</span>
        x.append<span class="token punctuation">(</span>model.addVar<span class="token punctuation">(</span><span class="token number">0.0</span>, float<span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span>, <span class="token number">2.0</span>, <span class="token string">'C'</span>, <span class="token string">"x1"</span><span class="token punctuation">))</span>
        x.append<span class="token punctuation">(</span>model.addVar<span class="token punctuation">(</span><span class="token number">0.0</span>, float<span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span>, <span class="token number">3.0</span>, <span class="token string">'C'</span>, <span class="token string">"x2"</span><span class="token punctuation">))</span>
        x.append<span class="token punctuation">(</span>model.addVar<span class="token punctuation">(</span><span class="token number">2.0</span>,          <span class="token number">3.0</span>, <span class="token number">1.0</span>, <span class="token string">'C'</span>, <span class="token string">"x3"</span><span class="token punctuation">))</span>

        <span class="token comment"># Add constraints.</span>
        model.addConstr<span class="token punctuation">(</span>- <span class="token number">1.0</span> * x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> + <span class="token number">1.0</span> * x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> + <span class="token number">3.0</span> * x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> + <span class="token number">10.0</span> * x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">20</span>, <span class="token string">"c1"</span><span class="token punctuation">)</span>
        model.addConstr<span class="token punctuation">(</span><span class="token number">1.0</span> * x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              - <span class="token number">3.0</span> * x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> + x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">30</span>, <span class="token string">"c2"</span><span class="token punctuation">)</span>
        model.addConstr<span class="token punctuation">(</span><span class="token number">1.0</span> * x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>              - <span class="token number">3.5</span> * x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span>, <span class="token string">"c3"</span><span class="token punctuation">)</span>
      

        <span class="token comment"># Step 3. Solve the problem and populate optimization result.</span>
        model.optimize<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> model.status <span class="token operator">==</span> MDO.OPTIMAL:
            print<span class="token punctuation">(</span>f<span class="token string">"Optimal objective value is: {model.objval}"</span><span class="token punctuation">)</span>
            print<span class="token punctuation">(</span><span class="token string">"Decision variables: "</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token for-or-select variable">v</span> <span class="token keyword">in</span> x:
                print<span class="token punctuation">(</span>f<span class="token string">"x[{v.VarName}] = {v.X}"</span><span class="token punctuation">)</span>
        else:
            print<span class="token punctuation">(</span><span class="token string">"No feasible solution."</span><span class="token punctuation">)</span>
    except MindoptError as e:
        print<span class="token punctuation">(</span><span class="token string">"Received Mindopt exception."</span><span class="token punctuation">)</span>
        print<span class="token punctuation">(</span><span class="token string">" - Code          : {}"</span>.format<span class="token punctuation">(</span>e.errno<span class="token punctuation">))</span>
        print<span class="token punctuation">(</span><span class="token string">" - Reason        : {}"</span>.format<span class="token punctuation">(</span>e.message<span class="token punctuation">))</span>
    except Exception as e:
        print<span class="token punctuation">(</span><span class="token string">"Received other exception."</span><span class="token punctuation">)</span>
        print<span class="token punctuation">(</span><span class="token string">" - Reason        : {}"</span>.format<span class="token punctuation">(</span>e<span class="token punctuation">))</span>
    finally:
        <span class="token comment"># Step 4. Free the model.</span>
        model.dispose<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>从上面的例子可以看到，MAPL建模语言比较简洁，没有Python运行这么多复杂的创建、添加、异常捕捉和释放的过程，就聚焦在编个模型去求解计算，更易于理解和添加。上面的例子还只是线性规划，对于非线性规划的问题，Python的API会更复杂。而采用MAPL建模语言只需要表达清楚数学公式，对于调试模型修改更方便。</p> 
<h4><a id="_116"></a>支持多种求解器，换求解器的时候不用重复编程</h4> 
<p>很多人选择建模语言，最大的原因是希望切换求解器方案。因为不同品牌的求解器的求解能力不一样，遇到一个问题数学模型调整了一行公式，可能之前选择的求解器就不支持了，需要更换求解器。<br> 此时如果选择用各家求解器的API来编程，换一个求解器，就需要重新学习对应的API，重新码代码，维护起来困难。虽然业界也有通用的 .mps 和 .nl 的优化问题数据格式，但是熟悉不同求解器的调用数据计算的方法也很耗时，或者装对应的软件也很麻烦。这个时候，建模语言的优势就很大。</p> 
<p>比如下面是MAPL代码中，只需要换一行，就能换求解器进行计算：</p> 
<pre><code class="prism language-shell">option solver highs<span class="token punctuation">;</span>     <span class="token comment"># 更换求解器</span>
</code></pre> 
<p>更多MAPL支持的求解器，可以参考上一个博客<a href="https://developer.aliyun.com/article/1388917?spm=a2c6h.13148508.setting.14.72034f0eQevRqu" rel="nofollow">MindOpt APL，可以支持调用几十种求解器的建模语言</a></p> 
<h4><a id="APIPython_129"></a>建模语言也支持通用编程语言的API，如Python</h4> 
<p>有很多同学喜欢Python语言，更希望用Python编程。MAPL建模语言支持Python来调用，import maplpy后就用Python的方式来编代码，能继续享受一行代码换求解器的优良属性。可一看<a href="https://opt.aliyun.com/example/VfQfQnMfaUN3" rel="nofollow">广告流量分配：曝光和转化均衡</a>案例中的代码对比。</p> 
<h3><a id="_133"></a>常见的建模语言</h3> 
<p>市面上的建模语言有很多个，需要看各家求解器支持的建模语言，比如MindOpt求解器支持如下4种建模语言：MAPL（MindOpt APL）、AMPL、Pyomo、PuLP。<br> <img src="https://images2.imgbox.com/f8/8d/2EFyCP4e_o.png" alt="image.png"><br> 其中MindOpt APL（MAPL）就是阿里达摩院自研的建模语言，是目前中国唯一一款代数建模语言。其他建模语言的描述大家可以点击上面的链接查看：<a href="https://opt.aliyun.com/platform/docs/htmldoc/solver" rel="nofollow">https://opt.aliyun.com/platform/docs/htmldoc/solver</a></p> 
<h3><a id="MAPL_139"></a>MAPL的优点</h3> 
<p>MAPL国内第一款拥有自主知识产权，完全自研的国产建模语言，提供了丰富文档学习以及案例参考。并且在电力SCUC等领域问题上建模性能优秀，对标或超越已有产品。对比AMPL等建模语言，部分语法上更灵活简单，后续也会支持向量化建模等特色能力，提升建模易用性等。</p> 
<h4><a id="_143"></a>灵活性：</h4> 
<p>MAPL具有非常高的灵活性，可以用来建模和求解各种类型的优化问题，包括线性规划、整数规划、非线性规划等。它支持多种数学表达式和运算符，可以方便地表示复杂的数学关系和约束条件。如下是它支持数值计算。<br> <img src="https://images2.imgbox.com/67/5d/Tc2mNtPw_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_150"></a>易用性</h4> 
<p>MAPL建模语言采用了类似于自然语言的语法和结构，使得用户可以很容易地理解和编写优化模型。并且支持读写csv文件，使得数据的读取和写入变得容易，数据储存也很方便。<br> 如下将结果print输出为csv表格：<br> <img src="https://images2.imgbox.com/ef/e6/TYtxkhxP_o.png" alt="image.png"></p> 
<h4><a id="_156"></a>更多选择</h4> 
<p>MAPL与MindOpt Studio平台集成，可以在线上环境使用，无需下载，并且支持调用多种求解器，可直接对比结果。还支持将输出mps文件，可以在不同的计算环境和操作系统之间进行导入和导出。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ad22681c06131715c36ab02121a84448/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">android开发在android13中存储权限发生变化，READ_EXTERNAL_STORAGE，WRITE_EXTERNAL_STORAGE无法使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f42a0b16b5a9cc7bf94dc055136b9169/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[INS-06006]AIX7.2 安装19c互信通不过</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>