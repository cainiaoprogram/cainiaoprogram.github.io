<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>fftw的使用 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="fftw的使用" />
<meta property="og:description" content="六、 更多实数据的DFT 通过一个统一的r2r（real-to-real，实数－实数）接口，FFTW支持其它的一些变换类型，这些变换的输入和输出数组大小相同。这些r2r变换可以分为3个类型：DFT的实 数据输入，complex-Hermitian（指复Hermitian对称）以半复数格式的输出；DCT/DST（离散正余弦变换）；DHT（离散 Hartley变换）。接口如下：
fftw_plan fftw_plan_r2r_1d(int n, double *in, double *out,
fftw_r2r_kind kind, unsigned flags);
fftw_plan fftw_plan_r2r_2d(int n0, int n1, double *in, double *out,
fftw_r2r_kind kind0, fftw_r2r_kind kind1, unsigned flags);
fftw_plan fftw_plan_r2r_3d(int n0, int n1, int n2,
double *in, double *out,
fftw_r2r_kind kind0,
fftw_r2r_kind kind1,
fftw_r2r_kind kind2,
unsigned flags);
fftw_plan fftw_plan_r2r(int rank, const int *n, double *in, double *out, const fftw_r2r_kind *kind, unsigned flags); 这里n为数组的物理尺寸。对于多维变换，数组按行优先方式存储（与C&#43;&#43;标准相同，与Fortran不同）。由于DFT是可分离变换，所以2维/3维/多维的变换是在每个维度上分别进行变换得到的，每个维度都可指定一个kind参数，指定该维的变换类型。
1. 半复数格式DFT（HalfComplex-format）
对于大小为n的1维DFT，输出格式如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3804bdf0ca992cfca0c5f9d538f1cd95/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2010-09-06T15:32:00+08:00" />
<meta property="article:modified_time" content="2010-09-06T15:32:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">fftw的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>六、 更多实数据的DFT</h3> 
<div> 
 <p style="text-indent: 2em;">通过一个统一的r2r（real-to-real，实数－实数）接口，FFTW支持其它的一些变换类型，这些变换的输入和输出数组大小相同。这些r2r变换可以分为3个类型：DFT的实 数据输入，complex-Hermitian（指复Hermitian对称）以半复数格式的输出；DCT/DST（离散正余弦变换）；DHT（离散 Hartley变换）。接口如下：</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<p> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: x-small; color: #0000ff;">     fftw_plan</span><span style="font-size: x-small;"> fftw_plan_r2r_1d(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind, </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);<br>     </span><span style="font-size: x-small; color: #0000ff;">fftw_plan</span><span style="font-size: x-small;"> fftw_plan_r2r_2d(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n0, </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n1, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind </span><span style="font-size: x-small;">kind0, </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind1, </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);<br>     </span><span style="font-size: x-small; color: #0000ff;">fftw_plan</span><span style="font-size: x-small;"> fftw_plan_r2r_3d(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n0, </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n1, </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n2,<br>                                </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind0,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind1,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind2,<br>                                </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);<br>     </span><span style="font-size: x-small; color: #0000ff;">fftw_plan</span><span style="font-size: x-small;"> fftw_plan_r2r(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> rank, </span><span style="font-size: x-small; color: #0000ff;">const int</span><span style="font-size: x-small;"> *n, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out, </span><span style="font-size: x-small; color: #0000ff;">const fftw_r2r_kind</span><span style="font-size: x-small;"> *kind, </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;">这里<em>n</em>为数组的物理尺寸。对于多维变换，数组按行优先方式存储（与C++标准相同，与Fortran不同）。由于DFT是可分离变换，所以2维/3维/多维的变换是在每个维度上分别进行变换得到的，每个维度都可指定一个<em>kind</em>参数，指定该维的变换类型。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>1. 半复数格式DFT（HalfComplex-format）</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">对于大小为n的1维DFT，输出格式如下：</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong></strong>r<sub>0</sub>, r<sub>1</sub>, r<sub>2</sub>, ..., r<sub>n/2</sub>, i<sub>(n+1)/2-1</sub>, ..., i<sub>2</sub>, i<sub>1</sub></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">上述(n+1)/2向下取整。r<sub>k</sub>是第k个输出的实部，i<sub>k</sub>是 第k个输出的虚部。对于一个半复数格式的数组hc[n]，第k个元素的实部为hc[k]，虚部为[n-k]；k==0或n/2（n为偶数）情况除外，这两 种情况下虚部为0，不存储。所以对于r2hc(real-half complex，正变换)变换，输入输出数组大小都为n，hc2r（half complex- real，逆变换）变换也是如此。除了数据格式的差异，r2hc和hc2r变换的结果与前述r2c和c2r的变换结果是相同的。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">对于多维比如2维变换，由可分离性，可以先对行 变换，再对列变换，FFTW_R2HC方式行变换的结果是半复数行，如果采用FFTW_R2HC方式进行列变换，需要进行一些数据处理，r2r变换不会自 动处理，需要手动进行，所以对于多维实数据变换，推荐使用普通的r2c/c2r接口。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>2. DCT/DST</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">DCT可以认为是实偶对称数据DFT（REDFT,<strong>R</strong>eal-<strong>E</strong>ven <strong>DFT</strong>）, DST可以认为是实奇对称数据DFT（RODFT,<strong>R</strong>eal-<strong>O</strong>dd <strong>DFT</strong>）。REDFT<em>ab</em>和RODFT<em>ab</em>中的<em>a</em>,<em>b</em>为数据移位标志（1表示移位），这些构成了DCT和DST的I－IV类，比较常用的为DCT-II，FFTW支持所有这些类型的变换。</p> 
</div> 
<p style="text-indent: 2em;"> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre>     
     </pre><ul><li><span style="font-size: x-small;"><br> </span>
      
      </li><li><span style="font-size: x-small;">FFTW_REDFT00 (DCT-I): even around j=0 and even around j=n-1.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_REDFT10 (DCT-II, the DCT): even around j=-0.5 and even around j=n-0.5.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_REDFT01 (DCT-III, the IDCT): even around j=0 and odd around j=n.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_REDFT11 (DCT-IV): even around j=-0.5 and odd around j=n-0.5.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_RODFT00 (DST-I): odd around j=-1 and odd around j=n.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_RODFT10 (DST-II): odd around j=-0.5 and odd around j=n-0.5.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_RODFT01 (DST-III): odd around j=-1 and even around j=n-1.</span><span style="font-size: x-small;"><br> </span></li><li><span style="font-size: x-small;">FFTW_RODFT11 (DST-IV): odd around j=-0.5 and even around j=n-0.5.</span></li></ul> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<div> 
 <p style="text-indent: 2em;">对称性只是逻辑意义上的，<strong>对物理输入数据没有任何限制</strong>。比如对于n＝5的REDFT00 (DCT-I)，输入数据为<em>abcde</em>，它对应n=8的<em>abcdedcb</em>的常规DFT；对于n＝4的REDFT10 (DCT-II)，输入数据为<em>abcd</em>，它对应n=8的<em>abcddcba</em>的常规DFT。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">所有这些变换都是可逆的。R*DFT00的逆变 换是R*DFT00，R*DFT10的逆变换是R*DFT01（即DCT和IDCT），R*DFT11的逆变换是R*DFT11。如同DFT一样，这些变 换的结果都没有归一化，所以正变换再逆变换后数据变为原始数据的N倍，N为逻辑DFT大小。比如对于REDFT00变换，N=2(n-1)；对于 RODFT00，N=2n。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">注意n=1的REDFT00对应与N=0的DFT，所以它是未定义的（返回值为NULL的fftw_plan）。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">R*DFT01和R*DFT10要比R*DFT11稍微快一些，尤其对于奇数长度数据；而R*DFT00则要慢一些，尤其对于奇数长度数据。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">比如对于in=[1 2 3 4]，n=4，N=2n=8。Matlab下dct变换的结果为[5 -2.2304 0 -0.15851]；FFTW的结果为（FFTW_REDFT10）out=[20 -6.3086 0 -0.4483415]，为matlab结果的√8（√N）倍；用out进行逆dct变换（FFTW_REDFT01）的结果为[8 16 24 32]，为原始数据的8（N）倍。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">再比如对于in=[0 2 4;6 1 3;5 7 4]的二维DCT变换，n=3，N=2n=6。Matlab下dct2的变换结果为out_matlab=[10.667 0 0.4714;-4.0825 -2.5 1.4434;0.4714 -2.5981 -3.1667]；FFTW的结果为（fftw_plan_r2r_2d(3, 3, in, out, FFTW_REDFT10, FFTW_REDFT10, FFTW_ESTIMATE）out_fftw=[128 0 4;-34.641 -15 8.66;4 -15.588 -19]，这与Matlab的结果同样是有差别的。将Matlab的结果变换到FFTW结果的步骤为：</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">1. 将out_matlab乘以√6×√6（即√N×√N）；</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">2. 再将上一步得到的out_matlab的第一行和第一列都乘以√2，因此第一个元素（即左上角的元素）要乘以2。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">第一个是归一化的原因，第二个是FFTW为了将DCT变换与实偶对称FFT相对应的结果。这些对于DCT变换的应用都影响不大。（<a href="http://www.mathworks.de/matlabcentral/newsreader/view_thread/126307" rel="nofollow"><span style="color: #ff0000;">见此</span></a>）</p> 
</div> 
<div> 
 <p style="text-indent: 2em;">最后对out_fftw进行IDCT变换 （fftw_plan_r2r_2d(3, 3, in, out, FFTW_REDFT01, FFTW_REDFT01, FFTW_ESTIMATE），将得到[0 72 144;216 36 108;180 252 144]；它是原始数据in的36（N×N，N=6）倍。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>3. 其它</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">fftw_malloc考虑了数据对齐，以便使 用SIMD指令加速，所以最好不要用C函数malloc替代，而且不要将fftw_malloc、fftw_free和malloc、free、 delete等混用。尽量使用fftw_malloc分配数组，而不是下面的固定数组，因为固定数组是在栈上分配的，而栈空间较小；还因为这种方式没有考 虑数据对齐，不便应用SIMD指令。</p> 
</div> 
<p style="text-indent: 2em;"> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> data[N0][N1][N2];<br></span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> plan;<br>...<br>plan = fftw_plan_dft_3d(N0, N1, N2, &amp;data[0][0][0], &amp;data[0][0][0], FFTW_FORWARD, FFTW_ESTIMATE);<br>...</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;">对于多维数组也尽量使用fftw_malloc(n0*n1*n285*sizeof(double))，不要使用C的malloc。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<p> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *a_good_array;<br>a_good_array = (</span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;">*) fftw_malloc(5*12*27* </span><span style="font-size: small; color: #0000ff;">sizeof</span><span style="font-size: small;">(fftw_complex));<br><br><br></span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> ***a_bad_array;  </span><span style="font-size: small; color: #008000;">/* another way to make a 5x12x27 array */</span><span style="font-size: small;"> <br>a_bad_array = (</span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> ***) malloc(5 * </span><span style="font-size: small; color: #0000ff;">sizeof</span><span style="font-size: small;">(</span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> **));</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <h3>七、 函数参考</h3> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>1. 复数DFT</strong></p> 
</div> 
<p style="text-indent: 2em;"> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: small; color: #0000ff;">     fftw_plan </span><span style="font-size: small;">fftw_plan_dft_1d(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n,<br>                                </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> sign, </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);<br>     </span><span style="font-size: small; color: #0000ff;">fftw_plan </span><span style="font-size: small;">fftw_plan_dft_2d(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n0, </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n1,<br>                                </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> sign, </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);<br>     </span><span style="font-size: small; color: #0000ff;">fftw_plan </span><span style="font-size: small;">fftw_plan_dft_3d(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n0, </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n1, </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n2,<br>                                </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> sign, </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);<br>     </span><span style="font-size: small; color: #0000ff;">fftw_plan </span><span style="font-size: small;">fftw_plan_dft(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> rank, </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> *n,<br>                             </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                             </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> sign, </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;">2. 实数DFT</p> 
</div> 
<p style="text-indent: 2em;"> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: small; color: #0000ff;">     fftw_plan </span><span style="font-size: small;">fftw_plan_dft_r2c_1d(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n,<br>                                    </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                    </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);<br>     </span><span style="font-size: small; color: #0000ff;">fftw_plan </span><span style="font-size: small;">fftw_plan_dft_r2c_2d(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n0, </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n1,<br>                                    </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                    </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);<br>     </span><span style="font-size: small; color: #0000ff;">fftw_plan </span><span style="font-size: small;">fftw_plan_dft_r2c_3d(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n0, </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n1, </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> n2,<br>                                    </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                    </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);<br>     </span><span style="font-size: small; color: #0000ff;">fftw_plan </span><span style="font-size: small;">fftw_plan_dft_r2c(</span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> rank, </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">int</span><span style="font-size: small;"> *n,<br>                                 </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out,<br>                                 </span><span style="font-size: small; color: #0000ff;">unsigned</span><span style="font-size: small;"> flags);</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;"><strong>3. 实数－实数变换</strong></p> 
</div> 
<p style="text-indent: 2em;"> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: x-small; color: #0000ff;">     fftw_plan </span><span style="font-size: x-small;">fftw_plan_r2r_1d(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind, </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);<br>     </span><span style="font-size: x-small; color: #0000ff;">fftw_plan </span><span style="font-size: x-small;">fftw_plan_r2r_2d(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n0, </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n1, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind0, </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind1, </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);<br>     </span><span style="font-size: x-small; color: #0000ff;">fftw_plan </span><span style="font-size: x-small;">fftw_plan_r2r_3d(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n0, </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n1, </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> n2,<br>                                </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind0,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind1,<br>                                </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> kind2,<br>                                </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);<br>     </span><span style="font-size: x-small; color: #0000ff;">fftw_plan </span><span style="font-size: x-small;">fftw_plan_r2r(</span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> rank, </span><span style="font-size: x-small; color: #0000ff;">const</span><span style="font-size: x-small;"> </span><span style="font-size: x-small; color: #0000ff;">int</span><span style="font-size: x-small;"> *n, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *in, </span><span style="font-size: x-small; color: #0000ff;">double</span><span style="font-size: x-small;"> *out, </span><span style="font-size: x-small; color: #0000ff;">const</span><span style="font-size: x-small;"> </span><span style="font-size: x-small; color: #0000ff;">fftw_r2r_kind</span><span style="font-size: x-small;"> *kind, </span><span style="font-size: x-small; color: #0000ff;">unsigned</span><span style="font-size: x-small;"> flags);</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;"><strong>4. 实数－实数变换类型</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">对于大小为n的下列变换，对应的逻辑DFT大小为N，N用来进行归一化。FFTW的变换没有归一化，正变换后再逆变换为原数据的N倍（不是n倍），对于多维变换，为N的乘积(N0*N1*N285)。下表列出了变换类型及其对应的逻辑大小N及逆变换：</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<p> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre>     
     </pre><ul><li><br> 
      
      </li><li>FFTW_R2HC computes a real-input DFT with output in halfcomplex format, i.e. real and imaginary parts <br>for a transform of size n stored as:r<sub>0</sub>, r<sub>1</sub>, r<sub>2</sub>, ..., r<sub>n/2</sub>, i<sub>(n+1)/2-1</sub>, ..., i<sub>2</sub>, i<sub>1</sub> <br>(Logical N=n, inverse is FFTW_HC2R.) </li><li>FFTW_HC2R computes the reverse of FFTW_R2HC, above. (Logical N=n, inverse is FFTW_R2HC.) </li><li>FFTW_DHT computes a discrete Hartley transform. (Logical N=n, inverse is FFTW_DHT.) </li><li>FFTW_REDFT00 computes an REDFT00 transform, i.e. a DCT-I. (Logical N=2*(n-1), inverse is FFTW_REDFT00.) </li><li>FFTW_REDFT10 computes an REDFT10 transform, i.e. a DCT-II (sometimes called the DCT). <br>(Logical N=2*n, inverse is FFTW_REDFT01.) </li><li>FFTW_REDFT01 computes an REDFT01 transform, i.e. a DCT-III (sometimes called the IDCT, being the inverse of DCT-II). <br>(Logical N=2*n, inverse is FFTW_REDFT=10.) </li><li>FFTW_REDFT11 computes an REDFT11 transform, i.e. a DCT-IV. (Logical N=2*n, inverse is FFTW_REDFT11.) </li><li>FFTW_RODFT00 computes an RODFT00 transform, i.e. a DST-I. (Logical N=2*(n+1), inverse is FFTW_RODFT00.) </li><li>FFTW_RODFT10 computes an RODFT10 transform, i.e. a DST-II. (Logical N=2*n, inverse is FFTW_RODFT01.) </li><li>FFTW_RODFT01 computes an RODFT01 transform, i.e. a DST-III. (Logical N=2*n, inverse is FFTW_RODFT=10.) </li><li>FFTW_RODFT11 computes an RODFT11 transform, i.e. a DST-IV. (Logical N=2*n, inverse is FFTW_RODFT11.)</li></ul> </td></tr></tbody></table> 
<p></p> 
<div> 
 <h3>八、 其它</h3> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>1. 数据类型</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">FFTW有三个版本的数据类型：double、float和long double，使用方法如下：</p> 
</div> 
<ul><li>链接对应的库（比如libfftw3-3、libfftw3f-3、或ibfftw3l-3） </li><li>包含同样的头文件fftw3.h </li><li>将所有以小写"fftw_"开头的名字替换为"fftwf_"（float版本）或"fftwl_"（long double版本）。比如将fftw_complex替换为fftwf_complex，将fftw_execute替换为fftwf_execute等。 </li><li>所有以大写"FFTW_"开头的名字不变 </li><li>将函数参数中的double替换为float或long double </li></ul> 
<div> 
 <p style="text-indent: 2em;">最后，虽然long double是C99的标准，但你的编译器可能根本不支持该类型，或它并不能提供比double更高的精度。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>2. 用同一个fftw_plan执行多个数据的变换</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">前面说过可以利用同一个fftw_plan通过对输入数据赋不同值来实现不同的变换，实际上还可以利用同一个fftw_plan实现对不同输入输出数据的变换，也就是说可以有多个输入输出数据数组，各自进行变换，互不影响。当然这要满足一定的条件：</p> 
</div> 
<ul><li>输入/输出数据大小相等。 </li><li>变换类型、是否原位运算不变。 </li><li>对split数组（指实虚部分开），实部和虚部的分割方式与方案创建时相同。 </li><li>数组的对齐方式相同。如果都是用fftw_malloc分配的则此项条件满足，除非使用 FFTW_UNALIGNED标志。 </li></ul> 
<div> 
 <p style="text-indent: 2em;">如果想对新数组，比如大小相等的一批数组执行变换，可以使用以下接口：</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"> </p> 
</div> 
<p> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: small; color: #0000ff;">     void</span><span style="font-size: small;"> fftw_execute_dft(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out);<br>     <br>     </span><span style="font-size: small; color: #0000ff;">void</span><span style="font-size: small;"> fftw_execute_split_dft(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *ri, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *ii, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *ro, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *io);<br>     <br>     </span><span style="font-size: small; color: #0000ff;">void</span><span style="font-size: small;"> fftw_execute_dft_r2c(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *out);<br>     <br>     </span><span style="font-size: small; color: #0000ff;">void</span><span style="font-size: small;"> fftw_execute_split_dft_r2c(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *ro, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *io);<br>     <br>     </span><span style="font-size: small; color: #0000ff;">void</span><span style="font-size: small;"> fftw_execute_dft_c2r(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">fftw_complex</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *out);<br>     <br>     </span><span style="font-size: small; color: #0000ff;">void</span><span style="font-size: small;"> fftw_execute_split_dft_c2r(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *ri, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *ii, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *out);<br>     <br>     </span><span style="font-size: small; color: #0000ff;">void</span><span style="font-size: small;"> fftw_execute_r2r(<br>          </span><span style="font-size: small; color: #0000ff;">const</span><span style="font-size: small;"> </span><span style="font-size: small; color: #0000ff;">fftw_plan</span><span style="font-size: small;"> p,<br>          </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *in, </span><span style="font-size: small; color: #0000ff;">double</span><span style="font-size: small;"> *out);</span></pre> </td></tr></tbody></table> 
<p></p> 
<div> 
 <p style="text-indent: 2em;">这些函数的执行不会修改原始plan，并且可以和fftw_execute混合使用。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>3. 多线程FFTW</strong></p> 
</div> 
<div> 
 <p style="text-indent: 2em;">FFTW可以多线程执行，但是多线程存在线程同步问题，这可能会降低性能。所以除非问题规模非常大，一般并不能从多线程中获益。</p> 
</div> 
<div> 
 <p style="text-indent: 2em;"><strong>4. FFTW变换公式</strong></p> 
</div> 
<p> </p> 
<table border="1" cellspacing="0" cellpadding="0" align="center" bgcolor="#d9d9d9"><tbody><tr><td> <pre><span style="font-size: small;">一维复DFT正变换</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-dft.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/04/fb/vB9TnRXa_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">一维复DFT逆变换</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-idft.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/48/26/89aoa3CR_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">一维实DFT正变换（<em>Y</em><em><sub>k</sub></em><em> = Y</em><em><sub>n-k</sub></em><sub><sup>*</sup></sub>）</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-dft.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/84/59/hBafHZVA_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">一维实DFT逆变换</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-idft.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/06/de/S0IRfrLI_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">REDFT00 (DCT-I)</span></pre> </td><td> <pre>     
     <div>
      
      <div>
       
       <a href="http://www.fftw.org/fftw3_doc/equation-redft00.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/2e/ee/UrdgNGiZ_o.png" border="0" alt=""></a>
      
      </div>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">REDFT10 (DCT-II)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-redft10.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/2c/62/wqTkIRWl_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">REDFT01 (DCT-III)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-redft01.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/d1/f0/h1TF1F3q_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">REDFT11 (DCT-IV)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-redft11.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/1f/a7/VgMyloQZ_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">RODFT00 (DST-I)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-rodft00.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/4e/bc/C8K8gxhn_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">RODFT10 (DST-II)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-rodft10.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/25/7f/1TKaXGhZ_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">RODFT01 (DST-III)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-rodft01.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/b6/a7/ziecg0Hh_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">RODFT11 (DST-IV)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-rodft11.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/92/c0/liCEnDjQ_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr><tr><td> <pre><span style="font-size: small;">1d Discrete Hartley Transforms (DHTs)</span></pre> </td><td> <pre>     
     <div>
      
      <a href="http://www.fftw.org/fftw3_doc/equation-dht.png" rel="nofollow noopener noreferrer" target="_blank"><img class="blogimg" src="https://images2.imgbox.com/ec/ce/aNbtDVHh_o.png" border="0" alt=""></a>
     
     </div></pre> </td></tr></tbody></table> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b8fd004aae84f6f47a15d00a4072f699/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C# Mandelbrot和Julia分形图像生成程序更新到2010-9-14版 支持多线程计算 多核处理器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b18d7a722e54c98fefeb937983f32699/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 中文分词器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>