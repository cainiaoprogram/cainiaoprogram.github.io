<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Element-UI可编辑表格的实现 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Element-UI可编辑表格的实现" />
<meta property="og:description" content="一、 可编辑单元格的实现
实现效果：点击可编辑
实现原理：在单元格中放置span 和 input ，绑定data中同一的数据，捕捉点击单元格事件和失去焦点事件，添加/删除 元素的相应class，控制span 和 input 框的显示。
实现代码：
Style：
.tb-edit .input-box { display: none } .tb-edit .current-cell .input-box { display: block; margin-left: -15px; } Html：
&lt;el-table-column label=&#39;&lt;@spring.message &#34;flowemptransfer.description&#34;/&gt;&#39; class-name=&#34;column-bg-color-editable&#34; width=&#34;100&#34; show-overflow-tooltip&gt; &lt;template scope=&#34;scope&#34;&gt; &lt;div class=&#34;input-box&#34;&gt; &lt;el-input size=&#34;small&#34; @blur=&#34;handleInputBlur&#34; v-model=&#34;scope.row.description&#34; &gt;&lt;/el-input&gt; &lt;/div&gt; &lt;span&gt;{{scope.row.description}}&lt;/span&gt; &lt;/template&gt; &lt;/el-table-column&gt; JavaScript：
//单元格点击后，显示input，并让input 获取焦点 handleCellClick:function(row, column, cell, event){ emptransfer.addClass(cell,&#39;current-cell&#39;); if(emptransfer.getChildElement(cell,3) !== 0){ var _inputParentNode =emptransfer.getChildElement(cell,3); if(_inputParentNode.hasChildNodes()&amp;&amp; _inputParentNode.childNodes.length &gt; 2) { var _inputNode = _inputParentNode." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f646921b31dd08bfc1384c6d8f915bee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-30T10:43:41+08:00" />
<meta property="article:modified_time" content="2018-10-30T10:43:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Element-UI可编辑表格的实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>一、 可编辑单元格的实现<br> 实现效果：点击可编辑<br> <img src="https://images2.imgbox.com/39/a9/WM2UlHk2_o.jpg" alt="在这里插入图片描述"><br> 实现原理：在单元格中放置span 和 input ，绑定data中同一的数据，捕捉点击单元格事件和失去焦点事件，添加/删除 元素的相应class，控制span 和 input 框的显示。<br> 实现代码：</p> 
<p>Style：</p> 
<pre><code>.tb-edit .input-box {
   display: none
}
.tb-edit .current-cell .input-box {
   display: block;
   margin-left: -15px;
}
</code></pre> 
<p>Html：</p> 
<pre><code>&lt;el-table-column
      label='&lt;@spring.message "flowemptransfer.description"/&gt;'
      class-name="column-bg-color-editable"
      width="100"
      show-overflow-tooltip&gt;
   &lt;template scope="scope"&gt;
      &lt;div class="input-box"&gt;
         &lt;el-input size="small" @blur="handleInputBlur" v-model="scope.row.description" &gt;&lt;/el-input&gt;
      &lt;/div&gt;
      &lt;span&gt;{<!-- -->{scope.row.description}}&lt;/span&gt;
   &lt;/template&gt;
&lt;/el-table-column&gt;
</code></pre> 
<p>JavaScript：</p> 
<pre><code>//单元格点击后，显示input，并让input 获取焦点
handleCellClick:function(row, column, cell, event){
    emptransfer.addClass(cell,'current-cell');
    if(emptransfer.getChildElement(cell,3) !== 0){
        var _inputParentNode =emptransfer.getChildElement(cell,3);
        if(_inputParentNode.hasChildNodes()&amp;&amp; _inputParentNode.childNodes.length &gt; 2) {
            var _inputNode = _inputParentNode.childNodes[2];
            if(_inputNode.tagName === 'INPUT'){
                _inputNode.focus();
            }
        }
    }
},
//input框失去焦点事件
handleInputBlur:function(event){   //当 input 失去焦点 时,input 切换为 span，并且让下方 表格消失（注意，与点击表格事件的执行顺序）
    var _event = event;
    setTimeout(function(){
        var _inputNode = _event.target;
        if(emptransfer.getParentElement(_inputNode,4)!==0){
            var _cellNode = emptransfer.getParentElement(_inputNode,4);
            emptransfer.removeClass(_cellNode,'current-cell');
            emptransfer.removeClass(_cellNode,'current-cell2');
        }
    },200);
},
</code></pre> 
<p>二、 Input框编辑时动态查询（下拉列表）<br> 实现效果：编辑input时，下方出现下拉动态查询，点击下拉中的数据，填入表中<br> <img src="https://images2.imgbox.com/1a/b3/6Q5QLqlf_o.jpg" alt="在这里插入图片描述"></p> 
<p>实现原理：原理同上，监听input编辑事件获取DOM节点，改变class控制子元素的显示。<br> 这里的显示情况有三种：<br> 1）不点击表格时，只显示span<br> 2）点击表格后，未编辑，只显示input<br> 3）在input框编辑时显示input + 下拉表格区域<br> 流程如下：<br> <img src="https://images2.imgbox.com/00/b5/8rKXrqwU_o.jpg" alt="在这里插入图片描述"></p> 
<p>实现代码：<br> Style：</p> 
<pre><code>.tb-edit .input-box {//显示span
  display: none
}
.tb-edit .current-cell .input-box {//显示input
  display: block;
  margin-left: -15px;
}
.tb-edit .hidden-list{//不显示 下拉区域
  display: none;
}
.tb-edit .current-cell2 .hidden-list{//显示下拉区域
  display: block;
}
</code></pre> 
<p>Html：</p> 
<pre><code>&lt;template scope="scope"&gt;
  &lt;div class="input-box"&gt;
     &lt;el-input size="small" v-model="scope.row.employeeCode"  @blur="handleInputBlur" @focus="handleInputFocus" :row-index=scope.$index @change="handleEdit"&gt;
     &lt;/el-input&gt;
  &lt;/div&gt;
  &lt;span&gt;{<!-- -->{scope.row.employeeCode}}&lt;/span&gt;
&lt;span&gt;&lt;i  @click="selectEmpInfo(scope.$index)" class="el-input__icon el-icon-information"&gt;&lt;/i&gt;&lt;/span&gt;
  &lt;div class="hidden-list" style="position: absolute;z-index:10;border: 1px solid #bfbfbf;box-shadow: 0px 0px 2px 0px #aaa;left:0px;"&gt;
     &lt;el-table stripe border
             :data="downListTableData"
             :row-index=scope.$index
             tooltip-effect="light"
             v-loading="empDownListLoading"
             style="width: 100%;margin-top: 20px"
             @row-click="empDownListItemClick"&gt;
        &lt;el-table-column
              width="100"
              prop="employeeCode"
              label='&lt;@spring.message "flowemptransfer.employeecode"/&gt;'
        &gt;&lt;/el-table-column&gt;
        &lt;el-table-column
              width="90"
              prop="name"
              label='&lt;@spring.message "flowemptransfer.name"/&gt;'
        &gt;&lt;/el-table-column&gt;
        &lt;el-table-column
              prop="joinDate"
              label='&lt;@spring.message "flowemptransfer.joindate"/&gt;'
              width="110px"
              fit="true"
        &gt;&lt;/el-table-column&gt;
        &lt;el-table-column
              prop="fullUnitName"
              show-overflow-tooltip="true"
              width="160"
              label='&lt;@spring.message "flowemptransfer.nowdept"/&gt;'
        &gt;&lt;/el-table-column&gt;
        &lt;el-table-column
              prop="positionName"
              show-overflow-tooltip="true"
              width="160"
              label='&lt;@spring.message "flowemptransfer.nowposi"/&gt;'
        &gt;&lt;/el-table-column&gt;
     &lt;/el-table&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<p>JavaScript:</p> 
<pre><code>//单元格点击后，显示input，并让input 获取焦点
handleCellClick:function(row, column, cell, event){
   emptransfer.addClass(cell,'current-cell');
   if(emptransfer.getChildElement(cell,3) !== 0){
       var _inputParentNode =emptransfer.getChildElement(cell,3);
       if(_inputParentNode.hasChildNodes()&amp;&amp; _inputParentNode.childNodes.length &gt; 2) {
           var _inputNode = _inputParentNode.childNodes[2];
           if(_inputNode.tagName === 'INPUT'){
               _inputNode.focus();
           }
       }
   }
},
//input框失去焦点事件
handleInputBlur:function(event){   //当 input 失去焦点 时,input 切换为 span，并且让下方 表格消失（注意，与点击表格事件的执行顺序）
   var _event = event;
   setTimeout(function(){
       var _inputNode = _event.target;
       if(emptransfer.getParentElement(_inputNode,4)!==0){
           var _cellNode = emptransfer.getParentElement(_inputNode,4);
           emptransfer.removeClass(_cellNode,'current-cell');
           emptransfer.removeClass(_cellNode,'current-cell2');
       }
   },200);
},
//input框编辑时触发的方法，动态弹出员工查询下拉列表
handleEdit:function(value) {
   var _inputNode = inputFocusEle;
   if(emptransfer.getParentElement(_inputNode,1)!==0){
       var _parentNode = emptransfer.getParentElement(_inputNode,1);
       var index = _parentNode.getAttribute('row-index');
       emptransfer.tableData[index].name='';
       emptransfer.tableData[index].joinDate='';
       emptransfer.tableData[index].nowDept='';
       emptransfer.tableData[index].nowFullDept='';
       emptransfer.tableData[index].nowDeptCode='';
       emptransfer.tableData[index].nowPosi='';
       emptransfer.tableData[index].nowPosiCode='';
   }
   if(emptransfer.getParentElement(_inputNode,4)!==0){
       var _cellNode = emptransfer.getParentElement(_inputNode,4);
       emptransfer.addClass(_cellNode,'current-cell2')
       emptransfer.queryPreEmpInfo(_inputNode.value);
   }

},
</code></pre> 
<p>三、 点击图标显示下拉、点击图标显示Dialog的实现<br> 实现效果：<br> <img src="https://images2.imgbox.com/a6/d1/lULVyq6Z_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/71/b5/yhTm31mE_o.jpg" alt="在这里插入图片描述"></p> 
<p>实现原理：同上。<br> 实现代码：</p> 
<p>Style：</p> 
<pre><code>.tb-edit .transfer-type-list{
   display: none;
}
.tb-edit .current-cell1 .transfer-type-list{
   display: block;
   z-index: 10;
}
</code></pre> 
<p>Html：</p> 
<pre><code>&lt;template scope="scope"&gt;
   &lt;div  style="display: inline-block;color:#0c91e5;cursor: pointer"&gt;&lt;span &gt;&lt;i class="el-icon-information" tabindex="1" @blur="handleIconBlur" @click="selectTransferType($event)"&gt;&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;
   &lt;span &gt;{<!-- -->{scope.row.transferType}}&lt;/span&gt;
   &lt;div class="transfer-type-list" style="position: absolute;background-color: #ffffff;left:-40px;border: 1px solid #bfbfbf;box-shadow: 0px 0px 2px 0px #aaa"&gt;
      &lt;div style="height: 30px;width: 180px;"&gt;
         &lt;div style="float: left;height: 100%;width: 5px;background-color: #0c91e5;"&gt;&lt;/div&gt;
         &lt;div style="float: left;height: 100%;margin-left: 15px;width: 130px;line-height: 30px;font-weight: 700;"&gt;&lt;@spring.message "flowemptransfer.transfertype"/&gt;&lt;/div&gt;
         &lt;div style="float:left;width: 0;height: 0;margin-top: 11px;border-left: 10px solid transparent;border-right: 10px solid transparent;border-top:8px solid #0c91e5;"&gt;&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="transfer-type-item" v-for="(item,index) in transferPosiType" @click="handleTransferTypeClick($event,scope.$index)"&gt;
         &lt;div style="display:inline-block;width: 25%;height: 30px;line-height: 30px;text-align: center;font-size: 12px;color: #ccc;border: 1px solid #f1f1f1;"&gt;{<!-- -->{item.codeValue}}&lt;/div&gt;
         &lt;div style="display:inline-block;margin-left:-4px;width: 75%;height: 30px;line-height: 30px;text-align: center;border: 1px solid #f1f1f1;font-size: 12px"&gt;{<!-- -->{item.codeName}}&lt;/div&gt;
         &lt;input type="hidden" :value="index"/&gt;
      &lt;/div&gt;

   &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<p>JavaScript：</p> 
<pre><code>//点击弹出 调整类型下拉列表
selectTransferType:function(event){    //点击事件， 下方出现下拉列表： 调动类型
    var _i = event.target;
    _i.focus();
    if( emptransfer.getParentElement(_i,4)!==0){
        var _boxEle = emptransfer.getParentElement(_i,4);
        emptransfer.addClass(_boxEle,'current-cell1');
    }
},

//调整类型下拉列表的行点击事件
handleTransferTypeClick:function(event,index){
    var _index;
    var _click = event.target;
    var _item = _click.parentNode;
    var _nextNode = _item.childNodes[4];
    if(_nextNode.tagName === 'INPUT'){
        _index = _nextNode.value;
    }else{
        var _inputNode =_click.childNodes[4];
        _index = _inputNode.value;
    }
    emptransfer.tableData[index].transferType = emptransfer.transferPosiType[_index].codeName;
    emptransfer.tableData[index].transferTypeCode = emptransfer.transferPosiType[_index].codeValue;
    if(emptransfer.getParentElement(_item,3)!==0){
        var _boxEle = emptransfer.getParentElement(_item,3);
        emptransfer.removeClass(_boxEle,'current-cell1');
    }
},

</code></pre> 
<hr> 
<p>demo代码：</p> 
<pre><code>&lt;#include "../../include/header.html"&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;员工调动申请&lt;/title&gt;
  &lt;link href="${base.contextPath}/lib/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" type="text/css"/&gt;
  &lt;script src="${base.contextPath}/lib/lodash4.13.1/lodash.min.js"&gt;&lt;/script&gt;
  &lt;style&gt;
    #emptransfer{
      padding: 30px;
    }

    .hr-label {
      margin-top: 30px;
      margin-bottom: 20px;
    }

    .header-btn{
      margin-left: -15px;
    }
    .label-width{
      padding-top:5px;
    }
    .content-label{
      text-align: right;
      margin-left: 1%;
    }
    .btn-submit{
      width:100%;
    }
    .middle{
      min-width:1044px;
    }
    .info-1{
      font-size: 20px;
      font-weight: 700;
      color: red;
      vertical-align: middle;
    }
    .info-2{
      font-size: 14px;
      font-style: italic;
    }
    .info-3{
      font-style: italic;
      font-size: 12px;
      margin-top: 7px;
    }
    .info-4{
      font-style: italic;
      margin-bottom: 20px;
      font-size: 12px;
    }
    .btn-add{
      margin-right: 30px;
      display: inline-block;
      cursor: pointer;
    }
    .btn-delete{
      margin-right: 30px;
      display: inline-block;
      cursor: pointer;
    }
    .btn-import{
      margin-right: 30px;
      display: inline-block;
      cursor: pointer;
    }
    .btn-export{
      display: inline-block;
      cursor: pointer;
    }
    .btn-modelexcel{
      display: inline-block;
      float: right;
    }
    .btn-download-exel {
      display: inline-block;
      float: right;
      border: 1px solid #0092da;
      padding: 2px 12px;
      border-radius: 16px;
      color: #0092da;
      cursor: pointer;
    }

    .tb-edit .input-box {
      display: none
    }
    .tb-edit .current-cell{
      /*position: relative;*/
    }
    .tb-edit .current-cell .input-box {
      display: block;
      margin-left: -15px;
    }
    .tb-edit .current-cell .input-box+span {
      display: none
    }
    .tb-edit .el-table__body-wrapper{
      height:500px;
    }
    .hidden-list .el-table__body-wrapper{
      height:auto;
    }
    .input-box{
       width:99px;
     }

    .el-input--small .el-input__inner {
      height: 38px;
    }
    .input-box  input{
      padding-right: 30px;
    }
    .tb-edit .transfer-type-list{
      display: none;
    }
    .tb-edit .current-cell1 .transfer-type-list{
      display: block;
      z-index: 10;
    }
    .tb-edit .hidden-list{
      display: none;
    }
    .tb-edit .current-cell2 .hidden-list{
      display: block;
    }
    .transfer-type-item:hover{
      background-color: #f1f1f1;
    }
    .el-date-editor.el-input {
      width: 120px;
    }
    .el-input__icon{
      color:#0c91e5;
      cursor: pointer;
    }
    .el-table .cell, .el-table th &gt; div{
      padding-right: 6px;
      padding-left: 15px;
    }
    .column-bg-color{
      background-color: #eef1f6;
    }
    .column-bg-color-editable{
      background-color: #e1f1ec;
    }
    .el-table--enable-row-hover .el-table__body tr:hover .column-bg-color-editable{
      background-color: #e1f1ec;
    }


    .el-dialog__headerbtn .el-dialog__close {
      background-color: #00A0D1;
      color: #ffffff;
      width: 30px;
      height: 32px;
      padding-top: 9px;

    }
    .el-dialog__headerbtn .el-dialog__close:before {
      background-color: #00A0D1;
      color: #ffffff;
      width: 50px;
      height: 50px;
    }

    .el-dialog__header {
      padding: 0px;
      border-bottom: 1px solid #EBEDEE;
      margin-bottom: 10px;
    }
    #import-file-dialog .el-dialog__title {
      line-height: 2;
      font-size: 16px;
      font-weight: 700;
      color: #14A4FA;
      margin-top: 22px;
      border-left: 5px solid #14A4FA;
      padding-left: 17px;
      padding-bottom: -15px;
      margin-top: 10px;
    }
    .content-span{
      line-height: 26px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script type="text/javascript"&gt;
    var _token = '${_csrf.token}';
    var employeeCodeStr = '&lt;@spring.message "flowemptransfer.employeecode"/&gt;';
    var nameStr = '&lt;@spring.message "flowemptransfer.name"/&gt;';
    var joinDateStr = '&lt;@spring.message "flowemptransfer.joindate"/&gt;';
    var nowDeptStr = '&lt;@spring.message "flowemptransfer.nowdept"/&gt;';
    var nowDeptCodeStr = '&lt;@spring.message "flowemptransfer.nowdeptcode"/&gt;';
    var nowPosiStr = '&lt;@spring.message "flowemptransfer.nowposi"/&gt;';
    var nowPosiCodeStr = '&lt;@spring.message "flowemptransfer.nowposicode"/&gt;';
    var transferDepStr = '&lt;@spring.message "flowemptransfer.transferdept"/&gt;';
    var transferDepCodeStr = '&lt;@spring.message "flowemptransfer.transferdeptcode"/&gt;';
    var transferPosiStr = '&lt;@spring.message "flowemptransfer.transferposi"/&gt;';
    var transferPosiCodeStr = '&lt;@spring.message "flowemptransfer.transferposicode"/&gt;';
    var transferTypeStr = '&lt;@spring.message "flowemptransfer.transfertype"/&gt;';
    var transferTypeCodeStr = '&lt;@spring.message "flowemptransfer.transfertypecode"/&gt;';
    var effectiveDateStr = '&lt;@spring.message "flowemptransfer.effectivedate"/&gt;';
    var descriptionStr = '&lt;@spring.message "flowemptransfer.description"/&gt;';
    var downloadExcelName = '&lt;@spring.message "flowemptransfer.downloadexcelname"/&gt;';
    var exportExcelName = '&lt;@spring.message "flowemptransfer.exportexcelname"/&gt;';
    var tables = '&lt;@spring.message "flowemptransfer.tablenumber"/&gt;';
    var infoTipOne = '&lt;@spring.message "flowemptransfer.infotipone"/&gt;';
    var empCodeNotEmpty = '&lt;@spring.message "flowemptransfer.empcodenotempty"/&gt;';
    var transferPosiNotEmpty = '&lt;@spring.message "flowemptransfer.transferposinotempty"/&gt;';
    var transferDeptNotEmpty = '&lt;@spring.message "flowemptransfer.transferdeptnotempty"/&gt;';
    var transferTypeNotEmpty = '&lt;@spring.message "flowemptransfer.transfertypenotempty"/&gt;';
    var effectiveDateNotEmpty = '&lt;@spring.message "flowemptransfer.effectivedatenotempty"/&gt;';
    const TRANSFER_TYPE = 'MASSGMASSNA3'
    const TEMPLATE_NAME="EMP_TRANSFER_EXCEL_URL";
&lt;/script&gt;
  &lt;div id="emptransfer" v-loading="submitLoading"  style="min-width: 500px"&gt;
    &lt;div class="header"&gt;
      &lt;div class="row "&gt;
        &lt;div class="col-md-1 col-sm-1 col-xs-2 content-label"&gt;&lt;label class="label-width"&gt;&lt;@spring.message "flowemptransfer.description"/&gt;&lt;/label&gt;&lt;/div&gt;
        &lt;div class="col-md-5 col-sm-5 col-xs-9 "&gt;
          &lt;textarea v-model="headMemo" class="form-control margin-label" rows="5" placeholder="&lt;@spring.message 'policy.remarktip'/&gt;" style="border: 1px solid #eee;"&gt;
          &lt;/textarea&gt;
          &lt;div &gt;
            &lt;div style="display:inline-block;width: 5px;vertical-align: top"&gt;&lt;span class="info-1"&gt;*&lt;/span&gt;&lt;/div&gt;
            &lt;div style="display:inline-block;width: 15%;vertical-align: top"&gt;&lt;span class="info-2"&gt;&lt;@spring.message "flowemptransfer.note"/&gt;：&lt;/span&gt;&lt;/div&gt;
            &lt;div style="display:inline-block;width: 75%"&gt;&lt;div class="info-3"&gt;1、&lt;@spring.message "flowemptransfer.notetext1"/&gt;&lt;/div&gt;
              &lt;div class="info-4"&gt;2、&lt;@spring.message "flowemptransfer.notetext2"/&gt;&lt;/div&gt;&lt;/div&gt;
          &lt;/div&gt;
          &lt;div class="header-btn"&gt;
            &lt;div class="col-md-5 col-sm-5 col-xs-8"&gt;&lt;el-button type="primary" class="btn-submit" @click="checkSubmit"&gt;&lt;@spring.message "flowemptransfer.submitbtnstr"/&gt;&lt;/el-button&gt;&lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="hr-label"&gt;
        &lt;hr&gt;
      &lt;/div&gt;
      &lt;div class="btn-add" @click="add"&gt;
        &lt;img src="${base.contextPath}/resources/myflow/emplevechange/images/add.png"&gt;
        &lt;span&gt;&lt;@spring.message "flowemptransfer.addbtnstr"/&gt;&lt;/span&gt;
      &lt;/div&gt;
      &lt;div class="btn-delete" @click="removeDialogVisible = true"&gt;
        &lt;img src="${base.contextPath}/resources/myflow/emplevechange/images/delete.png"&gt;
        &lt;span&gt;&lt;@spring.message "flowemptransfer.removebtnstr"/&gt;&lt;/span&gt;
      &lt;/div&gt;
      &lt;div class="btn-import" @click="confirmInportDialog =true"&gt;
        &lt;img src="${base.contextPath}/resources/myflow/emplevechange/images/import.png"&gt;
        &lt;span&gt;&lt;@spring.message "flowemptransfer.importbtnstr"/&gt;&lt;/span&gt;
      &lt;/div&gt;
      &lt;div class="btn-export exportBtn" @click="exportExcel"&gt;
        &lt;img src="${base.contextPath}/resources/myflow/emplevechange/images/export.png"&gt;
        &lt;span&gt;&lt;@spring.message "flowemptransfer.exportbtnstr"/&gt;&lt;/span&gt;
      &lt;/div&gt;
      &lt;div class="btn-download-exel" &gt;
        &lt;a href="${base.contextPath}/baseupload/load?url=/20171213/1513147546849.xls" download='&lt;@spring.message "flowemptransfer.downloadexcelname"/&gt;'&gt;&lt;@spring.message "flowemptransfer.downformwork"/&gt;&lt;/a&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div clas="middle"&gt;

      &lt;el-table
          class="tb-edit"
          ref="multipleTable"
          :data="tableData"
          tooltip-effect="light"
          style="width: 100%;margin-top: 20px"
          border
          @selection-change="handleSelectionChange"
          @cell-click ="handleCellClick"
          :row-class-name="tableRowClassName"
          &gt;
        &lt;el-table-column
            type="selection"
            class-name="column-bg-color"
            width="55"&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            label='&lt;@spring.message "flowemptransfer.employeecode"/&gt;'
            width="100"
            show-overflow-tooltip
            class-name="column-bg-color-editable"
            &gt;
          &lt;template scope="scope"&gt;
            &lt;div class="input-box"&gt;
              &lt;el-input size="small" v-model="scope.row.employeeCode"  @blur="handleInputBlur" @focus="handleInputFocus" :row-index=scope.$index @change="handleEdit"&gt;
              &lt;/el-input&gt;
            &lt;/div&gt;
            &lt;span&gt;{<!-- -->{scope.row.employeeCode}}&lt;/span&gt;&lt;span&gt;&lt;i  @click="selectEmpInfo(scope.$index)" class="el-input__icon el-icon-information"&gt;&lt;/i&gt;&lt;/span&gt;
            &lt;div class="hidden-list" style="position: absolute;z-index:10;border: 1px solid #bfbfbf;box-shadow: 0px 0px 2px 0px #aaa;left:0px;"&gt;
              &lt;el-table stripe border
                    :data="downListTableData"
                    :row-index=scope.$index
                    tooltip-effect="light"
                    v-loading="empDownListLoading"
                    style="width: 100%;margin-top: 20px"
                    @row-click="empDownListItemClick"&gt;
                &lt;el-table-column
                    width="100"
                    prop="employeeCode"
                    label='&lt;@spring.message "flowemptransfer.employeecode"/&gt;'
                &gt;&lt;/el-table-column&gt;
                &lt;el-table-column
                    width="90"
                    prop="name"
                    label='&lt;@spring.message "flowemptransfer.name"/&gt;'
                &gt;&lt;/el-table-column&gt;
                &lt;el-table-column
                    prop="joinDate"
                    label='&lt;@spring.message "flowemptransfer.joindate"/&gt;'
                    width="110px"
                    fit="true"
                &gt;&lt;/el-table-column&gt;
                &lt;el-table-column
                    prop="fullUnitName"
                    show-overflow-tooltip="true"
                    width="160"
                    label='&lt;@spring.message "flowemptransfer.nowdept"/&gt;'
                &gt;&lt;/el-table-column&gt;
                &lt;el-table-column
                    prop="positionName"
                    show-overflow-tooltip="true"
                    width="160"
                    label='&lt;@spring.message "flowemptransfer.nowposi"/&gt;'
                &gt;&lt;/el-table-column&gt;
              &lt;/el-table&gt;
            &lt;/div&gt;
          &lt;/template&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            prop="name"
            label='&lt;@spring.message "flowemptransfer.name"/&gt;'
            width="80"
            class-name="column-bg-color"
            &gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            prop="joinDate"
            label='&lt;@spring.message "flowemptransfer.joindate"/&gt;'
            width="100"
            class-name="column-bg-color"
            show-overflow-tooltip&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            prop="nowFullDept"
            label='&lt;@spring.message "flowemptransfer.nowdept"/&gt;'
            width="110"
            class-name="column-bg-color"
            show-overflow-tooltip&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            prop="nowPosi"
            label='&lt;@spring.message "flowemptransfer.nowposi"/&gt;'
            width="110"
            class-name="column-bg-color"
            show-overflow-tooltip&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            prop="transferFullDept"
            label='&lt;@spring.message "flowemptransfer.transferdept"/&gt;'
            width="110"
            class-name="column-bg-color"
            show-overflow-tooltip
            &gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            label='&lt;@spring.message "flowemptransfer.transferposi"/&gt;'
            width="110"
            class-name="column-bg-color-editable"
            show-overflow-tooltip&gt;
          &lt;template scope="scope"&gt;
            &lt;div style="display: inline-block;color:#0c91e5;cursor: pointer" @click="selectTransferPosi(scope.$index)"&gt;&lt;span&gt;&lt;i class="el-icon-information" &gt;&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;
            &lt;span &gt;{<!-- -->{scope.row.transferPosi}}&lt;/span&gt;
          &lt;/template&gt;

        &lt;/el-table-column&gt;
        &lt;el-table-column
            label='&lt;@spring.message "flowemptransfer.transfertype"/&gt;'
            width="100"
            class-name="column-bg-color-editable"
            show-overflow-tooltip&gt;
          &lt;template scope="scope"&gt;
            &lt;div  style="display: inline-block;color:#0c91e5;cursor: pointer"&gt;&lt;span &gt;&lt;i class="el-icon-information" tabindex="1" @blur="handleIconBlur" @click="selectTransferType($event)"&gt;&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;
            &lt;span &gt;{<!-- -->{scope.row.transferType}}&lt;/span&gt;
            &lt;div class="transfer-type-list" style="position: absolute;background-color: #ffffff;left:-40px;border: 1px solid #bfbfbf;box-shadow: 0px 0px 2px 0px #aaa"&gt;
              &lt;div style="height: 30px;width: 180px;"&gt;
                &lt;div style="float: left;height: 100%;width: 5px;background-color: #0c91e5;"&gt;&lt;/div&gt;
                &lt;div style="float: left;height: 100%;margin-left: 15px;width: 130px;line-height: 30px;font-weight: 700;"&gt;&lt;@spring.message "flowemptransfer.transfertype"/&gt;&lt;/div&gt;
                &lt;div style="float:left;width: 0;height: 0;margin-top: 11px;border-left: 10px solid transparent;border-right: 10px solid transparent;border-top:8px solid #0c91e5;"&gt;&lt;/div&gt;
              &lt;/div&gt;
              &lt;div class="transfer-type-item" v-for="(item,index) in transferPosiType" @click="handleTransferTypeClick($event,scope.$index)"&gt;
                &lt;div style="display:inline-block;width: 25%;height: 30px;line-height: 30px;text-align: center;font-size: 12px;color: #ccc;border: 1px solid #f1f1f1;"&gt;{<!-- -->{item.codeValue}}&lt;/div&gt;
                &lt;div style="display:inline-block;margin-left:-4px;width: 75%;height: 30px;line-height: 30px;text-align: center;border: 1px solid #f1f1f1;font-size: 12px"&gt;{<!-- -->{item.codeName}}&lt;/div&gt;
                &lt;input type="hidden" :value="index"/&gt;
              &lt;/div&gt;

            &lt;/div&gt;
          &lt;/template&gt;

        &lt;/el-table-column&gt;
        &lt;el-table-column
            label='&lt;@spring.message "flowemptransfer.effectivedate"/&gt;'
            width="130"
            class-name="column-bg-color-editable"
            show-overflow-tooltip&gt;
          &lt;template scope="scope"&gt;
            &lt;div class="input-box"&gt;
              &lt;el-date-picker
                  v-model="scope.row.effectiveDate"
                  type="date"
                  @blur="handleDataPickerBlur"
                  placeholder='&lt;@spring.message "flowemptransfer.selectdate"/&gt;'&gt;
              &lt;/el-date-picker&gt;
            &lt;/div&gt;
            &lt;span &gt;{<!-- -->{scope.row.effectiveDate|fomatDate}}&lt;/span&gt;
          &lt;/template&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column
            label='&lt;@spring.message "flowemptransfer.description"/&gt;'
            class-name="column-bg-color-editable"
            width="100"
            show-overflow-tooltip&gt;
          &lt;template scope="scope"&gt;
            &lt;div class="input-box"&gt;
              &lt;el-input size="small" @blur="handleInputBlur" v-model="scope.row.description" &gt;&lt;/el-input&gt;
            &lt;/div&gt;
            &lt;span&gt;{<!-- -->{scope.row.description}}&lt;/span&gt;
          &lt;/template&gt;
        &lt;/el-table-column&gt;
      &lt;/el-table&gt;
    &lt;/div&gt;

    &lt;el-dialog
        :visible.sync="empInfoDialogVisible"
        width="30%"
        @close="closeEmpDialog"
    &gt;
      &lt;div class="row"&gt;
        &lt;label class="" style="text-align: center;margin-left: 10%;width: 8%;"&gt;&lt;@spring.message "flowemptransfer.employeecode"/&gt;&lt;/label&gt;
        &lt;el-input style="display: inline-block;width: 30%;" v-model="empDialogParam.employeeCode"&gt;&lt;/el-input&gt;
        &lt;label  style="text-align: center;width: 8%;"&gt;&lt;@spring.message "flowemptransfer.name"/&gt;&lt;/label&gt;
        &lt;el-input style="display: inline-block;width: 30%;" v-model="empDialogParam.name"&gt;&lt;/el-input&gt;
      &lt;/div&gt;
      &lt;div class="row"&gt;
        &lt;el-button style="display:block;width:20%;margin: 30px auto 20px;" type="primary" @click="queryDialogEmpInfo"&gt;&lt;@spring.message "flowemptransfer.querybtnstr"/&gt;&lt;/el-button&gt;
      &lt;/div&gt;
      &lt;div class="row" style="margin: 0px 10px"&gt;
        &lt;hr style="background-color: #f1f1f1"/&gt;
        &lt;el-table
          :data="empDialogTableData"
          tooltip-effect="light"
          style="width: 100%;margin-top: 20px"
          v-loading="empDialogLoading"
          @row-click="empDialogItemClick"&gt;
          &lt;el-table-column
              prop="employeeCode"
              width="80"
              label='&lt;@spring.message "flowemptransfer.employeecode"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              prop="name"
              width="80"
              label='&lt;@spring.message "flowemptransfer.name"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              prop="joinDate"
              label='&lt;@spring.message "flowemptransfer.joindate"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              show-overflow-tooltip="true"
              prop="fullUnitName"
              label='&lt;@spring.message "flowemptransfer.nowdept"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              show-overflow-tooltip="true"
              prop="positionName"
              label='&lt;@spring.message "flowemptransfer.nowposi"/&gt;'
          &gt;&lt;/el-table-column&gt;
        &lt;/el-table&gt;
      &lt;/div&gt;
      &lt;el-pagination
          @current-change="empDialogPageChange"
          :current-page="1"
          :page-count="paginationEmpDialog.pageCount"
          layout="prev, pager, next, jumper"&gt;
      &lt;/el-pagination&gt;
    &lt;/el-dialog&gt;

    &lt;el-dialog
        :visible.sync="newPosiDialogVisible"
        width="30%"
        @close="closePosiDialog"
    &gt;
      &lt;div class="row"&gt;
        &lt;label class="" style="text-align: center;margin-left: 10%;width: 8%;" &gt;&lt;@spring.message "flowemptransfer.unit"/&gt;&lt;/label&gt;
        &lt;el-input style="display: inline-block;width: 30%;" v-model="posiDialogParam.fullUnitName"&gt;&lt;/el-input&gt;
        &lt;label  style="text-align: center;width: 8%;"&gt;&lt;@spring.message "flowemptransfer.position"/&gt;&lt;/label&gt;
        &lt;el-input style="display: inline-block;width: 30%;"  v-model="posiDialogParam.positionName"&gt;&lt;/el-input&gt;
      &lt;/div&gt;
      &lt;div class="row"&gt;
        &lt;el-button style="display:block;width:20%;margin: 30px auto 20px;" type="primary" @click="queryDialogPosi"&gt;&lt;@spring.message "flowemptransfer.querybtnstr"/&gt;&lt;/el-button&gt;
      &lt;/div&gt;
      &lt;div class="row" style="margin: 0px 10px"&gt;
        &lt;hr style="background-color: #f1f1f1"/&gt;
        &lt;el-table
            tooltip-effect="light"
            style="width: 100%;margin-top: 20px"
            :data="posiDialogTableData"
            v-loading="posiDialogLoading"
            @row-click="posiDialogItemClick"&gt;
          &lt;el-table-column
              prop="unitCode"
              width="100"
              label='&lt;@spring.message "flowemptransfer.unitcode"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              prop="fullUnitName"
              show-overflow-tooltip="true"
              header-align="center"
              label='&lt;@spring.message "flowemptransfer.unitName"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              prop="positionCode"
              width="100"
              label='&lt;@spring.message "flowemptransfer.positioncode"/&gt;'
          &gt;&lt;/el-table-column&gt;
          &lt;el-table-column
              prop="positionName"
              show-overflow-tooltip="true"
              label='&lt;@spring.message "flowemptransfer.positionname"/&gt;'
          &gt;&lt;/el-table-column&gt;
        &lt;/el-table&gt;
      &lt;/div&gt;
      &lt;el-pagination
          @current-change="posiDialogPageChange"
          :current-page="1"
          :page-count="paginationPosiDialog.pageCount"
          layout="prev, pager, next, jumper"&gt;
      &lt;/el-pagination&gt;
    &lt;/el-dialog&gt;

    &lt;el-dialog id="import-file-dialog" title='&lt;@spring.message "flowemptransfer.importdialogtitle"/&gt;' :visible.sync="importDialogFlag" &gt;

      &lt;div class="header-title"&gt;
        &lt;img  src="${base.contextPath}/resources/myflow/emplevechange/images/icon.png"&gt;
        &lt;label  &gt;&lt;@spring.message "flowemptransfer.importnote"/&gt;&lt;/label&gt;
      &lt;/div&gt;

      &lt;div class="header-content" style="padding:20px;"&gt;
        &lt;span class="content-span"&gt;1.&lt;@spring.message "flowemptransfer.importtipone"/&gt;&lt;/span&gt;&lt;br&gt;
        &lt;span class="content-span"&gt;2.&lt;@spring.message "flowemptransfer.importtiptwo"/&gt;&lt;/span&gt;&lt;br&gt;
        &lt;span class="content-span"&gt;3.&lt;@spring.message "flowemptransfer.importtipthree"/&gt;&lt;/span&gt;&lt;br&gt;
        &lt;span class="content-span" style="color:#14A4FA;"&gt;&lt;@spring.message "flowemptransfer.importtipfour"/&gt;&lt;/span&gt;&lt;br&gt;
        &lt;span class="content-span" style="color:#14A4FA;"&gt;&lt;@spring.message "flowemptransfer.importtipfive"/&gt;&lt;/span&gt;&lt;br&gt;

      &lt;/div&gt;
      &lt;div class="header-title"&gt;
        &lt;img  src="${base.contextPath}/resources/myflow/emplevechange/images/icon.png"&gt;
        &lt;label  &gt;&lt;@spring.message "flowemptransfer.importfile"/&gt;&lt;/label&gt;
      &lt;/div&gt;
      &lt;div class="footer-content" style="padding: 20px;"&gt;

        &lt;form method="POST" id="formID" enctype="multipart/form-data"&gt;
          &lt;table width="100%" cellpadding="5px" id="diaTable" &gt;

            &lt;tr&gt;
              &lt;td&gt;
                &lt;span for="uploadFile" class="chose-label" style="margin-right: 10px;"&gt;&lt;@spring.message "flowemptransfer.selectfile"/&gt;&lt;/span&gt;
                &lt;input id="uploadFile" type="file" @change="getFile"  style="display: none"&gt;
                &lt;el-input v-model="filename" class="import-input" style="width: 55%;display: inline-block;" disabled&gt;&lt;/el-input&gt;
                &lt;el-button type="primary" class="lookup-label" @click="fileClick" style="width:85px;"&gt;&lt;@spring.message "flowemptransfer.browsethrough"/&gt;&lt;/el-button&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
          &lt;/table&gt;

        &lt;/form&gt;
      &lt;/div&gt;
      &lt;div  class="footer-btn" style="text-align: center"&gt;
        &lt;el-button class="dialog-import-btn"  @click="submitForm($event)" style="width: 18%;border-color: #4db3ff;color: #4db3ff;"&gt;&lt;@spring.message "flowemptransfer.importbtnstr"/&gt;&lt;/el-button&gt;
      &lt;/div&gt;
      &lt;!--&lt;div class="header-title"&gt;--&gt;
        &lt;!--&lt;img  src="${base.contextPath}/resources/myflow/emplevechange/images/icon.png"&gt;--&gt;
        &lt;!--&lt;label  &gt;&lt;@spring.message "flowemptransfer.importfile"/&gt;&lt;/label&gt;--&gt;
      &lt;!--&lt;/div&gt;--&gt;

      &lt;div class="header-content" style="padding: 20px"&gt;
        &lt;span class="content-span"&gt;1.&lt;@spring.message "flowemptransfer.importtipsix"/&gt;&lt;/span&gt;&lt;br&gt;
        &lt;span class="content-span"&gt;2.&lt;@spring.message "flowemptransfer.importtipseven"/&gt;&lt;/span&gt;&lt;br&gt;
        &lt;span class="content-span"&gt;3.&lt;@spring.message "flowemptransfer.importtipeight"/&gt;&lt;/span&gt;&lt;br&gt;
      &lt;/div&gt;
    &lt;/el-dialog&gt;

    &lt;hhr-dialog
        :visible.sync="warnDialogVisible"
        @confirm="warnDialogVisible = false"
        :text1="warnDialogText"
        confirm-text="&lt;@spring.message 'hap.confirm'/&gt;"
        type="warn"&gt;&lt;/hhr-dialog&gt;

    &lt;hhr-dialog
        :visible.sync="removeDialogVisible"
        @confirm="remove"
        @cancel="removeDialogVisible = false"
        text1='&lt;@spring.message "flowemptransfer.removedialogtext"/&gt;'
        confirm-text="&lt;@spring.message 'hap.confirm'/&gt;"
        cancel-text="&lt;@spring.message 'hap.cancel'/&gt;"
        type="doubt"&gt;&lt;/hhr-dialog&gt;

    &lt;hhr-dialog
        :visible.sync="confirmInportDialog"
        @confirm="importExcel"
        @cancel="confirmInportDialog = false"
        text1='&lt;@spring.message "flowemptransfer.importdialogtextone"/&gt;'
        text2='&lt;@spring.message "flowemptransfer.importdialogtexttwo"/&gt;'
        confirm-text="&lt;@spring.message 'hap.confirm'/&gt;"
        cancel-text="&lt;@spring.message 'hap.cancel'/&gt;"
        type="doubt"&gt;&lt;/hhr-dialog&gt;

    &lt;hhr-dialog
        :visible.sync="submitValiteDialog"
        @confirm="submitValiteDialog = false"
        :text1="submitValiteHint"
        confirm-text="&lt;@spring.message 'hap.confirm'/&gt;"
        type="warn"&gt;&lt;/hhr-dialog&gt;

    &lt;hhr-dialog
        :visible.sync="confirmSubmitDialog"
        @confirm="submit"
        @cancel="cancelSubmit"
        text1='&lt;@spring.message "flowemptransfer.confirmsubmit"/&gt;'
        confirm-text="&lt;@spring.message 'hap.confirm'/&gt;"
        cancel-text="&lt;@spring.message 'hap.cancel'/&gt;"
        type="doubt"&gt;&lt;/hhr-dialog&gt;

  &lt;/div&gt;

&lt;script type="text/javascript" &gt;
    var inputFocusEle ;
    var emptransfer = new Vue({
        el:"#emptransfer",
        data:{
            instruction:'',
            templateurl:'',
            showInput:true,
            headMemo:'',
            downListTableData:[],
            tableData: [],
            empDialogTableData:[],
            empDialogTableAllData:[],
            posiDialogTableData:[],
            posiDialogTableAllData:[],
            multipleSelection: [],
            showPosiDialog:true,
            newPosiDialogVisible:false,
            empInfoDialogVisible:false,
            confirmInportDialog:false,
            importDialogFlag:false,
            warnDialogVisible:false,
            removeDialogVisible:false,
            submitValiteDialog:false,
            confirmSubmitDialog:false,
            empDownListLoading:false,
            empDialogLoading:false,
            posiDialogLoading:false,
            submitLoading:false,
            submitValiteHint:'',
            warnDialogText:'',
            filename:'',
            file: '',
            transferPosiType:[],
            rowIndex:'',
            dotList:[],
            source:null,
            export:{
                enable: true,
            },
            wopts:{bookType: 'xlsx', bookSST: true, type: 'binary', cellStyles: true},
            paginationEmpDialog:{
                pageCount: 1,
                num: 5,
            },
            paginationPosiDialog:{
                pageCount: 1,
                num: 5,
            },
            pagination:{
                pageCount: 1,
                num: 10,
            },
            empDialogParam:{
                employeeCode:'',
                name:''
            },
            posiDialogParam:{
                fullUnitName:'',
                positionName:''
            }
        },
        mounted:function () {
            axios.get('${base.contextPath}/sap/code?code='+TRANSFER_TYPE)
                .then(function (response) {
                    emptransfer.transferPosiType = response.data.rows;

                })
                .catch(function (error) {
                    console.error(error);
                    emptransfer.$message.error({
                        message: "&lt;@spring.message 'hhr.axioserror'/&gt;",
                        duration: 2000
                    });
                });


            axios.get('${base.contextPath}/hhr/myflow/download/queryexcelurl?templeName='+TEMPLATE_NAME)
                .then(function (response) {
                    console.info(response);
                    if(response.data.success){
                        emptransfer.templateurl= response.data.message;
                        console.info(emptransfer.templateurl);
                    }
                })
                .catch(function (error) {
                    console.log(error);
                    emptransfer.$message.error({
                        message: "&lt;@spring.message 'hhr.axioserror'/&gt;",
                        duration: 2000

                    });
                });
        },
        methods:{

            //初始化时候将index 加入到row中
            tableRowClassName:function(row, index) {
                //把每一行的索引放进row
                row.index = index
            },

            //全选/全不选 事件
            toggleSelection:function(rows) {
//                if (rows) {
//                    rows.forEach(row =&gt; {
//                        this.$refs.multipleTable.toggleRowSelection(row);
//                    });
//                } else {
//                    this.$refs.multipleTable.clearSelection();
//                }
                if (rows) {
                    rows.forEach(function (row) {
                        undefined.$refs.multipleTable.toggleRowSelection(row);
                    });
                } else {
                    undefined.$refs.multipleTable.clearSelection();
                }
            },

            //勾选改变触发事件
            handleSelectionChange:function(val) {
                this.multipleSelection = val;
            },

            //新增
            add:function(){
                emptransfer.tableData.push({
                    employeeCode:'',
                    name: '',
                    joinDate:'',
                    nowDept:'',
                    nowPosi:'',
                    transferDept:'',
                    transferPosi:'',
                    transferType:'',
                    effectiveDate:'',
                    description:''
                });
//                emptransfer.tablePageChange(1)
            },

            //删除
            remove:function(){
                emptransfer.removeDialogVisible = false;
//                emptransfer.tableData =this.tableData.filter(t =&gt; !emptransfer.multipleSelection.some(s =&gt; s.index === t.index))
                emptransfer.tableData = emptransfer.tableData.filter(function (t) {
                    return !emptransfer.multipleSelection.some(function (s) {
                        return s.index === t.index;
                    });
                });
        emptransfer.multipleSelection =[];
            },

            //提交前的数据校验
            checkSubmit:function () {
//                emptransfer.submitLoading = true;
                var myTable = emptransfer.tableData;
                var dtoList = [];
                var _myJson = {};
                var message = '';
                if(myTable.length==0){
                    message = infoTipOne;
                }else{
                    for(var i=0;i&lt;myTable.length;i++){
                        var dto = {};
                        if(myTable[i].employeeCode==''|myTable[i].employeeCode==null){
                            message =  tables + (i+1) + empCodeNotEmpty;
                            break;
                        }else{
                            dto["employeeCode"] = myTable[i].employeeCode;
                        }
                        if(myTable[i].transferDeptCode==''|myTable[i].transferDeptCode==null){
                            message = tables + (i+1) + transferDeptNotEmpty;
                            break;
                        }else{
                            dto["newUnitCode"] = myTable[i].transferDeptCode;
                        }

                        if(myTable[i].transferPosiCode==''|myTable[i].transferPosiCode==null){
                            message = tables + (i+1) + transferPosiNotEmpty;
                            break;
                        }else{
                            dto["newPositionCode"] = myTable[i].transferPosiCode;
                        }

                        if(myTable[i].transferTypeCode==''|myTable[i].transferTypeCode==null){
                            message = tables + (i+1) + transferTypeNotEmpty;
                            break;
                        }else{
                            dto["changeType"] = myTable[i].transferTypeCode;
                        }

                        if(myTable[i].effectiveDate==''|myTable[i].effectiveDate==null){
                            message = tables + (i+1) + effectiveDateNotEmpty;
                            break;
                        }else{
                            dto["validDate"] = myTable[i].effectiveDate;
                        }
                        dto["name"] = myTable[i].name;
                        dto["originalUnitCode"] = myTable[i].nowDeptCode;
                        dto["originalPositionCode"] = myTable[i].nowPosiCode;
                        dto["originalUnitName"] =myTable[i].nowDept;
                        dto["originalPositionName"] =myTable[i].nowPosi;
                        dto["newUnitName"] =myTable[i].transferDept;
                        dto["newPositionName"] =myTable[i].transferPosi;
                        dto["joinDate"] =myTable[i].joinDate;
                        dto["changeTypeText"] =myTable[i].transferType;
                        dto["memo"] =myTable[i].description;
                        dto["headMemo"] = emptransfer.headMemo;
                        dtoList.push(dto);
                    }
                }
                if(message == ''){
                    emptransfer.confirmSubmitDialog = true;
                    emptransfer.dtoList = dtoList;


                }else{
                    emptransfer.submitValiteHint = message;
                    emptransfer.submitValiteDialog = true;
                }
            },

      //提交
            submit:function () {
                emptransfer.confirmSubmitDialog = false;
                emptransfer.submitLoading = true;
                var configsubmit = {
                    method: 'post',
                    url: "${base.contextPath}/hhr/flow/emptransfer/apply/submit",
                    data: emptransfer.dtoList,
                    headers: {'X-Requested-With': 'XMLHttpRequest','X-CSRF-TOKEN':'${_csrf.token}'},
                    requestHeader:{'Content-Type':'application/json'}
                }

                axios(configsubmit).then(function (response) {

                    if(response.data.success){
                        emptransfer.tableData = [];
                        emptransfer.headMemo = '';
                        emptransfer.submitLoading = false;
                        var url = "myflow/base/submitsuccess.html";
                        window.parent.window.openTab(url,"&lt;@spring.message 'employeechange.submitsuccess'/&gt;");
                    }else{
                        emptransfer.submitLoading = false;
                        console.error(response.data.message);
                        emptransfer.$message.error({
                            message: response.data.message,
                            duration: 2000
                        });
                    }

                }).catch(function (error) {
                    emptransfer.submitLoading = false;
                    console.error(error);
                    emptransfer.$message.error({
                        message: "&lt;@spring.message 'hhr.axioserror'/&gt;",
                        duration: 2000
                    });
                });
            },

      //取消提交
            cancelSubmit:function () {
                emptransfer.confirmSubmitDialog = false;
                emptransfer.dtoList = [];
            },


            //input获取焦点时讲input元素提出来
            handleInputFocus:function(event){
                inputFocusEle = event.target;
            },

            //input框编辑时触发的方法，动态弹出员工查询下拉列表
            handleEdit:function(value) {
                var _inputNode = inputFocusEle;
                if(emptransfer.getParentElement(_inputNode,1)!==0){
                    var _parentNode = emptransfer.getParentElement(_inputNode,1);
                    var index = _parentNode.getAttribute('row-index');
                    emptransfer.tableData[index].name='';
                    emptransfer.tableData[index].joinDate='';
                    emptransfer.tableData[index].nowDept='';
                    emptransfer.tableData[index].nowFullDept='';
                    emptransfer.tableData[index].nowDeptCode='';
                    emptransfer.tableData[index].nowPosi='';
                    emptransfer.tableData[index].nowPosiCode='';
                }
                if(emptransfer.getParentElement(_inputNode,4)!==0){
                    var _cellNode = emptransfer.getParentElement(_inputNode,4);
                    emptransfer.addClass(_cellNode,'current-cell2')
                    emptransfer.queryPreEmpInfo(_inputNode.value);
                }

            },

            //查询 下拉中的 前10条员工信息
            queryPreEmpInfo:_.debounce(function (empCode) {

                emptransfer.empDownListLoading = true;
                axios("${base.contextPath}/hhr/myflow/emptransfer/queryPreEmpUnitPosi?employeeCode="+empCode)
                    .then(function (response) {
                        emptransfer.empDownListLoading = false;
                        if(typeof(response.data.rows)!=="undefined"){
                            emptransfer.downListTableData = response.data.rows;
//                            emptransfer.downListTableData.forEach(row=&gt;{
//                                row["employeeCode"] = row["employeeCode"].replace(/\b(0{1,5})/gi,"");
//                                if(row["joinDate"]!==null){
//                                    row["joinDate"] = (row["joinDate"].split(' '))[0];
//                                }
//                            })
                            emptransfer.downListTableData.forEach(function (row) {
                                row["employeeCode"] = row["employeeCode"].replace(/\b(0{1,5})/gi, "");
                                if (row["joinDate"] !== null) {
                                    row["joinDate"] = row["joinDate"].split(' ')[0];
                                }
                            });
                        }
                    })
                    .catch(function (error) {
                        emptransfer.empDownListLoading = false;
                        console.error(error);
                        emptransfer.$message.error({
                            message: "&lt;@spring.message 'hhr.axioserror'/&gt;",
                            duration: 2000
                        });
                    });

            },500),

            //员工查询下拉的表格行点击事件
            empDownListItemClick:function(row, event, column){ //编辑 工号 时 动态获取 员工信息的table 的row-click
                var _tr = event.target;
                if(emptransfer.getParentElement(_tr,6)!==0){
                    var _getRowIndexEle = emptransfer.getParentElement(_tr,6);
                    var index = _getRowIndexEle.getAttribute('row-index');
                    if(index === null){
                        _getRowIndexEle = _getRowIndexEle.childNodes[0];
                        index = _getRowIndexEle.getAttribute('row-index');
                    }
                    if( emptransfer.getParentElement(_getRowIndexEle,3)!==0){
                        var _boxEle = emptransfer.getParentElement(_getRowIndexEle,3);
                        emptransfer.tableData[index].employeeCode=row.employeeCode;
                        emptransfer.tableData[index].name=row.name;
                        emptransfer.tableData[index].joinDate=row.joinDate;
                        emptransfer.tableData[index].nowDept=row.unitName;
                        emptransfer.tableData[index].nowFullDept=row.fullUnitName;
                        emptransfer.tableData[index].nowDeptCode=row.unitCode;
                        emptransfer.tableData[index].nowPosi=row.positionName;
                        emptransfer.tableData[index].nowPosiCode=row.positionCode;
                        emptransfer.removeClass(_boxEle,'current-cell');
                    }
                }
            },

            //input框失去焦点事件
            handleInputBlur:function(event){   //当 input 失去焦点 时,input 切换为 span，并且让下方 表格消失（注意，与点击表格事件的执行顺序）
                var _event = event;
                setTimeout(function(){
                    var _inputNode = _event.target;
                    if(emptransfer.getParentElement(_inputNode,4)!==0){
                        var _cellNode = emptransfer.getParentElement(_inputNode,4);
                        emptransfer.removeClass(_cellNode,'current-cell');
                        emptransfer.removeClass(_cellNode,'current-cell2');
                    }
                },200);
            },

            //点击弹出 员工查询Dialog
            selectEmpInfo:function(index){
                emptransfer.rowIndex=index;
                emptransfer.empInfoDialogVisible = true;
//                emptransfer.queryDialogEmpInfo();
            },

            //查询 Dialog中的员工信息
            queryDialogEmpInfo:function () {
                emptransfer.paginationEmpDialog.pageCount = 1;
                emptransfer.empDialogLoading = true;
                var empQueryParamJson = emptransfer.empDialogParam;
                var CancelToken = axios.CancelToken;
                var source = CancelToken.source();
                emptransfer.source = source;
                var configqueryemp = {
                    method: 'post',
                    url: "${base.contextPath}/hhr/myflow/emptransfer/queryEmpUnitPosi",
                    data: empQueryParamJson,
                    headers: {'X-Requested-With': 'XMLHttpRequest','X-CSRF-TOKEN':_token},
                    requestHeader:{'Content-Type':'application/json'},
                    cancelToken:source.token
                }
                axios(configqueryemp).then(function (response) {
                    if(response.data.success){
                        emptransfer.empDialogLoading = false;
                        emptransfer.empDialogTableAllData = response.data.rows;
//                        emptransfer.empDialogTableAllData.forEach(row=&gt;{
//                            row["employeeCode"] = row["employeeCode"].replace(/\b(0{1,5})/gi,"");
//                            if( row["joinDate"]!= null){
//                                row["joinDate"] = (row["joinDate"].split(" "))[0];
//                            }
//                        })
                        emptransfer.empDialogTableAllData.forEach(function (row) {
                            row["employeeCode"] = row["employeeCode"].replace(/\b(0{1,5})/gi, "");
                            if (row["joinDate"] != null) {
                                row["joinDate"] = row["joinDate"].split(" ")[0];
                            }
                        });
                        emptransfer.empDialogPageChange(1);
                    }else{
                        emptransfer.empDialogLoading = false;
                        console.error(response.data.message);
                        emptransfer.$message.error({
                            message: response.data.message,
                            duration: 2000
                        });
                    }

                }).catch(function (error) {
                    emptransfer.empDialogLoading = false;
                    console.error(error);
//                    emptransfer.$message.error({
//                        message: "&lt;@spring.message 'hhr.axioserror'/&gt;",
//                        duration: 2000
//                    });
                });
            },

            //员工信息Dialog分页方法
            empDialogPageChange: function (currentPage) {
                var total = emptransfer.empDialogTableAllData.length;
                emptransfer.paginationEmpDialog.pageCount = Math.ceil(total/emptransfer.paginationEmpDialog.num);

                var start = (currentPage-1)*emptransfer.paginationEmpDialog.num;
                emptransfer.empDialogTableData = [];
                for(var i=start; i&lt;start+emptransfer.paginationEmpDialog.num &amp;&amp; i&lt;total; i++){
                    emptransfer.empDialogTableData[i-start] = emptransfer.empDialogTableAllData[i];
                }

            },

            //员工查询Dialog的表格行点击事件
            empDialogItemClick:function(row, event, column){
                var index = emptransfer.rowIndex;
                emptransfer.tableData[index].employeeCode = row.employeeCode;
                emptransfer.tableData[index].name = row.name;
                emptransfer.tableData[index].joinDate = row.joinDate;
                emptransfer.tableData[index].nowFullDept = row.fullUnitName;
                emptransfer.tableData[index].nowDept = row.unitName;
                emptransfer.tableData[index].nowDeptCode = row.unitCode;
                emptransfer.tableData[index].nowPosi = row.positionName;
                emptransfer.tableData[index].nowPosiCode = row.positionCode;
                emptransfer.empInfoDialogVisible =false;
            },

            //员工查询Dialog框关闭的回调
            closeEmpDialog:function () {
                emptransfer.source.cancel("操作被用户取消");
                emptransfer.paginationEmpDialog.pageCount=1;
                emptransfer.paginationEmpDialog.num=5;
                emptransfer.empDialogParam.employeeCode='';
                emptransfer.empDialogParam.name='';
                emptransfer.empDialogTableAllData=[];
                emptransfer.empDialogTableData=[];
            },

            //点击弹出 新岗位查询Dialog
            selectTransferPosi:function(index){  //点击事件，弹窗：现岗位 选择LOV
                emptransfer.rowIndex=index;
                emptransfer.newPosiDialogVisible = true;
//                emptransfer.queryDialogPosi();
            },

            //查询 Dialog中的新岗位信息
            queryDialogPosi:function () {
                emptransfer.paginationPosiDialog.pageCount = 1;
                emptransfer.posiDialogLoading = true;
                var posiQueryParamJson = emptransfer.posiDialogParam;
                var CancelToken = axios.CancelToken;
                var source = CancelToken.source();
                emptransfer.source = source;
                var configqueryemp = {
                    method: 'post',
                    url: "${base.contextPath}/hhr/myflow/emptransfer/queryTransferPosi",
                    data: posiQueryParamJson,
                    headers: {'X-Requested-With': 'XMLHttpRequest','X-CSRF-TOKEN':_token},
                    requestHeader:{'Content-Type':'application/json'},
          cancelToken:source.token
                }
                axios(configqueryemp).then(function (response) {
                    if(response.data.success){
                        emptransfer.posiDialogLoading = false;
                        emptransfer.posiDialogTableAllData = response.data.rows;
                        emptransfer.posiDialogPageChange(1);
                    }else{
                        emptransfer.posiDialogLoading = false;
                        console.error(response.data.message);
                        emptransfer.$message.error({
                            message: response.data.message,
                            duration: 2000
                        });
                    }

                }).catch(function (error) {
                    emptransfer.posiDialogLoading = false;
                    console.error(error);
//                    emptransfer.$message.error({
//                        message: "&lt;@spring.message 'hhr.axioserror'/&gt;",
//                        duration: 2000
//                    });
                });
            },

            //新岗位Dialog分页方法
            posiDialogPageChange: function (currentPage) {
                var total = emptransfer.posiDialogTableAllData.length;
                emptransfer.paginationPosiDialog.pageCount = Math.ceil(total/emptransfer.paginationPosiDialog.num);

                var start = (currentPage-1)*emptransfer.paginationPosiDialog.num;
                emptransfer.posiDialogTableData = [];
                for(var i=start; i&lt;start+emptransfer.paginationPosiDialog.num &amp;&amp; i&lt;total; i++){
                    emptransfer.posiDialogTableData[i-start] = emptransfer.posiDialogTableAllData[i];
                }

            },

            //新岗位Dialog的表格行点击事件
            posiDialogItemClick:function(row, event, column){
                var index = emptransfer.rowIndex;
                emptransfer.tableData[index].transferDept = row.unitName;
                emptransfer.tableData[index].transferFullDept = row.fullUnitName;
                emptransfer.tableData[index].transferDeptCode = row.unitCode;
                emptransfer.tableData[index].transferPosi = row.positionName;
                emptransfer.tableData[index].transferPosiCode = row.positionCode;
                emptransfer.newPosiDialogVisible =false;
            },

            //新岗位Dialog框关闭的回调
            closePosiDialog:function () {
                emptransfer.source.cancel("操作被用户取消");
                emptransfer.paginationPosiDialog.pageCount=1;
                emptransfer.paginationPosiDialog.num=5;
                emptransfer.posiDialogParam.employeeCode='';
                emptransfer.posiDialogParam.name='';
                emptransfer.posiDialogTableAllData=[];
                emptransfer.posiDialogTableData=[];
            },



            //点击弹出 调整类型下拉列表
            selectTransferType:function(event){ //点击事件， 下方出现下拉列表： 调动类型
                var _i = event.target;
                _i.focus();
                if( emptransfer.getParentElement(_i,4)!==0){
                    var _boxEle = emptransfer.getParentElement(_i,4);
                    emptransfer.addClass(_boxEle,'current-cell1');
                }
            },

            //调整类型下拉列表的行点击事件
            handleTransferTypeClick:function(event,index){
                var _index;
                var _click = event.target;
                var _item = _click.parentNode;
                var _nextNode = _item.childNodes[4];
                if(_nextNode.tagName === 'INPUT'){
                    _index = _nextNode.value;
                }else{
                    var _inputNode =_click.childNodes[4];
                    _index = _inputNode.value;
                }
                emptransfer.tableData[index].transferType = emptransfer.transferPosiType[_index].codeName;
                emptransfer.tableData[index].transferTypeCode = emptransfer.transferPosiType[_index].codeValue;
                if(emptransfer.getParentElement(_item,3)!==0){
                    var _boxEle = emptransfer.getParentElement(_item,3);
                    emptransfer.removeClass(_boxEle,'current-cell1');
                }
            },



            handleDelete:function(index, row) {
            },

            //单元格点击后，显示input，并让input 获取焦点
            handleCellClick:function(row, column, cell, event){
                emptransfer.addClass(cell,'current-cell');
                if(emptransfer.getChildElement(cell,3) !== 0){
                    var _inputParentNode =emptransfer.getChildElement(cell,3);
                    if(_inputParentNode.hasChildNodes()&amp;&amp; _inputParentNode.childNodes.length &gt; 2) {
                        var _inputNode = _inputParentNode.childNodes[2];
                        if(_inputNode.tagName === 'INPUT'){
                            _inputNode.focus();
                        }
                    }
                }
            },

            //调整类型 的Icon 的失去焦点事件
            handleIconBlur:function(event){
                var _event = event;
                setTimeout(function(){
                    var _iNode = _event.target;
                    if(emptransfer.getParentElement(_iNode,4)!==0){
                        var _cellNode = emptransfer.getParentElement(_iNode,4);
                        emptransfer.removeClass(_cellNode,'current-cell1');
                    }
                },200);
            },



            //日期组件失去焦点事件
            handleDataPickerBlur:function(element){
                setTimeout(function(){
                    var _dataPickerNode = element.$el;
                    if(emptransfer.getParentElement(_dataPickerNode,3)!==0){
                        var _cellNode = emptransfer.getParentElement(_dataPickerNode,3);
                        emptransfer.removeClass(_cellNode,'current-cell');
                    }
                },200);
            },

            //获取trElement num 层父元素
            getParentElement:function(trElement,num){
                var currentNode = trElement;
                for(var i =0;i &lt; num;i++ ){
                    if(currentNode !== null){
                        currentNode = currentNode.parentNode;
                    }else{
                        return 0
                    }
                }
                return currentNode;
            },

            //获取trElement num 层子元素
            getChildElement:function(trElement,num){
                var currentNode = trElement;
                for(var i =0;i &lt; num;i++ ){
                    if(currentNode.hasChildNodes()){
                        currentNode = currentNode.childNodes[0];
                    }else{
                        return 0;
                    }
                }
                return currentNode;
            },

            //获取 当前事件  的 单元格元素
            getCell:function(event){
                var cell = event.target;

                while (cell &amp;&amp; cell.tagName.toUpperCase() !== 'HTML') {
                    if (cell.tagName.toUpperCase() === 'TD') {
                        return cell;
                    }
                    cell = cell.parentNode;
                }

                return null;
            },

            //给elements 添加 类cName
            addClass:function( elements,cName ){
                if( !emptransfer.hasClass( elements,cName ) ){
                    elements.className += " " + cName;
                };
            },

            //移除elements 类cName
            removeClass:function( elements,cName ) {
                if (emptransfer.hasClass(elements, cName)) {
                    elements.className = elements.className.replace(new RegExp("(\\s|^)" + cName + "(\\s|$)"), " "); // replace方法是替换
                };
            },

            //判断elements 是否有类cName
            hasClass:function( elements,cName ){
                return !!elements.className.match( new RegExp( "(\\s|^)" + cName + "(\\s|$)") ); // ( \\s|^ ) 判断前面是否有空格 （\\s | $ ）判断后面是否有空格 两个感叹号为转换为布尔值 以方便做判断
            },



            //弹出 Dialog 提示导入excel确认信息
            importExcel:function(){
                emptransfer.tableData = [];
                emptransfer.confirmInportDialog=false;
                emptransfer.importDialogFlag=true;
            },

            //导入excel到后台，解析校验后，再返回前台显示
            submitForm:function(event) {
                event.preventDefault();
                var formData = new FormData();
                if(this.file==""){
                    emptransfer.warnDialogText='&lt;@spring.message "emplevelchange.selectfile"/&gt;';
                    emptransfer.warnDialogVisible=true;
                    return;
                }
                formData.append('file', this.file);
                var configsave = {
                    method: 'post',
                    url: "${base.contextPath}/api/public/hhr/myflow/emptransfer/importExcel",
                    data: formData,
                    processData: false,
                    contentType: false,
                    headers: { 'Content-Type': 'multipart/form-data'},
                }
        emptransfer.submitLoading = true;
                axios(configsave).then(function (response) {
                    if(response.data.success){
                        if(typeof(response.data.rows)!=="undefined"){
                            emptransfer.tableData = response.data.rows
//                            emptransfer.tableData.forEach(row=&gt;{
//                                row["joinDate"] = row["joinDate"].split(" ")[0];
//                            })
                            emptransfer.tableData.forEach(function (row) {
                                row["joinDate"] = row["joinDate"].split(" ")[0];
                                row["effectiveDate"] = row["effectiveDate"].split(" ")[0];
                            });
                            emptransfer.importDialogFlag=false;
                        }
                    }else{
                        emptransfer.warnDialogText = response.data.message;
                        emptransfer.warnDialogVisible = true;
                    }
                    emptransfer.submitLoading = false;
                }).catch(function (error) {
                    emptransfer.warnDialogText = response.data.message;
                    emptransfer.submitLoading = false;
                    emptransfer.warnDialogVisible = true;
                });
            },

            //点击“浏览”获取要上传的文件
            fileClick:function() {
                document.getElementById('uploadFile').click()
            },

            //获取上传的文件和文件名
            getFile:function(event) {
                this.file = event.target.files[0];
                this.filename=this.file.name;
            },



            //导出excel校验
            exportExcel:function () {
                console.log('---------------211---------------')
                if(emptransfer.tableData.length === 0){
                    emptransfer.$message.error("没有数据可以导出！");
                    return;
                }
                if (emptransfer.export.enable) {
                    emptransfer.export.enable = false;
                    document.getElementsByClassName("exportBtn")[0].style.cursor = "wait";
                    document.getElementsByClassName("exportBtn")[0].style["background-color"] = "#969696";
                    emptransfer.exportExelAction(emptransfer.changeExelData(emptransfer.tableData));
                    window.setTimeout(exportEnable, 3000);
                }
                function exportEnable() {
                    emptransfer.export.enable = true;
                    document.getElementsByClassName("exportBtn")[0].style.cursor = "pointer";
                    document.getElementsByClassName("exportBtn")[0].style["background-color"] = "#FFFFFF";
                }
            },

            //导出execl动作
            exportExelAction:function(json,type){
                var tmpdata = json[0];

                json.unshift({});
                var keyMap = []; //获取keys
                for (var k in tmpdata) {
                    keyMap.push(k);
                    json[0][k] = k;
                }

                var tmpdata = []; //用来保存转换好的json
                var _tmp = json.map(function (v, i) {
                    return keyMap.map(function (k, j) {
                        return Object.assign({}, {
                            v: v[k],
                            position: (j &gt; 25 ? emptransfer.getCharCol(j) : String.fromCharCode(65 + j)) + (i + 1)
                        });
                    });
                }).reduce(function (prev, next) {
                    return prev.concat(next);
                }).forEach(function (v, i) {
                    return tmpdata[v.position] = {
                        v: v.v
                    };
                });
                var outputPos = Object.keys(tmpdata); //设置区域,比如表格从A1到D10
                var index = ["A1", "B1", "C1", "D1", "E1", "F1", "G1", "H1", "I1", "J1", "K1", "L1", "M1", "N1"];
                index.forEach(function (i) {
                    tmpdata[i].s = {
                        font: {
                            bold: true,
                            color: {
                                rgb: "000000"
                            }
                        },
                        fill: {
                            bgColor: {
                                rgb: "CCCCCC"
                            },
                            fgColor: {
                                rgb: "CCCCCC"
                            }
                        },
                        alignment: {
                            horizontal: "center"
                        }
                    };
                });
//设置列宽
                tmpdata["!cols"] = [{
                    wpx: '60'
                }, {
                    wpx: '75'
                }, {
                    wpx: '90'
                }, {
                    wpx: '100'
                }, {
                    wpx: '160'
                }, {
                    wpx: '100'
                }, {
                    wpx: '180'
                }, {
                    wpx: '120'
                }, {
                    wpx: '160'
                }, {
                    wpx: '120'
                }, {
                    wpx: '180'
                }, {
                    wpx: '100'
                }, {
                    wpx: '90'
                }, {
                    wpx: '180'
                }];
                var tmpWB = {
                    SheetNames: ['mySheet'], //保存的表标题
                    Sheets: {
                        'mySheet': Object.assign({}, tmpdata, //内容
                            {
                                '!ref': outputPos[0] + ':' + outputPos[outputPos.length - 1] //设置填充区域
                            })
                    }
                };
                var tmpDown = new Blob([emptransfer.s2ab(XLSX.write(tmpWB, { bookType: type == undefined ? 'xlsx' : type, bookSST: false, type: 'binary' //这里的数据是用来定义导出的格式类型
                }))], {
                    type: ""
                }); //创建二进制对象写入转换
                emptransfer.saveAs(tmpDown, exportExcelName + '.' + (emptransfer.wopts.bookType == "biff2" ? "xls" : emptransfer.wopts.bookType));
            },

            //表头数据的处理
            changeExelData:function (json) {
                var _newJsonArray = [];
                json.map(function (v, i) {
                    var _newJson = {};
                    _newJson[employeeCodeStr] = v["employeeCode"]; //工号
                    _newJson[nameStr] = v["name"]; //姓名
                    _newJson[joinDateStr] = v["joinDate"]; //入职日期
                    _newJson[nowDeptCodeStr] = v["nowDeptCode"]; //现部门编码
                    _newJson[nowDeptStr] = v["nowFullDept"]; //现部门文本
                    _newJson[nowPosiCodeStr] = v["nowPosiCode"]; //现岗位编码
                    _newJson[nowPosiStr] = v["nowPosi"]; //现岗位文本
                    _newJson[transferDepCodeStr] = v["transferDeptCode"]; //调动后部门编码
                    _newJson[transferDepStr] = v["transferFullDept"]; //调动后部门文本
                    _newJson[transferPosiCodeStr] = v["transferPosiCode"]; //调动后岗位编码
                    _newJson[transferPosiStr] = v["transferPosi"]; //调动后岗位文本
                    _newJson[transferTypeStr] = v["transferTypeCode"] + ' ' + v["transferType"]; //调动类型编码+文本
                    _newJson[effectiveDateStr] = emptransfer.dateFormat(v["effectiveDate"]); //生效日期
                    _newJson[descriptionStr] = v["description"]; //备注
                    _newJsonArray.push(_newJson);
                });
                return _newJsonArray;
            },

            // 将指定的自然数转换为26进制表示。映射关系：[0-25] -&gt; [A-Z]。
            getCharCol:function(n){
                var temCol = '',
                    s = '',
                    m = 0
                while (n &gt; 0) {
                    m = n % 26 + 1
                    s = String.fromCharCode(m + 64) + s
                    n = (n - m) / 26
                }
                return s
            },

      //模拟a标签点击，下载表格文件（兼容IE和Edge）
            saveAs:function( obj, fileName) {
                if('msSaveOrOpenBlob' in navigator){
                    // Microsoft Edge and Microsoft Internet Explorer 10-11
                    window.navigator.msSaveOrOpenBlob(obj, fileName);
                }else{
                    // standard code for Google Chrome, Mozilla Firefox etc
                    var evt = document.createEvent('MouseEvents');
                    evt.initEvent('click', true, true);
                    var t = document.createElement("a");
                    t.setAttribute("download", fileName || "下载");
                    var myurl =   URL.createObjectURL(obj);
                    t.setAttribute("href", myurl);
                    t.dispatchEvent(evt)
                    setTimeout(function () {
                        URL.revokeObjectURL(obj);
                    }, 100);
                }

            },

            //字符串转字符流
            s2ab:function(s){
                var buf = new ArrayBuffer(s.length);
                var view = new Uint8Array(buf);
                for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) &amp; 0xFF;
                return buf;
            },

            formatTen: function (num) {
                return num &gt; 9 ? (num + "") : ("0" + num);
            },

            dateFormat:function (value) {
                if (!value) { return ''}
                var date = new Date(value);
                var year = date.getFullYear();
                var month = date.getMonth() + 1;
                var day = date.getDate();
                var hour = date.getHours();
                var minute = date.getMinutes();
                var second = date.getSeconds();
                return year + "-" + emptransfer.formatTen(month) + "-" +emptransfer.formatTen(day);
            }
        }
    });

    //过滤器
    Vue.filter('fomatDate', function(value) {
        if (!value) { return ''}
        var date = new Date(value);
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();
        return year + "-" + emptransfer.formatTen(month) + "-" +emptransfer.formatTen(day);
    })
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<hr> 
<h2><a id="_1871"></a>觉得有帮助的小伙伴右上角点个赞~</h2> 
<p><img src="https://images2.imgbox.com/1c/b4/2YpGbIO9_o.jpg" alt="在这里插入图片描述"></p> 
<h2><a id="_1873"></a>扫描上方二维码关注我的订阅号~</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fec9696103b50645ec6f334953895d1f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">element中input的change事件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/83f1aafcf2b002e877af48792d5d7216/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一个奇怪的问题——ImportError: No module named google.protobuf.internal</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>