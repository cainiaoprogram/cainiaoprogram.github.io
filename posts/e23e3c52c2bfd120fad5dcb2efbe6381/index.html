<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>K-means聚类 —— matlab - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="K-means聚类 —— matlab" />
<meta property="og:description" content="目录
1.简介
2.算法原理
3.实例分析
3.1 读取数据
3.2 原理推导K均值过程
3.3 自带kmeans函数求解过程
完整代码
1.简介 聚类是一个将数据集中在某些方面相似的数据成员进行分类组织的过程，聚类就是一种发现这种内在结构的技术，聚类技术经常被称为无监督学习。
K均值聚类是最著名的划分聚类算法，由于简洁和效率使得他成为所有聚类算法中最广泛使用的。给定一个数据点集合和需要的聚类数目K，K由用户指定，K均值算法根据某个距离函数反复把数据分入K个聚类中。
2.算法原理 K-means算法是典型的基于距离的聚类算法，采用距离作为相似性的评价指标，即认为两个对象的距离越近，其相似度就越大。该算法认为簇是由距离靠近的对象组成的，因此把得到紧凑且独立的簇作为最终目标。
K-mean算法步骤如下：
（1）随机选取K个样本为中⼼
（2）分别计算所有样本到随机选取的K个中⼼的距离
（3）样本离哪个中⼼近就被分到哪个中⼼
（4）计算各个中⼼样本的均值（最简单的⽅法就是求样本每个维度的平均值）作为新的中心
（5）重复（2）（3）（4）直到新的中⼼和原来的中⼼基本不变化的时候，算法结束
3.实例分析 数据来源于：统计年鉴
从数据中，我们可以看到，实际数据是被分为三类的。
3.1 读取数据 data=xlsread(&#39;D:\桌面\kmeans.xlsx&#39;) 返回：
在这里我们看到，xlsread读取数据时没有读取变量名，但序号也被加进去了，接下来我们需要将其剔除
data=data(:,2:7) 返回：
3.2 原理推导K均值过程 %% 原理推导K均值 [m,n]=size(data); %读取数据的行数与列数 cluster_num=3; %自定义分类数 cluster=data(randperm(m,cluster_num),:); epoch_max=1000;%最大次数 therad_lim=0.001;%中心变化阈值 epoch_num=0; while(epoch_num&lt;epoch_max) epoch_num=epoch_num&#43;1; for i=1:cluster_num distance=(data-repmat(cluster(i,:),m,1)).^2; distance1(:,i)=sqrt(sum(distance&#39;)); end [~,index_cluster]=min(distance1&#39;); for j=1:cluster_num cluster_new(j,:)=mean(data(find(index_cluster==j),:)); end if (sqrt(sum((cluster_new-cluster).^2))&gt;therad_lim) cluster=cluster_new; else break; end end %% 画出聚类效果 figure(2) subplot(2,1,1) a=unique(index_cluster); %找出分类出的个数 C=cell(1,length(a)); for i=1:length(a) C(1,i)={find(index_cluster==a(i))}; end for j=1:cluster_num data_get=data(C{1,j},:); scatter(data_get(:,1),data_get(:,2),100,&#39;filled&#39;,&#39;MarkerFaceAlpha&#39;,." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e23e3c52c2bfd120fad5dcb2efbe6381/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-16T19:23:06+08:00" />
<meta property="article:modified_time" content="2022-02-16T19:23:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">K-means聚类 —— matlab</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#1.%E7%AE%80%E4%BB%8B" rel="nofollow">1.简介</a></p> 
<p id="2.%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86-toc" style="margin-left:40px;"><a href="#2.%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86" rel="nofollow">2.算法原理</a></p> 
<p id="3.%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90-toc" style="margin-left:40px;"><a href="#3.%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90" rel="nofollow">3.实例分析</a></p> 
<p id="3.1%20%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#3.1%20%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE" rel="nofollow">3.1 读取数据</a></p> 
<p id="3.2%C2%A0%E5%8E%9F%E7%90%86%E6%8E%A8%E5%AF%BCK%E5%9D%87%E5%80%BC%E8%BF%87%E7%A8%8B-toc" style="margin-left:80px;"><a href="#3.2%C2%A0%E5%8E%9F%E7%90%86%E6%8E%A8%E5%AF%BCK%E5%9D%87%E5%80%BC%E8%BF%87%E7%A8%8B" rel="nofollow">3.2 原理推导K均值过程</a></p> 
<p id="3.3%20%E8%87%AA%E5%B8%A6kmeans%E5%87%BD%E6%95%B0%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B-toc" style="margin-left:80px;"><a href="#3.3%20%E8%87%AA%E5%B8%A6kmeans%E5%87%BD%E6%95%B0%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B" rel="nofollow">3.3 自带kmeans函数求解过程</a></p> 
<p id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81" rel="nofollow">完整代码</a></p> 
<hr id="hr-toc"> 
<h3>1.简介</h3> 
<p>        聚类是一个将数据集中在某些方面相似的数据成员进行分类组织的过程，聚类就是一种发现这种内在结构的技术，聚类技术经常被称为无监督学习。</p> 
<p>        K均值聚类是最著名的划分聚类算法，由于简洁和效率使得他成为所有聚类算法中最广泛使用的。给定一个数据点集合和需要的聚类数目K，K由用户指定，K均值算法根据某个距离函数反复把数据分入K个聚类中。</p> 
<h3 id="2.%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86">2.算法原理</h3> 
<p>        K-means算法是典型的基于距离的聚类算法，采用距离作为相似性的评价指标，即认为两个对象的距离越近，其相似度就越大。该算法认为簇是由距离靠近的对象组成的，因此把得到紧凑且独立的簇作为最终目标。</p> 
<p>K-mean算法步骤如下：</p> 
<p>（1）随机选取K个样本为中⼼</p> 
<p>（2）分别计算所有样本到随机选取的K个中⼼的距离</p> 
<p>（3）样本离哪个中⼼近就被分到哪个中⼼</p> 
<p>（4）计算各个中⼼样本的均值（最简单的⽅法就是求样本每个维度的平均值）作为新的中心</p> 
<p>（5）重复（2）（3）（4）直到新的中⼼和原来的中⼼基本不变化的时候，算法结束</p> 
<h3 id="3.%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90">3.实例分析</h3> 
<p style="text-align:center;"><img alt="" height="513" src="https://images2.imgbox.com/f7/33/Jv6pYMVM_o.png" width="624"></p> 
<p>数据来源于：统计年鉴</p> 
<p>从数据中，我们可以看到，实际数据是被分为三类的。</p> 
<h4 id="3.1%20%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE">3.1 读取数据</h4> 
<pre><code>data=xlsread('D:\桌面\kmeans.xlsx')</code></pre> 
<p>返回：</p> 
<p><img alt="" height="320" src="https://images2.imgbox.com/c8/6e/1nuS3Pdr_o.png" width="689"></p> 
<p>在这里我们看到，xlsread读取数据时没有读取变量名，但序号也被加进去了，接下来我们需要将其剔除</p> 
<pre><code>data=data(:,2:7)</code></pre> 
<p>返回：</p> 
<p><img alt="" height="330" src="https://images2.imgbox.com/e5/dd/Arn3lv3t_o.png" width="725"></p> 
<h4 id="3.2%C2%A0%E5%8E%9F%E7%90%86%E6%8E%A8%E5%AF%BCK%E5%9D%87%E5%80%BC%E8%BF%87%E7%A8%8B">3.2 原理推导K均值过程</h4> 
<pre><code>%% 原理推导K均值
[m,n]=size(data); %读取数据的行数与列数
cluster_num=3; %自定义分类数
cluster=data(randperm(m,cluster_num),:);
epoch_max=1000;%最大次数
therad_lim=0.001;%中心变化阈值
epoch_num=0;
while(epoch_num&lt;epoch_max)
    epoch_num=epoch_num+1;
    for i=1:cluster_num
    distance=(data-repmat(cluster(i,:),m,1)).^2;
    distance1(:,i)=sqrt(sum(distance'));
    end
    [~,index_cluster]=min(distance1');
    for j=1:cluster_num
    cluster_new(j,:)=mean(data(find(index_cluster==j),:));
    end
    if (sqrt(sum((cluster_new-cluster).^2))&gt;therad_lim)
        cluster=cluster_new;
    else
        break;
    end
end
%% 画出聚类效果
figure(2)
subplot(2,1,1)
a=unique(index_cluster); %找出分类出的个数
C=cell(1,length(a));
for i=1:length(a)
   C(1,i)={find(index_cluster==a(i))};
end
for j=1:cluster_num
    data_get=data(C{1,j},:);
    scatter(data_get(:,1),data_get(:,2),100,'filled','MarkerFaceAlpha',.6,'MarkerEdgeAlpha',.9);
    hold on
end
plot(cluster(:,1),cluster(:,2),'kd','LineWidth',2);
hold on
sc_t=mean(silhouette(data,index_cluster'));
title_str=['原理推导K均值聚类','  聚类数为：',num2str(cluster_num),'  SC轮廓系数:',num2str(sc_t)];
title(title_str)</code></pre> 
<p>返回：</p> 
<p><img alt="" height="252" src="https://images2.imgbox.com/9f/35/WCIIajjm_o.png" width="668"></p> 
<h4 id="3.3%20%E8%87%AA%E5%B8%A6kmeans%E5%87%BD%E6%95%B0%E6%B1%82%E8%A7%A3%E8%BF%87%E7%A8%8B">3.3 自带kmeans函数求解过程</h4> 
<pre><code>%% MATLAB自带kmeans函数
subplot(2,1,2) %画子图，在这里是一图上可画两张子图
cluster_num=3; %自定义分类数
[index_km,center_km]=kmeans(data,cluster_num) ;%MATLAB自带kmeans函数
a=unique(index_km); %找出分类出的个数
C=cell(1,length(a));
for i=1:length(a)
   C(1,i)={find(index_km==a(i))};
end
for j=1:cluster_num
    data_get=data(C{1,j},:);
    scatter(data_get(:,1),data_get(:,2),100,'filled','MarkerFaceAlpha',.6,'MarkerEdgeAlpha',.9);
    hold on
end
plot(center_km(:,1),center_km(:,2),'kd','LineWidth',2);
hold on
sc_k=mean(silhouette(data,index_km));
title_str1=['MATLAB自带kmeans函数','  聚类数为：',num2str(cluster_num),'  SC轮廓系数:',num2str(sc_k)];
title(title_str1)</code></pre> 
<p>返回结果如下：</p> 
<p><img alt="" height="262" src="https://images2.imgbox.com/61/24/C39P5JlE_o.png" width="633"></p> 
<h3 id="%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81">完整代码</h3> 
<pre><code>clear;clc;
data=xlsread('D:\桌面\kmeans.xlsx')
data=data(:,2:7)
%% 原理推导K均值
[m,n]=size(data); %读取数据的行数与列数
cluster_num=3; %自定义分类数
cluster=data(randperm(m,cluster_num),:);
epoch_max=1000;%最大次数
therad_lim=0.001;%中心变化阈值
epoch_num=0;
while(epoch_num&lt;epoch_max)
    epoch_num=epoch_num+1;
    for i=1:cluster_num
    distance=(data-repmat(cluster(i,:),m,1)).^2;
    distance1(:,i)=sqrt(sum(distance'));
    end
    [~,index_cluster]=min(distance1');
    for j=1:cluster_num
    cluster_new(j,:)=mean(data(find(index_cluster==j),:));
    end
    if (sqrt(sum((cluster_new-cluster).^2))&gt;therad_lim)
        cluster=cluster_new;
    else
        break;
    end
end
%% 画出聚类效果
figure
subplot(2,1,1) %画子图，在这里是一图上可画两张子图
a=unique(index_cluster); %找出分类出的个数
C=cell(1,length(a));
for i=1:length(a)
   C(1,i)={find(index_cluster==a(i))};
end
for j=1:cluster_num
    data_get=data(C{1,j},:);
    scatter(data_get(:,1),data_get(:,2),100,'filled','MarkerFaceAlpha',.6,'MarkerEdgeAlpha',.9);
    hold on
end
plot(cluster(:,1),cluster(:,2),'kd','LineWidth',2);
hold on
sc_t=mean(silhouette(data,index_cluster'));
title_str=['原理推导K均值聚类','  聚类数为：',num2str(cluster_num),'  SC轮廓系数:',num2str(sc_t)];
title(title_str)

%% MATLAB自带kmeans函数
subplot(2,1,2) %画子图，在这里是一图上可画两张子图
cluster_num=3; %自定义分类数
[index_km,center_km]=kmeans(data,cluster_num) ;%MATLAB自带kmeans函数
a=unique(index_km); %找出分类出的个数
C=cell(1,length(a));
for i=1:length(a)
   C(1,i)={find(index_km==a(i))};
end
for j=1:cluster_num
    data_get=data(C{1,j},:);
    scatter(data_get(:,1),data_get(:,2),100,'filled','MarkerFaceAlpha',.6,'MarkerEdgeAlpha',.9);
    hold on
end
plot(center_km(:,1),center_km(:,2),'kd','LineWidth',2);
hold on
sc_k=mean(silhouette(data,index_km));
title_str1=['MATLAB自带kmeans函数','  聚类数为：',num2str(cluster_num),'  SC轮廓系数:',num2str(sc_k)];
title(title_str1)</code></pre> 
<p>返回：</p> 
<p><img alt="" height="628" src="https://images2.imgbox.com/4a/fc/MGcCteEx_o.png" width="702"></p> 
<p>每次返回结果也不尽相同，原理推导的和自带的函数的求解结果也相差不是很大，但与原始数据的分类相比较，还是有一定差距</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d36e3be695ab6d5b49574b6cef755994/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Termux的安装、换源、基本库安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9583166f70a2e09e71a2a7ac1c5b4257/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue3.x的expose是什么？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>