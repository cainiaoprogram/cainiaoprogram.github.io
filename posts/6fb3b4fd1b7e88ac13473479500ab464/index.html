<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>js中async与await详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="js中async与await详解" />
<meta property="og:description" content="引言 JavaScript 是一门基于事件驱动和异步编程的语言，而异步编程是 JavaScript 中最常用的编程方式之一。在异步编程中，我们通常使用回调函数或 Promise 对象来处理异步操作的结果。而在 ES2017 中，引入了 async 和 await 关键字，使得异步编程更加简洁和易读。
Promise 对象 在介绍 async 和 await 之前，我们先来了解一下 Promise 对象。Promise 对象是 JavaScript 中处理异步编程的一种机制，它可以将异步操作封装成一个对象，使得异步操作的结果可以像同步操作一样被处理。
一个 Promise 对象表示一个异步操作的最终完成或失败，并且可以将其结果返回给异步操作的调用者。Promise 对象有三种状态：pending（等待中）、fulfilled（已完成）和rejected（已失败）。当一个 Promise 对象处于等待中状态时，它表示异步操作正在进行中；当一个 Promise 对象处于已完成状态时，它表示异步操作已经成功完成；当一个 Promise 对象处于已失败状态时，它表示异步操作已经失败。
在使用 Promise 对象时，我们通常使用 then 方法处理异步操作的结果，或者使用 catch 方法处理异步操作的错误。以下是一个简单的例子，演示如何使用 Promise 对象处理异步操作的结果：
javascript Copy code fetch(&#39;https://api.example.com/data&#39;) .then(response =&gt; response.json()) .then(data =&gt; console.log(data)) .catch(error =&gt; console.error(error)); 在上面的例子中，我们使用 fetch 函数从服务器获取数据，并将其解析为 JSON 格式。然后，我们使用 then 方法处理解析后的数据，或者使用 catch 方法处理错误。
async 函数 async 函数是一种特殊的函数，它的返回值是一个 Promise 对象。使用 async 关键字声明的函数可以在内部使用 await 关键字来等待异步操作完成，并返回一个 Promise 对象。在 async 函数中使用 await 关键字可以让异步操作的结果像同步操作一样被处理，从而避免了回调地狱的问题。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6fb3b4fd1b7e88ac13473479500ab464/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-29T12:06:38+08:00" />
<meta property="article:modified_time" content="2023-05-29T12:06:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">js中async与await详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>引言</h3> 
<blockquote> 
 <p>JavaScript 是一门基于事件驱动和异步编程的语言，而异步编程是 JavaScript 中最常用的编程方式之一。在异步编程中，我们通常使用回调函数或 Promise 对象来处理异步操作的结果。而在 ES2017 中，引入了 async 和 await 关键字，使得异步编程更加简洁和易读。</p> 
</blockquote> 
<h3><a id="Promise__5"></a>Promise 对象</h3> 
<p>在介绍 <code>async </code>和 <code>await</code> 之前，我们先来了解一下 <code>Promise</code> 对象。<code>Promise</code> 对象是 JavaScript 中处理异步编程的一种机制，它可以将异步操作封装成一个对象，使得异步操作的结果可以像同步操作一样被处理。</p> 
<p>一个 <code>Promise</code> 对象表示一个异步操作的最终完成或失败，并且可以将其结果返回给异步操作的调用者。<code>Promise </code>对象有三种状态：<code>pending</code>（等待中）、<code>fulfilled</code>（已完成）和<code>rejected</code>（已失败）。当一个 <code>Promise </code>对象处于等待中状态时，它表示异步操作正在进行中；当一个 Promise 对象处于已完成状态时，它表示异步操作已经成功完成；当一个 <code>Promise</code> 对象处于已失败状态时，它表示异步操作已经失败。</p> 
<p>在使用 <code>Promise</code> 对象时，我们通常使用 <code>then</code> 方法处理异步操作的结果，或者使用 <code>catch</code> 方法处理异步操作的错误。以下是一个简单的例子，演示如何使用 <code>Promise </code>对象处理异步操作的结果：</p> 
<pre><code class="prism language-js">javascript
Copy code
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.example.com/data'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在上面的例子中，我们使用 <code>fetch</code> 函数从服务器获取数据，并将其解析为 <code>JSON</code> 格式。然后，我们使用 <code>then</code> 方法处理解析后的数据，或者使用 <code>catch</code> 方法处理错误。</p> 
<h3><a id="async__25"></a>async 函数</h3> 
<p><code>async</code> 函数是一种特殊的函数，它的返回值是一个 <code>Promise</code> 对象。使用 <code>async</code> 关键字声明的函数可以在内部使用 <code>await</code> 关键字来等待异步操作完成，并返回一个 <code>Promise</code> 对象。在 <code>async </code>函数中使用 <code>await</code> 关键字可以让异步操作的结果像同步操作一样被处理，从而避免了回调地狱的问题。</p> 
<p>以下是一个简单的例子，演示如何定义和调用 <code>async</code> 函数：</p> 
<pre><code class="prism language-js">javascript
Copy code
<span class="token comment">// 定义一个 async 函数</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.example.com/data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 调用 async 函数</span>
<span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在上面的例子中，我们先定义了一个名为 <code>getData</code> 的 <code>async</code> 函数。在 <code>getData</code> 函数中，我们使用 <code>await</code> 关键字等待从服务器获取数据的异步操作完成，并将结果解析为 <code>JSON</code> 格式。最后，<code>getData</code> 函数返回解析后的数据。</p> 
<p>在调用 <code>getData</code> 函数时，我们使用 <code>then</code> 方法处理返回的数据，或者使用 <code>catch</code> 方法处理错误。由于 getData 函数返回的是一个 <code>Promise</code> 对象，因此我们可以使用 <code>Promise</code> 的标准方法来处理返回的结果。</p> 
<p><strong>需要注意的是，<code>await</code> 关键字只能在 <code>async</code> 函数中使用，否则会导致语法错误。如果在非 <code>async </code>函数中使用 <code>await </code>关键字，会导致语法错误。</strong></p> 
<h3><a id="await__55"></a>await 关键字</h3> 
<p>await 关键字用于等待一个异步操作完成，并返回异步操作的结果。在使用 <code>await</code> 的时候，需要将其放在一个 <code>async</code> 函数内部。在等待异步操作完成时，<code>JavaScript</code> 引擎会暂停执行当前函数，并等待异步操作完成，然后再继续执行下面的代码。</p> 
<p>以下是一个简单的例子，演示如何使用 await：</p> 
<pre><code class="prism language-js">javascript
Copy code
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.example.com/data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 调用 fetchData 函数</span>
<span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在上面的例子中，<code>fetchData</code> 函数使用 <code>await </code>等待 <code>fetch</code> 函数返回的结果，然后再等待将结果解析为 <code>JSON</code> 格式。最后，<code>fetchData</code> 函数返回解析后的数据。在调用 <code>fetchData</code> 函数时，使用 <code>then</code> 方法处理返回的数据，或者使用 <code>catch </code>方法处理错误。</p> 
<p>需要注意的是，<code>await</code> 只能等待返回 <code>Promise</code> 对象的异步函数执行完成，如果等待的不是 <code>Promise</code> 对象，会自动将其转换为 <code>Promise</code> 对象。</p> 
<h3><a id="_79"></a>总结</h3> 
<p><code>async</code> 和 <code>await</code> 是 <code>JavaScript</code> 中处理异步编程的一种新方式，它们可以让异步操作的结果像同步操作一样被处理，从而使得异步编程更加简洁和易读。在使用 <code>async</code> 和 <code>await</code> 时，需要注意以下几点：</p> 
<ul><li><code>async</code> 函数的返回值是一个 <code>Promise</code> 对象；</li><li><code>await </code>关键字只能在 <code>async</code> 函数中使用；</li><li><code>await</code> 关键字只能等待返回 <code>Promise</code> 对象的异步函数执行完成；</li><li>在使用 <code>await</code> 时，<code>JavaScript</code> 引擎会暂停执行当前函数，直到异步操作完成。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d168c7e715f2414f098313d18609c069/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">纵览轻量化卷积神经网络：SqueezeNet、MobileNet、ShuffleNet、Xception</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a27e10ad9fc6fc6bce1dc03cc68bb0ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">配置Maven仓库私服</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>