<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据增强方法汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据增强方法汇总" />
<meta property="og:description" content="数据增强 1.有监督数据增强1.1 单样本数据增强augly安装augly使用方法 1.2 多样本数据增强1.2.1 SMOTEpython实现 1.2.2 SamplePairingpython实现 1.2.3 mixuppython实现 2.无监督数据增强2.1 GAN2.2 Diffunsion2.3 Autoaugmentation 1.有监督数据增强 1.1 单样本数据增强 augly安装 AugLy是一个数据增强库，目前支持四种模式（音频、图像、文本和视频）和100多种增强。每个模态的增强包含在自己的子库中。这些子库包括基于函数和基于类的变换、组合运算符，并可以选择提供有关所应用转换的元数据，包括其强度。
该库基于Python，至少需要Python 3.6&#43;版本、
官网地址 ：https://github.com/facebookresearch/AugLy
安装该库方法
pip install augly[all] 也可以只安装某一个应用，比如只安装音频
pip install augly[audio] 也可以克隆git
git clone git@github.com:facebookresearch/AugLy.git &amp;&amp; cd AugLy [Optional, but recommended] conda create -n augly &amp;&amp; conda activate augly &amp;&amp; conda install pip pip install -e .[all] augly使用方法 augly.image所有函数都接受要作为输入增强的图像或PIL图像对象的路径，并返回增强的PIL图像对象。如果指定了输出路径，图像也将保存到文件中。
import augly.image as imaugs image_path = &#34;your_img_path.png&#34; output_path = &#34;your_output_path.png&#34; aug_image = imaugs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/5112031464c235503061f33d336109ad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-18T16:29:32+08:00" />
<meta property="article:modified_time" content="2022-11-18T16:29:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据增强方法汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>数据增强</h4> 
 <ul><li><a href="#1_1" rel="nofollow">1.有监督数据增强</a></li><li><ul><li><a href="#11__3" rel="nofollow">1.1 单样本数据增强</a></li><li><ul><li><a href="#augly_4" rel="nofollow">augly安装</a></li><li><a href="#augly_32" rel="nofollow">augly使用方法</a></li></ul> 
   </li><li><a href="#12__84" rel="nofollow">1.2 多样本数据增强</a></li><li><ul><li><a href="#121_SMOTE_85" rel="nofollow">1.2.1 SMOTE</a></li><li><ul><li><a href="#python_106" rel="nofollow">python实现</a></li></ul> 
    </li><li><a href="#122_SamplePairing_150" rel="nofollow">1.2.2 SamplePairing</a></li><li><ul><li><a href="#python_156" rel="nofollow">python实现</a></li></ul> 
    </li><li><a href="#123_mixup_188" rel="nofollow">1.2.3 mixup</a></li><li><ul><li><a href="#python_201" rel="nofollow">python实现</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#2_257" rel="nofollow">2.无监督数据增强</a></li><li><ul><li><a href="#21_GAN_258" rel="nofollow">2.1 GAN</a></li><li><a href="#22_Diffunsion_261" rel="nofollow">2.2 Diffunsion</a></li><li><a href="#23_Autoaugmentation_265" rel="nofollow">2.3 Autoaugmentation</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_1"></a>1.有监督数据增强</h2> 
<h3><a id="11__3"></a>1.1 单样本数据增强</h3> 
<h4><a id="augly_4"></a>augly安装</h4> 
<p>AugLy是一个数据增强库，目前支持四种模式（音频、图像、文本和视频）和100多种增强。每个模态的增强包含在自己的子库中。这些子库包括基于函数和基于类的变换、组合运算符，并可以选择提供有关所应用转换的元数据，包括其强度。</p> 
<p><img src="https://images2.imgbox.com/6d/37/LQzGeoJu_o.png" alt="在这里插入图片描述"><br> 该库基于Python，至少需要Python 3.6+版本、</p> 
<p>官网地址 ：<a href="https://github.com/facebookresearch/AugLy">https://github.com/facebookresearch/AugLy</a><br> 安装该库方法</p> 
<pre><code class="prism language-python">pip install augly<span class="token punctuation">[</span><span class="token builtin">all</span><span class="token punctuation">]</span>
</code></pre> 
<p><mark>也可以只安装某一个应用，比如只安装音频</mark></p> 
<pre><code class="prism language-python">pip install augly<span class="token punctuation">[</span>audio<span class="token punctuation">]</span>
</code></pre> 
<p>也可以克隆git</p> 
<pre><code class="prism language-python">git clone git@github<span class="token punctuation">.</span>com<span class="token punctuation">:</span>facebookresearch<span class="token operator">/</span>AugLy<span class="token punctuation">.</span>git <span class="token operator">&amp;</span><span class="token operator">&amp;</span> cd AugLy
<span class="token punctuation">[</span>Optional<span class="token punctuation">,</span> but recommended<span class="token punctuation">]</span> conda create <span class="token operator">-</span>n augly <span class="token operator">&amp;</span><span class="token operator">&amp;</span> conda activate augly <span class="token operator">&amp;</span><span class="token operator">&amp;</span> conda install pip
pip install <span class="token operator">-</span>e <span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token builtin">all</span><span class="token punctuation">]</span>
</code></pre> 
<h4><a id="augly_32"></a>augly使用方法</h4> 
<p><font color="blue">augly.image所有函数都接受要作为输入增强的图像或PIL图像对象的路径，并返回增强的PIL图像对象。如果指定了输出路径，图像也将保存到文件中。</font></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> augly<span class="token punctuation">.</span>image <span class="token keyword">as</span> imaugs

image_path <span class="token operator">=</span> <span class="token string">"your_img_path.png"</span>
output_path <span class="token operator">=</span> <span class="token string">"your_output_path.png"</span>

aug_image <span class="token operator">=</span> imaugs<span class="token punctuation">.</span>overlay_emoji<span class="token punctuation">(</span>image_path<span class="token punctuation">,</span> opacity<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> emoji_size<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span>

<span class="token comment">#增强功能也可以接受PIL图像作为输入</span>
aug_image <span class="token operator">=</span> imaugs<span class="token punctuation">.</span>pad_square<span class="token punctuation">(</span>aug_image<span class="token punctuation">)</span>

<span class="token comment">#如果指定了输出路径，图像也将保存到文件中</span>
aug_image <span class="token operator">=</span> imaugs<span class="token punctuation">.</span>overlay_onto_screenshot<span class="token punctuation">(</span>aug_image<span class="token punctuation">,</span> output_path<span class="token operator">=</span>output_path<span class="token punctuation">)</span>
</code></pre> 
<p><mark>🎵🕺🗣🏀使用augly与pytorch transforms集成</mark></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms
<span class="token keyword">import</span> augly<span class="token punctuation">.</span>image <span class="token keyword">as</span> imaugs

COLOR_JITTER_PARAMS <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"brightness_factor"</span><span class="token punctuation">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
    <span class="token string">"contrast_factor"</span><span class="token punctuation">:</span> <span class="token number">1.2</span><span class="token punctuation">,</span>
    <span class="token string">"saturation_factor"</span><span class="token punctuation">:</span> <span class="token number">1.4</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

AUGMENTATIONS <span class="token operator">=</span> <span class="token punctuation">[</span>
    imaugs<span class="token punctuation">.</span>Blur<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    imaugs<span class="token punctuation">.</span>ColorJitter<span class="token punctuation">(</span><span class="token operator">**</span>COLOR_JITTER_PARAMS<span class="token punctuation">)</span><span class="token punctuation">,</span>
    imaugs<span class="token punctuation">.</span>OneOf<span class="token punctuation">(</span>
        <span class="token punctuation">[</span>imaugs<span class="token punctuation">.</span>OverlayOntoScreenshot<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imaugs<span class="token punctuation">.</span>OverlayEmoji<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imaugs<span class="token punctuation">.</span>OverlayText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">#一种是应用到PIL图像</span>
image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"your_img_path.png"</span><span class="token punctuation">)</span>
TRANSFORMS <span class="token operator">=</span> imaugs<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>AUGMENTATIONS<span class="token punctuation">)</span>
aug_image <span class="token operator">=</span> TRANSFORMS<span class="token punctuation">(</span>image<span class="token punctuation">)</span>

<span class="token comment">#也可以应用到tensor张量</span>
TENSOR_TRANSFORMS <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>AUGMENTATIONS <span class="token operator">+</span> <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
aug_tensor_image <span class="token operator">=</span> TENSOR_TRANSFORMS<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
</code></pre> 
<p>增强函数方法很多 也可以查看文档<br> <a href="https://augly.readthedocs.io/en/latest/augly.image.html" rel="nofollow">https://augly.readthedocs.io/en/latest/augly.image.html</a></p> 
<h3><a id="12__84"></a>1.2 多样本数据增强</h3> 
<h4><a id="121_SMOTE_85"></a>1.2.1 SMOTE</h4> 
<p>SMOTE全称“Synthetic Minority Over-sampling Technique”<br> 过度采样技术</p> 
<p>主要是针对不平衡的数据集使用。可以采用随机欠采样或过采样技术，对数据集进行调整，使其趋于均衡。</p> 
<p><mark>原理</mark><br> 它是基于随机过采样算法的一种改进方案，由于随机过采样采取简单复制样本的策略来增加少数类样本，这样容易产生模型过拟合的问题，即使得模型学习到的信息过于特别（Specific）而不够泛化（General），算法的基本思想是对少数类样本进行分析并根据少数类样本人工合成新样本添加到数据集中，具体如下图所示：</p> 
<p><img src="https://images2.imgbox.com/83/c4/zqsnL5Fm_o.png" alt="在这里插入图片描述"></p> 
<p><mark>算法流程</mark></p> 
<ol><li>将每一个图像看成是一个特征空间，将特征映射到空间上类似于聚类算法将各数据点展示出来</li><li>对于小样本的图像<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
       
         (x,y) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></span>，按欧式距离找出k个最近邻的样本，从中随机选择一个样本点，选择为近邻点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
         
         
           x 
          
         
           n 
          
         
        
          , 
         
         
         
           y 
          
         
           n 
          
         
        
          ) 
         
        
       
         (x_n,y_n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li><li>将特征空间中的样本点与最近邻的样本点连线。随机选取线上一点作为新的样本（这里的特征空间样本点，也可以是样本的中心聚类中心这种）</li><li>重复1，2，3直到数据集平衡</li></ol> 
<p><mark>算法公式</mark><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
        
        
          x 
         
         
         
           n 
          
         
           e 
          
         
           w 
          
         
        
       
         , 
        
        
        
          y 
         
         
         
           n 
          
         
           e 
          
         
           w 
          
         
        
       
         = 
        
       
         ( 
        
       
         x 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
         + 
        
       
         r 
        
       
         a 
        
       
         n 
        
       
         d 
        
       
         ( 
        
       
         0 
        
       
         , 
        
       
         1 
        
       
         ) 
        
       
         ∗ 
        
       
         ( 
        
       
         ( 
        
        
        
          x 
         
        
          n 
         
        
       
         − 
        
       
         x 
        
       
         ) 
        
       
         , 
        
       
         ( 
        
        
        
          y 
         
        
          n 
         
        
       
         − 
        
       
         y 
        
       
         ) 
        
       
         ) 
        
       
      
        (x_{new},y_{new}=(x,y)+rand(0,1)*((x_n -x),(y_n-y)) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p> 
<h5><a id="python_106"></a>python实现</h5> 
<p>安装</p> 
<pre><code class="prism language-python">pip install imbalanced<span class="token operator">-</span>learn
</code></pre> 
<p>我们将通过一个不平衡的二分类问题来实现SMOTE算法</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> Counter
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> where
<span class="token comment"># 定义数据集</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
	n_clusters_per_class<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> weights<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.99</span><span class="token punctuation">]</span><span class="token punctuation">,</span> flip_y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 汇总类分布</span>
counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
<span class="token comment"># 绘制散点图</span>
<span class="token keyword">for</span> label<span class="token punctuation">,</span> _ <span class="token keyword">in</span> counter<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	row_ix <span class="token operator">=</span> where<span class="token punctuation">(</span>y <span class="token operator">==</span> label<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>row_ix<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>row_ix<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>Counter输出分类汇总({0: 9900, 1: 100})<br> <img src="https://images2.imgbox.com/83/f0/kE7Pzo88_o.png" alt="在这里插入图片描述"><br> 接下来，使用SMOTE对少数类进行过采样，并绘制转换后的数据集。</p> 
<pre><code class="prism language-python">oversample <span class="token operator">=</span> SMOTE<span class="token punctuation">(</span><span class="token punctuation">)</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> oversample<span class="token punctuation">.</span>fit_resample<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
counter <span class="token operator">=</span> Counter<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
<span class="token keyword">for</span> label<span class="token punctuation">,</span> _ <span class="token keyword">in</span> counter<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	row_ix <span class="token operator">=</span> where<span class="token punctuation">(</span>y <span class="token operator">==</span> label<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	pyplot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>row_ix<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>row_ix<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
pyplot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>Counter输出分类汇总({0: 9900, 1: 9900})<br> <img src="https://images2.imgbox.com/ca/a0/5jvatJAt_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="122_SamplePairing_150"></a>1.2.2 SamplePairing</h4> 
<p>Sample是通过样本配对的方法实现数据增强，顾名思义使用几张样本图像，进行图像组合融合来实现数据增强的功能</p> 
<p>Sample Pairing 采用最简单的方法混合两个图像；取两张图片的平均值。它只使用第一个标签并丢弃第二个标签</p> 
<h5><a id="python_156"></a>python实现</h5> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">SamplePairing</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> train_data_dir<span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>train_data_dir <span class="token operator">=</span> train_data_dir
        self<span class="token punctuation">.</span>pool <span class="token operator">=</span> self<span class="token punctuation">.</span>load_dataset<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>p <span class="token operator">=</span> p

    <span class="token keyword">def</span> <span class="token function">load_dataset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dataset_train_raw <span class="token operator">=</span> vdatasets<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">(</span>self<span class="token punctuation">.</span>train_data_dir<span class="token punctuation">)</span>
        <span class="token keyword">return</span> dataset_train_raw

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">:</span>
        toss <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>p<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> toss<span class="token punctuation">:</span>
            img_a_array <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>img<span class="token punctuation">)</span>

            <span class="token comment"># pick one image from the pool</span>
            img_b<span class="token punctuation">,</span> _ <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pool<span class="token punctuation">)</span>
            img_b_array <span class="token operator">=</span> np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>img_b<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment"># mix two images</span>
            mean_img <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">[</span>img_a_array<span class="token punctuation">,</span> img_b_array<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            img <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">(</span>mean_img<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment"># could have used PIL.Image.blend</span>

        <span class="token keyword">return</span> img
</code></pre> 
<h4><a id="123_mixup_188"></a>1.2.3 mixup</h4> 
<p>mixup也是将两个样本图像配对混合在一起，创建新的图像样本</p> 
<p>算法原理，<br> 假设数据和标签的配对<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         x 
        
       
         1 
        
       
         , 
        
       
         y 
        
       
         1 
        
       
         ) 
        
       
         , 
        
       
         ( 
        
       
         x 
        
       
         2 
        
       
         , 
        
       
         y 
        
       
         2 
        
       
         ) 
        
       
      
        (x1,y1),(x2,y2) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span><br> 新的训练样本。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         x 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
      
        (x,y) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> 制作在这里标签<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         1 
        
       
         ， 
        
       
         y 
        
       
         2 
        
       
      
        y1，y2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8388800000000001em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mord">2</span></span></span></span></span></p> 
<p>假设是one-hot表示的向量。<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         1 
        
       
         , 
        
       
         x 
        
       
         2 
        
       
      
        x1,x2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8388800000000001em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mord">2</span></span></span></span></span>是任意的向量或张量</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          x 
         
        
          = 
         
        
          λ 
         
         
         
           x 
          
         
           1 
          
         
        
          + 
         
        
          ( 
         
        
          1 
         
        
          − 
         
        
          λ 
         
        
          ) 
         
         
         
           x 
          
         
           2 
          
         
        
       
         x=\lambda x_1+(1−\lambda)x_2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord mathdefault">λ</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.30110799999999993em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">−</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.30110799999999993em;"><span class="" style="top: -2.5500000000000003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          λ 
         
         
         
           y 
          
         
           1 
          
         
        
          + 
         
        
          ( 
         
        
          1 
         
        
          − 
         
        
          λ 
         
        
          ) 
         
         
         
           y 
          
         
           2 
          
         
        
       
         y=\lambda y_1+(1−\lambda)y_2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 0.8888799999999999em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">λ</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.30110799999999993em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">−</span><span class="mord mathdefault">λ</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.30110799999999993em;"><span class="" style="top: -2.5500000000000003em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br> 在这里<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         λ 
        
       
         ∈ 
        
       
         [ 
        
       
         0 
        
       
         , 
        
       
         1 
        
       
         ] 
        
       
      
        \lambda \in[0,1] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathdefault">λ</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p> 
<h5><a id="python_201"></a>python实现</h5> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np


<span class="token keyword">class</span> <span class="token class-name">MixupGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> datagen<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>X_train <span class="token operator">=</span> X_train
        self<span class="token punctuation">.</span>y_train <span class="token operator">=</span> y_train
        self<span class="token punctuation">.</span>batch_size <span class="token operator">=</span> batch_size
        self<span class="token punctuation">.</span>alpha <span class="token operator">=</span> alpha
        self<span class="token punctuation">.</span>shuffle <span class="token operator">=</span> shuffle
        self<span class="token punctuation">.</span>sample_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>datagen <span class="token operator">=</span> datagen

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            indexes <span class="token operator">=</span> self<span class="token punctuation">.</span>__get_exploration_order<span class="token punctuation">(</span><span class="token punctuation">)</span>
            itr_num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>indexes<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>batch_size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>itr_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
                batch_ids <span class="token operator">=</span> indexes<span class="token punctuation">[</span>i <span class="token operator">*</span> self<span class="token punctuation">.</span>batch_size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>batch_size <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span>
                X<span class="token punctuation">,</span> y <span class="token operator">=</span> self<span class="token punctuation">.</span>__data_generation<span class="token punctuation">(</span>batch_ids<span class="token punctuation">)</span>

                <span class="token keyword">yield</span> X<span class="token punctuation">,</span> y

    <span class="token keyword">def</span> <span class="token function">__get_exploration_order</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        indexes <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sample_num<span class="token punctuation">)</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>shuffle<span class="token punctuation">:</span>
            np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>indexes<span class="token punctuation">)</span>

        <span class="token keyword">return</span> indexes

    <span class="token keyword">def</span> <span class="token function">__data_generation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> batch_ids<span class="token punctuation">)</span><span class="token punctuation">:</span>
        _<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c <span class="token operator">=</span> self<span class="token punctuation">.</span>X_train<span class="token punctuation">.</span>shape
        _<span class="token punctuation">,</span> class_num <span class="token operator">=</span> self<span class="token punctuation">.</span>y_train<span class="token punctuation">.</span>shape
        X1 <span class="token operator">=</span> self<span class="token punctuation">.</span>X_train<span class="token punctuation">[</span>batch_ids<span class="token punctuation">[</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">]</span><span class="token punctuation">]</span>
        X2 <span class="token operator">=</span> self<span class="token punctuation">.</span>X_train<span class="token punctuation">[</span>batch_ids<span class="token punctuation">[</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        y1 <span class="token operator">=</span> self<span class="token punctuation">.</span>y_train<span class="token punctuation">[</span>batch_ids<span class="token punctuation">[</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">]</span><span class="token punctuation">]</span>
        y2 <span class="token operator">=</span> self<span class="token punctuation">.</span>y_train<span class="token punctuation">[</span>batch_ids<span class="token punctuation">[</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        l <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>beta<span class="token punctuation">(</span>self<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span> self<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span> self<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span>
        X_l <span class="token operator">=</span> l<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        y_l <span class="token operator">=</span> l<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

        X <span class="token operator">=</span> X1 <span class="token operator">*</span> X_l <span class="token operator">+</span> X2 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> X_l<span class="token punctuation">)</span>
        y <span class="token operator">=</span> y1 <span class="token operator">*</span> y_l <span class="token operator">+</span> y2 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y_l<span class="token punctuation">)</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>datagen<span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
                X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>datagen<span class="token punctuation">.</span>random_transform<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> X<span class="token punctuation">,</span> y
</code></pre> 
<h2><a id="2_257"></a>2.无监督数据增强</h2> 
<h3><a id="21_GAN_258"></a>2.1 GAN</h3> 
<p>最常见的就是GAN，其原理可以阅读鄙人的这篇文章<br> <a href="https://blog.csdn.net/weixin_42010722/article/details/122827355">Generative Model - 李宏毅笔记</a></p> 
<h3><a id="22_Diffunsion_261"></a>2.2 Diffunsion</h3> 
<p>还有以及现在最火的ai 扩散算法，原理也可以阅读下面这篇文章</p> 
<p><a href="https://blog.csdn.net/weixin_42010722/article/details/127861427">Diffusion Model算法</a></p> 
<h3><a id="23_Autoaugmentation_265"></a>2.3 Autoaugmentation</h3> 
<p>AutoAugment是Google提出的自动选择最优数据增强方案的研究，这是无监督数据增强的重要研究方向。它的基本思路是使用增强学习从数据本身寻找最佳图像变换策略</p> 
<p><img src="https://images2.imgbox.com/4b/81/YGcaliHY_o.png" alt="在这里插入图片描述" width="400" height="200"></p> 
<p>例如指导基本图像转换操作的选择，例如水平/垂直翻转图像、旋转图像、更改图像颜色等。AutoAugment不仅预测要组合哪些图像转换，还可以预测所用变换的每个图像概率和大小，因此图像并不总是以相同的方式进行操作。AutoAugment能够大量的图像转换可能性的搜索空间中选择最佳策略。</p> 
<p>AutoAugment根据运行的数据集学习不同的转换。例如，对于涉及房屋号码街景（SVHN）的图像，包括数字的自然场景图像，AutoAugment专注于剪切和平移等几何变换，这些变换代表了该数据集中常见的失真。此外，鉴于世界上不同建筑和房屋编号材料的多样性，AutoAugment已经学会了完全反转原始SVHN数据集中自然出现的颜色。<br> <img src="https://images2.imgbox.com/14/44/J7v7EzU7_o.png" alt="在这里插入图片描述" width="400" height="200"><br> <mark>简单说就是AutoAugment，自己不需要去设定需要增强的元素，算法会自动结合所有的增强策略选择最优的策略进行输出，输出一个增强后的图像</mark></p> 
<p>DeepAugment是一个专注于数据增强的AutoML工具。它利用贝叶斯优化来发现您的图像数据集的特点，并量身定制的数据增强策略。DeepAugment的主要优势和特点是：</p> 
<ul><li>降低CNN模型的错误率</li><li>通过自动化流程节省时间</li><li>比谷歌之前的解决方案快50倍-AutoAugment</li></ul> 
<p>安装</p> 
<pre><code class="prism language-python">pip install deepaugment
</code></pre> 
<p>使用方法</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> deepaugment<span class="token punctuation">.</span>deepaugment <span class="token keyword">import</span> DeepAugment

deepaug <span class="token operator">=</span> DeepAugment（my_images，my_labels）

best_policies <span class="token operator">=</span> deepaug<span class="token punctuation">.</span>optimize<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过配置DeepAugment，实现增强用法</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> cifar10

<span class="token comment"># my configuration</span>
my_config <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"model"</span><span class="token punctuation">:</span> <span class="token string">"basiccnn"</span><span class="token punctuation">,</span>
    <span class="token string">"method"</span><span class="token punctuation">:</span> <span class="token string">"bayesian_optimization"</span><span class="token punctuation">,</span>
    <span class="token string">"train_set_size"</span><span class="token punctuation">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
    <span class="token string">"opt_samples"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">"opt_last_n_epochs"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">"opt_initial_points"</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token string">"child_epochs"</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token string">"child_first_train_epochs"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">"child_batch_size"</span><span class="token punctuation">:</span> <span class="token number">64</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> cifar10<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># X_train.shape -&gt; (N, M, M, 3)</span>
<span class="token comment"># y_train.shape -&gt; (N)</span>
deepaug <span class="token operator">=</span> DeepAugment<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> config<span class="token operator">=</span>my_config<span class="token punctuation">)</span>

best_policies <span class="token operator">=</span> deepaug<span class="token punctuation">.</span>optimize<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre> 
<p>CIFAR-10在WRN-28-10上测试的最佳政策</p> 
<p>方法：Wide-ResNet-28-10通过最佳策略使用CIFAR-10增强图像和未增强图像（其他一切相同）进行训练。</p> 
<p>结果：DeepAugment的误差减少60%（准确率提高8.5%）</p> 
<p><img src="https://images2.imgbox.com/0c/22/OTDiRfRn_o.png" alt="在这里插入图片描述" width="400" height="200"><br> <img src="https://images2.imgbox.com/ee/03/ELcSIWdv_o.png" alt="在这里插入图片描述" width="400" height="200"></p> 
<p>有关更详细的安装/使用信息 参考官方地址<br> <a href="https://github.com/barisozmen/deepaugment">https://github.com/barisozmen/deepaugment</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9fa799a7f400fe19a9855ebc4f599d0a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">GEE开发之Modis_NDVI数据分析获取大总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fe20d513e0024a86eabb9df0afb7bd6f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【已解决】Win 10 切换程序时，默认输入法始终为英文，抓狂，解决办法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>