<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Tomcat8 安装drools7.11 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Tomcat8 安装drools7.11" />
<meta property="og:description" content="一、Tomcat8 安装drools7.11 1、workbench简单介绍 workbench 在我看来是一个drools web端的工具，它集成了git，maven和drools。能过帮我们快速的编写一个规则。废话不多说，我们开始搭建workbench。
2、workbench环境 Tomcat8（（我用的是8.5这个版本，必须要tomcat 8以上不然会报错））
jdk8
3、workbench下载 下载地址：https://download.jboss.org/drools/release/7.11.0.Final/
我们可以看到目前 7.48版本已经不支持tomcat，而是用WildFly搭建。最后一个支持Tomcat的版本是7.11.0.Final。
不过往下翻就能看到可以下载历史版本
我们下载kie-drools-wb-7.11.0.Final-tomcat8.war 就ok了
4、修改Tomcat配置 1、部署 把kie-drools-wb（workbench）的war包解压缩放到tomcat webapps下（将名字改成kie-drools-wb）
2、配置JEE安全性 1、添加jar包 把drools 相关的jar下载好放到lib下（5个jar）
包括kie-tomcat-integration、JACC和slf4j-api三个JAR包(自己从maven仓库下载)复制到tomcat的lib目录下 (不加入两个jackson的两个包tomcat启动时会报抱不到jackson相关的类的错误，从maven下载kie包注意版本号)
大家自行在maven仓库中下载。
2、JACC配置 修改Tomcat的server.xml配置文件
在server.xml加入以下内容：
&lt;Valve className=&#34;org.kie.integration.tomcat.JACCValve&#34; /&gt; 如图：
3、添加用户 在config目录下的tomcat-users.xml文件中添加角色和用户名，注意确保至少有admin角色或者analyst其中一个角色
&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39;?&gt; &lt;tomcat-users xmlns=&#34;http://tomcat.apache.org/xml&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://tomcat.apache.org/xml tomcat-users.xsd&#34; version=&#34;1.0&#34;&gt; &lt;role rolename=&#34;manager&#34;/&gt; &lt;role rolename=&#34;admin&#34;/&gt; &lt;role rolename=&#34;analyst&#34;/&gt; &lt;role rolename=&#34;kie-server&#34;/&gt; &lt;role rolename=&#34;user&#34;/&gt; &lt;role rolename=&#34;manager-gui&#34;/&gt; &lt;user username=&#34;tomcat&#34; password=&#34;tomcat&#34; roles=&#34;admin,manager,manager-gui,kie-server,analyst&#34;/&gt; &lt;user username=&#34;kieserver&#34; password=&#34;kieserver1!&#34; roles=&#34;kie-server,admin&#34;/&gt; &lt;/tomcat-users&gt; 说明：角色必须有kie-server。必须有kieserver用户，并且密码必须是keiserver1!。因为kie-server注册时默认用户名和密码就是这个。如果不用默认密码。需要在setenv.sh文件中添加。
5、定义系统属性 在tomcat的bin目录下创建setenv." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3b52b1118ecce95b251be88eb02bcbda/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-07T10:46:51+08:00" />
<meta property="article:modified_time" content="2021-02-07T10:46:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Tomcat8 安装drools7.11</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Tomcat8_drools711_0"></a>一、Tomcat8 安装drools7.11</h2> 
<h3><a id="1workbench_2"></a>1、workbench简单介绍</h3> 
<p>workbench 在我看来是一个drools web端的工具，它集成了git，maven和drools。能过帮我们快速的编写一个规则。废话不多说，我们开始搭建workbench。</p> 
<h3><a id="2workbench_6"></a>2、workbench环境</h3> 
<ul><li> <p>Tomcat8（（我用的是8.5这个版本，必须要tomcat 8以上不然会报错））</p> </li><li> <p>jdk8</p> </li></ul> 
<h3><a id="3workbench_14"></a>3、workbench下载</h3> 
<p>下载地址：https://download.jboss.org/drools/release/7.11.0.Final/</p> 
<p>我们可以看到目前 7.48版本已经不支持tomcat，而是用WildFly搭建。最后一个支持Tomcat的版本是7.11.0.Final。</p> 
<p>不过往下翻就能看到可以下载历史版本</p> 
<p><img src="https://images2.imgbox.com/ef/2a/a4QGOg0i_o.png" alt="在这里插入图片描述"></p> 
<p>我们下载kie-drools-wb-7.11.0.Final-tomcat8.war 就ok了</p> 
<p><img src="https://images2.imgbox.com/f7/6a/OBhZSHpA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4Tomcat_30"></a>4、修改Tomcat配置</h3> 
<h4><a id="1_32"></a>1、部署</h4> 
<p>把kie-drools-wb（workbench）的war包解压缩放到tomcat webapps下（将名字改成kie-drools-wb）</p> 
<h4><a id="2JEE_36"></a>2、配置JEE安全性</h4> 
<h5><a id="1jar_38"></a>1、添加jar包</h5> 
<p>把drools 相关的jar下载好放到lib下（5个jar）</p> 
<p>包括kie-tomcat-integration、JACC和slf4j-api三个JAR包(自己从maven仓库下载)复制到tomcat的lib目录下 (不加入两个jackson的两个包tomcat启动时会报抱不到jackson相关的类的错误，从maven下载kie包注意版本号)</p> 
<p><img src="https://images2.imgbox.com/ab/f7/gBwLHlLr_o.png" alt="在这里插入图片描述"></p> 
<p>大家自行在maven仓库中下载。</p> 
<h5><a id="2JACC_49"></a>2、JACC配置</h5> 
<p>修改Tomcat的server.xml配置文件</p> 
<p>在server.xml加入以下内容：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.kie.integration.tomcat.JACCValve<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p>如图：</p> 
<p><img src="https://images2.imgbox.com/c1/fc/fwXyNmIX_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3_64"></a>3、添加用户</h5> 
<p>在config目录下的tomcat-users.xml文件中添加角色和用户名，注意确保至少有admin角色或者analyst其中一个角色</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tomcat-users</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://tomcat.apache.org/xml<span class="token punctuation">"</span></span>
              <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
              <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://tomcat.apache.org/xml tomcat-users.xsd<span class="token punctuation">"</span></span>
              <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>manager<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>admin<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>analyst<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kie-server<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>manager-gui<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">username</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tomcat<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tomcat<span class="token punctuation">"</span></span> <span class="token attr-name">roles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>admin,manager,manager-gui,kie-server,analyst<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">username</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kieserver<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kieserver1!<span class="token punctuation">"</span></span> <span class="token attr-name">roles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kie-server,admin<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tomcat-users</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<p>说明：角色必须有kie-server。必须有kieserver用户，并且密码必须是keiserver1!。因为kie-server注册时默认用户名和密码就是这个。如果不用默认密码。需要在setenv.sh文件中添加。</p> 
<h3><a id="5_88"></a>5、定义系统属性</h3> 
<p>在tomcat的bin目录下创建setenv.bat文件(<strong>注意linux是setenv.sh文件</strong>)，并写入以下内容（注意空格)：</p> 
<pre><code class="prism language-shell">CATALINA_OPTS<span class="token operator">=</span><span class="token string">"-Xmx1024M  -Djava.security.auth.login.config=<span class="token variable">$CATALINA_HOME</span>/webapps/kie-drools-wb/WEB-INF/classes/login.config  -Dorg.jboss.logging.provider=jdk"</span>
</code></pre> 
<h3><a id="6Tomcat_96"></a>6、启动Tomcat</h3> 
<pre><code class="prism language-shell">./bin/startup.sh
</code></pre> 
<h3><a id="7_104"></a>7、登录</h3> 
<p>已经搭建完成，最后测试登录，输入地址：</p> 
<p>http://localhost:8080/kie-drools-wb/kie-drools-wb.jsp</p> 
<p>根据tomcat-users.xml里的配置输入用户名和密码，此处输入用户名是kieserver,密码是aaaaaa，回车登录</p> 
<p>如图：</p> 
<p><img src="https://images2.imgbox.com/25/6e/g75Ypqwb_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/d4/f9/jeD7ilql_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>如果安装不成功。可以去我配置好的资源文件中下载。下载地址为：<br> https://download.csdn.net/download/h_and_g/15116860</p> 
</blockquote> 
<h2><a id="Tomcat9kieserver_120"></a>二、Tomcat9安装kie-server</h2> 
<h3><a id="1kieserver_122"></a>1、kie-server简单介绍</h3> 
<p>kiserver是我们的定义的业务流程和业务规则的执行的地方，他提供执行引擎，来解释执行这些流程和规则 。kie-server就是一个war包，可以部署到我们的web服务器上，比如tomcat或者wildfly。</p> 
<h3><a id="2kieserver_126"></a>2、kie-server安装环境</h3> 
<ul><li>Tomcat9</li><li>jdk8</li></ul> 
<h3><a id="3kieserver_131"></a>3、kie-server下载</h3> 
<p>下载地址：https://download.jboss.org/drools/release/</p> 
<p>现在的版本是7.48，我们往下翻，会看到：Other downloads。如下图。</p> 
<p><img src="https://images2.imgbox.com/8c/70/HAhA5rb7_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/1a/79/SVmFqxMi_o.png" alt="在这里插入图片描述"></p> 
<p>点击上面红框，进入下载页面。或者直接用上面的下载地址。</p> 
<p>选择你需要的版本。我这里用的是最后一个支持Tomcat的版本7.11.0.Final。</p> 
<p><img src="https://images2.imgbox.com/5d/d4/NHs7uOav_o.png" alt="在这里插入图片描述"></p> 
<p>点进去。</p> 
<p><img src="https://images2.imgbox.com/86/bd/soZEo7ve_o.png" alt="在这里插入图片描述"></p> 
<p>我们下载kie-server-distribution-7.11.0.Final.zip。</p> 
<p>解压，我们发现里面有五个文件，如下图：</p> 
<p><img src="https://images2.imgbox.com/30/17/XYj5988T_o.png" alt="在这里插入图片描述"></p> 
<p>我们用kie-server-7.11.0.Final-webc.war这个包，并将名字改为kie-server.war。</p> 
<h3><a id="4Tomcat_168"></a>4、修改Tomcat配置</h3> 
<h4><a id="1_170"></a>1、部署</h4> 
<p>jdk1.8和Tomcat9的下载和安装比较简单，这里就省略了。</p> 
<p>将下载并修改名称后的kie-server.war包放到Tomcat的webapps目录下。</p> 
<h4><a id="2jar_176"></a>2、添加jar包</h4> 
<p>把drools 相关的jar下载好放到lib下（5个jar）</p> 
<ul><li>javax.security.jacc:javax.security.jacc-api</li><li>org.kie:kie-tomcat-integration</li><li>org.slf4j:artifactId=slf4j-api</li><li>org.slf4j:artifactId=slf4j-jdk14</li><li>com.h2database:h2 （H2数据库的驱动包，根据你使用的数据库下载相应的驱动包）</li></ul> 
<p>包括kie-tomcat-integration、JACC、slf4j-api和slf4j-jdk14四个JAR包(自己从maven仓库下载)复制到tomcat的lib目录下 。</p> 
<p>由于官方安装步骤里面用的是H2数据库，所以这里为了尽量少该配置，沿用了H2数据库，因此下载的是H2数据库的驱动包。</p> 
<p>如下图：</p> 
<p><img src="https://images2.imgbox.com/2e/53/l16lL5ar_o.png" alt="在这里插入图片描述"></p> 
<p>大家自行在maven仓库中下载。</p> 
<p>H2数据库的驱动包的版本要注意，如果下载1.4.200后，项目启动后会报MVCC错误。如下：</p> 
<pre><code class="prism language-log">Caused by:
        org.h2.jdbc.JdbcSQLNonTransientConnectionException: Datenbank-Verbindungs Option "MVCC" nicht unterst³tzt
        Unsupported connection setting "MVCC" [90113-200]
</code></pre> 
<p>因为H2在1.4.200这个版本后，H2取消了对内存中DBs的MCVV支持，所以我这里用的是1.4.197版本。</p> 
<h4><a id="3JACC_207"></a>3、JACC配置</h4> 
<p>修改Tomcat的server.xml配置文件</p> 
<p>在server.xml加入以下内容：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.kie.integration.tomcat.JACCValve<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p>如图：</p> 
<p><img src="https://images2.imgbox.com/17/38/kJsuxUMN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4_222"></a>4、添加用户</h4> 
<p>在config目录下的tomcat-users.xml文件中添加角色和用户名，注意确保至少有admin角色或者analyst其中一个角色</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tomcat-users</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://tomcat.apache.org/xml<span class="token punctuation">"</span></span>
              <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
              <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://tomcat.apache.org/xml tomcat-users.xsd<span class="token punctuation">"</span></span>
              <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>manager<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>admin<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>analyst<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kie-server<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>role</span> <span class="token attr-name">rolename</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>manager-gui<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">username</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tomcat<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tomcat<span class="token punctuation">"</span></span> <span class="token attr-name">roles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>admin,manager,manager-gui,kie-server,analyst<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">username</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kieserver<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kieserver1!<span class="token punctuation">"</span></span> <span class="token attr-name">roles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>kie-server,admin<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tomcat-users</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<p>说明：<code>角色必须有kie-server。必须有kieserver用户，并且密码必须是keiserver1!。因为kie-server注册时默认用户名和密码就是这个。如果不用默认密码。需要在setenv.sh文件中添加。</code></p> 
<p>如果不是默认的也没有配置的话，启动日志里面会报401错误。</p> 
<h4><a id="5_248"></a>5、配置数据源</h4> 
<p>编辑***TOMCAT_HOME/conf/context.xml***文件，添加以下内容：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Resource</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sharedDataSource<span class="token punctuation">"</span></span>
          <span class="token attr-name">auth</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Container<span class="token punctuation">"</span></span>
          <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.h2.jdbcx.JdbcDataSource<span class="token punctuation">"</span></span>
          <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sa<span class="token punctuation">"</span></span>
          <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sa<span class="token punctuation">"</span></span>
          <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MVCC=TRUE<span class="token punctuation">"</span></span>
          <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>H2 Data Source<span class="token punctuation">"</span></span>
          <span class="token attr-name">loginTimeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>
          <span class="token attr-name">testOnBorrow</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
          <span class="token attr-name">factory</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.h2.jdbcx.JdbcDataSourceFactory<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> 
<h4><a id="6_265"></a>6、定义系统属性</h4> 
<p>在tomcat的bin目录下创建setenv.sh文件(<strong>注意windows系统是setenv.bat文件</strong>)，并写入以下内容（注意空格)：</p> 
<pre><code class="prism language-shell">CATALINA_OPTS<span class="token operator">=</span><span class="token string">"-Xmx512M -Djbpm.tsr.jndi.lookup=java:comp/env/TransactionSynchronizationRegistry -Dorg.kie.server.persistence.ds=java:comp/env/jdbc/jbpm -Djbpm.tm.jndi.lookup=java:comp/env/TransactionManager -Dorg.kie.server.persistence.tm=JBossTS -Dhibernate.connection.release_mode=after_transaction -Dorg.kie.server.id=tomcat-kieserver -Dorg.kie.server.location=http://localhost:8080/kie-server/services/rest/server -Dorg.kie.server.controller=http://localhost:8080/kie-wb/rest/controller"</span>
</code></pre> 
<p>最后三个参数需要重新配置，因为它们依赖于它们运行的实际环境:</p> 
<ul><li>实际的kie服务器id，用于识别给定的kie服务器</li></ul> 
<pre><code class="prism language-shell">-Dorg.kie.server.id<span class="token operator">=</span>kie-server
</code></pre> 
<ul><li>kie服务器通过HTTP的实际位置</li></ul> 
<pre><code class="prism language-shell">-Dorg.kie.server.location<span class="token operator">=</span>http://localhost:8080/kie-server/services/rest/server
</code></pre> 
<ul><li>控制器的位置，以防kie服务器应该在托管模式下运行</li></ul> 
<pre><code class="prism language-shell">-Dorg.kie.server.controller<span class="token operator">=</span>http://localhost:8080/kie-wb/rest/controller
</code></pre> 
<h4><a id="7XA_293"></a>7、配置XA</h4> 
<p>在Tomcat的conf目录下创建xa-recovery-properties.xml文件。添加如下内容：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token doctype">&lt;!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd"&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabaseUser<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>sa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabasePassword<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>sa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabaseDynamicClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabaseURL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>java:comp/env/h2DataSource<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>这里需要特别注意：最后一个java:comp/env/h2DataSource</p> 
<p>中的h2DataSource一定要修改，修改为在context.xml中配置的name值，既是sharedDataSource；</p> 
<p>否则无法找到数据源。</p> 
<p>替换后的配置如下：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token doctype">&lt;!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd"&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabaseUser<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>sa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabasePassword<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>sa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabaseDynamicClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_1_DatabaseURL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>java:comp/env/sharedDataSource<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>最后在setenv.sh文件中增加读取这个文件的配置。在这个文件中追加如下配置。</p> 
<pre><code class="prism language-shell">-Dcom.arjuna.ats.jta.recovery.XAResourceRecovery1<span class="token operator">=</span>com.arjuna.ats.internal.jdbc.recovery.BasicXARecovery\<span class="token punctuation">;</span>abs://<span class="token variable">$CATALINA_HOME</span>/conf/xa-recovery-properties.xml\ \<span class="token punctuation">;</span>1
</code></pre> 
<p>配置后的整个setenv.sh的内容为：</p> 
<pre><code class="prism language-shell">CATALINA_OPTS<span class="token operator">=</span><span class="token string">"-Xmx512M \
        -Djbpm.tsr.jndi.lookup=java:comp/env/TransactionSynchronizationRegistry \
        -Dorg.kie.server.persistence.ds=java:comp/env/jdbc/jbpm \
        -Djbpm.tm.jndi.lookup=java:comp/env/TransactionManager \
        -Dorg.kie.server.persistence.tm=JBossTS \
        -Dhibernate.connection.release_mode=after_transaction \
        -Dorg.kie.server.id=kie-server \
        -Dorg.kie.server.location=http://localhost:8080/kie-server/services/rest/server \
        -Dorg.kie.server.controller=http://localhost:9090/kie-drools-wb/rest/controller\
        -Dcom.arjuna.ats.jta.recovery.XAResourceRecovery1=com.arjuna.ats.internal.jdbc.recovery.BasicXARecovery\;abs://<span class="token variable">$CATALINA_HOME</span>/conf/xa-recovery-properties.xml\ \;1"</span>
</code></pre> 
<h3><a id="6_348"></a>6、启动</h3> 
<pre><code class="prism language-shell">./bin/startup.sh
</code></pre> 
<h3><a id="7_354"></a>7、验证</h3> 
<p>启动成功，在浏览器中输入：</p> 
<p>http://ip:8080/kie-server/services/rest/server</p> 
<p>出现以下内容：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>response</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SUCCESS<span class="token punctuation">"</span></span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Kie Server info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kie-server-info</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>KieServer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>BRM<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>BPM<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>CaseMgmt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>BPM-UI<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>BRP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>DMN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>capabilities</span><span class="token punctuation">&gt;</span></span>Swagger<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>capabilities</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>http://localhost:8080/kie-server/services/rest/server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>messages</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>content</span><span class="token punctuation">&gt;</span></span>Server KieServerInfo{serverId='kie-server', version='7.11.0.Final', name='kie-server', location='http://localhost:8080/kie-server/services/rest/server', capabilities=[KieServer, BRM, BPM, CaseMgmt, BPM-UI, BRP, DMN, Swagger], messages=null}started successfully at Thu Feb 04 16:01:37 CST 2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>content</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>severity</span><span class="token punctuation">&gt;</span></span>INFO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>severity</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timestamp</span><span class="token punctuation">&gt;</span></span>2021-02-04T16:01:37.993+08:00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timestamp</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>messages</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>kie-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>kie-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.11.0.Final<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kie-server-info</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>response</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>表示启动成功。</p> 
<p>验证是否已经注册到workbench中。登录上面安装的workbench服务器管理页面。</p> 
<p><img src="https://images2.imgbox.com/f8/ba/k6RR0jaF_o.png" alt="在这里插入图片描述"></p> 
<p>点击servers。进入如图所示的页面，表示安装成功。</p> 
<p><img src="https://images2.imgbox.com/2b/a4/6FBQMTEF_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>如果安装不成功。可以去我配置好的资源文件中下载。下载地址为：<br> https://download.csdn.net/download/h_and_g/15116877</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e48a823466785e24c46dfe38d66fc2a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java 银行项目对于金额的面试题_java发布项目后注意小点，以及对于金额在java中的处理...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/773aa2be6c34132351c4732785e66305/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">css常见问题总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>