<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>YII2.0框架(三) 缓存机制yii\caching\Cache - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="YII2.0框架(三) 缓存机制yii\caching\Cache" />
<meta property="og:description" content="摘自：http://www.yiichina.com/doc/guide/2.0/caching-data
一、Yii 缓存机制
1.数据缓存
$cache = new \yii\caching\FileCache(); //文件缓存
$key = &#39;name&#39;;
$value = &#39;value11111111111&#39;;
$duration = 100;
$data = [
[&#39;name&#39; =&gt; &#39;name&#39;],
[&#39;value&#39; =&gt; &#39;value&#39;]
];
$exists = $cache-&gt;exists($key); //检查指定的键是否存在缓存中
$buildKey = $cache-&gt;buildKey($key); //检查指定的键是否存在缓存中,超过32位使用MD5加密
$get = $cache-&gt;get($key); //从缓存中取得指定键的值
$set = $cache-&gt;set($key, $value, $duration); //将指定键的值存储在缓存中
$multiSet = $cache-&gt;multiSet($data, $duration); //将多条数据存在缓存中
$add = $cache-&gt;add($key, $value, $duration); //将多条数据存在缓存中
$delete = $cache-&gt;delete($key); //删除指定键值的数据
$flush = $cache-&gt;flush($key); //从缓存中删除所有数据 2.片段缓存
&lt;?php
/*@var $this yii\web\View*/" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6ffb1b11d736518fcf49c2e7a1555cef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-05-08T16:59:26+08:00" />
<meta property="article:modified_time" content="2017-05-08T16:59:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">YII2.0框架(三) 缓存机制yii\caching\Cache</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-size:18px"><strong><span style="font-size:24px"><span style="font-size:18px; color:#009900">摘自：http://www.yiichina.com/doc/guide/2.0/caching-data</span><br> </span></strong></span></p> 
<p><span style="font-size:18px"><strong><span style="font-size:24px">一、Yii 缓存机制</span></strong></span></p> 
<span style="font-size:18px"><strong>1.数据缓存</strong><br>         $cache = new \yii\caching\FileCache();<span style="color:#FF0000"> //文件缓存</span><br>         $key = 'name';<br>         $value = 'value11111111111';<br>         $duration = 100;<br>         $data = [<br>             ['name' =&gt; 'name'],<br>             ['value' =&gt; 'value']<br>         ];<br>         $exists = $cache-&gt;exists($key);<span style="color:#FF0000"> //检查指定的键是否存在缓存中</span><br>         $buildKey = $cache-&gt;buildKey($key); <span style="color:#FF0000">//检查指定的键是否存在缓存中,超过32位使用MD5加密</span><br>         $get = $cache-&gt;get($key);<span style="color:#FF0000"> //从缓存中取得指定键的值</span><br>         $set = $cache-&gt;set($key, $value, $duration); <span style="color:#FF0000"> //将指定键的值存储在缓存中</span><br>         $multiSet = $cache-&gt;multiSet($data, $duration);<span style="color:#FF0000"> //将多条数据存在缓存中</span><br>         $add = $cache-&gt;add($key, $value, $duration); <span style="color:#FF0000"> //将多条数据存在缓存中</span><br>         $delete = $cache-&gt;delete($key); <span style="color:#FF0000">//删除指定键值的数据</span><br>         $flush = $cache-&gt;flush($key); <span style="color:#FF0000">//从缓存中删除所有数据</span>    <br> <strong>2.片段缓存</strong><br> &lt;?php<br> /*@var $this yii\web\View*/<br> $denpendency = [<br>     'class' =&gt; 'yii\caching\FileDenpendency',<br> ];<br> $key = 'section';<br> $duration = 5;<br> $dependency = [ <span style="color:#FF0000">//文件缓存依赖</span><br>     'class' =&gt; 'yii\caching\FileDenpendency',<br> ];<br> $denpendency = [ <span style="color:#FF0000">//数据库查询缓存依赖</span><br>     'calss' =&gt; 'yii\caching\DbDenpendency',<br>     'sql' =&gt; 'SELECT * FROM tb_admin',<br> ];<br> <br> if ($this-&gt;beginCache($key, ['duration' =&gt; $duration], ['dependency' =&gt; $dependency],<br> <br> ['variations' =&gt; \Yii::$app-&gt;language])) {<!-- --><br>     <br>     echo '该页面数据缓存';<br> <br>     $this-&gt;endCache();<br> }<br> <br> ?&gt;<br> <strong>3.页面缓存<span style="font-size:18px"><span style="color:#FF0000">(服务器端缓存)</span></span></strong><br>     /**<br>      * @desc 控制器行为<br>      */<br>     public function behaviors() <br>     {<!-- --><br>         return [<br>             [<br>                 'class' =&gt; 'yii\filters\PageCache', <span style="color:#FF0000">//页面缓存(服务器端缓存)</span><br>                 'only' =&gt; ['index'],<br>                 'duration' =&gt; 60,<br>                 'variations' =&gt; Yii::$app-&gt;language,<br>                 'dependency' =&gt; [<br>                     'class' =&gt; 'yii\caching\DbDependency',<br>                     'sql' =&gt; 'SELECT * FROM tb_user',<br>                 ]<br>             ],<br>         ];<br>     }<br> <strong>4.HTTP缓存<span style="font-size:18px"><span style="color:#FF0000">（客户端缓存）</span></span></strong><br>     /**<br>      * @desc 控制器行为<br>      */<br>     public function behaviors() <br>     {<!-- --><br>         return [<br>             [<br>                 'class' =&gt; 'yii\filters\HttpCache',<span style="color:#FF0000"> //http缓存(客户端缓存 )</span><br>                 'only' =&gt; ['input'],<br>                 <span style="color:#FF0000">/*Last-Modified 头使用时间戳标明页面自上次客户端缓存后是否被修改过。*/</span><br>                 'lastModified' =&gt; function($action, $params) {<!-- --><br>                     $query = new \yii\db\Query();<br>                     return strtotime($query-&gt;from('tb_admin')-&gt;max('created')); <span style="color:#FF0000"> //当数据中最大时间改变,缓存失效</span><br>                 },<br>                 <span style="color:#FF0000">/*“Entity Tag”（实体标签，简称 ETag）使用一个哈希值表示页面内容。如果页面 被修改过，哈希值也会随之改变。通过对比客户端的哈希值和服务器端生成的哈 希值，浏览器就能判断页面是否被修改过，进而决定是否应该重新传输内容*/</span><br>                 'etagSeed' =&gt; function($action, $params) { <br>                     $post = $this-&gt;findModel(\Yii::$app-&gt;request-&gt;get('id'));<br>                     return serialize([$post-&gt;title, $post-&gt;content]);<br>                 }<br>             ]<br>         ];<br>     }</span>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c06e2cb52108cb162549dd48aee80cbf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">页面引用bootstrap报错Bootstrap&#39;s JavaScript requires jQuery</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a251141fb1ad29c6762c8e9afeaf227f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据库设计 - 01外卖配送系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>