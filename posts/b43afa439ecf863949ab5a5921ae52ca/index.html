<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>redis学习 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="redis学习" />
<meta property="og:description" content="数据类型 String（字符串）： SET,GET
其他关于string命令
GETRANGE key start end 返回 key 中字符串值的子字符
GETSET key value
将给定 key 的值设为 value ，并返回 key 的旧值(old value)。
GETBIT key offset
对 key 所储存的字符串值，获取指定偏移量上的位(bit)。
MGET key1 [key2…]
获取所有(一个或多个)给定 key 的值。
SETBIT key offset value
对 key 所储存的字符串值，设置或清除指定偏移量上的位(bit)。
SETEX key seconds value
将值 value 关联到 key ，并将 key 的过期时间设为 seconds (以秒为单位)。
SETNX key value
只有在 key 不存在时设置 key 的值。
SETRANGE key offset value
用 value 参数覆写给定 key 所储存的字符串值，从偏移量 offset 开始。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b43afa439ecf863949ab5a5921ae52ca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-27T11:32:53+08:00" />
<meta property="article:modified_time" content="2021-07-27T11:32:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">redis学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_1"></a>数据类型</h3> 
<h4><a id="String_2"></a>String（字符串）：</h4> 
<p>SET,GET<br> <img src="https://images2.imgbox.com/72/ef/wODMR3xp_o.png" alt="在这里插入图片描述"></p> 
<p>其他关于string命令</p> 
<p>GETRANGE key start end 返回 key 中字符串值的子字符<br> <img src="https://images2.imgbox.com/a4/b4/VhZc6zWO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7f/fa/65ZFCmfT_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/44/33/31K8oRMX_o.png" alt="在这里插入图片描述"></p> 
<p>GETSET key value<br> 将给定 key 的值设为 value ，并返回 key 的旧值(old value)。</p> 
<p><img src="https://images2.imgbox.com/e1/39/eD9KgzAH_o.png" alt="在这里插入图片描述"></p> 
<p>GETBIT key offset<br> 对 key 所储存的字符串值，获取指定偏移量上的位(bit)。<br> <img src="https://images2.imgbox.com/c5/45/dxGu7nP5_o.png" alt="在这里插入图片描述"></p> 
<p>MGET key1 [key2…]<br> 获取所有(一个或多个)给定 key 的值。<br> <img src="https://images2.imgbox.com/59/af/Txn3xUQZ_o.png" alt="在这里插入图片描述"><br> SETBIT key offset value<br> 对 key 所储存的字符串值，设置或清除指定偏移量上的位(bit)。<br> <img src="https://images2.imgbox.com/9a/47/IowII7Fo_o.png" alt="在这里插入图片描述"></p> 
<p>SETEX key seconds value<br> 将值 value 关联到 key ，并将 key 的过期时间设为 seconds (以秒为单位)。<br> <img src="https://images2.imgbox.com/3e/9f/alGpRA7d_o.png" alt="在这里插入图片描述"></p> 
<p>SETNX key value<br> 只有在 key 不存在时设置 key 的值。</p> 
<p>SETRANGE key offset value<br> 用 value 参数覆写给定 key 所储存的字符串值，从偏移量 offset 开始。<br> <img src="https://images2.imgbox.com/85/cc/VEvzUidI_o.png" alt="在这里插入图片描述"></p> 
<p>STRLEN key<br> 返回 key 所储存的字符串值的长度。<br> <img src="https://images2.imgbox.com/37/8d/3P5qmAt7_o.png" alt="在这里插入图片描述"></p> 
<p>MSET key value [key value …]<br> 同时设置一个或多个 key-value 对。</p> 
<p>MSETNX key value [key value …]<br> 同时设置一个或多个 key-value 对，当且仅当所有给定 key 都不存在。</p> 
<p>PSETEX key milliseconds value<br> 这个命令和 SETEX 命令相似，但它以毫秒为单位设置 key 的生存时间，而不是像 SETEX 命令那样，以秒为单位。</p> 
<p>INCR key<br> 将 key 中储存的数字值增一。</p> 
<p>INCRBY key increment<br> 将 key 所储存的值加上给定的增量值（increment） 。</p> 
<p>INCRBYFLOAT key increment<br> 将 key 所储存的值加上给定的浮点增量值（increment） 。</p> 
<p>DECR key<br> 将 key 中储存的数字值减一。</p> 
<p>DECRBY key decrement<br> key 所储存的值减去给定的减量值（decrement） 。</p> 
<p>APPEND key value<br> 如果 key 已经存在并且是一个字符串， APPEND 命令将指定的 value 追加到该 key 原来值（value）的末尾。<br> <img src="https://images2.imgbox.com/e5/3c/1H9aob4T_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="Hash_73"></a>Hash（哈希）：适合存储对象</h4> 
<p>HMSET，HGET,HGETALL<br> <img src="https://images2.imgbox.com/e1/b0/cM6m9xsx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/08/2c/muyVI2Sg_o.png" alt="在这里插入图片描述"><br> 其他哈希操作命令：<br> <img src="https://images2.imgbox.com/a7/7d/swChOmdx_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c9/ca/sYK3cj9t_o.png" alt="在这里插入图片描述"></p> 
<p>对于HSCAN命令：</p> 
<p><img src="https://images2.imgbox.com/8e/34/rsi5LXsA_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="List____85"></a>List (列表) 可重复，有序 :</h4> 
<p>lpush,lrange<br> <img src="https://images2.imgbox.com/f7/47/Xf6Sy7ln_o.png" alt="在这里插入图片描述"></p> 
<p>其他list命令操作：<br> <img src="https://images2.imgbox.com/45/49/h5MO2o24_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/31/09/WajwC2Cm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="Set_94"></a>Set（集合）无重复无序：</h4> 
<p>sadd，smenbers<br> <img src="https://images2.imgbox.com/a5/2d/OI9YL0Vn_o.png" alt="在这里插入图片描述"></p> 
<p>其他set命令：<br> <img src="https://images2.imgbox.com/e8/68/ZJ517Ipj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3a/84/9cEyt7Kp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8e/0a/NyQKRRe9_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="zset_103"></a>zset（有序集合）无重复有序：</h4> 
<p>zadd，zrangebyscore<br> 按照默认顺序排序，score一样是为0<br> <img src="https://images2.imgbox.com/90/25/dLJm8Svd_o.png" alt="在这里插入图片描述"></p> 
<p>按照score顺序：<br> <img src="https://images2.imgbox.com/0c/78/EXOlXiKs_o.png" alt="在这里插入图片描述"></p> 
<p>其他命令关于zset：<br> <img src="https://images2.imgbox.com/d2/6c/KySIDtDH_o.png" alt="在这里插入图片描述"><br> <strong>关于ZINTERSTORE destination numkeys key [key …]<br> 计算给定的一个或多个有序集的交集并将结果集存储在新的有序集合 destination 中</strong><br> <img src="https://images2.imgbox.com/f4/d8/TFaR6xiJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/84/50/hcVRpmWA_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/db/0c/FYWYS4Cq_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="redis_key_120"></a>redis key</h3> 
<p>与rediskey相关的命令：https://redis.io/commands<br> <img src="https://images2.imgbox.com/54/df/qVUeTqAA_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/71/83/ey8i7XQO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Redis_HyperLogLog_126"></a>Redis HyperLogLog</h3> 
<p>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。<br> <strong>只会计算不会存储</strong><br> <img src="https://images2.imgbox.com/f1/f1/GkCNxpJu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_131"></a>发布订阅模式</h3> 
<p>客户端订阅：<br> <img src="https://images2.imgbox.com/71/80/fWqek7Tg_o.png" alt="在这里插入图片描述"></p> 
<p>发布：<br> <img src="https://images2.imgbox.com/92/8c/9qQTZqX8_o.png" alt="在这里插入图片描述"></p> 
<p>示例：订阅chat频道，publish通过chat发布，两个订阅chat的客户端接收到消息<br> <img src="https://images2.imgbox.com/18/89/p6e6UVWo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/08/49/BqWgOvvD_o.png" alt="在这里插入图片描述"></p> 
<p>发布订阅的命令：<br> <img src="https://images2.imgbox.com/fc/26/lXP3gJjb_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="redis_146"></a>redis事务</h3> 
<p>以 <strong>MULTI</strong> 开始一个事务， 然后将多个命令入队到事务中， 最后由 <strong>EXEC</strong> 命令触发事务， 一并执行事务中的所有命令：<br> <img src="https://images2.imgbox.com/a4/6e/4wFWt8Ve_o.png" alt="在这里插入图片描述"></p> 
<p>单个 Redis 命令的执行是原子性的，但 Redis 没有在事务上增加任何维持原子性的机制，所以 Redis 事务的执行并不是原子性的。<br> 事务可以理解为一个打包的批量执行脚本，但批量指令并非原子化的操作，<strong>中间某条指令的失败不会导致前面已做指令的回滚，也不会造成后续的指令不做。</strong><br> 相关命令：<br> <img src="https://images2.imgbox.com/bc/33/askE8gNK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="redishttpsimgblogcsdnimgcnba0102dc4e76415bad6629def8c826e4png_155"></a>redis脚本<img src="https://images2.imgbox.com/44/1b/R7KmoOms_o.png" alt="在这里插入图片描述"></h3> 
<p>常用命令：<br> <img src="https://images2.imgbox.com/cb/19/xvuMhXki_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="redis_161"></a>redis连接命令</h3> 
<p><img src="https://images2.imgbox.com/ca/b4/xFWexGqY_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="redis_164"></a>redis服务器命令</h3> 
<p><img src="https://images2.imgbox.com/10/11/Rf8JPNV2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bc/8d/qcPDTqr9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cf/11/YZAxFzlu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="redis_stream_168"></a>redis stream</h3> 
<p>Redis Stream 主要用于消息队列（MQ，Message Queue）<br> Redis 发布订阅 (pub/sub) 消息无法持久化<br> Redis Stream 提供了消息的持久化和主备复制功能<br> Redis Stream 的结构如下所示，它有一个消息链表，将所有加入的消息都串起来，每个消息都有一个唯一的 ID 和对应的内容：<br> <img src="https://images2.imgbox.com/8f/08/T5tRNSIo_o.png" alt="在这里插入图片描述"><br> 每个 Stream 都有唯一的名称，它就是 Redis 的 key，在我们首次使用 xadd 指令追加消息时自动创建。<br> 上图解析：<br> <strong>Consumer Group</strong> ：消费组，使用 XGROUP CREATE 命令创建，一个消费组有多个消费者(Consumer)。<br> <strong>last_delivered_id</strong> ：游标，每个消费组会有个游标 last_delivered_id，任意一个消费者读取了消息都会使游标 last_delivered_id 往前移动。<br> <strong>pending_ids</strong> ：消费者(Consumer)的状态变量，作用是维护消费者的未确认的 id。 pending_ids 记录了当前已经被客户端读取的消息，但是还没有 ack (Acknowledge character：确认字符）。<br> 相关命令：<br> <img src="https://images2.imgbox.com/06/77/R9yiPww3_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Redis__182"></a>Redis 数据备份与恢复</h3> 
<p>一些命令：SAVE，config get dir，bgsave</p> 
<h3><a id="redis_184"></a>redis安全</h3> 
<p><strong>config get requirepass</strong><br> <img src="https://images2.imgbox.com/ed/35/nP7BA2s5_o.png" alt="在这里插入图片描述"></p> 
<p><strong>config set requirepass "密码"</strong><br> <img src="https://images2.imgbox.com/17/30/jIe7qlTV_o.png" alt="在这里插入图片描述"></p> 
<p><strong>连接redis需要密码，命令：<br> auth "密码"</strong><br> <img src="https://images2.imgbox.com/c1/49/lIxvgDes_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Redis__195"></a>Redis 性能测试</h3> 
<p><img src="https://images2.imgbox.com/58/4d/Q6lIlF8N_o.png" alt="在这里插入图片描述"></p> 
<p><strong>在redis目录下执行</strong><br> 以下实例同时执行 10000 个请求来检测性能：<br> <img src="https://images2.imgbox.com/4d/3b/aLAyVRry_o.png" alt="在这里插入图片描述"></p> 
<p>以下实例同时执行 1000 个请求来检测性能：<br> <img src="https://images2.imgbox.com/e3/e2/vfDwaMXw_o.png" alt="在这里插入图片描述"></p> 
<p>redis 性能测试工具可选参数如下所示：<br> <img src="https://images2.imgbox.com/03/d7/iAqlviWi_o.png" alt="在这里插入图片描述"></p> 
<p>多个参数来测试 redis 性能：<br> <img src="https://images2.imgbox.com/1b/aa/XGjpwUPE_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_211"></a>客户端连接</h3> 
<p>redis客户端连接就相当于开了几个窗口<br> <strong>原理：</strong><br> Redis 通过监听一个 TCP 端口或者 Unix socket 的方式来接收来自客户端的连接，当一个连接建立后，Redis 内部会进行以下一些操作：<br> 首先，客户端 socket 会被设置为非阻塞模式，因为 Redis 在网络事件处理上采用的是非阻塞多路复用模型。<br> 然后为这个 socket 设置 TCP_NODELAY 属性，禁用 Nagle 算法<br> 然后创建一个可读的文件事件用于监听这个客户端 socket 的数据发送<br> <strong>获取最大连接数</strong>：config get maxclients，可以在redis.conf文件修改<br> <strong>设置最大连接数</strong>：redis-server --maxclients 100000<br> <strong>客户端命令</strong>：<br> <img src="https://images2.imgbox.com/89/a7/etSJ9cRS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Javaredis_223"></a>Java使用redis</h3> 
<p>使用驱动连接<br> 将jar包放到工程中<br> <strong>连接</strong>：https://static.runoob.com/download/jedis-2.9.0.jar 下载驱动，最好是这个版本，下载最新版容易出现有一个s开头的jar包找不到的情况。</p> 
<pre><code>import redis.clients.jedis.Jedis;
 
public class RedisJava {
    public static void main(String[] args) {
        //连接本地的 Redis 服务
        Jedis jedis = new Jedis("localhost");
        // 如果 Redis 服务设置了密码，需要下面这行，没有就不需要
        // jedis.auth("123456"); 
        System.out.println("连接成功");
        //查看服务是否运行
        System.out.println("服务正在运行: "+jedis.ping());
    }
}
</code></pre> 
<p>字符串：</p> 
<pre><code>import redis.clients.jedis.Jedis;
 
public class RedisStringJava {
    public static void main(String[] args) {
        //连接本地的 Redis 服务
        Jedis jedis = new Jedis("localhost");
        System.out.println("连接成功");
        //设置 redis 字符串数据
        jedis.set("runoobkey", "www.runoob.com");
        // 获取存储的数据并输出
        System.out.println("redis 存储的字符串为: "+ jedis.get("runoobkey"));
    }
}
</code></pre> 
<p>到这里算告一段落。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/58f91052746d583b68b6c822805d6a46/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">node、Vue cil、vs code安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9726df96eec124c3f2df9ad0f0c792ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">域策略设置计算机睡眠,win10专业版中如何使用组策略跳过从睡眠中恢复的密码提示...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>