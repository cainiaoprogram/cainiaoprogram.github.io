<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python小脚本——批量将PDF文件转换成图片 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python小脚本——批量将PDF文件转换成图片" />
<meta property="og:description" content="语言：python 3
用法：选择PDF文件所在的目录，点击 确定 后，自动将该目录下的所有PDF转换成单个图片，图片名称为: pdf文件名.page_序号.jpg
如运行中报错，需要自行根据报错内容按照缺失的库
例如：
#安装库 pip install pyautogui #安装库 pip install pillow 这里提供两种源码，第一种是在代码中手动添加pdf所在目录
import os import glob from PyPDF2 import PdfReader from pdf2image import convert_from_path pdf_dir = &#34;path/to/pdf_dir/&#34; #pdf目录 # 遍历目录中的PDF文件 pdf_files = glob.glob(os.path.join(pdf_dir, &#34;*.pdf&#34;)) # 遍历每个PDF文件，并将其转换为图片 for pdf_file in pdf_files: # 创建PdfReader对象 pdf = open(pdf_file, &#39;rb&#39;) pdf_reader = PdfReader(pdf) # 遍历PDF的页面并将其转换为图片 for page_num in range(len(pdf_reader.pages)): # 获取页面对象 page = pdf_reader.pages[page_num] # 将PDF页面转换为图像 images = convert_from_path(pdf_file, first_page=page_num&#43;1, last_page=page_num&#43;1) # 定义图像保存路径 filename = os." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c2c65716b98ee7939cf8062480fdadfe/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-22T16:18:25+08:00" />
<meta property="article:modified_time" content="2023-08-22T16:18:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python小脚本——批量将PDF文件转换成图片</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>语言：python 3</p> 
<p>用法：选择PDF文件所在的目录，点击 确定 后，自动将<span style="color:#ff9900;"><strong>该目录下的所有PDF</strong></span>转换成单个图片，图片名称为:   pdf文件名.page_序号.jpg</p> 
<p><span style="color:#ff9900;"><strong>如运行中报错，需要自行根据报错内容按照缺失的库</strong></span></p> 
<p>例如：</p> 
<pre><code class="language-python">#安装库

pip install pyautogui

#安装库

pip install  pillow</code></pre> 
<p>这里提供两种源码，第一种是在代码中手动添加pdf所在目录</p> 
<pre><code class="language-python">import os
import glob
from PyPDF2 import PdfReader
from pdf2image import convert_from_path

pdf_dir = "path/to/pdf_dir/"  #pdf目录

# 遍历目录中的PDF文件
pdf_files = glob.glob(os.path.join(pdf_dir, "*.pdf"))

# 遍历每个PDF文件，并将其转换为图片
for pdf_file in pdf_files:
    # 创建PdfReader对象
    pdf = open(pdf_file, 'rb')
    pdf_reader = PdfReader(pdf)
    
    # 遍历PDF的页面并将其转换为图片
    for page_num in range(len(pdf_reader.pages)):
        # 获取页面对象
        page = pdf_reader.pages[page_num]

        # 将PDF页面转换为图像
        images = convert_from_path(pdf_file, first_page=page_num+1, last_page=page_num+1)

        # 定义图像保存路径
        filename = os.path.splitext(os.path.basename(pdf_file))[0]
        image_path = os.path.join(pdf_dir, f"{filename}_page_{page_num+1}.jpg")

        # 保存图像
        for i, image in enumerate(images):
            if i == 0:
                image.save(image_path, "JPEG")
            else:
                image_path = os.path.join(pdf_dir, f"{filename}_page_{page_num+1}_{i+1}.jpg")
                image.save(image_path, "JPEG")

    # 关闭PDF文件
    pdf.close()
</code></pre> 
<p>第二种是点击运行后，弹出窗口选择PDF所在文件夹，程序运行对<strong><span style="background-color:#ff9900;">该文件夹下的所有PDF文件</span></strong>转换成图片</p> 
<pre><code class="language-python">#手动选择目录下的pdf文件
import os
from tkinter import Tk
from tkinter.filedialog import askdirectory
from PyPDF2 import PdfReader
from pdf2image import convert_from_path

# 打开选择目录的对话框
Tk().withdraw()  # 隐藏Tkinter根窗口
pdf_dir = askdirectory(title="选择PDF所在目录")

# 遍历目录中的PDF文件
pdf_files = [f for f in os.listdir(pdf_dir) if f.endswith(".pdf")]

# 遍历每个PDF文件，并将其转换为图片
for pdf_file in pdf_files:
    # 创建PdfReader对象
    pdf_path = os.path.join(pdf_dir, pdf_file)
    pdf = open(pdf_path, 'rb')
    pdf_reader = PdfReader(pdf)
    
    # 遍历PDF的页面并将其转换为图片
    for page_num in range(len(pdf_reader.pages)):
        # 获取页面对象
        page = pdf_reader.pages[page_num]

        # 将PDF页面转换为图像
        images = convert_from_path(pdf_path, first_page=page_num+1, last_page=page_num+1)

        # 定义图像保存路径
        filename = os.path.splitext(pdf_file)[0]
        image_path = os.path.join(pdf_dir, f"{filename}_page_{page_num+1}.jpg")

        # 保存图像
        for i, image in enumerate(images):
            if i == 0:
                image.save(image_path, "JPEG")
            else:
                image_path = os.path.join(pdf_dir, f"{filename}_page_{page_num+1}_{i+1}.jpg")
                image.save(image_path, "JPEG")

    # 关闭PDF文件
    pdf.close()
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e3cd1dbfe2cf1c67a89ff61aa7aef83/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">STP总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9f65b735d65ba8dd71ec71112dd2d3cf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序使用高德地图实现检索定位附近周边的POI功能示例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>