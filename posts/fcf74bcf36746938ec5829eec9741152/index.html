<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kconfig常用语法，入门必看 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="kconfig常用语法，入门必看" />
<meta property="og:description" content="kconfig 1. kconfig简单介绍 Kconfig用来配置内核，它就是各种配置界面的源文件，内核的配置工具读取各个Kconfig文件，生成配置界面供开发人员配置内核，最后生成配置文件.config
2. kconfig和makefile关系 makefile用来配置编译源文件的方法，kconfig可以说是以界面的方式来配置决定那些makefile文件需要编译。
看kconfig和makefile和源文件如何关联起来 makefile
obj-$(CONFIG_LCD_TRULY_TFT240240_2_E)	&#43;= truly_tft240240_2_e.o truly_tft240240_2_e：源文件名字
CONFIG_LCD_TRULY_TFT240240_2_E：CONFIG_是前缀，重点是后面的LCD_TRULY_TFT240240_2_E，kconfig通过LCD_TRULY_TFT240240_2_E关联到makefile，从而找到truly_tft240240_2_e，然后进行编译。
kconfig
config LCD_TRULY_TFT240240_2_E tristate &#34;SLCD TRULY TFT240240-2-E with control IC st7789s (240x240)&#34; depends on BACKLIGHT_CLASS_DEVICE default n 这个我们只用看config config LCD_TRULY_TFT240240_2_E ，其他先不管。LCD_TRULY_TFT240240_2_E和makeflie的CONFIG_LCD_TRULY_TFT240240_2_E中的LCD_TRULY_TFT240240_2_E对应。
然后可以通过make menuconfig 查看结果
在菜单用按 / 可以搜索
这样通过空格键选中就可以选中编译的方式，如不编译、编译到内核
编译到模块。
以上就是基本的使用流程
###常见命令
kconfig的基本用法 config条目(entry)
config TMPFS_POSIX_ACL
bool “Tmpfs POSIX Access Control Lists”
depends on TMPFS
select GENERIC_ACL
help
POSIX Access Control Lists (ACLs) support permissions for users and" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fcf74bcf36746938ec5829eec9741152/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-08T13:02:36+08:00" />
<meta property="article:modified_time" content="2022-09-08T13:02:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kconfig常用语法，入门必看</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-kimbie-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="kconfig_0"></a>kconfig</h3> 
<h4><a id="1_kconfig_2"></a>1. kconfig简单介绍</h4> 
<p>Kconfig用来配置内核，它就是各种配置界面的源文件，内核的配置工具读取各个Kconfig文件，生成配置界面供开发人员配置内核，最后生成配置文件.config</p> 
<h4><a id="2_kconfigmakefile_4"></a>2. kconfig和makefile关系</h4> 
<p>makefile用来配置编译源文件的方法，kconfig可以说是以界面的方式来配置决定那些makefile文件需要编译。</p> 
<h5><a id="kconfigmakefile_6"></a>看kconfig和makefile和源文件如何关联起来</h5> 
<p><strong>makefile</strong></p> 
<pre><code class="prism language-cpp">obj<span class="token operator">-</span>$<span class="token punctuation">(</span>CONFIG_LCD_TRULY_TFT240240_2_E<span class="token punctuation">)</span>	<span class="token operator">+=</span> truly_tft240240_2_e<span class="token punctuation">.</span>o
</code></pre> 
<p>truly_tft240240_2_e：源文件名字<br> CONFIG_LCD_TRULY_TFT240240_2_E：CONFIG_是前缀，重点是后面的LCD_TRULY_TFT240240_2_E，kconfig通过LCD_TRULY_TFT240240_2_E关联到makefile，从而找到truly_tft240240_2_e，然后进行编译。<br> <strong>kconfig</strong></p> 
<pre><code class="prism language-cpp">config LCD_TRULY_TFT240240_2_E 
	tristate <span class="token string">"SLCD TRULY TFT240240-2-E with control IC st7789s (240x240)"</span>
	depends on BACKLIGHT_CLASS_DEVICE
	<span class="token keyword">default</span> n
</code></pre> 
<p></p> 
<p>这个我们只用看config config LCD_TRULY_TFT240240_2_E ，其他先不管。LCD_TRULY_TFT240240_2_E和makeflie的CONFIG_LCD_TRULY_TFT240240_2_E中的LCD_TRULY_TFT240240_2_E对应。<br> 然后可以通过make menuconfig 查看结果<br> 在菜单用按 / 可以搜索<br> <img src="https://images2.imgbox.com/4b/aa/9d4Oh6fe_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7a/52/jUsTFnjz_o.png" alt="在这里插入图片描述"><br> 这样通过空格键选中就可以选中编译的方式，如不编译、编译到内核<br> 编译到模块。<br> 以上就是基本的使用流程</p> 
<p>###常见命令<br> <img src="https://images2.imgbox.com/2d/8c/ZZvy0o01_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="kconfig_37"></a>kconfig的基本用法</h4> 
<ol><li> <p><strong>config条目(entry)</strong><br> config TMPFS_POSIX_ACL</p> <p>bool “Tmpfs POSIX Access Control Lists”</p> <p>depends on TMPFS</p> <p>select GENERIC_ACL</p> <p>help</p> <p>POSIX Access Control Lists (ACLs) support permissions for users and</p> <p>groups beyond the owner/group/world scheme.</p> <p>To learn more about Access Control Lists, visit the POSIX ACLs for</p> <p>Linux website <a href="http://acl.bestbits.at/" rel="nofollow">http://acl.bestbits.at/</a>.</p> <p>If you don’t know what Access Control Lists are, say N.</p> </li></ol> 
<p>以上对应的配置界面为<br> <img src="https://images2.imgbox.com/38/82/JT5P1nuI_o.png" alt="在这里插入图片描述"><br> 解析：</p> 
<pre><code>        config是关键字，表示一个配置选项的开始；紧跟着的TMPFS_POSIX_ACL是配置选项的名称，省略了前缀"CONFIG_"
bool表示变量类型，即"CONFIG_ TMPFS_POSIX_ACL "的类型，有5种类型：bool、tristate、string、hex和int，其中tristate和string是基本的类型
          bool变量的值：    y和n
          tristate变量的值：y、n和m
</code><pre><code>      string变量的值&amp;#xff1a;  字符串
</code></pre>
</pre> 
<p>bool之后的字符串“Tmpfs POSIX Access Control Lists”是提示信息（在上面的配置界面中就是通过它来识别CONFIG_TMPFS_POSIX_ACL），在配置界面中上下移动光标选中它时，就可以通过按空格或回车键来设置CONFIG_ TMPFS_POSIX_ACL的值（即选择了哪个值就会把该值赋值给CONFIG_TMPFS_POSIX_ACL）</p> 
<p>depends on：表示依赖于XXX，“depends on TMPFS”表示只有当TMPFS配置选项被选中时，当前配置选项的提示信息才会出现，才能设置当前配置选项<br> select：是反向依赖关系的意思，即当前配置选项被选中，则GENERIC_ACL就会被选中。<br> </p> 
<ol start="2"><li><strong>menu条目</strong></li></ol> 
<p>menu条目用于生成菜单，其格式如下：</p> 
<pre><code>     menu "Floating point emulation"
</code><pre><code> config FPE_NWFPE

 ..............

 config FPE_NWFPE_XP

 .............

 endmenu
</code></pre>
</pre> 
<p></p> 
<p>menu之后的Floating poing emulation是菜单名。menu和endmenu间有很多config条目，在配置界面中如下所示：<br> <img src="https://images2.imgbox.com/04/56/G6pdf4yF_o.png" alt="在这里插入图片描述"><br> 其中Floating point emulation就是菜单名，然后进入这个菜单有 FPE_NWFPE、FPE_NWFPE_XP…等config条目选择</p> 
<pre><code>     Floating point emulation---&gt;
</code><pre><code>               [] FPE_NWFPE

               [] FPE_NWFPE_XP
</code></pre>
</pre> 
<p></p> 
<p>3.<strong>choice条目</strong><br> choice条目将多个类似的配置选项组合在一起，供用户单选或多选，这不同于menu条目</p> 
<pre><code class="prism language-cpp">choice
	prompt <span class="token string">"soc x1000 codec type select"</span>
	depends on SOC_X1000
config SND_ASOC_INGENIC_PHOENIX_ICDC
	tristate <span class="token string">"Audio support for phoenix with internal codec"</span>
	select SND_ASOC_DMA_V13
	select SND_ASOC_JZ_AIC_I2S_V13
	select SND_ASOC_JZ_ICDC_D3
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">select</span> <span class="token expression">SND_ASOC_JZ_PCM_V13</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">select</span> <span class="token expression">SND_ASOC_FIIO_PCM5242</span></span>
</code></pre> 
<p>config SND_ASOC_INGENIC_PHOENIX_SPDIF<br> tristate <span class="token string">“Audio support for phoenix with spdif”</span><br> select SND_ASOC_DMA_V13<br> select SND_ASOC_JZ_AIC_SPDIF_V13<br> select SND_ASOC_JZ_SPDIF_V13<br> <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">select</span> <span class="token expression">SND_ASOC_JZ_PCM_V13</span></span></p> 
<p>endchoice<br> </p> 
<pre><code>  prompt "soc x1000 codec type select"给出提示信息“soc x1000 codec type select”，光标选中后回车进入就可以看到多个config条目定义的配置选项

 choice条目中定义的变量只有bool和tristate
 如下图
</code></pre> 
<p><img src="https://images2.imgbox.com/0d/c7/d87zrby7_o.png" alt="在这里插入图片描述"></p> 
<ol start="4"><li><strong>comment条目</strong><br> menu “Floating point emulation”</li></ol> 
<p>comment “At least one emulation must be selected”</p> 
<p>config FPE_NWFPE</p> 
<p>…</p> 
<p>config FPE_NWFPE_XP</p> 
<p>在界面中如下所示：<br> <img src="https://images2.imgbox.com/a5/0b/uFzUBjJE_o.png" alt="在这里插入图片描述"></p> 
<ol start="5"><li> <p>** source条目**<br> source条目用于读取另一个Kconfig文件，如：</p> <pre><code>source "net/Kconifg"　
</code></pre> </li></ol> 
<p>参考了<br> https://www.jianshu.com/p/aba588d380c2<br> https://www.cnblogs.com/fah936861121/p/7229522.html</p> 
<div id="treeSkill"></div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/377bdaabc44cf078df481b5dc3cfa54d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mybatis 缓存配置 ，如何禁用缓存与一些细节</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2205d8183b3167dadfdd9265759bf59f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Token_JWT</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>