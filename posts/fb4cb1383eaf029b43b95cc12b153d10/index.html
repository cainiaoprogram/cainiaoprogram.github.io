<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python操作Word：轻松实现文档的创建、编辑与自动化处理 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python操作Word：轻松实现文档的创建、编辑与自动化处理" />
<meta property="og:description" content="引言：
在日常工作和学习中，我们经常需要使用Microsoft Word来创建、编辑和处理文档。然而，手动操作Word可能会耗费大量的时间和精力。为了提高工作效率，我们可以使用Python编程语言来操作Word文档，实现文档的自动化处理。本文将详细介绍如何使用Python操作Word，包括创建、编辑和自动化处理文档的方法。
一、安装Python-docx库
要使用Python操作Word，首先需要安装Python-docx库。Python-docx是一个用于创建、查询和修改Microsoft Word（.docx）文件的Python库。可以使用pip命令进行安装：
pip install python-docx 二、创建Word文档
导入库： import docx 创建文档对象： doc = docx.Document() 添加段落： paragraph = doc.add_paragraph(&#39;这是一个新的段落。&#39;) 保存文档： doc.save(&#39;example.docx&#39;) 三、编辑Word文档
打开文档： doc = docx.Document(&#39;example.docx&#39;) 读取段落： for paragraph in doc.paragraphs: print(paragraph.text) 修改段落： paragraph = doc.paragraphs[0] paragraph.text = &#39;这是修改后的段落。&#39; 添加图片： doc.add_picture(&#39;image.jpg&#39;, width=docx.shared.Inches(1)) 保存文档： doc.save(&#39;example_edited.docx&#39;) 四、自动化处理Word文档
批量替换文本： from docx import Document import os import re def replace_text(file_path, old_text, new_text): doc = Document(file_path) for paragraph in doc.paragraphs: paragraph.text = re." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fb4cb1383eaf029b43b95cc12b153d10/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-10T19:05:50+08:00" />
<meta property="article:modified_time" content="2024-01-10T19:05:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python操作Word：轻松实现文档的创建、编辑与自动化处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>引言：<br> 在日常工作和学习中，我们经常需要使用Microsoft Word来创建、编辑和处理文档。然而，手动操作Word可能会耗费大量的时间和精力。为了提高工作效率，我们可以使用Python编程语言来操作Word文档，实现文档的自动化处理。本文将详细介绍如何使用Python操作Word，包括创建、编辑和自动化处理文档的方法。</p> 
<p>一、安装Python-docx库<br> 要使用Python操作Word，首先需要安装Python-docx库。Python-docx是一个用于创建、查询和修改Microsoft Word（.docx）文件的Python库。可以使用pip命令进行安装：</p> 
<pre><code>pip install python-docx
</code></pre> 
<p>二、创建Word文档</p> 
<ol><li>导入库：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> docx
</code></pre> 
<ol start="2"><li>创建文档对象：</li></ol> 
<pre><code class="prism language-python">doc <span class="token operator">=</span> docx<span class="token punctuation">.</span>Document<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>添加段落：</li></ol> 
<pre><code class="prism language-python">paragraph <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">'这是一个新的段落。'</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>保存文档：</li></ol> 
<pre><code class="prism language-python">doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'example.docx'</span><span class="token punctuation">)</span>
</code></pre> 
<p>三、编辑Word文档</p> 
<ol><li>打开文档：</li></ol> 
<pre><code class="prism language-python">doc <span class="token operator">=</span> docx<span class="token punctuation">.</span>Document<span class="token punctuation">(</span><span class="token string">'example.docx'</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>读取段落：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">for</span> paragraph <span class="token keyword">in</span> doc<span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>修改段落：</li></ol> 
<pre><code class="prism language-python">paragraph <span class="token operator">=</span> doc<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
paragraph<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'这是修改后的段落。'</span>
</code></pre> 
<ol start="4"><li>添加图片：</li></ol> 
<pre><code class="prism language-python">doc<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'image.jpg'</span><span class="token punctuation">,</span> width<span class="token operator">=</span>docx<span class="token punctuation">.</span>shared<span class="token punctuation">.</span>Inches<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="5"><li>保存文档：</li></ol> 
<pre><code class="prism language-python">doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'example_edited.docx'</span><span class="token punctuation">)</span>
</code></pre> 
<p>四、自动化处理Word文档</p> 
<ol><li>批量替换文本：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document
<span class="token keyword">import</span> os
<span class="token keyword">import</span> re

<span class="token keyword">def</span> <span class="token function">replace_text</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    doc <span class="token operator">=</span> Document<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> doc<span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>
        paragraph<span class="token punctuation">.</span>text <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">,</span> paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>file_path <span class="token operator">+</span> <span class="token string">'.tmp'</span><span class="token punctuation">)</span> <span class="token comment"># 删除临时文件，避免覆盖原文件</span>
</code></pre> 
<ol start="2"><li>批量生成报告：根据模板生成多个报告，每个报告包含不同的数据。例如，根据学生名单生成成绩报告。可以使用Python-docx库的template功能来实现。以下是一个简单的示例：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document <span class="token keyword">as</span> docx_Document <span class="token comment"># 导入Document类，并重命名为docx_Document，以避免与内置的Document类冲突。</span>
五、使用Python<span class="token operator">-</span>docx库处理表格
<span class="token number">1.</span> 创建表格：

```python
table <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_table<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> cols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>添加单元格：</li></ol> 
<pre><code class="prism language-python">cell <span class="token operator">=</span> table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
cell<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'Hello'</span>
</code></pre> 
<ol start="3"><li>合并单元格：</li></ol> 
<pre><code class="prism language-python">cell<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>table<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>删除单元格：</li></ol> 
<pre><code class="prism language-python">table<span class="token punctuation">.</span>_tbl<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>cell<span class="token punctuation">.</span>_tc<span class="token punctuation">)</span>
</code></pre> 
<ol start="5"><li>保存文档：</li></ol> 
<pre><code class="prism language-python">doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'example_table.docx'</span><span class="token punctuation">)</span>
</code></pre> 
<p>六、使用Python-docx库处理样式</p> 
<ol><li>设置字体样式：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>oxml<span class="token punctuation">.</span>ns <span class="token keyword">import</span> qn

run <span class="token operator">=</span> paragraph<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">'Hello, world!'</span><span class="token punctuation">)</span>
font <span class="token operator">=</span> run<span class="token punctuation">.</span>font
font<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Arial'</span>
font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
font<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>
font<span class="token punctuation">.</span>italic <span class="token operator">=</span> <span class="token boolean">True</span>
</code></pre> 
<ol start="2"><li>设置段落样式：</li></ol> 
<pre><code class="prism language-python">paragraph_format <span class="token operator">=</span> paragraph<span class="token punctuation">.</span>style
paragraph_format<span class="token punctuation">.</span>alignment <span class="token operator">=</span> WD_ALIGN_PARAGRAPH<span class="token punctuation">.</span>CENTER
</code></pre> 
<ol start="3"><li>设置表格样式：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>table <span class="token keyword">import</span> WD_TABLE_ALIGNMENT

table<span class="token punctuation">.</span>alignment <span class="token operator">=</span> WD_TABLE_ALIGNMENT<span class="token punctuation">.</span>CENTER
</code></pre> 
<p>七、使用Python-docx库处理图片</p> 
<ol><li>插入图片：</li></ol> 
<pre><code class="prism language-python">doc<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'image.jpg'</span><span class="token punctuation">,</span> width<span class="token operator">=</span>docx<span class="token punctuation">.</span>shared<span class="token punctuation">.</span>Inches<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>调整图片大小：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Inches

doc<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'image.jpg'</span><span class="token punctuation">,</span> width<span class="token operator">=</span>Inches<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>旋转图片：</li></ol> 
<pre><code class="prism language-python">doc<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">'image.jpg'</span><span class="token punctuation">,</span> width<span class="token operator">=</span>Inches<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> height<span class="token operator">=</span>Inches<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rotate<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>
</code></pre> 
<p>八、使用Python-docx库处理页眉和页脚</p> 
<ol><li>添加页眉：</li></ol> 
<pre><code class="prism language-python">header <span class="token operator">=</span> doc<span class="token punctuation">.</span>sections<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>header
header_paragraph <span class="token operator">=</span> header<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
header_paragraph<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'This is the header.'</span>
</code></pre> 
<ol start="2"><li>添加页脚：</li></ol> 
<pre><code class="prism language-python">footer <span class="token operator">=</span> doc<span class="token punctuation">.</span>sections<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>footer
footer_paragraph <span class="token operator">=</span> footer<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
footer_paragraph<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'This is the footer.'</span>
</code></pre> 
<p>九、使用Python-docx库处理书签</p> 
<ol><li>添加书签：</li></ol> 
<pre><code class="prism language-python">bookmark <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_bookmark<span class="token punctuation">(</span><span class="token string">'my_bookmark'</span><span class="token punctuation">)</span>
bookmark<span class="token punctuation">.</span>add_range<span class="token punctuation">(</span>docx_Document<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">'This is my bookmark.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>跳转到书签：</li></ol> 
<pre><code class="prism language-python">bookmark <span class="token operator">=</span> doc<span class="token punctuation">.</span>bookmarks<span class="token punctuation">[</span><span class="token string">'my_bookmark'</span><span class="token punctuation">]</span>
bookmark<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>十、使用Python-docx库处理注释</p> 
<ol><li>添加注释：</li></ol> 
<pre><code class="prism language-python">comment <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_comment<span class="token punctuation">(</span><span class="token string">'This is a comment.'</span><span class="token punctuation">)</span>
comment<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">'This is the content of the comment.'</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>删除注释：</li></ol> 
<pre><code class="prism language-python">comment <span class="token operator">=</span> doc<span class="token punctuation">.</span>comments<span class="token punctuation">[</span><span class="token string">'my_comment'</span><span class="token punctuation">]</span>
comment<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>十一、使用Python-docx库处理大纲</p> 
<ol><li>添加标题：</li></ol> 
<pre><code class="prism language-python">heading <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span><span class="token string">'My Heading'</span><span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>添加段落：</li></ol> 
<pre><code class="prism language-python">paragraph <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">'My paragraph.'</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>添加列表：</li></ol> 
<pre><code class="prism language-python">list_item <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">'Item in the list.'</span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'ListBullet'</span><span class="token punctuation">)</span>
</code></pre> 
<p>十二、使用Python-docx库处理目录</p> 
<ol><li>添加目录：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx<span class="token punctuation">.</span>enum<span class="token punctuation">.</span>text <span class="token keyword">import</span> WD_BREAK
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>oxml<span class="token punctuation">.</span>ns <span class="token keyword">import</span> qn
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>oxml <span class="token keyword">import</span> parse_xml

toc <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">'Table of Contents'</span><span class="token punctuation">)</span>
toc<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>
toc<span class="token punctuation">.</span>underline <span class="token operator">=</span> <span class="token boolean">True</span>
toc<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
toc<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>PAGE<span class="token punctuation">)</span>
</code></pre> 
<ol start="2"><li>更新目录：</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document <span class="token keyword">as</span> docx_Document
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>oxml <span class="token keyword">import</span> OxmlElement
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>oxml<span class="token punctuation">.</span>ns <span class="token keyword">import</span> qn

<span class="token keyword">def</span> <span class="token function">update_toc</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">:</span>
    toc <span class="token operator">=</span> document<span class="token punctuation">.</span>paragraphs<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    toc<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
    toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token string">'Table of Contents'</span><span class="token punctuation">)</span>
    toc_run<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>
    toc_run<span class="token punctuation">.</span>underline <span class="token operator">=</span> <span class="token boolean">True</span>
    toc_run<span class="token punctuation">.</span>font<span class="token punctuation">.</span>size <span class="token operator">=</span> Pt<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>
    toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>PAGE<span class="token punctuation">)</span>
    <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> document<span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span>
        <span class="token keyword">if</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Heading1'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>SECTION<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Heading2'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>SECTION<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Heading3'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>SECTION<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Heading4'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>SECTION<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Heading5'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>SECTION<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Heading6'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>SECTION<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> paragraph<span class="token punctuation">.</span>style <span class="token operator">==</span> <span class="token string">'Normal'</span><span class="token punctuation">:</span>
            toc_run <span class="token operator">=</span> toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
            toc_run<span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>LINE<span class="token punctuation">)</span>
    toc<span class="token punctuation">.</span>add_run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_break<span class="token punctuation">(</span>WD_BREAK<span class="token punctuation">.</span>PAGE<span class="token punctuation">)</span>
    <span class="token keyword">return</span> toc
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42702b7c88131f2efb3991624c8d2a98/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">鹅目标检测数据集VOC格式300张</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/04ec44cfabc926fe062cc3bba8043af0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Redis基础知识（持续更新中）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>