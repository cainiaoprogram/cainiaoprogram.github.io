<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python支持向量机实验_Python SVM(支持向量机)实现方法完整示例 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python支持向量机实验_Python SVM(支持向量机)实现方法完整示例" />
<meta property="og:description" content="本文实例讲述了python SVM(支持向量机)实现方法。分享给大家供大家参考，具体如下：
运行环境 Pyhton3 numpy(科学计算包) matplotlib(画图所需，不画图可不必)
计算过程
st=&gt;start: 开始
e=&gt;end: 结束
op1=&gt;operation: 读入数据
op2=&gt;operation: 格式化数据
cond=&gt;condition: 是否达到迭代次数
op3=&gt;operation: 寻找超平面分割最小间隔
ccond=&gt;conditon: 数据是否改变
op4=&gt;operation: 输出结果
st-&gt;op1-&gt;op2-&gt;cond
cond(yes)-&gt;op4-&gt;e
cond(no)-&gt;op3
啊，这markdown flow好难用，我决定就画到这吧=。=
输入样例 /* testSet.txt */
3.542485 1.977398 -1
3.018896 2.556416 -1
7.551510 -1.580030 1
2.114999 -0.004466 -1
8.127113 1.274372 1
7.108772 -0.986906 1
8.610639 2.046708 1
2.326297 0.265213 -1
3.634009 1.730537 -1
0.341367 -0.894998 -1
3.125951 0.293251 -1
2.123252 -0.783563 -1
0.887835 -2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4a5e1308aaeb39e5aff3ac62ceb8cdef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-04T02:51:06+08:00" />
<meta property="article:modified_time" content="2021-02-04T02:51:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python支持向量机实验_Python SVM(支持向量机)实现方法完整示例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>本文实例讲述了python SVM(支持向量机)实现方法。分享给大家供大家参考，具体如下：</p> 
 <p>运行环境 Pyhton3 numpy(科学计算包) matplotlib(画图所需，不画图可不必)</p> 
 <p>计算过程</p> 
 <p>st=&gt;start: 开始</p> 
 <p>e=&gt;end: 结束</p> 
 <p>op1=&gt;operation: 读入数据</p> 
 <p>op2=&gt;operation: 格式化数据</p> 
 <p>cond=&gt;condition: 是否达到迭代次数</p> 
 <p>op3=&gt;operation: 寻找超平面分割最小间隔</p> 
 <p>ccond=&gt;conditon: 数据是否改变</p> 
 <p>op4=&gt;operation: 输出结果</p> 
 <p>st-&gt;op1-&gt;op2-&gt;cond</p> 
 <p>cond(yes)-&gt;op4-&gt;e</p> 
 <p>cond(no)-&gt;op3</p> 
 <p>啊，这markdown flow好难用，我决定就画到这吧=。=</p> 
 <p>输入样例 /* testSet.txt */</p> 
 <p>3.542485 1.977398 -1</p> 
 <p>3.018896 2.556416 -1</p> 
 <p>7.551510 -1.580030 1</p> 
 <p>2.114999 -0.004466 -1</p> 
 <p>8.127113 1.274372 1</p> 
 <p>7.108772 -0.986906 1</p> 
 <p>8.610639 2.046708 1</p> 
 <p>2.326297 0.265213 -1</p> 
 <p>3.634009 1.730537 -1</p> 
 <p>0.341367 -0.894998 -1</p> 
 <p>3.125951 0.293251 -1</p> 
 <p>2.123252 -0.783563 -1</p> 
 <p>0.887835 -2.797792 -1</p> 
 <p>7.139979 -2.329896 1</p> 
 <p>1.696414 -1.212496 -1</p> 
 <p>8.117032 0.623493 1</p> 
 <p>8.497162 -0.266649 1</p> 
 <p>4.658191 3.507396 -1</p> 
 <p>8.197181 1.545132 1</p> 
 <p>1.208047 0.213100 -1</p> 
 <p>1.928486 -0.321870 -1</p> 
 <p>2.175808 -0.014527 -1</p> 
 <p>7.886608 0.461755 1</p> 
 <p>3.223038 -0.552392 -1</p> 
 <p>3.628502 2.190585 -1</p> 
 <p>7.407860 -0.121961 1</p> 
 <p>7.286357 0.251077 1</p> 
 <p>2.301095 -0.533988 -1</p> 
 <p>-0.232542 -0.547690 -1</p> 
 <p>3.457096 -0.082216 -1</p> 
 <p>3.023938 -0.057392 -1</p> 
 <p>8.015003 0.885325 1</p> 
 <p>8.991748 0.923154 1</p> 
 <p>7.916831 -1.781735 1</p> 
 <p>7.616862 -0.217958 1</p> 
 <p>2.450939 0.744967 -1</p> 
 <p>7.270337 -2.507834 1</p> 
 <p>1.749721 -0.961902 -1</p> 
 <p>1.803111 -0.176349 -1</p> 
 <p>8.804461 3.044301 1</p> 
 <p>1.231257 -0.568573 -1</p> 
 <p>2.074915 1.410550 -1</p> 
 <p>-0.743036 -1.736103 -1</p> 
 <p>3.536555 3.964960 -1</p> 
 <p>8.410143 0.025606 1</p> 
 <p>7.382988 -0.478764 1</p> 
 <p>6.960661 -0.245353 1</p> 
 <p>8.234460 0.701868 1</p> 
 <p>8.168618 -0.903835 1</p> 
 <p>1.534187 -0.622492 -1</p> 
 <p>9.229518 2.066088 1</p> 
 <p>7.886242 0.191813 1</p> 
 <p>2.893743 -1.643468 -1</p> 
 <p>1.870457 -1.040420 -1</p> 
 <p>5.286862 -2.358286 1</p> 
 <p>6.080573 0.418886 1</p> 
 <p>2.544314 1.714165 -1</p> 
 <p>6.016004 -3.753712 1</p> 
 <p>0.926310 -0.564359 -1</p> 
 <p>0.870296 -0.109952 -1</p> 
 <p>2.369345 1.375695 -1</p> 
 <p>1.363782 -0.254082 -1</p> 
 <p>7.279460 -0.189572 1</p> 
 <p>1.896005 0.515080 -1</p> 
 <p>8.102154 -0.603875 1</p> 
 <p>2.529893 0.662657 -1</p> 
 <p>1.963874 -0.365233 -1</p> 
 <p>8.132048 0.785914 1</p> 
 <p>8.245938 0.372366 1</p> 
 <p>6.543888 0.433164 1</p> 
 <p>-0.236713 -5.766721 -1</p> 
 <p>8.112593 0.295839 1</p> 
 <p>9.803425 1.495167 1</p> 
 <p>1.497407 -0.552916 -1</p> 
 <p>1.336267 -1.632889 -1</p> 
 <p>9.205805 -0.586480 1</p> 
 <p>1.966279 -1.840439 -1</p> 
 <p>8.398012 1.584918 1</p> 
 <p>7.239953 -1.764292 1</p> 
 <p>7.556201 0.241185 1</p> 
 <p>9.015509 0.345019 1</p> 
 <p>8.266085 -0.230977 1</p> 
 <p>8.545620 2.788799 1</p> 
 <p>9.295969 1.346332 1</p> 
 <p>2.404234 0.570278 -1</p> 
 <p>2.037772 0.021919 -1</p> 
 <p>1.727631 -0.453143 -1</p> 
 <p>1.979395 -0.050773 -1</p> 
 <p>8.092288 -1.372433 1</p> 
 <p>1.667645 0.239204 -1</p> 
 <p>9.854303 1.365116 1</p> 
 <p>7.921057 -1.327587 1</p> 
 <p>8.500757 1.492372 1</p> 
 <p>1.339746 -0.291183 -1</p> 
 <p>3.107511 0.758367 -1</p> 
 <p>2.609525 0.902979 -1</p> 
 <p>3.263585 1.367898 -1</p> 
 <p>2.912122 -0.202359 -1</p> 
 <p>1.731786 0.589096 -1</p> 
 <p>2.387003 1.573131 -1</p> 
 <p>代码实现 # -*- coding:utf-8 -*-</p> 
 <p>#!python3</p> 
 <p>__author__ = 'Wsine'</p> 
 <p>from numpy import *</p> 
 <p>import matplotlib.pyplot as plt</p> 
 <p>import operator</p> 
 <p>import time</p> 
 <p>def loadDataSet(fileName):</p> 
 <p>dataMat = []</p> 
 <p>labelMat = []</p> 
 <p>with open(fileName) as fr:</p> 
 <p>for line in fr.readlines():</p> 
 <p>lineArr = line.strip().split('\t')</p> 
 <p>dataMat.append([float(lineArr[0]), float(lineArr[1])])</p> 
 <p>labelMat.append(float(lineArr[2]))</p> 
 <p>return dataMat, labelMat</p> 
 <p>def selectJrand(i, m):</p> 
 <p>j = i</p> 
 <p>while (j == i):</p> 
 <p>j = int(random.uniform(0, m))</p> 
 <p>return j</p> 
 <p>def clipAlpha(aj, H, L):</p> 
 <p>if aj &gt; H:</p> 
 <p>aj = H</p> 
 <p>if L &gt; aj:</p> 
 <p>aj = L</p> 
 <p>return aj</p> 
 <p>class optStruct:</p> 
 <p>def __init__(self, dataMatIn, classLabels, C, toler):</p> 
 <p>self.X = dataMatIn</p> 
 <p>self.labelMat = classLabels</p> 
 <p>self.C = C</p> 
 <p>self.tol = toler</p> 
 <p>self.m = shape(dataMatIn)[0]</p> 
 <p>self.alphas = mat(zeros((self.m, 1)))</p> 
 <p>self.b = 0</p> 
 <p>self.eCache = mat(zeros((self.m, 2)))</p> 
 <p>def calcEk(oS, k):</p> 
 <p>fXk = float(multiply(oS.alphas, oS.labelMat).T * (oS.X * oS.X[k, :].T)) + oS.b</p> 
 <p>Ek = fXk - float(oS.labelMat[k])</p> 
 <p>return Ek</p> 
 <p>def selectJ(i, oS, Ei):</p> 
 <p>maxK = -1</p> 
 <p>maxDeltaE = 0</p> 
 <p>Ej = 0</p> 
 <p>oS.eCache[i] = [1, Ei]</p> 
 <p>validEcacheList = nonzero(oS.eCache[:, 0].A)[0]</p> 
 <p>if (len(validEcacheList)) &gt; 1:</p> 
 <p>for k in validEcacheList:</p> 
 <p>if k == i:</p> 
 <p>continue</p> 
 <p>Ek = calcEk(oS, k)</p> 
 <p>deltaE = abs(Ei - Ek)</p> 
 <p>if (deltaE &gt; maxDeltaE):</p> 
 <p>maxK = k</p> 
 <p>maxDeltaE = deltaE</p> 
 <p>Ej = Ek</p> 
 <p>return maxK, Ej</p> 
 <p>else:</p> 
 <p>j = selectJrand(i, oS.m)</p> 
 <p>Ej = calcEk(oS, j)</p> 
 <p>return j, Ej</p> 
 <p>def updateEk(oS, k):</p> 
 <p>Ek = calcEk(oS, k)</p> 
 <p>oS.eCache[k] = [1, Ek]</p> 
 <p>def innerL(i, oS):</p> 
 <p>Ei = calcEk(oS, i)</p> 
 <p>if ((oS.labelMat[i] * Ei &lt; -oS.tol) and (oS.alphas[i] &lt; oS.C)) or ((oS.labelMat[i] * Ei &gt; oS.tol) and (oS.alphas[i] &gt; 0)):</p> 
 <p>j, Ej = selectJ(i, oS, Ei)</p> 
 <p>alphaIold = oS.alphas[i].copy()</p> 
 <p>alphaJold = oS.alphas[j].copy()</p> 
 <p>if (oS.labelMat[i] != oS.labelMat[j]):</p> 
 <p>L = max(0, oS.alphas[j] - oS.alphas[i])</p> 
 <p>H = min(oS.C, oS.C + oS.alphas[j] - oS.alphas[i])</p> 
 <p>else:</p> 
 <p>L = max(0, oS.alphas[j] + oS.alphas[i] - oS.C)</p> 
 <p>H = min(oS.C, oS.alphas[j] + oS.alphas[i])</p> 
 <p>if (L == H):</p> 
 <p># print("L == H")</p> 
 <p>return 0</p> 
 <p>eta = 2.0 * oS.X[i, :] * oS.X[j, :].T - oS.X[i, :] * oS.X[i, :].T - oS.X[j, :] * oS.X[j, :].T</p> 
 <p>if eta &gt;= 0:</p> 
 <p># print("eta &gt;= 0")</p> 
 <p>return 0</p> 
 <p>oS.alphas[j] -= oS.labelMat[j] * (Ei - Ej) / eta</p> 
 <p>oS.alphas[j] = clipAlpha(oS.alphas[j], H, L)</p> 
 <p>updateEk(oS, j)</p> 
 <p>if (abs(oS.alphas[j] - alphaJold) &lt; 0.00001):</p> 
 <p># print("j not moving enough")</p> 
 <p>return 0</p> 
 <p>oS.alphas[i] += oS.labelMat[j] * oS.labelMat[i] * (alphaJold - oS.alphas[j])</p> 
 <p>updateEk(oS, i)</p> 
 <p>b1 = oS.b - Ei - oS.labelMat[i] * (oS.alphas[i] - alphaIold) * oS.X[i, :] * oS.X[i, :].T - oS.labelMat[j] * (oS.alphas[j] - alphaJold) * oS.X[i, :] * oS.X[j, :].T</p> 
 <p>b2 = oS.b - Ei - oS.labelMat[i] * (oS.alphas[i] - alphaIold) * oS.X[i, :] * oS.X[j, :].T - oS.labelMat[j] * (oS.alphas[j] - alphaJold) * oS.X[j, :] * oS.X[j, :].T</p> 
 <p>if (0 &lt; oS.alphas[i]) and (oS.C &gt; oS.alphas[i]):</p> 
 <p>oS.b = b1</p> 
 <p>elif (0 &lt; oS.alphas[j]) and (oS.C &gt; oS.alphas[j]):</p> 
 <p>oS.b = b2</p> 
 <p>else:</p> 
 <p>oS.b = (b1 + b2) / 2.0</p> 
 <p>return 1</p> 
 <p>else:</p> 
 <p>return 0</p> 
 <p>def smoP(dataMatIn, classLabels, C, toler, maxIter, kTup=('lin', 0)):</p> 
 <p>"""</p> 
 <p>输入：数据集, 类别标签, 常数C, 容错率, 最大循环次数</p> 
 <p>输出：目标b, 参数alphas</p> 
 <p>"""</p> 
 <p>oS = optStruct(mat(dataMatIn), mat(classLabels).transpose(), C, toler)</p> 
 <p>iterr = 0</p> 
 <p>entireSet = True</p> 
 <p>alphaPairsChanged = 0</p> 
 <p>while (iterr &lt; maxIter) and ((alphaPairsChanged &gt; 0) or (entireSet)):</p> 
 <p>alphaPairsChanged = 0</p> 
 <p>if entireSet:</p> 
 <p>for i in range(oS.m):</p> 
 <p>alphaPairsChanged += innerL(i, oS)</p> 
 <p># print("fullSet, iter: %d i:%d, pairs changed %d" % (iterr, i, alphaPairsChanged))</p> 
 <p>iterr += 1</p> 
 <p>else:</p> 
 <p>nonBoundIs = nonzero((oS.alphas.A &gt; 0) * (oS.alphas.A &lt; C))[0]</p> 
 <p>for i in nonBoundIs:</p> 
 <p>alphaPairsChanged += innerL(i, oS)</p> 
 <p># print("non-bound, iter: %d i:%d, pairs changed %d" % (iterr, i, alphaPairsChanged))</p> 
 <p>iterr += 1</p> 
 <p>if entireSet:</p> 
 <p>entireSet = False</p> 
 <p>elif (alphaPairsChanged == 0):</p> 
 <p>entireSet = True</p> 
 <p># print("iteration number: %d" % iterr)</p> 
 <p>return oS.b, oS.alphas</p> 
 <p>def calcWs(alphas, dataArr, classLabels):</p> 
 <p>"""</p> 
 <p>输入：alphas, 数据集, 类别标签</p> 
 <p>输出：目标w</p> 
 <p>"""</p> 
 <p>X = mat(dataArr)</p> 
 <p>labelMat = mat(classLabels).transpose()</p> 
 <p>m, n = shape(X)</p> 
 <p>w = zeros((n, 1))</p> 
 <p>for i in range(m):</p> 
 <p>w += multiply(alphas[i] * labelMat[i], X[i, :].T)</p> 
 <p>return w</p> 
 <p>def plotFeature(dataMat, labelMat, weights, b):</p> 
 <p>dataArr = array(dataMat)</p> 
 <p>n = shape(dataArr)[0]</p> 
 <p>xcord1 = []; ycord1 = []</p> 
 <p>xcord2 = []; ycord2 = []</p> 
 <p>for i in range(n):</p> 
 <p>if int(labelMat[i]) == 1:</p> 
 <p>xcord1.append(dataArr[i, 0])</p> 
 <p>ycord1.append(dataArr[i, 1])</p> 
 <p>else:</p> 
 <p>xcord2.append(dataArr[i, 0])</p> 
 <p>ycord2.append(dataArr[i, 1])</p> 
 <p>fig = plt.figure()</p> 
 <p>ax = fig.add_subplot(111)</p> 
 <p>ax.scatter(xcord1, ycord1, s=30, c='red', marker='s')</p> 
 <p>ax.scatter(xcord2, ycord2, s=30, c='green')</p> 
 <p>x = arange(2, 7.0, 0.1)</p> 
 <p>y = (-b[0, 0] * x) - 10 / linalg.norm(weights)</p> 
 <p>ax.plot(x, y)</p> 
 <p>plt.xlabel('X1'); plt.ylabel('X2')</p> 
 <p>plt.show()</p> 
 <p>def main():</p> 
 <p>trainDataSet, trainLabel = loadDataSet('testSet.txt')</p> 
 <p>b, alphas = smoP(trainDataSet, trainLabel, 0.6, 0.0001, 40)</p> 
 <p>ws = calcWs(alphas, trainDataSet, trainLabel)</p> 
 <p>print("ws = \n", ws)</p> 
 <p>print("b = \n", b)</p> 
 <p>plotFeature(trainDataSet, trainLabel, ws, b)</p> 
 <p>if __name__ == '__main__':</p> 
 <p>start = time.clock()</p> 
 <p>main()</p> 
 <p>end = time.clock()</p> 
 <p>print('finish all in %s' % str(end - start))</p> 
 <p>输出样例</p> 
 <p>ws =</p> 
 <p>[[ 0.65307162]</p> 
 <p>[-0.17196128]]</p> 
 <p>b =</p> 
 <p>[[-2.89901748]]</p> 
 <p>finish all in 2.5683854014099112</p> 
 <p align="center"><img src="https://images2.imgbox.com/83/71/xhmx3WFl_o.png" alt="352674949a275fc504bb6bc9ddebe439.png"></p> 
 <p>绘图方面还存在一些bug。</p> 
 <p>更多关于Python相关内容感兴趣的读者可查看本站专题：《Python数学运算技巧总结》、《Python数据结构与算法教程》、《Python函数使用技巧总结》、《Python字符串操作技巧汇总》、《Python入门与进阶经典教程》及《Python文件与目录操作技巧汇总》</p> 
 <p>希望本文所述对大家Python程序设计有所帮助。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/63f39baa259dd3bc201febb456236d14/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql并发写 主键重复_数据库“锁”事一例：并发情景下重复主键问题方案讨论...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d29abbbf9033230a85530e6c15656e0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">文本相似度计算——Simhash算法（python实现）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>