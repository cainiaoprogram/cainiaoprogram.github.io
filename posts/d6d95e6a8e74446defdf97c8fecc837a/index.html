<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>05、Python -- 爬取ts文件格式视频思路 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="05、Python -- 爬取ts文件格式视频思路" />
<meta property="og:description" content="目录 第一步：爬取一段5秒视频找url代码结果 第二步：下载整个视频的所有片段代码：结果： 第三步：合成视频安装模块代码：结果 简洁代码代码：结果： 最终代码简洁前代码简洁后代码 思路：
1、爬取视频，但是每次只能爬取一段5秒的视频。
2、一个视频有很多秒，所以需要爬取很多片段的视频
3、把所有爬取下来的片段视频合成导出。
4、最后再简洁代码
第一步：爬取一段5秒视频 找url 首先，找到需要爬取的视频，选择如图，找到对应的URL。
代码 然后最简单的四行爬取代码
结果 爬取的结果如图，里面视频只有5秒
第二步：下载整个视频的所有片段 代码： 结果： 把该视频所有片段都下载下来了
第三步：合成视频 安装模块 命令：pip install moviepy -i https://mirrors.aliyun.com/pypi/simple/
代码： 结果 完整合成视频并下载下来
简洁代码 代码： 结果： 如图：每个视频只由4秒
最终代码 简洁前代码 这里我把原本存放视频的文件夹名由《视频》改成《视频片段》
所以这里的【视频】，后面写代码的时候也应该改成【视频片段】
# 导入模块 import requests number = 0 # 循环下载视频片段 while True: format_num = &#39;{:05d}&#39;.format(number) # f&#39;&#39; --&gt; 用于在字符串中添加执行表达式 url = f&#39;https://xxxxxxxxxx.{format_num}.ts?pkexxxxxxxxxxxxx&#39; res = requests.get(url) # 遇到404，就跳出循环 if res.status_code == 404: break open(f&#39;视频片段/{format_num}." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d6d95e6a8e74446defdf97c8fecc837a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-24T21:50:33+08:00" />
<meta property="article:modified_time" content="2023-10-24T21:50:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">05、Python -- 爬取ts文件格式视频思路</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#5_8" rel="nofollow">第一步：爬取一段5秒视频</a></li><li><ul><li><a href="#url_9" rel="nofollow">找url</a></li><li><a href="#_14" rel="nofollow">代码</a></li><li><a href="#_18" rel="nofollow">结果</a></li></ul> 
  </li><li><a href="#_22" rel="nofollow">第二步：下载整个视频的所有片段</a></li><li><ul><li><a href="#_24" rel="nofollow">代码：</a></li><li><a href="#_28" rel="nofollow">结果：</a></li></ul> 
  </li><li><a href="#_34" rel="nofollow">第三步：合成视频</a></li><li><ul><li><a href="#_37" rel="nofollow">安装模块</a></li><li><a href="#_43" rel="nofollow">代码：</a></li><li><a href="#_48" rel="nofollow">结果</a></li></ul> 
  </li><li><a href="#_58" rel="nofollow">简洁代码</a></li><li><ul><li><a href="#_60" rel="nofollow">代码：</a></li><li><a href="#_64" rel="nofollow">结果：</a></li></ul> 
  </li><li><a href="#_85" rel="nofollow">最终代码</a></li><li><ul><li><a href="#_86" rel="nofollow">简洁前代码</a></li><li><a href="#_137" rel="nofollow">简洁后代码</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>思路：<br> 1、爬取视频，但是每次只能爬取一段5秒的视频。<br> 2、一个视频有很多秒，所以需要爬取很多片段的视频<br> 3、把所有爬取下来的片段视频合成导出。</p> 
<p>4、最后再简洁代码</p> 
<h2><a id="5_8"></a>第一步：爬取一段5秒视频</h2> 
<h3><a id="url_9"></a>找url</h3> 
<p>首先，找到需要爬取的视频，选择如图，找到对应的URL。<br> <img src="https://images2.imgbox.com/5f/cf/5fuINrA8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_14"></a>代码</h3> 
<p>然后最简单的四行爬取代码<br> <img src="https://images2.imgbox.com/af/f5/FzujTR9V_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_18"></a>结果</h3> 
<p>爬取的结果如图，里面视频只有5秒<br> <img src="https://images2.imgbox.com/fa/8f/UZmICUP6_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_22"></a>第二步：下载整个视频的所有片段</h2> 
<h3><a id="_24"></a>代码：</h3> 
<p><img src="https://images2.imgbox.com/1a/01/Q8Yl8lSs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_28"></a>结果：</h3> 
<p><img src="https://images2.imgbox.com/00/4e/rhEUk2n8_o.png" alt="在这里插入图片描述"><br> 把该视频所有片段都下载下来了<br> <img src="https://images2.imgbox.com/16/b8/qQMTvMZx_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_34"></a>第三步：合成视频</h2> 
<h3><a id="_37"></a>安装模块</h3> 
<p>命令：pip install moviepy -i https://mirrors.aliyun.com/pypi/simple/</p> 
<p><img src="https://images2.imgbox.com/eb/a2/C1weCJHL_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_43"></a>代码：</h3> 
<p><img src="https://images2.imgbox.com/3e/9d/XRpq3N34_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_48"></a>结果</h3> 
<p><img src="https://images2.imgbox.com/a5/d6/AAAPDUZJ_o.png" alt="在这里插入图片描述"></p> 
<p>完整合成视频并下载下来<br> <img src="https://images2.imgbox.com/e8/f1/07y2B6RW_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_58"></a>简洁代码</h2> 
<h3><a id="_60"></a>代码：</h3> 
<p><img src="https://images2.imgbox.com/f8/e0/stkOVQX4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_64"></a>结果：</h3> 
<p><img src="https://images2.imgbox.com/0e/5c/JDmXzVHr_o.png" alt="在这里插入图片描述"><br> 如图：每个视频只由4秒<br> <img src="https://images2.imgbox.com/cd/c7/ew9pYYIm_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ba/13/XVpf5Yz1_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_85"></a>最终代码</h2> 
<h3><a id="_86"></a>简洁前代码</h3> 
<p>这里我把原本存放视频的文件夹名由《视频》改成《视频片段》<br> <img src="https://images2.imgbox.com/86/ab/XzUueBk3_o.png" alt="在这里插入图片描述"><br> 所以这里的【视频】，后面写代码的时候也应该改成【视频片段】<br> <img src="https://images2.imgbox.com/d4/47/9cmWWWax_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"># 导入模块
<span class="token keyword">import</span> <span class="token namespace">requests</span>

number <span class="token operator">=</span> <span class="token number">0</span>
# 循环下载视频片段
<span class="token keyword">while</span> <span class="token class-name">True</span><span class="token operator">:</span>
    format_num <span class="token operator">=</span> <span class="token char">'{:05d}'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
    # f'' <span class="token operator">--</span><span class="token operator">&gt;</span> 用于在字符串中添加执行表达式
    url <span class="token operator">=</span> f'https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>xxxxxxxxxx<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span><span class="token punctuation">.</span>ts<span class="token operator">?</span>pkexxxxxxxxxxxxx'
    res <span class="token operator">=</span> requests<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    # 遇到<span class="token number">404</span>，就跳出循环
    <span class="token keyword">if</span> res<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">404</span><span class="token operator">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">open</span><span class="token punctuation">(</span>f'视频片段<span class="token operator">/</span><span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span><span class="token punctuation">.</span>ts<span class="token char">', '</span>wb'<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>f'已经下载了 <span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span> 个<span class="token punctuation">.</span>ts文件'<span class="token punctuation">)</span>
    number <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token function">print</span><span class="token punctuation">(</span>f'一共下载了 <span class="token punctuation">{<!-- --></span>number<span class="token punctuation">}</span> 个视频 ， 准备合成，请稍等几分钟'<span class="token punctuation">)</span>



# 合成
#从moviepy这个模块的子模块editor里面导入所有的功能
from moviepy<span class="token punctuation">.</span>editor <span class="token keyword">import</span> <span class="token operator">*</span>

# 列表 把这些视频加载到程序中来，保存在一个列表中
clip_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token operator">:</span>
    format_num <span class="token operator">=</span> <span class="token char">'{:05d}'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    clip <span class="token operator">=</span> <span class="token class-name">VideoFileClip</span><span class="token punctuation">(</span>f'视频片段<span class="token operator">/</span><span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span><span class="token punctuation">.</span>ts'<span class="token punctuation">)</span>
    clip_list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>clip<span class="token punctuation">)</span>


# 最终视频合成
lastVideo <span class="token operator">=</span> <span class="token function">concatenate_videoclips</span><span class="token punctuation">(</span>clip_list<span class="token punctuation">)</span>
# 视频下载写出地址
lastVideo<span class="token punctuation">.</span><span class="token function">write_videofile</span><span class="token punctuation">(</span>'完整视频<span class="token operator">/</span>最终视频<span class="token punctuation">.</span>mp4'<span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_137"></a>简洁后代码</h3> 
<pre><code class="prism language-java"># 导入模块
<span class="token keyword">import</span> <span class="token namespace">requests</span>
#从moviepy这个模块的子模块editor里面导入所有的功能
from moviepy<span class="token punctuation">.</span>editor <span class="token keyword">import</span> <span class="token operator">*</span>
number <span class="token operator">=</span> <span class="token number">0</span>
# 列表， 用于把所有片段视频加载到程序中来，保存在一个列表中
clip_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
# 循环下载视频片段
<span class="token keyword">while</span> <span class="token class-name">True</span><span class="token operator">:</span>
    format_num <span class="token operator">=</span> <span class="token char">'{:05d}'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
    # f'' <span class="token operator">--</span><span class="token operator">&gt;</span> 用于在字符串中添加执行表达式
    url <span class="token operator">=</span> f'https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>xxxxxxxhevc_1<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span><span class="token punctuation">.</span>ts<span class="token operator">?</span>pkexxxxxxxxxxxxxxxxxxxxxx'
    res <span class="token operator">=</span> requests<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    # 遇到<span class="token number">404</span>，就跳出循环
    <span class="token keyword">if</span> res<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">404</span><span class="token operator">:</span>
        <span class="token keyword">break</span>
    # 视频片段 就是存放一段段视频的文件夹名
    <span class="token keyword">open</span><span class="token punctuation">(</span>f'视频片段<span class="token operator">/</span><span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span><span class="token punctuation">.</span>ts<span class="token char">', '</span>wb'<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    clip <span class="token operator">=</span> <span class="token class-name">VideoFileClip</span><span class="token punctuation">(</span>f'视频片段<span class="token operator">/</span><span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span><span class="token punctuation">.</span>ts'<span class="token punctuation">)</span>
    clip_list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>clip<span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>f'已经下载了并且加载了 <span class="token punctuation">{<!-- --></span>format_num<span class="token punctuation">}</span> 个<span class="token punctuation">.</span>ts文件'<span class="token punctuation">)</span>
    number <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token function">print</span><span class="token punctuation">(</span>f'一共下载了 <span class="token punctuation">{<!-- --></span>number<span class="token punctuation">}</span> 个视频 ， 准备加载，请稍等几分钟'<span class="token punctuation">)</span>
# 最终视频合成
lastVideo <span class="token operator">=</span> <span class="token function">concatenate_videoclips</span><span class="token punctuation">(</span>clip_list<span class="token punctuation">)</span>
# 视频下载写出地址
lastVideo<span class="token punctuation">.</span><span class="token function">write_videofile</span><span class="token punctuation">(</span>'完整视频<span class="token operator">/</span>最终视频<span class="token punctuation">.</span>mp4'<span class="token punctuation">)</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/86b0417736b5709f823f56642fe0e819/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">win11图标间距变大了怎么调整</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/83ce45bfbe707678bf1135cb612969dc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32：TTL串口调试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>