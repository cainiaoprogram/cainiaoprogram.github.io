<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何限制用户登录到域计算机 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何限制用户登录到域计算机" />
<meta property="og:description" content="登录到属性对于内置域管理员Administrator无效。
默认情况下，创建新的Active Directory用户时，它们会自动添加到“ 域用户”组中。反过来，默认情况下，将域用户组加入AD域后，会将其添加到域工作站上的本地用户组。这意味着任何域用户都可以登录到域网络中的任何计算机。在本文中，我们将考虑如何限制用户登录到域计算机的主要方法。
内容：
限制用户帐户仅登录到特定的AD计算机如何在PowerShell中修改LogonWorkstations属性？如何限制用户使用GPO登录到AD工作站？ 限制用户帐户仅登录到特定的AD计算机
在小型域中，可以在Active Directory中每个用户帐户的属性中将用户登录限制为域计算机。例如，您要只允许特定用户登录其计算机。去做吧：
通过运行dsa.msc命令来运行ADUC管理单元（Active Directory用户和计算机）。使用AD搜索，找到要限制访问的用户帐户并打开其属性；转到“ 帐户”标签，然后单击“ 登录到”按钮。如您所见，允许用户登录到所有域计算机（用户可以登录到：所有计算机）。要只允许用户访问特定的计算机，请选择“以下计算机”选项并添加用户可以登录的计算机的名称； 注意。您必须指定完整的NetBIOS或DNS计算机名称（不要使用通配符）。该值不区分大小写。
您最多可以将64台计算机添加到此列表。如果您尝试添加65 个计算机，将出现如下错误信息：This property is limited to 64 values. You must remove some of the existing values before you can add new ones;保存更改。现在，用户只能登录到指定的AD计算机。 如何在PowerShell中修改LogonWorkstations属性？
手动将用户登录限制为域计算机是非常麻烦的。您可以使用PowerShell自动执行此操作。允许用户登录的计算机列表存储在AD用户属性“ LogonWorkstations ”中。例如，我们的任务是允许特定用户仅登录到名称在文本文件computers.csv中列出的计算机。
该脚本如下所示：
Import-Module ActiveDirectory
$ADusername = ‘asmith’
$complist = Import-Csv -Path &#34;C:\PS\computers.csv&#34; | ForEach-Object {$_.NetBIOSName}
$comparray = $complist -join &#34;,&#34;
Set-ADUser -Identity $ADusername -LogonWorkstations $comparray
Clear-Variable comparray
使用Get-ADUser cmdlet，可以显示允许用户登录的计算机的列表。
Get-ADUser $ADusername -Properties LogonWorkstations | Format-List Name, LogonWorkstations" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/09cbfa53bf737329adac7d0f49721b25/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-01-09T17:21:17+08:00" />
<meta property="article:modified_time" content="2020-01-09T17:21:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何限制用户登录到域计算机</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0cm;"><span style="color:#313131;"> </span><strong><span style="color:#313131;">登录到属性对于内置域管理员Administrator无效。</span></strong></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#313131;">默认情况下，</span><span style="color:#313131;"><a href="http://woshub.com/new-aduser-create-active-directory-users-powershell/" rel="nofollow"><span style="color:#04aeda;">创建新的</span><span style="color:#04aeda;">Active Directory</span><span style="color:#04aeda;">用户时</span></a></span><span style="color:#313131;">，它们会自动添加到</span><span style="color:#313131;">“ </span><em><span style="color:#313131;">域用户</span></em><em><span style="color:#313131;">”</span></em><span style="color:#313131;">组中。反过来，默认情况下，将域用户组加入</span><span style="color:#313131;">AD</span><span style="color:#313131;">域后，会将其添加到域工作站上的本地<em>用户</em>组。这意味着任何域用户都可以登录到域网络中的任何计算机。在本文中，我们将考虑如何限制用户登录到域计算机的主要方法。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#313131;">内容：</span></strong></p> 
<ul><li><span style="color:#313131;"><a href="http://woshub.com/restrict-workstation-logon-ad-users/#h2_1" rel="nofollow"><span style="color:#04aeda;">限制用户帐户仅登录到特定的</span><span style="color:#04aeda;">AD</span><span style="color:#04aeda;">计算机</span></a></span></li><li><span style="color:#313131;"><a href="http://woshub.com/restrict-workstation-logon-ad-users/#h2_2" rel="nofollow"><span style="color:#04aeda;">如何在</span><span style="color:#04aeda;">PowerShell</span><span style="color:#04aeda;">中修改</span><span style="color:#04aeda;">LogonWorkstations</span><span style="color:#04aeda;">属性？</span></a></span></li><li><span style="color:#313131;"><a href="http://woshub.com/restrict-workstation-logon-ad-users/#h2_3" rel="nofollow"><span style="color:#04aeda;">如何限制用户使用</span><span style="color:#04aeda;">GPO</span><span style="color:#04aeda;">登录到</span><span style="color:#04aeda;">AD</span><span style="color:#04aeda;">工作站？</span></a></span></li></ul> 
<p style="margin-left:0cm;"><span style="color:#313131;">限制用户帐户仅登录到特定的</span><span style="color:#313131;">AD</span><span style="color:#313131;">计算机</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">在小型域中，可以在</span><span style="color:#313131;">Active Directory</span><span style="color:#313131;">中每个用户帐户的属性中将用户登录限制为域计算机。例如，您要只允许特定用户登录其计算机。去做吧：</span></p> 
<ol><li><span style="color:#313131;">通过运行</span><span style="color:#313131;">dsa.msc</span><span style="color:#313131;">命令来运行</span><span style="color:#313131;">ADUC</span><span style="color:#313131;">管理单元（</span><span style="color:#313131;">Active Directory</span><span style="color:#313131;">用户和计算机）。</span></li><li><span style="color:#313131;">使用</span><span style="color:#313131;"><a href="http://woshub.com/searching-ad-groups-users-using-wildcards/" rel="nofollow"><span style="color:#04aeda;">AD</span><span style="color:#04aeda;">搜索</span></a></span><span style="color:#313131;">，找到要限制访问的用户帐户并打开其属性；</span></li><li><span style="color:#313131;">转到</span><span style="color:#313131;">“ </span><strong><span style="color:#313131;">帐户</span></strong><strong><span style="color:#313131;">”</span></strong><span style="color:#313131;">标签，然后单击</span><span style="color:#313131;">“ </span><strong><span style="color:#313131;">登录到</span></strong><strong><span style="color:#313131;">”</span></strong><span style="color:#313131;">按钮。</span><img alt="" class="has" height="429" src="https://images2.imgbox.com/0c/df/1a9g6hvn_o.png" width="605"></li><li><span style="color:#313131;">如您所见，允许用户登录到所有域计算机（用户可以登录到：所有计算机）。要只允许用户访问特定的计算机，请选择</span><strong><span style="color:#313131;">“</span></strong><strong><span style="color:#313131;">以下计算机</span></strong><strong><span style="color:#313131;">”</span></strong><span style="color:#313131;">选项并添加用户可以登录的计算机的名称；</span><img alt="" class="has" height="500" src="https://images2.imgbox.com/1c/4e/FIZOrZkm_o.png" width="411"></li></ol> 
<p style="margin-left:0cm;"><strong><span style="color:#313131;">注意</span></strong><span style="color:#313131;">。您必须指定完整的</span><span style="color:#313131;">NetBIOS</span><span style="color:#313131;">或</span><span style="color:#313131;">DNS</span><span style="color:#313131;">计算机名称（不要使用通配符）。该值不区分大小写。</span></p> 
<ol><li><span style="color:#313131;">您最多可以将</span><span style="color:#313131;">64</span><span style="color:#313131;">台计算机添加到此列表。如果您尝试添加</span><span style="color:#313131;">65 </span><span style="color:#313131;">个</span><span style="color:#313131;">计算机，将出现如下错误信息：</span><span style="color:#313131;">This property is limited to 64 values. You must remove some of the existing values before you can add new ones;</span><img alt="" class="has" height="161" src="https://images2.imgbox.com/95/82/5H3mZWXO_o.png" width="465"></li><li><span style="color:#313131;">保存更改。现在，用户只能登录到指定的</span><span style="color:#313131;">AD</span><span style="color:#313131;">计算机。</span></li></ol> 
<p style="margin-left:0cm;"><span style="color:#313131;">如何在</span><span style="color:#313131;">PowerShell</span><span style="color:#313131;">中修改</span><span style="color:#313131;">LogonWorkstations</span><span style="color:#313131;">属性？</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">手动将用户登录限制为域计算机是非常麻烦的。您可以使用</span><span style="color:#313131;">PowerShell</span><span style="color:#313131;">自动执行此操作。允许用户登录的计算机列表存储在</span><span style="color:#313131;">AD</span><span style="color:#313131;">用户属性</span><span style="color:#313131;">“ <strong>LogonWorkstations</strong> ”</span><span style="color:#313131;">中。例如，我们的任务是允许特定用户仅登录到名称在文本文件</span><span style="color:#313131;">computers.csv</span><span style="color:#313131;">中列出的计算机。</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">该脚本如下所示：</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">Import-Module ActiveDirectory<br> $ADusername = ‘asmith’<br> $complist = Import-Csv -Path "C:\PS\computers.csv" | ForEach-Object {$_.NetBIOSName}<br> $comparray = $complist -join ","<br> Set-ADUser -Identity $ADusername -LogonWorkstations $comparray<br> Clear-Variable comparray</span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="460" src="https://images2.imgbox.com/38/d9/sEOthjzD_o.png" width="648"></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">使用</span><span style="color:#313131;"><a href="http://woshub.com/get-aduser-getting-active-directory-users-data-via-powershell/" rel="nofollow"><span style="color:#04aeda;">Get-ADUser</span></a> cmdlet</span><span style="color:#313131;">，可以显示允许用户登录的计算机的列表。</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">Get-ADUser $ADusername -Properties LogonWorkstations | Format-List Name, LogonWorkstations</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">或者，您可以在</span><span style="color:#313131;">ADUC</span><span style="color:#313131;">控制台中查看计算机列表。</span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="287" src="https://images2.imgbox.com/5f/ad/Ls6Ncgtn_o.png" width="379"></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">要将新的计算机名称添加到列表，请使用以下命令：</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">$Wks = (Get-ADUser asmith-Properties LogonWorkstations).LogonWorkstations<br> $Wks += ",man-b2-wks2"<br> Set-ADUser asmith -LogonWorkstations $Wks</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">如何限制用户使用</span><span style="color:#313131;">GPO</span><span style="color:#313131;">登录到</span><span style="color:#313131;">AD</span><span style="color:#313131;">工作站？</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">在大域中，由于某些限制和缺乏灵活性，使用</span><span style="color:#313131;">LogonWorkstations</span><span style="color:#313131;">用户属性限制用户对计算机的访问是不可行的。通常，为了防止用户登录某些计算机，使用组策略。</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">您可以使用</span><span style="color:#313131;">“</span><span style="color:#313131;">受限制的组</span><span style="color:#313131;">”</span><span style="color:#313131;">策略（</span><span style="color:#313131;">Windows</span><span style="color:#313131;">设置</span><span style="color:#313131;">-&gt;</span><span style="color:#313131;">安全设置）来限制本地组</span><span style="color:#313131;">“</span><span style="color:#313131;">用户</span><span style="color:#313131;">”</span><span style="color:#313131;">中的用户列表，但是我们将考虑另一个选项。</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">GPO</span><span style="color:#313131;">部分中的<strong>计算机策略</strong></span><strong><span style="color:#313131;">-&gt;</span></strong><strong><span style="color:#313131;">策略</span></strong><strong><span style="color:#313131;">-&gt;</span></strong><strong><span style="color:#313131;">安全设置</span></strong><strong><span style="color:#313131;">-&gt;</span></strong><strong><span style="color:#313131;">本地策略</span></strong><strong><span style="color:#313131;">-&gt;</span></strong><strong><span style="color:#313131;">用户权限分配中</span></strong><span style="color:#313131;">有两个组策略：</span></p> 
<ul><li><strong><span style="color:#313131;">拒绝</span></strong><span style="color:#313131;">本地登录</span><span style="color:#313131;">–</span><span style="color:#313131;">允许将本地登录限制为特定用户或组的工作站登录；</span></li><li><strong><span style="color:#313131;">允许本地登录</span></strong><span style="color:#313131;"> –</span><span style="color:#313131;">包含<strong>允许本地</strong>登录计算机的用户列表。</span></li></ul> 
<p style="margin-left:0cm;"><span style="color:#313131;">例如，为防止特定组的用户登录到特定</span><span style="color:#313131;">Active Directory OU</span><span style="color:#313131;">中的计算机，您可以创建一个单独的用户组，将其添加到</span><span style="color:#313131;">“ </span><em><span style="color:#313131;">拒绝本地登录</span></em><em><span style="color:#313131;">”</span></em><span style="color:#313131;">策略中，然后将该策略链接到包含您计算机的</span><span style="color:#313131;">OU</span><span style="color:#313131;">。想要限制登录。</span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="603" src="https://images2.imgbox.com/45/5a/tmVt8wty_o.png" width="801"></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="657" src="https://images2.imgbox.com/af/77/mnQeRRNa_o.png" width="992"></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">在大型</span><span style="color:#313131;">AD</span><span style="color:#313131;">域中，可以结合使用这些策略。例如，您要限制用户登录其他</span><span style="color:#313131;">OU</span><span style="color:#313131;">中的计算机。为此，请在每个</span><span style="color:#313131;">OU</span><span style="color:#313131;">中创建一个安全组并将所有</span><span style="color:#313131;">OU</span><span style="color:#313131;">用户添加到其中。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#313131;">提示</span></strong><span style="color:#313131;">。可以使用</span><span style="color:#313131;">Get-ADUser</span><span style="color:#313131;">和</span><span style="color:#313131;"><a href="http://woshub.com/active-directory-group-management-using-powershell/" rel="nofollow"><span style="color:#04aeda;">Add-ADGroupMember</span></a> PowerShell cmdlet</span><span style="color:#313131;">在以下脚本的帮助下将特定</span><span style="color:#313131;">OU</span><span style="color:#313131;">的用户自动添加到您的安全组中：</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">Import-module ActiveDirectory<br> $rootOU = “OU=Users,OU=UK,DC=corp,DC=woshub,DC=com”<br> $group = “corp\lon-users”<br> Get-ADUser -SearchBase $rootOu -Filter * | ForEach-Object {Add-ADGroupMember -Identity $group -Members $_ }</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">然后启用</span><span style="color:#313131;">“ </span><strong><span style="color:#313131;">允许本地登录</span></strong><span style="color:#313131;"> ”</span><span style="color:#313131;">策略，将此组添加到其中（以及不同的管理员组：域管理员，工作站管理员等），并将策略分配给计算机的</span><span style="color:#313131;">OU</span><span style="color:#313131;">。因此，您将只允许特定的</span><span style="color:#313131;">OU</span><span style="color:#313131;">用户登录到计算机。</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">如果来自其他</span><span style="color:#313131;">OU</span><span style="color:#313131;">（不允许其在本地登录）的用户尝试登录计算机，则会出现一个带有以下消息的窗口：</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">您无法登录，因为此计算机上不允许使用您使用的登录方法。请与您的网络管理员联系以获取更多信息。</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">要么：</span></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">不允许使用您尝试使用的登录方法。有关更多信息，请与您的网络管理员联系。</span></p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="137" src="https://images2.imgbox.com/72/e3/MtyJlllO_o.png" width="599"></p> 
<p style="margin-left:0cm;"><span style="color:#313131;">以下是有关登录限制策略的一些重要说明：</span></p> 
<ul><li><span style="color:#313131;">不要使用这些策略来限制对服务器或</span><span style="color:#313131;">AD</span><span style="color:#313131;">域控制器的访问；</span></li></ul> 
<p style="margin-left:0cm;"><span style="color:#313131;">如何</span><span style="color:#313131;"><a href="http://woshub.com/allow-non-administrators-rdp-access-to-domain-controller/" rel="nofollow"><span style="color:#04aeda;">允许非管理员</span><span style="color:#04aeda;">RDP</span><span style="color:#04aeda;">访问域控制器</span></a></span><span style="color:#313131;">。</span></p> 
<ul><li><span style="color:#313131;">不要通过内置</span><span style="color:#313131;">GPO</span><span style="color:#313131;">启用这些策略：默认域策略或默认域控制器策略；默认域策略或默认域控制器策略。</span></li><li><span style="color:#313131;">限制性政策具有更高的优先级；</span></li><li><span style="color:#313131;">不要忘记可以用于在计算机（服务器）上运行服务的服务帐户（包括</span><span style="color:#313131;"><a href="http://woshub.com/group-managed-service-accounts-in-windows-server-2012/" rel="nofollow"><span style="color:#04aeda;">gMSA</span></a></span><span style="color:#313131;">）；</span></li><li><span style="color:#313131;">不要使用限制本地访问整个域的策略。仅将它们链接到特定的</span><span style="color:#313131;">OU</span><span style="color:#313131;">。</span></li></ul> 
<p style="margin-left:0cm;"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/20847ce1b507d4cd7c34c282132b1869/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">@ConfigurationProperties(prefix = )异常报错解决方案：</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f9492a63f4244fa1e42bbd7da5d21ee3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ENVI5.3安装过程及常见问题解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>