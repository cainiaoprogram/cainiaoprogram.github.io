<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sklearn逻辑回归参数设置_逻辑回归模型预测 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sklearn逻辑回归参数设置_逻辑回归模型预测" />
<meta property="og:description" content="如何用分类模型预测消费者行为？ 针对类别型变量进行分析预测的方式——逻辑回归分析
分类模型和回归模型最明显的区别在于：
回归模型预测的Y是数字型变量，如销售额分类模型中，所预测的Y主要是类别型变量，如用户是否购买的标签只会有0（未购买）和1（购买） 什么是分类模型？
分类模型是机器通过学习与训练已有的数据，从而预测新数据的类别。
逻辑回归的定义
最主流的分类分析方法就是进行逻辑回归建模 模型性能稳定模型的解释变量和目标变量之间的关系容易解释逻辑回归不仅是分类模型的主力军，更是最常用的数据分析模型之一 逻辑回归模型的建立
建立逻辑回归模型，就是考虑在各种X的情况下，实现Y=1的概率。 Y=1 用户的点击/购买/注册Y=0 用户未点击/未购买/未注册对于每个需要预测的记录，都会生成一个预测的期望值 预测值，在0和1之间真实值，是1或者0预测值和真实值之间存在差值 逻辑回归模型的评估和优化
真实值和预测值会形成左图ABCD四种可能的组合。评判模型预测效果的好坏时，可用预测的正确数除以总数： (A&#43;D)/(A&#43;B&#43;C&#43;D)因此模型的优化过程就是尽可能减少 预测值和真实值之间的差值错误预测结果的数量 最常见的分类模型应用场景：
医疗肿瘤预测垃圾邮件识别个人信用评分 使用逻辑回归预测恶性肿瘤 调包与数据导入
# 导入pandas与numpy工具包。 查看数据
使用head()函数，查看前5行数据。
data.head() 数据特征解释：每个维度特征都是1～10之间的数字
Sample code number 样本代码编号Clump Thickness 肿块厚度Uniformity of Cell Size 细胞大小的均匀性Uniformity of Cell Shape 细胞形状的均匀性Marginal Adhesion 边缘粘Single Epithelial Cell Size 单上皮细胞的大小Bare Nuclei 裸核Bland Chromatin 乏味染色体Normal Nucleoli 正常核Mitoses 有丝分裂class 类别 2为良性，4为恶性 关键步骤一：缺失值处理
发现数据中有&#39;?&#39;, 为了后续的分析，使用replace()将异常值替换为标准缺失值，用dropna()将带缺失值的行舍弃，代码如下
# 将?替换为标准缺失值表示。 data = data.replace(to_replace=&#39;?&#39;, value=np.nan) # 丢弃带有缺失值的数据（只要有一个维度有缺失）。 data = data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/b662ad1d09ee7ff700a7b0c1e613c99b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-24T00:46:42+08:00" />
<meta property="article:modified_time" content="2020-11-24T00:46:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sklearn逻辑回归参数设置_逻辑回归模型预测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <h3><b>如何用分类模型预测消费者行为？</b></h3> 
 <p>针对类别型变量进行分析预测的方式——逻辑回归分析</p> 
 <p><b>分类模型和回归模型最明显的区别在于：</b></p> 
 <ul><li>回归模型预测的Y是数字型变量，如销售额</li><li>分类模型中，所预测的Y主要是类别型变量，如用户是否购买的标签只会有0（未购买）和1（购买）</li></ul> 
 <p><b>什么是分类模型？</b><br>分类模型是机器通过<b>学习与训练</b>已有的数据，从而<b>预测</b>新数据的<b>类别</b>。</p> 
 <p><b>逻辑回归的定义</b></p> 
 <ul><li>最主流的分类分析方法就是进行逻辑回归建模 
   <ul><li>模型性能稳定</li><li>模型的解释变量和目标变量之间的关系容易解释</li></ul></li><li>逻辑回归不仅是分类模型的主力军，更是最常用的数据分析模型之一</li></ul> 
 <p><b>逻辑回归模型的建立</b></p> 
 <ul><li><b>建立逻辑回归模型，就是考虑在各种X的情况下，实现Y=1的概率。</b> 
   <ul><li>Y=1 
     <ul><li>用户的点击/购买/注册</li></ul></li><li>Y=0 
     <ul><li>用户未点击/未购买/未注册</li></ul></li></ul></li><li><b>对于每个需要预测的记录，都会生成一个预测的期望值</b> 
   <ul><li>预测值，在0和1之间</li><li>真实值，是1或者0</li><li>预测值和真实值之间存在差值</li></ul></li></ul> 
 <p><b>逻辑回归模型的评估和优化</b></p> 
 <ul><li>真实值和预测值会形成左图ABCD四种可能的组合。</li><li>评判模型预测效果的好坏时，可用预测的正确数除以总数： 
   <ul><li>(A+D)/(A+B+C+D)</li></ul></li><li>因此模型的优化过程就是尽可能减少 
   <ul><li>预测值和真实值之间的差值</li><li>错误预测结果的数量 </li></ul></li></ul> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/ee/29/o3tHdGOq_o.png" alt="2541c1b9fb5d6de8deeb8b8802834de0.png"> 
 </div> 
 <p><b>最常见的分类模型应用场景：</b></p> 
 <ul><li>医疗肿瘤预测</li><li>垃圾邮件识别</li><li>个人信用评分</li></ul> 
 <hr> 
 <h3><b>使用逻辑回归预测恶性肿瘤</b></h3> 
 <p><b>调包与数据导入</b></p> 
 <div class="has"> 
  <pre class="has"><code># 导入pandas与numpy工具包。
</code></pre> 
 </div> 
 <p><b>查看数据</b></p> 
 <p>使用head()函数，查看前5行数据。</p> 
 <div class="has"> 
  <pre><code>data.head()</code></pre> 
 </div> 
 <p><b>数据特征解释：每个维度特征都是1～10之间的数字</b></p> 
 <ul><li>Sample code number 样本代码编号</li><li>Clump Thickness 肿块厚度</li><li>Uniformity of Cell Size 细胞大小的均匀性</li><li>Uniformity of Cell Shape 细胞形状的均匀性</li><li>Marginal Adhesion 边缘粘</li><li>Single Epithelial Cell Size 单上皮细胞的大小</li><li>Bare Nuclei 裸核</li><li>Bland Chromatin 乏味染色体</li><li>Normal Nucleoli 正常核</li><li>Mitoses 有丝分裂</li><li>class 类别 2为良性，4为恶性</li></ul> 
 <p><b>关键步骤一：缺失值处理</b></p> 
 <p>发现数据中有'?', 为了后续的分析，使用replace()将异常值替换为标准缺失值，用dropna()将带缺失值的行舍弃，代码如下</p> 
 <div class="has"> 
  <pre><code># 将?替换为标准缺失值表示。
data = data.replace(to_replace='?', value=np.nan)

# 丢弃带有缺失值的数据（只要有一个维度有缺失）。
data = data.dropna(how='any')

# 输出data的数据量和维度。
data.shape</code></pre> 
 </div> 
 <p>再次查看数据量和维度，发现有16行数据被舍弃低于3%，在合理范围内 。</p> 
 <p>结果解释：683条数据 9个特征 1个id 1个分类结果</p> 
 <div class="has"> 
  <pre><code>data.shape
data[column_names[1:10]].head() # 只看第2到10列，省略了对第一列ID的查看</code></pre> 
 </div> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/4f/b7/aUmIvb13_o.png" alt="f70e6f95f0d0756e3e5241c232f2ad75.png"> 
 </div> 
 <p><b>关键步骤二：拆分训练集和测试集</b><br>准备完数据后，可以开始逻辑回归建模，先拆分训练集和测试集 ，使用train_test_split将数据集拆分成训练集和测试集。<br>用test_size=0.25，意思就是75%作为训练集，25%作为测试集。调整这个系数就可以调整训练集测试集的大小</p> 
 <div class="has"> 
  <pre><code># 随机采样25%的数据用于测试，剩下的75%用于构建训练集合。
X_train, X_test, y_train, y_test = train_test_split(data[column_names[1:10]], 
#特征：第0列id去掉,第10列分类结果去掉
  data[column_names[10]],#第10列的分类结果作为目标分类变量 
  test_size=0.25, 
  random_state=33)</code></pre> 
 </div> 
 <p>此时，可以查看测试集/训练集的样本数量和类别分布。也就是测试集与训练集中良性肿瘤的数量。</p> 
 <div class="has"> 
  <pre><code>y_train.value_counts()</code></pre> 
 </div> 
 <div class="has"> 
  <pre><code>y_test.value_counts()</code></pre> 
 </div> 
 <p><b>关键步骤三：标准化数据</b></p> 
 <p>在分类模型中，为了消除特征之间的差异性，我们需要将数据标准化，也就是说，将不同的特征值控制在一定的范围内，使得不同的特征变量具有相同的尺度。代码如下：</p> 
 <div class="has"> 
  <pre><code># 从sklearn.preprocessing里导入StandardScaler。
from sklearn.preprocessing import StandardScaler
# 从sklearn.linear_model里导入LogisticRegression
from sklearn.linear_model import LogisticRegression</code></pre> 
 </div> 
 <div class="has"> 
  <pre><code># 标准化数据，保证每个维度的特征数据方差为1，均值为0。使得预测结果不会被某些维度过大的特征值而主导。
ss = StandardScaler()
X_train = ss.fit_transform(X_train)
X_test = ss.transform(X_test)</code></pre> 
 </div> 
 <p><b>关键步骤四：训练与评估模型</b></p> 
 <p>调用Lr中的fit模块训练模型参数，模型建立好之后需要评估训练效果，本案例中，提供了两种评估方法：从Sklearn导入分类报告及使用逻辑回归自带评分函数获得模型预测正确的百分比。代码如下：</p> 
 <div class="has"> 
  <pre><code>#调用Lr中的fit模块训练模型参数
lr = LogisticRegression()
lr.fit(X_train, y_train)
lr_y_predict = lr.predict(X_test)

#评估训练效果——从Sklearn导入分类报告；
from sklearn.metrics import classification_report
print(classification_report(y_test, lr_y_predict, target_names=['Benign', 'Malignant']))

#使用逻辑回归自带评分函数获得模型预测正确的百分比
print('Accuracy of LR Classifier:', lr.score(X_test, y_test))</code></pre> 
 </div> 
 <p></p> 
 <div style="text-align:center;"> 
  <img src="https://images2.imgbox.com/ab/8c/iVoRpIfO_o.png" alt="2187d3ef8ad40d7d309267cac279b9cd.png"> 
 </div> 
 <p><b>结果解读：</b></p> 
 <ul><li>Benign为良性，Malignant为恶性</li><li>support为样本个数 </li><li>recall 召回率/查全率 
   <ul><li>患有恶性肿瘤时，被诊断出的概率</li></ul></li><li>precision 精确率/查准率 
   <ul><li>诊断为恶性肿瘤时，的确患有恶性肿瘤的概率</li></ul></li></ul> 
 <p><b>召回率与精确率我们往往会更关注其中一个指标。 在这个案例中，我们显然更关注召回率，也就是应该被正确识别的恶性肿瘤的百分比 。</b></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/36a62430ca8bd782270fe14b6f23482e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">信息传播学习笔记（2）——SIS模型python代码实现（基于全局与基于节点）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b38cbe20200a9e24033aa3bc12daa459/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">您的设备不支持googleplay服务_googleplay服务无法使用和商店使用方法！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>