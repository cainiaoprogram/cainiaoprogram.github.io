<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从小白到大神之路之学习运维第42天---第三阶段----HAProxy开源负载均衡软件（工作原理、架构图、流程图、组成、centos7上部署haproxy&#43;nginx&#43;nfs（脚本部署）操作） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="从小白到大神之路之学习运维第42天---第三阶段----HAProxy开源负载均衡软件（工作原理、架构图、流程图、组成、centos7上部署haproxy&#43;nginx&#43;nfs（脚本部署）操作）" />
<meta property="og:description" content="第三阶段基础
时 间：2023年6月16日
参加人：全班人员
内 容：
HAProxy开源负载均衡软件
目录
一、主要信息
整个系统是由以下三个组件构成:
二、HAProxy 工作原理
三、架构图
四、Haproxy 流程图
五、Haproxy 组成
六、centos7上部署haproxy&#43;nginx&#43;nfs（脚本部署）
实验环境配置：
haproxy的服务器配置：
nfs&#43;rps服务器部署：
nginx服务器1部署:
nginx服务器2部署：
结果测试：
一、主要信息 HAProxy 是一款流行的开源负载均衡软件，它可以帮助在高流量网站上分担负载，提高网站的可靠性和性能。
HAProxy 通常用于将来自客户端的流量分发到多个服务器中，以实现负载均衡。
它还提供了高可用性和故障恢复功能，例如健康检查和自动切换到备用服务器。
另外，HAProxy 还提供了很多高级功能，例如 SSL 终止、HTTP 压缩和请求缓存。HAProxy 的架构是基于事件驱动的，它运行在一个单一的进程中，并使用多线程和单线程事件循环机制来处理多个并发连接。
整个系统是由以下三个组件构成: 1.**客户端**:指浏览器或其他客户端应用程序，向 HAProxy 发送请求。
2.**HAProxy 服务器**: 运行在中间层的 HAProxy 服务器，接收来自客户端的请求，并将它们转发到后端服务器以处理请求。
3.**后端服务器**:这些服务器用于响应客户端请求。HAProxy 可以链接到多个服务端以实现负载均衡。在 HAProxy 结构中，后端服务器被组织成一个服务器池，它们可以是物理或虚拟服务器
当客户端连接到 HAProxy 服务器时，它们会被定向到适当的后端服务器。HAProxy 可以使用多种负载平衡算法来判断哪些后端服务器需要处理请求。一旦 HAProxy 选择了一个后端服务器，它会将客户端的请求转发到该服务器并返回响应。HAProxy 的优势在于它可以处理数百万个并发连接，同时提供高可用性、可扩展性和性能优化功能。
二、HAProxy 工作原理 如下：
1.客户端发起连接:当客户端发起连接请求时，它将连接到 HAProxy 提供的 IP 地址和端口。
2.HAProxy 接受连接请求: HAProxy 将客户端连接请求接受到其监听的端口上，以等待后续的请求。
3.检查请求: HAProxy 会检查请求并根据预定义的负载平衡规则，将请求分发到其中一个可用的后端服务器。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a2a29140ae9ed6cee00bb367ba2cb8b0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-16T14:55:12+08:00" />
<meta property="article:modified_time" content="2023-06-16T14:55:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从小白到大神之路之学习运维第42天---第三阶段----HAProxy开源负载均衡软件（工作原理、架构图、流程图、组成、centos7上部署haproxy&#43;nginx&#43;nfs（脚本部署）操作）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:center;"><strong><strong>第三阶段基础</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">时  间：2023年6月16日</p> 
<p style="margin-left:.0001pt;text-align:justify;">参加人：全班人员</p> 
<p style="margin-left:.0001pt;text-align:justify;">内  容：</p> 
<p style="margin-left:.0001pt;text-align:center;">HAProxy开源负载均衡软件</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E4%B8%BB%E8%A6%81%E4%BF%A1%E6%81%AF-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E4%B8%BB%E8%A6%81%E4%BF%A1%E6%81%AF" rel="nofollow">一、主要信息</a></p> 
<p id="%E6%95%B4%E4%B8%AA%E7%B3%BB%E7%BB%9F%E6%98%AF%E7%94%B1%E4%BB%A5%E4%B8%8B%E4%B8%89%E4%B8%AA%E7%BB%84%E4%BB%B6%E6%9E%84%E6%88%90%3A-toc" style="margin-left:40px;"><a href="#%E6%95%B4%E4%B8%AA%E7%B3%BB%E7%BB%9F%E6%98%AF%E7%94%B1%E4%BB%A5%E4%B8%8B%E4%B8%89%E4%B8%AA%E7%BB%84%E4%BB%B6%E6%9E%84%E6%88%90%3A" rel="nofollow">整个系统是由以下三个组件构成:</a></p> 
<p id="%E4%BA%8C%E3%80%81HAProxy%20%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81HAProxy%20%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" rel="nofollow">二、HAProxy 工作原理</a></p> 
<p id="%E4%B8%89%E3%80%81%E6%9E%B6%E6%9E%84%E5%9B%BE-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E6%9E%B6%E6%9E%84%E5%9B%BE" rel="nofollow">三、架构图</a></p> 
<p id="%E5%9B%9B%E3%80%81Haproxy%20%E6%B5%81%E7%A8%8B%E5%9B%BE-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81Haproxy%20%E6%B5%81%E7%A8%8B%E5%9B%BE" rel="nofollow">四、Haproxy 流程图</a></p> 
<p id="%E4%BA%94%E3%80%81Haproxy%20%E7%BB%84%E6%88%90-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81Haproxy%20%E7%BB%84%E6%88%90" rel="nofollow">五、Haproxy 组成</a></p> 
<p id="%E5%85%AD%E3%80%81centos7%E4%B8%8A%E9%83%A8%E7%BD%B2haproxy%2Bnginx%2Bnfs%EF%BC%88%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2%EF%BC%89-toc" style="margin-left:0px;"><a href="#%E5%85%AD%E3%80%81centos7%E4%B8%8A%E9%83%A8%E7%BD%B2haproxy%2Bnginx%2Bnfs%EF%BC%88%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2%EF%BC%89" rel="nofollow">六、centos7上部署haproxy+nginx+nfs（脚本部署）</a></p> 
<p id="%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%9A" rel="nofollow">实验环境配置：</a></p> 
<p id="haproxy%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%EF%BC%9A-toc" style="margin-left:40px;"><a href="#haproxy%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%EF%BC%9A" rel="nofollow">haproxy的服务器配置：</a></p> 
<p id="nfs%2Brps%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%EF%BC%9A-toc" style="margin-left:40px;"><a href="#nfs%2Brps%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%EF%BC%9A" rel="nofollow">nfs+rps服务器部署：</a></p> 
<p id="nginx%E6%9C%8D%E5%8A%A1%E5%99%A81%E9%83%A8%E7%BD%B2%3A-toc" style="margin-left:40px;"><a href="#nginx%E6%9C%8D%E5%8A%A1%E5%99%A81%E9%83%A8%E7%BD%B2%3A" rel="nofollow">nginx服务器1部署:</a></p> 
<p id="%C2%A0nginx%E6%9C%8D%E5%8A%A1%E5%99%A82%E9%83%A8%E7%BD%B2%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%C2%A0nginx%E6%9C%8D%E5%8A%A1%E5%99%A82%E9%83%A8%E7%BD%B2%EF%BC%9A" rel="nofollow"> nginx服务器2部署：</a></p> 
<p id="%E7%BB%93%E6%9E%9C%E6%B5%8B%E8%AF%95%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E7%BB%93%E6%9E%9C%E6%B5%8B%E8%AF%95%EF%BC%9A" rel="nofollow">结果测试：</a></p> 
<hr id="hr-toc"> 
<h2 id="%E4%B8%80%E3%80%81%E4%B8%BB%E8%A6%81%E4%BF%A1%E6%81%AF" style="margin-left:.0001pt;text-align:justify;"><strong><strong>一、主要信息</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>    HAProxy 是一款流行的开源负载均衡软件</strong></strong>，它可以帮助在高流量网站上分担负载，提高网站的可靠性和性能。</p> 
<p style="margin-left:.0001pt;text-align:justify;">    HAProxy 通常用于将来自客户端的流量分发到多个服务器中，以实现负载均衡。</p> 
<p style="margin-left:.0001pt;text-align:justify;">    它还提供了高可用性和故障恢复功能，例如健康检查和自动切换到备用服务器。</p> 
<p style="margin-left:.0001pt;text-align:justify;">    另外，HAProxy 还提供了很多高级功能，例如 SSL 终止、HTTP 压缩和请求缓存。HAProxy 的架构是基于事件驱动的，它运行在一个单一的进程中，并使用多线程和单线程事件循环机制来处理多个并发连接。</p> 
<h3 id="%E6%95%B4%E4%B8%AA%E7%B3%BB%E7%BB%9F%E6%98%AF%E7%94%B1%E4%BB%A5%E4%B8%8B%E4%B8%89%E4%B8%AA%E7%BB%84%E4%BB%B6%E6%9E%84%E6%88%90%3A" style="margin-left:.0001pt;text-align:justify;"><strong><strong>整个系统是由以下三个组件构成:</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>1.**客户端**:</strong></strong>指浏览器或其他客户端应用程序，向 HAProxy 发送请求。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>2.**HAProxy 服务器**: </strong></strong>运行在中间层的 HAProxy 服务器，接收来自客户端的请求，并将它们转发到后端服务器以处理请求。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>3.**后端服务器**:</strong></strong>这些服务器用于响应客户端请求。HAProxy 可以链接到多个服务端以实现负载均衡。在 HAProxy 结构中，后端服务器被组织成一个服务器池，它们可以是物理或虚拟服务器</p> 
<p style="margin-left:.0001pt;text-align:justify;">当客户端连接到 HAProxy 服务器时，它们会被定向到适当的后端服务器。HAProxy 可以使用多种负载平衡算法来判断哪些后端服务器需要处理请求。一旦 HAProxy 选择了一个后端服务器，它会将客户端的请求转发到该服务器并返回响应。HAProxy 的优势在于它可以处理数百万个并发连接，同时提供高可用性、可扩展性和性能优化功能。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h2 id="%E4%BA%8C%E3%80%81HAProxy%20%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" style="margin-left:.0001pt;text-align:justify;"><strong><strong>二、</strong></strong><strong><strong>HAProxy 工作原理</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>如下</strong></strong><strong><strong>：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>1.客户端发起连接:</strong></strong>当客户端发起连接请求时，它将连接到 HAProxy 提供的 IP 地址和端口。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>2.HAProxy 接受连接请求:</strong></strong> HAProxy 将客户端连接请求接受到其监听的端口上，以等待后续的请求。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>3.检查请求: </strong></strong>HAProxy 会检查请求并根据预定义的负载平衡规则，将请求分发到其中一个可用的后端服务器。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>4.转发请求:</strong></strong> HAProxy 会将请求转发到选定的后端服务器处理，该服务器将处理请求并返回HAProxy。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>5.HAProxy 返回响应:</strong></strong>一旦后端服务器处理完成请求，HAProxy 将返回响应到客户端。</p> 
<p style="margin-left:.0001pt;text-align:justify;">在 HAProxy 的架构中，它担当了传统的 TCP/HTTP 服务器和反向代理的角色。HAProxy 可以在应用层、TCP 层、IP 层对客户端请求进行负载均衡，同时可以在响应返回之前对请求进行修改。需要注意的是，HAProxy 几乎没有任何延迟，因为 它实现了事件驱动机制和无阻塞l/0，因此可以通过多线程和多核 CPU 等技术来处理并发连接。此外，HAProxy 还支持 TLS终止、HTTP 压缩、请求缓存等高级功能。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h2 id="%E4%B8%89%E3%80%81%E6%9E%B6%E6%9E%84%E5%9B%BE" style="margin-left:.0001pt;text-align:justify;"><strong><strong>三、架构图</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>以下是 HAProxy 的简化架构图，展示了客户端、HAProxy 和后端服务器之间的关系:</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="526" src="https://images2.imgbox.com/e1/90/4BGugoCu_o.png" width="558"></p> 
<p style="margin-left:.0001pt;text-align:justify;">在上图中，客户端向 HAProxy 发送请求。HAProxy 将请求路由到适当的后端服务器，并将响应从服务器返回给客户端。HAProxy 架构的优势在于它可以提供高可用性、可扩展性和性能优化功能，因此它已成为在线应用程序的主要负载平衡解决方案之一。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h2 id="%E5%9B%9B%E3%80%81Haproxy%20%E6%B5%81%E7%A8%8B%E5%9B%BE" style="margin-left:.0001pt;text-align:justify;"><strong><strong>四、Haproxy 流程图</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>以下是 HAProxy 的简化流程图，描述了客户端请求如何通过 HAProxy 进行负载均衡:</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="445" src="https://images2.imgbox.com/82/a9/hxXT6s3m_o.png" width="507"></p> 
<p style="margin-left:.0001pt;text-align:justify;">在上面的流程中，客户端向 HAProxy 发送请求，HAProxy 根据其负载平衡规则选择可用的后端服务器来处理请求。选定的后端服务器将请求处理并返回响应，HAProxy 在响应中暗示给客户端。HAProxy 通过使用一些算法来选择一个最合适的后端服务器，其中包括轮询和IP散列等负载均衡算法。HAProxy 还提供了其他高级功能，例如粘性会话和 SSL 卸载。</p> 
<p style="margin-left:.0001pt;text-align:justify;">需要注意的是，上面的流程图中省略了一些细节，例如 TCP 层和应用程序层请求处理等。实际上，HAProxy 可以在应用程序层、TCP 层和P 层上操作，并可以根据需要进行筛选和修改。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h2 id="%E4%BA%94%E3%80%81Haproxy%20%E7%BB%84%E6%88%90" style="margin-left:.0001pt;text-align:justify;"><strong><strong>五、</strong></strong><strong><strong>Haproxy 组成</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;">HAProxy 主要由以下组件组成:</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>1.**haproxy 二进制可执行文件**:</strong></strong> haproxyj二进制可执行文件是 HAProxy 的核心组件，实现了负载均衡、反向代理等功能。管理员可以使用 haproxy 二进制文件来启动、停止和管理HAProxy 进程，并指定配置文件和日志文件等参数。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>2.**配置文件**:</strong></strong>配置文件包含 HAProxy 服务的各种配置，例如监听 P 和端口、后端服务器列表、负载均衡算法、匹配规则、转发规则等。管理员可以编辑配置文件来自定义 HAProxy服务，同时也可以使用 HAProxy 的命令行选项覆盖配置文件的某些设置。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>3.**统计数据界面**:</strong></strong> HAProxy 提供了一个统计数据界面，可以通过该界面查看 HAProxy 服务的各项指标，例如吞吐量、连接数、CPU 利用率、内存利用率、后端服务器状态等。管理员可以使用这些指标来监控 HAProxy 服务的运行状态，并进行问题排查和性能优化。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>4.**日志文件**:</strong></strong>HAProxy 可以将报告存储在日志文件中，以便管理员进行问题排查和诊断。管理员可以在 HAProxy 的配置文件中指定日志文件路径、日志级别等选项，以满足不同的需求。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>5.**管理工具**:</strong></strong> HAProxy 提供了一些管理工具，帮助管理员更轻松地管理 HAProxy 服务。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>例如</strong></strong><strong><strong>：</strong></strong>“haproxy-systemd-wrapper 是一个用于启动和停止 HAProxy 服务的管理工具;haproxycl可以用于执行诸如热重载、重新启动、暂停和恢复服务等操作。</p> 
<p style="margin-left:.0001pt;text-align:justify;">总的来说，以上组件共同构成了 HAProxy 的体系结构，提供了负载均衡、反向代理、监控和管理等功能，使得 <strong><strong>HAProxy </strong></strong>成为一个<strong><strong>强大而灵活的开源负载均衡器</strong></strong>。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h2 id="%E5%85%AD%E3%80%81centos7%E4%B8%8A%E9%83%A8%E7%BD%B2haproxy%2Bnginx%2Bnfs%EF%BC%88%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2%EF%BC%89" style="margin-left:0px;text-align:left;"><strong><strong>六、</strong></strong><strong><strong>centos7上部署haproxy+nginx+nfs（脚本部署）</strong></strong></h2> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>目  的：</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>    </strong>两台nginx服务器做web服务，haproxy服务器做调度负载均衡，为保证提供的内容一致性使用nfs做共享目录，两台nginx服务器使用相同的共享目录文件提供web服务</p> 
<table border="1" cellspacing="0" style="margin-left:4.8pt;width:438pt;"><tbody><tr><td colspan="3" style="width:438pt;"> <p style="margin-left:.0001pt;text-align:center;">硬件需求</p> </td></tr><tr><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">centos7服务器</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">haproxy</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">192.168.1.107</p> </td></tr><tr><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">centos7服务器</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">nginx</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">192.168.1.136</p> </td></tr><tr><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">centos7服务器</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">nginx</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">192.168.1.145</p> </td></tr><tr><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">centos7服务器</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">nfs+rps</p> </td><td style="background-color:#ffffff;width:146pt;"> <p style="margin-left:.0001pt;text-align:center;">192.168.1.108</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="337" src="https://images2.imgbox.com/2c/d3/Qbh4cniW_o.png" width="728"></p> 
<h3 id="%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%EF%BC%9A" style="margin-left:.0001pt;text-align:justify;"><strong><strong>实验环境</strong></strong><strong><strong>配置：</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;">四台服务器均进行以下设置：</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">请关闭防火墙和selinux再执行后续操作</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#关闭防火墙和selinux代码如下</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl stop firewalld.service    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#停止防火墙服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl disable firewalld.service  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#开机不自启动防火墙服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">sed -i 's/SELINUX=.*/SELINUX=disabled/'</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/sysconfig/selinux   </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#将selinux的配置文件改为不启动</p> 
 <p style="margin-left:.0001pt;text-align:justify;">reboot   #重启服务器，修改selinux配置后重启生效</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="322" src="https://images2.imgbox.com/a2/13/OTxPuEkc_o.png" width="727"></p> 
<p> </p> 
<h3 id="haproxy%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%EF%BC%9A" style="margin-left:.0001pt;text-align:justify;"><strong><strong>haproxy的服务器</strong></strong><strong><strong>配置：</strong></strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">在作为haproxy的服务器上导入以下shell执行haproxy安装</p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>vim install-haproxy.sh</strong></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;">Chmod 755 <strong><strong>install-haproxy.sh</strong></strong></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="324" src="https://images2.imgbox.com/d0/29/H0JAg35V_o.png" width="744"></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#!/bin/bash</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#function:安装haproxy修改配置文件并添加两台web</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#author:999vip 2021118</p> 
 <p style="margin-left:.0001pt;text-align:justify;">yum install haproxy -y  #yum安装haproxy</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 请输入nginx服务器1ip  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">read a          #弹出输入框并将输入内容作为变量a</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 请输入nginx服务器2ip</p> 
 <p style="margin-left:.0001pt;text-align:justify;">read b          #弹出输入框并将输入内容作为变量a</p> 
 <p style="margin-left:.0001pt;text-align:justify;">sed -i "82s/127.0.0.1:5001/$a:80/"  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg        </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#替换haproxy的配置文件82行为nginx1的ip</p> 
 <p style="margin-left:.0001pt;text-align:justify;">sed -i "83s/127.0.0.1:5002/$b:80/"  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg        </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#替换haproxy的配置文件83行为nginx2的ip</p> 
 <p style="margin-left:.0001pt;text-align:justify;">sed -i '63s/5000/80/'  /etc/haproxy/haproxy.cfg  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#将haproxy的默认5000端口改为80端口</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "listen admin_stats" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg               </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#设置haproxy的web管理用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats enable" &gt;&gt; /etc/haproxy/haproxy.cfg                     </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#开启haproxy程序web服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "bind *:8080" &gt;&gt; /etc/haproxy/haproxy.cfg                      </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#haproxy管理页面端口为8080</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "mode http" &gt;&gt; /etc/haproxy/haproxy.cfg                        </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#以下为haproxy系统配置</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "option httplog" &gt;&gt; /etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "log global" &gt;&gt; /etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "maxconn 10" &gt;&gt; /etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats refresh 30s" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats uri /admin" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats realm haproxy" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats auth admin:admin" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats hide-version" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "stats admin if TRUE" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/etc/haproxy/haproxy.cfg              </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#以上为haproxy系统配置</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start haproxy.service                                     </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#开启haproxy程序</p> 
 <p style="margin-left:.0001pt;text-align:justify;">c=$(ip a | grep "inet "|grep ens33| awk '{print $2}'|awk -F/ '{print $1}')  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#变量c等于本机ip</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo haproxy部署完成</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 访问$c将自动轮询$a和$b的web页面</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 访问$c:8080/admin为haproxy程序的管理页面</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 管理页面登录账户为admin密码为admin</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="270" src="https://images2.imgbox.com/3a/d3/FHWfW0P6_o.png" width="715"></p> 
<p style="margin-left:.0001pt;text-align:justify;">执行结果如下，在弹出的提示语后分别输入两台<a href="https://so.csdn.net/so/search?q=nginx&amp;spm=1001.2101.3001.7020" title="nginx">nginx</a>服务器ip地址（根据实际环境输入）</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>例：</strong></strong></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>nginx1：192.168.1.136</strong></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>nginx2：192.168.1.145</strong></strong></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="231" src="https://images2.imgbox.com/28/9c/WWJftLBh_o.png" width="779"></p> 
<p style="margin-left:.0001pt;text-align:justify;">浏览器访问测试：192.168.1.107:8080/admin</p> 
<p style="margin-left:.0001pt;text-align:justify;">输入账户和密码</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="349" src="https://images2.imgbox.com/89/40/Goee1xZj_o.png" width="800"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>结果如下：</strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="637" src="https://images2.imgbox.com/38/dd/xA9cqNBQ_o.png" width="820"></p> 
<p></p> 
<h3 id="nfs%2Brps%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%EF%BC%9A" style="margin-left:.0001pt;text-align:justify;"><strong><strong>nfs+rps</strong></strong><strong><strong>服务器部署：</strong></strong></h3> 
<p style="margin-left:.0001pt;text-align:justify;">由于nginx服务需要用的nfs共享目录，这里我们先部署nfs在部署nginx</p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>vim install-nfs-rps.sh</strong></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>chomod 755 install-nfs-rps.sh</strong></strong></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="314" src="https://images2.imgbox.com/b2/7d/sZiCuNbU_o.png" width="692"></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#!/bin/bash</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#function:安装nfs 创建/app/file作为共享文件</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#author:999vip 20211118</p> 
 <p style="margin-left:.0001pt;text-align:justify;">yum install nfs-utils rpcbind -y</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#yum安装nfs和rpc服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">touch /etc/exports               </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#创建nfc的配置文件</p> 
 <p style="margin-left:.0001pt;text-align:justify;">mkdir -p /app/file               </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#创建nfc共享文件目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">chown -R nfsnobody.nfsnobody /app/file/</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#赋予共享目录nfs权限</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "/app/file *(rw,sync)" &gt;&gt; /etc/exports</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#允许所有IP访问nfs共享目录并有可读写权限</p> 
 <p style="margin-left:.0001pt;text-align:justify;">exportfs –rv                               </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#载入配置</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl enable nfs                        </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#开机自启动nfs</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl enable rpcbind          #开机自启动rps</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start nfs                #启动nfs程序</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start rpcbind            #启动rps程序</p> 
 <p style="margin-left:.0001pt;text-align:justify;">touch /app/file/index.html</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#在共享目录下创建网页文件</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo "&lt;h1&gt;<strong><span style="background-color:#ffff00;"><strong>chenjiafengmeiyouxiaoji</strong></span></strong><strong><span style="background-color:#ffff00;"><strong>i</strong></span></strong>&lt;/h1&gt;" &gt;&gt;</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/app/file/index.html</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#在网页文件中写入要显示的数据</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo nfs服务部署完成</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="375" src="https://images2.imgbox.com/ee/07/d5F6kVc6_o.png" width="688"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong>运行结果如下表示已完成nfs服务部署</strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="347" src="https://images2.imgbox.com/5d/43/dBhjm4Xw_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<h3 id="nginx%E6%9C%8D%E5%8A%A1%E5%99%A81%E9%83%A8%E7%BD%B2%3A" style="margin-left:.0001pt;text-align:justify;"><strong><strong>nginx服务器1部署</strong></strong><strong><strong>:</strong></strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">vim install-ninx1.sh</p> 
 <p style="margin-left:.0001pt;text-align:justify;">chomod 755 install-ninx1.sh</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="317" src="https://images2.imgbox.com/ab/a2/WQckxZt2_o.png" width="732"></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#!/bin/bash</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#function: Centos7一键安装nginux</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#author:999vip 20211117</p> 
 <p style="margin-left:.0001pt;text-align:justify;">yum -y install  gcc gcc-c++ autoconf automake libtool make openssl openssl-devel pcre pcre-devel #安装nginx所需环境</p> 
 <p style="margin-left:.0001pt;text-align:justify;">cd  /usr/local/src/                                                                              </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#切换到安装目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">wget  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">http://nginx.org/download/nginx-1.8.1.tar.gz                                               </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#下载nginx到当前目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">tar -zxvf nginx-1.8.1.tar.gz                                                                 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#解压nginx安装包</p> 
 <p style="margin-left:.0001pt;text-align:justify;">cd  nginx-1.8.1       #进入解压后目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">./configure \--prefix=/usr/local/nginx</p> 
 <p style="margin-left:.0001pt;text-align:justify;">\--with-http_ssl_module \--with-http_flv_module</p> 
 <p style="margin-left:.0001pt;text-align:justify;">\--with-http_stub_status_module</p> 
 <p style="margin-left:.0001pt;text-align:justify;">\--with-http_gzip_static_module \--with-pcre                                                     </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#编译文件</p> 
 <p style="margin-left:.0001pt;text-align:justify;">make &amp;&amp; make install      #编译安装                                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">cd  /usr/local/nginx      #进入nginx安装目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">sed -i '14s/nginx/BDQN/'</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/usr/local/nginx/html/index.html                                        </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#方便测试区分将网页中nginx改为BDQN</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/usr/local/nginx/sbin/nginx      #启动nginx服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo nginx部署完成，</p> 
 <p style="margin-left:.0001pt;text-align:justify;">请测试web页面   #屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 接下来将部署nfs并映射html,请确认是否继续                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 键入任意值将继续操作，如需中断请按Ctrl+c                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">read a                                                                                         </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#弹出框暂停执行，用户键入任意值继续执行，键入值作为变量a但后续并不调用这个变量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">yum install nfs-utils rpcbind  -y                                                                </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#安装nfs和rpc服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl enable nfs        #开机自启动nfs服务                                                                     </p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl enable rpcbind   #开机自启动rps服务                                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start nfs    #启动nfs服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start rpcbind    #启动rpc服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo nfs服务安装完成，接下来将进行挂载操作                                                       </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 键入任意值将继续操作，如需中断请按Ctrl+c                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 请输入nfs服务器ip                                                                           </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">read b           #将键入值作为变量b</p> 
 <p style="margin-left:.0001pt;text-align:justify;">mount -t nfs $b:/app/file /usr/local/nginx/html/                                                 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#挂载nfs上的目录到nginx的html目录下</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="346" src="https://images2.imgbox.com/45/76/jnn06hiO_o.png" width="692"></p> 
<p style="margin-left:.0001pt;text-align:justify;">注意：运行到下面这里时提示nginx部署完成，按任意键进行下一步时可暂停下，进行nginx2服务器部署</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>手动输入nfs服务器ip</strong></strong></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>例：192.168.1.108</strong></strong></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="347" src="https://images2.imgbox.com/ce/1c/6KL8NYU6_o.png" width="692"></p> 
<p><strong> 网页输入验证：192.168.1.107</strong></p> 
<p><img alt="" height="344" src="https://images2.imgbox.com/a1/1f/6aSnYYAf_o.png" width="679"></p> 
<p></p> 
<h3 id="%C2%A0nginx%E6%9C%8D%E5%8A%A1%E5%99%A82%E9%83%A8%E7%BD%B2%EF%BC%9A" style="margin-left:.0001pt;text-align:justify;"><strong><strong> nginx服务器2部署</strong></strong><strong><strong>：</strong></strong></h3> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>vim install-ninx2.sh</strong></strong></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><strong><strong>chomod 755 install-ninx2.sh</strong></strong></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="218" src="https://images2.imgbox.com/90/97/9aKI3KaK_o.png" width="692"></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;">#!/bin/bash</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#function: Centos7一键安装nginux</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#author:999vip 20211117</p> 
 <p style="margin-left:.0001pt;text-align:justify;">yum -y install  gcc gcc-c++ autoconf automake libtool make openssl openssl-devel pcre pcre-devel</p> 
 <p style="margin-left:.0001pt;text-align:justify;">#安装nginx所需环境</p> 
 <p style="margin-left:.0001pt;text-align:justify;">cd  /usr/local/src/   #切换到安装目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">wget  </p> 
 <p style="margin-left:.0001pt;text-align:justify;">http://nginx.org/download/nginx-1.8.1.tar.gz                                               </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#下载nginx到当前目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">tar -zxvf nginx-1.8.1.tar.gz                                                                     </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#解压nginx安装包</p> 
 <p style="margin-left:.0001pt;text-align:justify;">cd  nginx-1.8.1    #进入解压后目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">./configure \--prefix=/usr/local/nginx</p> 
 <p style="margin-left:.0001pt;text-align:justify;">\--with-http_ssl_module \--with-http_flv_module</p> 
 <p style="margin-left:.0001pt;text-align:justify;">\--with-http_stub_status_module</p> 
 <p style="margin-left:.0001pt;text-align:justify;">\--with-http_gzip_static_module \--with-pcre                                                     </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#编译文件</p> 
 <p style="margin-left:.0001pt;text-align:justify;">make &amp;&amp; make install   #编译安装</p> 
 <p style="margin-left:.0001pt;text-align:justify;">cd  /usr/local/nginx     #进入nginx安装目录</p> 
 <p style="margin-left:.0001pt;text-align:justify;">/usr/local/nginx/sbin/nginx     #启动nginx服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo nginx部署完成，</p> 
 <p style="margin-left:.0001pt;text-align:justify;">请测试web页面         #屏幕输出内容提醒用户                                                       </p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 接下来将部署nfs并映射html,请确认是否继续                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 键入任意值将继续操作，如需中断请按Ctrl+c                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">read a                                                                                           </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#弹出框暂停执行，用户键入任意值继续执行，</p> 
 <p style="margin-left:.0001pt;text-align:justify;">键入值作为变量a但后续并不调用这个变量</p> 
 <p style="margin-left:.0001pt;text-align:justify;">yum install nfs-utils rpcbind  -y                                                                </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#安装nfs和rpc服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl enable nfs  #开机自启动nfs服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl enable rpcbind     #开机自启动rps服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start nfs    #启动nfs服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">systemctl start rpcbind      #启动rpc服务</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo nfs服务安装完成，接下来将进行挂载操作                                                       </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 键入任意值将继续操作，如需中断请按Ctrl+c                                                    </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">echo 请输入nfs服务器ip                                                                           </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#屏幕输出内容提醒用户</p> 
 <p style="margin-left:.0001pt;text-align:justify;">read b             #将键入值作为变量b                                                                              </p> 
 <p style="margin-left:.0001pt;text-align:justify;">mount -t nfs $b:/app/file /usr/local/nginx/html/                                                 </p> 
 <p style="margin-left:.0001pt;text-align:justify;">#挂载nfs上的目录到nginx的html目录下</p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="409" src="https://images2.imgbox.com/c0/af/dwOAxJBx_o.png" width="755"></p> 
<p> </p> 
<h3 id="%E7%BB%93%E6%9E%9C%E6%B5%8B%E8%AF%95%EF%BC%9A" style="margin-left:.0001pt;text-align:justify;">结果测试：</h3> 
<p style="margin-left:.0001pt;text-align:justify;">同样，在提示nginx部署完成时不按回车，进行haproxy测试，访问haproxy服务器的web页面会自动转到nginx1服务器的web页面，点击刷新后会跳转到nginx2服务器的web页面，多次刷新会顺序跳转</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="344" src="https://images2.imgbox.com/96/da/vOmN1pON_o.png" width="679"></p> 
<p style="margin-left:.0001pt;text-align:justify;"> 这时测试完成，能正常做到<a href="https://so.csdn.net/so/search?q=%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1&amp;spm=1001.2101.3001.7020" title="负载均衡">负载均衡</a>，到nginx上敲下回车或者键入任意值回车进行nfs安装，安装完成后提示输入nfs服务器ip(根据实际部署的ip进行输入）</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="359" src="https://images2.imgbox.com/bc/88/G6QnGKZd_o.png" width="724"></p> 
<p style="margin-left:.0001pt;text-align:justify;">输入后会自动挂载nfs上脚本创建的目录到本地，这时再去访问haproxy的web页面发现出现的页面发生变化了，而且刷新也是相同界面，到这里就实现了负载均衡加页面统</p> 
<p><img alt="" height="407" src="https://images2.imgbox.com/b9/19/pUcWbwWT_o.png" width="727"></p> 
<p style="margin-left:.0001pt;text-align:justify;"> 到这里我们就可以去haproxy后台查看转发记录了，浏览器访问haproxy的IP:8080/admin进入后台</p> 
<p style="margin-left:.0001pt;text-align:justify;">账户名：admin 密码：admin</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="384" src="https://images2.imgbox.com/f7/9a/28rS3LOn_o.png" width="717"></p> 
<p style="margin-left:.0001pt;text-align:justify;">  后台显示两台nginx转发次数相差不超过±1即为正常，至此搭建完成，可以将项目移交给开发人员进行网站开发了。</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/86699b55c9214b8022b78f96227e5e09/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">go语言web开发系列之十六:gin框架中通过gorm使用事务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ab79de825cf9a456859087bec42a8fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">echarts图表-饼图、柱状图、折线图、散点图之间相互切换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>