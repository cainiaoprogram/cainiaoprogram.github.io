<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>YOLOv5快速训练目标检测模型记录 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="YOLOv5快速训练目标检测模型记录" />
<meta property="og:description" content="YOLOv5快速训练目标检测模型 训练准备环境配置图片标注数据集制作下载YOLOv5Gituhub代码 模型训练文件修改开始训练 模型预测遇到的问题图片无法读入训练模型后预测没效果no moddule named &#39;nn.mobilenetv3&#39; 问题 刚完成智能小车比赛视觉模型训练，将模型训练中遇到的问题和过程记录如下 训练准备 环境配置 使用的是win10系统，显卡为3060，环境配置Anaconda&#43;python3.8&#43;cuda11.4&#43;cudnn对应版本
CUDA下载
cudnn下载
图片标注 数据集：根据官方文档要求制作数据集，图像标注这里采用的是Github上开源的labelImg，可以按照需求制作voc或yolo格式数据集，这里采用的是YOLO模式输出数据，标注后会生成一个含图像分类和坐标的txt文件，当所有图像标注完成后可以在文件下下classes文件内查看所有分类。
标注工具链接: labellmg
tips：软件包含快捷键 Q，E为翻图，W为标注框选定，在右侧设置好默认标签后可以实现快速标注。
标注完成后会获得一个标签文件，文件中包含：标签类别序号和对应的坐标位置，每张图片会生成一个标签文件
以及一个classes文件，该文件中包含所有的类别标签，且与标签文件中的数字相对应。
数据集制作 这里用了最简单的方式制作数据集，按照官方示例中的介绍，将图像文件和标签文件划分整理，放进不同名字的文件夹中。注意图像文件和标签文件应在文件夹中一一对应。
文件夹格式： --datasets --images --train --val --labels --train --val 下载YOLOv5Gituhub代码 下载YOLOv5Gituhub代码至本地，链接: YOLOv5.
模型训练 文件修改 开始训练前，需要对配置文件进行简单的修改，以适应我们的数据集。
需要修改的文件 yolov5/train.py
train.py 485-490行 其他参数感兴趣的可以自选搜索修改 def parse_opt(known=False): parser = argparse.ArgumentParser() parser.add_argument(&#39;--weights&#39;, type=str, default=&#39;yolov5s.pt&#39;, help=&#39;initial weights path&#39;) #加载的权重文件，这里选择的是 yolov5s.pt 轻量模型权重。 parser.add_argument(&#39;--cfg&#39;, type=str, default=&#39;models/yolov5s.yaml&#39;, help=&#39;model.yaml path&#39;)#选取对应的模型配置文件和网络结构位置。 parser.add_argument(&#39;--data&#39;, type=str, default=&#39;data/coco128.yaml&#39;, help=&#39;dataset.yaml path&#39;)#数据集配置文件位置 parser.add_argument(&#39;--hyp&#39;, type=str, default=&#39;data/hyps/hyp." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/45957dcf31848cd7e330468960d2de95/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-17T14:24:24+08:00" />
<meta property="article:modified_time" content="2023-02-17T14:24:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">YOLOv5快速训练目标检测模型记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>YOLOv5快速训练目标检测模型</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">训练准备</a></li><li><ul><li><a href="#_3" rel="nofollow">环境配置</a></li><li><a href="#_7" rel="nofollow">图片标注</a></li><li><a href="#_18" rel="nofollow">数据集制作</a></li><li><a href="#YOLOv5Gituhub_32" rel="nofollow">下载YOLOv5Gituhub代码</a></li></ul> 
   </li><li><a href="#_36" rel="nofollow">模型训练</a></li><li><ul><li><a href="#_37" rel="nofollow">文件修改</a></li><li><a href="#_80" rel="nofollow">开始训练</a></li></ul> 
   </li><li><a href="#_199" rel="nofollow">模型预测</a></li><li><a href="#_218" rel="nofollow">遇到的问题</a></li><li><ul><li><a href="#_219" rel="nofollow">图片无法读入</a></li><li><a href="#_227" rel="nofollow">训练模型后预测没效果</a></li><li><a href="#no_moddule_named_nnmobilenetv3__230" rel="nofollow">no moddule named 'nn.mobilenetv3' 问题</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 刚完成智能小车比赛视觉模型训练，将模型训练中遇到的问题和过程记录如下 
<p></p> 
<h3><a id="_2"></a>训练准备</h3> 
<h4><a id="_3"></a>环境配置</h4> 
<p>使用的是win10系统，显卡为3060，环境配置Anaconda+python3.8+cuda11.4+cudnn对应版本<br> <a href="https://developer.nvidia.com/cuda-toolkit-archive" rel="nofollow">CUDA下载</a><br> <a href="https://developer.nvidia.com/rdp/cudnn-download" rel="nofollow">cudnn下载</a></p> 
<h4><a id="_7"></a>图片标注</h4> 
<p>数据集：根据官方文档要求制作数据集，图像标注这里采用的是Github上开源的labelImg，可以按照需求制作voc或yolo格式数据集，这里采用的是YOLO模式输出数据，标注后会生成一个含图像分类和坐标的txt文件，当所有图像标注完成后可以在文件下下classes文件内查看所有分类。</p> 
<p>标注工具链接: <a href="https://github.com/tzutalin/labelImg">labellmg</a><br> <img src="https://images2.imgbox.com/58/4f/jtH1nknh_o.png" alt="labellmg界面展示"><br> tips：软件包含快捷键 Q，E为翻图，W为标注框选定，在右侧设置好默认标签后可以实现快速标注。</p> 
<p>标注完成后会获得一个标签文件，文件中包含：标签类别序号和对应的坐标位置，每张图片会生成一个标签文件<br> <img src="https://images2.imgbox.com/9c/ee/06cVpGFR_o.png" alt="在这里插入图片描述"><br> 以及一个classes文件，该文件中包含所有的类别标签，且与标签文件中的数字相对应。<br> <img src="https://images2.imgbox.com/7a/05/93gGoK8F_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_18"></a>数据集制作</h4> 
<p>这里用了最简单的方式制作数据集，按照官方示例中的介绍，将图像文件和标签文件划分整理，放进不同名字的文件夹中。注意图像文件和标签文件应在文件夹中一一对应。</p> 
<pre><code>文件夹格式：
--datasets
	--images
	  		--train
  			--val
  	--labels
  			--train
  			--val
</code></pre> 
<h4><a id="YOLOv5Gituhub_32"></a>下载YOLOv5Gituhub代码</h4> 
<p>下载YOLOv5Gituhub代码至本地，链接: <a href="https://github.com/ultralytics/yolov5">YOLOv5</a>.</p> 
<h3><a id="_36"></a>模型训练</h3> 
<h4><a id="_37"></a>文件修改</h4> 
<p>开始训练前，需要对配置文件进行简单的修改，以适应我们的数据集。<br> 需要修改的文件 yolov5/train.py</p> 
<pre><code class="prism language-javascript">train<span class="token punctuation">.</span>py   <span class="token number">485</span><span class="token operator">-</span><span class="token number">490</span>行 其他参数感兴趣的可以自选搜索修改
def <span class="token function">parse_opt</span><span class="token punctuation">(</span>known<span class="token operator">=</span>False<span class="token punctuation">)</span><span class="token operator">:</span>
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span><span class="token function">ArgumentParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--weights'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'yolov5s.pt'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'initial weights path'</span><span class="token punctuation">)</span> #加载的权重文件，这里选择的是 yolov5s<span class="token punctuation">.</span>pt 轻量模型权重。
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--cfg'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'models/yolov5s.yaml'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'model.yaml path'</span><span class="token punctuation">)</span>#选取对应的模型配置文件和网络结构位置。
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--data'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'data/coco128.yaml'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'dataset.yaml path'</span><span class="token punctuation">)</span>#数据集配置文件位置
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--hyp'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'data/hyps/hyp.scratch.yaml'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'hyperparameters path'</span><span class="token punctuation">)</span>#超参  选默认未修改
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--epochs'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>#训练轮数
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--batch-size'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'total batch size for all GPUs'</span><span class="token punctuation">)</span>#每批量输入图片数量，根据显存大小设定即可
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--img-size'</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">]</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'[train, test] image sizes'</span><span class="token punctuation">)</span>#图像输入大小，测试中发现小于<span class="token number">640</span>时会出现训练结果不预测情况，建议<span class="token number">640</span><span class="token operator">*</span><span class="token number">640</span>输入
 
</code></pre> 
<p>接下来修改 yolov5\models\yolov5s.yaml 文件，修改后记得保存</p> 
<pre><code class="prism language-javascript"># parameters  修改类别，其他参数感兴趣同样可以自行研究修改
<span class="token literal-property property">nc</span><span class="token operator">:</span> <span class="token number">8</span>  # number <span class="token keyword">of</span> classes   将此处修改为我们需要检测的分类数量 
<span class="token literal-property property">depth_multiple</span><span class="token operator">:</span> <span class="token number">0.33</span>  # model depth multiple
<span class="token literal-property property">width_multiple</span><span class="token operator">:</span> <span class="token number">0.50</span>  # layer channel multiple
</code></pre> 
<p>接下来修改 yolov5\data/coco128.yaml 文件，可以直接在文件中修改，也可以自己重写</p> 
<pre><code class="prism language-javascript"># <span class="token constant">COCO</span> <span class="token number">2017</span> dataset http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>cocodataset<span class="token punctuation">.</span>org <span class="token operator">-</span> first <span class="token number">128</span> training images
# Train command<span class="token operator">:</span> python train<span class="token punctuation">.</span>py <span class="token operator">--</span>data coco128<span class="token punctuation">.</span>yaml
# Default dataset location is next to YOLOv5<span class="token operator">:</span>
#   <span class="token operator">/</span>parent
#     <span class="token operator">/</span>datasets<span class="token operator">/</span>coco128
#     <span class="token operator">/</span>yolov5

# Train<span class="token operator">/</span>val<span class="token operator">/</span>test sets <span class="token keyword">as</span> <span class="token number">1</span><span class="token punctuation">)</span> dir<span class="token operator">:</span> path<span class="token operator">/</span>to<span class="token operator">/</span>imgs<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> file<span class="token operator">:</span> path<span class="token operator">/</span>to<span class="token operator">/</span>imgs<span class="token punctuation">.</span>txt<span class="token punctuation">,</span> or <span class="token number">3</span><span class="token punctuation">)</span> list<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token operator">/</span>to<span class="token operator">/</span>imgs1<span class="token punctuation">,</span> path<span class="token operator">/</span>to<span class="token operator">/</span>imgs2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>datasets<span class="token operator">/</span>coco  # 选择数据集位置
<span class="token literal-property property">train</span><span class="token operator">:</span> images<span class="token operator">/</span>train  # train images 位置
<span class="token literal-property property">val</span><span class="token operator">:</span> images<span class="token operator">/</span>val  # val images 位置
<span class="token literal-property property">test</span><span class="token operator">:</span>  # test <span class="token function">images</span> <span class="token punctuation">(</span>optional<span class="token punctuation">)</span>  #测试集可选，我没用

# Classes
<span class="token literal-property property">nc</span><span class="token operator">:</span> <span class="token number">8</span>  # 类别数
<span class="token literal-property property">names</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'magiccube'</span><span class="token punctuation">,</span><span class="token string">'redbull'</span><span class="token punctuation">,</span><span class="token string">'ball'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'beer'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'qingdao'</span><span class="token punctuation">,</span><span class="token string">'dp'</span> <span class="token punctuation">]</span>  # <span class="token keyword">class</span> <span class="token class-name">names</span>  #每个类别对应的标签

</code></pre> 
<h4><a id="_80"></a>开始训练</h4> 
<p>修改完成后，可以直接运行train.py文件启动训练，当然也可以如同官方示例一样，在终端中用代码的方式为参数赋值训练，参考链接: <a href="https://github.com/ultralytics/yolov5/wiki/Train-Custom-Data">Train Custom Data</a>.</p> 
<p>这里把训练日志贴出来，为了方便展示只训练了10轮，训练完成后模型会保存在<br> runs\train\exp35\weights中，可以在该文件夹下看到训练中模型的各种拟合曲线。</p> 
<pre><code class="prism language-bash">train: <span class="token assign-left variable">weights</span><span class="token operator">=</span>yolov5s.pt, <span class="token assign-left variable">cfg</span><span class="token operator">=</span>models/yolov5s.yaml, <span class="token assign-left variable">data</span><span class="token operator">=</span>data/coco128.yaml, <span class="token assign-left variable">hyp</span><span class="token operator">=</span>data/hyps/hyp.scratch.yaml, <span class="token assign-left variable">epochs</span><span class="token operator">=</span><span class="token number">10</span>, <span class="token assign-left variable">batch_size</span><span class="token operator">=</span><span class="token number">16</span>, <span class="token assign-left variable">img_size</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">640</span>, <span class="token number">640</span><span class="token punctuation">]</span>, <span class="token assign-left variable">rect</span><span class="token operator">=</span>False, <span class="token assign-left variable">resume</span><span class="token operator">=</span>False, <span class="token assign-left variable">nosave</span><span class="token operator">=</span>False, <span class="token assign-left variable">notest</span><span class="token operator">=</span>False, <span class="token assign-left variable">noautoanchor</span><span class="token operator">=</span>False, <span class="token assign-left variable">evolve</span><span class="token operator">=</span>False, <span class="token assign-left variable">bucket</span><span class="token operator">=</span>, <span class="token assign-left variable">cache_images</span><span class="token operator">=</span>False, <span class="token assign-left variable">image_weights</span><span class="token operator">=</span>False, <span class="token assign-left variable">device</span><span class="token operator">=</span>, <span class="token assign-left variable">multi_scale</span><span class="token operator">=</span>False, <span class="token assign-left variable">single_cls</span><span class="token operator">=</span>False, <span class="token assign-left variable">adam</span><span class="token operator">=</span>False, <span class="token assign-left variable">sync_bn</span><span class="token operator">=</span>False, <span class="token assign-left variable">workers</span><span class="token operator">=</span><span class="token number">8</span>, <span class="token assign-left variable">project</span><span class="token operator">=</span>runs/train, <span class="token assign-left variable">entity</span><span class="token operator">=</span>None, <span class="token assign-left variable">name</span><span class="token operator">=</span>exp, <span class="token assign-left variable">exist_ok</span><span class="token operator">=</span>False, <span class="token assign-left variable">quad</span><span class="token operator">=</span>False, <span class="token assign-left variable">linear_lr</span><span class="token operator">=</span>False, <span class="token assign-left variable">label_smoothing</span><span class="token operator">=</span><span class="token number">0.0</span>, <span class="token assign-left variable">upload_dataset</span><span class="token operator">=</span>False, <span class="token assign-left variable">bbox_interval</span><span class="token operator">=</span>-1, <span class="token assign-left variable">save_period</span><span class="token operator">=</span>-1, <span class="token assign-left variable">artifact_alias</span><span class="token operator">=</span>latest, <span class="token assign-left variable">local_rank</span><span class="token operator">=</span>-1
YOLOv5  v5.0-250-g02719dd torch <span class="token number">1.9</span>.0+cu111 CUDA:0 <span class="token punctuation">(</span>NVIDIA GeForce RTX <span class="token number">3060</span>, <span class="token number">12288</span>.0MB<span class="token punctuation">)</span>
hyperparameters: <span class="token assign-left variable">lr0</span><span class="token operator">=</span><span class="token number">0.01</span>, <span class="token assign-left variable">lrf</span><span class="token operator">=</span><span class="token number">0.2</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.937</span>, <span class="token assign-left variable">weight_decay</span><span class="token operator">=</span><span class="token number">0.0005</span>, <span class="token assign-left variable">warmup_epochs</span><span class="token operator">=</span><span class="token number">3.0</span>, <span class="token assign-left variable">warmup_momentum</span><span class="token operator">=</span><span class="token number">0.8</span>, <span class="token assign-left variable">warmup_bias_lr</span><span class="token operator">=</span><span class="token number">0.1</span>, <span class="token assign-left variable">box</span><span class="token operator">=</span><span class="token number">0.05</span>, <span class="token assign-left variable">cls</span><span class="token operator">=</span><span class="token number">0.5</span>, <span class="token assign-left variable">cls_pw</span><span class="token operator">=</span><span class="token number">1.0</span>, <span class="token assign-left variable">obj</span><span class="token operator">=</span><span class="token number">1.0</span>, <span class="token assign-left variable">obj_pw</span><span class="token operator">=</span><span class="token number">1.0</span>, <span class="token assign-left variable">iou_t</span><span class="token operator">=</span><span class="token number">0.2</span>, <span class="token assign-left variable">anchor_t</span><span class="token operator">=</span><span class="token number">4.0</span>, <span class="token assign-left variable">fl_gamma</span><span class="token operator">=</span><span class="token number">0.0</span>, <span class="token assign-left variable">hsv_h</span><span class="token operator">=</span><span class="token number">0.015</span>, <span class="token assign-left variable">hsv_s</span><span class="token operator">=</span><span class="token number">0.7</span>, <span class="token assign-left variable">hsv_v</span><span class="token operator">=</span><span class="token number">0.4</span>, <span class="token assign-left variable">degrees</span><span class="token operator">=</span><span class="token number">0.0</span>, <span class="token assign-left variable">translate</span><span class="token operator">=</span><span class="token number">0.1</span>, <span class="token assign-left variable">scale</span><span class="token operator">=</span><span class="token number">0.5</span>, <span class="token assign-left variable">shear</span><span class="token operator">=</span><span class="token number">0.0</span>, <span class="token assign-left variable">perspective</span><span class="token operator">=</span><span class="token number">0.0</span>, <span class="token assign-left variable">flipud</span><span class="token operator">=</span><span class="token number">0.0</span>, <span class="token assign-left variable">fliplr</span><span class="token operator">=</span><span class="token number">0.5</span>, <span class="token assign-left variable">mosaic</span><span class="token operator">=</span><span class="token number">1.0</span>, <span class="token assign-left variable">mixup</span><span class="token operator">=</span><span class="token number">0.0</span>
tensorboard: Start with <span class="token string">'tensorboard --logdir runs/train'</span>, view at http://localhost:6006/
wandb: Install Weights <span class="token operator">&amp;</span> Biases <span class="token keyword">for</span> YOLOv5 logging with <span class="token string">'pip install wandb'</span> <span class="token punctuation">(</span>recommended<span class="token punctuation">)</span>

                 from  n    params  module                                  arguments                     
  <span class="token number">0</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>      <span class="token number">3520</span>  models.common.Focus                     <span class="token punctuation">[</span><span class="token number">3</span>, <span class="token number">32</span>, <span class="token number">3</span><span class="token punctuation">]</span>                    
  <span class="token number">1</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>     <span class="token number">18560</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">32</span>, <span class="token number">64</span>, <span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">]</span>                
  <span class="token number">2</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>     <span class="token number">18816</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token number">1</span><span class="token punctuation">]</span>                   
  <span class="token number">3</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>     <span class="token number">73984</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">64</span>, <span class="token number">128</span>, <span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">]</span>               
  <span class="token number">4</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">156928</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token number">3</span><span class="token punctuation">]</span>                 
  <span class="token number">5</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">295424</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">128</span>, <span class="token number">256</span>, <span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">]</span>              
  <span class="token number">6</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">625152</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token number">3</span><span class="token punctuation">]</span>                 
  <span class="token number">7</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>   <span class="token number">1180672</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">256</span>, <span class="token number">512</span>, <span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">]</span>              
  <span class="token number">8</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">656896</span>  models.common.SPP                       <span class="token punctuation">[</span><span class="token number">512</span>, <span class="token number">512</span>, <span class="token punctuation">[</span><span class="token number">5</span>, <span class="token number">9</span>, <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        
  <span class="token number">9</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>   <span class="token number">1182720</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">512</span>, <span class="token number">512</span>, <span class="token number">1</span>, False<span class="token punctuation">]</span>          
 <span class="token number">10</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">131584</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">512</span>, <span class="token number">256</span>, <span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">]</span>              
 <span class="token number">11</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>         <span class="token number">0</span>  torch.nn.modules.upsampling.Upsample    <span class="token punctuation">[</span>None, <span class="token number">2</span>, <span class="token string">'nearest'</span><span class="token punctuation">]</span>          
 <span class="token number">12</span>           <span class="token punctuation">[</span>-1, <span class="token number">6</span><span class="token punctuation">]</span>  <span class="token number">1</span>         <span class="token number">0</span>  models.common.Concat                    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                           
 <span class="token number">13</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">361984</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">512</span>, <span class="token number">256</span>, <span class="token number">1</span>, False<span class="token punctuation">]</span>          
 <span class="token number">14</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>     <span class="token number">33024</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">256</span>, <span class="token number">128</span>, <span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">]</span>              
 <span class="token number">15</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>         <span class="token number">0</span>  torch.nn.modules.upsampling.Upsample    <span class="token punctuation">[</span>None, <span class="token number">2</span>, <span class="token string">'nearest'</span><span class="token punctuation">]</span>          
 <span class="token number">16</span>           <span class="token punctuation">[</span>-1, <span class="token number">4</span><span class="token punctuation">]</span>  <span class="token number">1</span>         <span class="token number">0</span>  models.common.Concat                    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                           
 <span class="token number">17</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>     <span class="token number">90880</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">256</span>, <span class="token number">128</span>, <span class="token number">1</span>, False<span class="token punctuation">]</span>          
 <span class="token number">18</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">147712</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">]</span>              
 <span class="token number">19</span>          <span class="token punctuation">[</span>-1, <span class="token number">14</span><span class="token punctuation">]</span>  <span class="token number">1</span>         <span class="token number">0</span>  models.common.Concat                    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                           
 <span class="token number">20</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">296448</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token number">1</span>, False<span class="token punctuation">]</span>          
 <span class="token number">21</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>    <span class="token number">590336</span>  models.common.Conv                      <span class="token punctuation">[</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token number">3</span>, <span class="token number">2</span><span class="token punctuation">]</span>              
 <span class="token number">22</span>          <span class="token punctuation">[</span>-1, <span class="token number">10</span><span class="token punctuation">]</span>  <span class="token number">1</span>         <span class="token number">0</span>  models.common.Concat                    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                           
 <span class="token number">23</span>                <span class="token parameter variable">-1</span>  <span class="token number">1</span>   <span class="token number">1182720</span>  models.common.C3                        <span class="token punctuation">[</span><span class="token number">512</span>, <span class="token number">512</span>, <span class="token number">1</span>, False<span class="token punctuation">]</span>          
 <span class="token number">24</span>      <span class="token punctuation">[</span><span class="token number">17</span>, <span class="token number">20</span>, <span class="token number">23</span><span class="token punctuation">]</span>  <span class="token number">1</span>     <span class="token number">35061</span>  models.yolo.Detect                      <span class="token punctuation">[</span><span class="token number">8</span>, <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span>, <span class="token number">13</span>, <span class="token number">16</span>, <span class="token number">30</span>, <span class="token number">33</span>, <span class="token number">23</span><span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">30</span>, <span class="token number">61</span>, <span class="token number">62</span>, <span class="token number">45</span>, <span class="token number">59</span>, <span class="token number">119</span><span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">116</span>, <span class="token number">90</span>, <span class="token number">156</span>, <span class="token number">198</span>, <span class="token number">373</span>, <span class="token number">326</span><span class="token punctuation">]</span><span class="token punctuation">]</span>, <span class="token punctuation">[</span><span class="token number">128</span>, <span class="token number">256</span>, <span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
D:<span class="token punctuation">\</span>Anaconda3<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>site-packages<span class="token punctuation">\</span>torch<span class="token punctuation">\</span>nn<span class="token punctuation">\</span>functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please <span class="token keyword">do</span> not use them <span class="token keyword">for</span> anything important <span class="token keyword">until</span> they are released as stable. <span class="token punctuation">(</span>Triggered internally at  <span class="token punctuation">..</span><span class="token punctuation">\</span>c10/core/TensorImpl.h:1156.<span class="token punctuation">)</span>
  <span class="token builtin class-name">return</span> torch.max_pool2d<span class="token punctuation">(</span>input, kernel_size, stride, padding, dilation, ceil_mode<span class="token punctuation">)</span>
Model Summary: <span class="token number">283</span> layers, <span class="token number">7082421</span> parameters, <span class="token number">7082421</span> gradients, <span class="token number">16.4</span> GFLOPs

Transferred <span class="token number">354</span>/362 items from yolov5s.pt
Scaled weight_decay <span class="token operator">=</span> <span class="token number">0.0005</span>
Optimizer groups: <span class="token number">62</span> .bias, <span class="token number">62</span> conv.weight, <span class="token number">59</span> other
train: Scanning <span class="token string">'..\datasets\coco\labels\train.cache'</span> images and labels<span class="token punctuation">..</span>. <span class="token number">216</span> found, <span class="token number">0</span> missing, <span class="token number">0</span> empty, <span class="token number">0</span> corrupted: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">216</span>/216 <span class="token punctuation">[</span>00:1<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>?, ?it/s<span class="token punctuation">]</span>
val: Scanning <span class="token string">'..\datasets\coco\labels\val.cache'</span> images and labels<span class="token punctuation">..</span>. <span class="token number">10</span> found, <span class="token number">0</span> missing, <span class="token number">0</span> empty, <span class="token number">0</span> corrupted: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">10</span>/10 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span>?, ?it/s<span class="token punctuation">]</span>
Plotting labels<span class="token punctuation">..</span>. 

autoanchor: Analyzing anchors<span class="token punctuation">..</span>. anchors/target <span class="token operator">=</span> <span class="token number">5.70</span>, Best Possible Recall <span class="token punctuation">(</span>BPR<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1.0000</span>
Image sizes <span class="token number">640</span> train, <span class="token number">640</span> <span class="token builtin class-name">test</span>
Using <span class="token number">8</span> dataloader workers
Logging results to runs<span class="token punctuation">\</span>train<span class="token punctuation">\</span>exp35
Starting training <span class="token keyword">for</span> <span class="token number">10</span> epochs<span class="token punctuation">..</span>.

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">0</span>/9     <span class="token number">3</span>.68G    <span class="token number">0.1092</span>   <span class="token number">0.08215</span>   <span class="token number">0.06769</span>     <span class="token number">0.259</span>        <span class="token number">91</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>00:00,  <span class="token number">1</span>.68it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">4</span>.03it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>    <span class="token number">0.00131</span>     <span class="token number">0.0417</span>   <span class="token number">0.000303</span>   <span class="token number">3</span>.03e-05

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">1</span>/9     <span class="token number">3</span>.68G    <span class="token number">0.1002</span>   <span class="token number">0.09305</span>    <span class="token number">0.0653</span>    <span class="token number">0.2586</span>        <span class="token number">75</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.05it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">5</span>.26it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>    <span class="token number">0.00867</span>      <span class="token number">0.265</span>    <span class="token number">0.00592</span>   <span class="token number">0.000931</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">2</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.08899</span>   <span class="token number">0.09878</span>   <span class="token number">0.06223</span>      <span class="token number">0.25</span>        <span class="token number">77</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.06it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">5</span>.01it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>     <span class="token number">0.0709</span>      <span class="token number">0.258</span>     <span class="token number">0.0691</span>     <span class="token number">0.0167</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">3</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.07895</span>   <span class="token number">0.09372</span>   <span class="token number">0.06002</span>    <span class="token number">0.2327</span>        <span class="token number">90</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.04it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">4</span>.54it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.107</span>      <span class="token number">0.358</span>      <span class="token number">0.147</span>     <span class="token number">0.0488</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">4</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.06797</span>    <span class="token number">0.0914</span>   <span class="token number">0.05765</span>     <span class="token number">0.217</span>        <span class="token number">76</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.03it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">4</span>.82it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.237</span>      <span class="token number">0.615</span>      <span class="token number">0.214</span>     <span class="token number">0.0938</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">5</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.06103</span>   <span class="token number">0.07479</span>   <span class="token number">0.05627</span>    <span class="token number">0.1921</span>        <span class="token number">69</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.03it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">5</span>.63it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.195</span>      <span class="token number">0.772</span>      <span class="token number">0.308</span>      <span class="token number">0.148</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">6</span>/9     <span class="token number">3</span>.68G    <span class="token number">0.0548</span>    <span class="token number">0.0687</span>   <span class="token number">0.05505</span>    <span class="token number">0.1786</span>       <span class="token number">114</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.02it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">6</span>.82it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.183</span>      <span class="token number">0.807</span>      <span class="token number">0.347</span>      <span class="token number">0.196</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">7</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.05074</span>    <span class="token number">0.0619</span>   <span class="token number">0.05347</span>    <span class="token number">0.1661</span>        <span class="token number">69</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">5</span>.03it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">7</span>.65it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.442</span>      <span class="token number">0.369</span>      <span class="token number">0.447</span>      <span class="token number">0.204</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">8</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.04818</span>     <span class="token number">0.058</span>    <span class="token number">0.0527</span>    <span class="token number">0.1589</span>        <span class="token number">72</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">4</span>.92it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">8</span>.43it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.815</span>      <span class="token number">0.375</span>      <span class="token number">0.484</span>      <span class="token number">0.291</span>

     Epoch   gpu_mem       box       obj       cls     total    labels  img_size
       <span class="token number">9</span>/9     <span class="token number">3</span>.68G   <span class="token number">0.04369</span>   <span class="token number">0.05591</span>   <span class="token number">0.05179</span>    <span class="token number">0.1514</span>        <span class="token number">93</span>       <span class="token number">640</span>: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">14</span>/14 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">4</span>.90it/s<span class="token punctuation">]</span>
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">1</span>/1 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>00:00,  <span class="token number">5</span>.31it/s<span class="token punctuation">]</span>
                 all         <span class="token number">10</span>         <span class="token number">60</span>      <span class="token number">0.613</span>        <span class="token number">0.4</span>       <span class="token number">0.56</span>      <span class="token number">0.368</span>
           magiccube         <span class="token number">10</span>          <span class="token number">1</span>      <span class="token number">0.372</span>          <span class="token number">1</span>      <span class="token number">0.995</span>      <span class="token number">0.697</span>
             redbull         <span class="token number">10</span>         <span class="token number">10</span>      <span class="token number">0.488</span>        <span class="token number">0.2</span>       <span class="token number">0.54</span>      <span class="token number">0.363</span>
                ball         <span class="token number">10</span>          <span class="token number">1</span>      <span class="token number">0.988</span>          <span class="token number">1</span>      <span class="token number">0.995</span>      <span class="token number">0.498</span>
                 red         <span class="token number">10</span>         <span class="token number">10</span>      <span class="token number">0.747</span>        <span class="token number">0.9</span>      <span class="token number">0.935</span>      <span class="token number">0.758</span>
                beer         <span class="token number">10</span>         <span class="token number">10</span>      <span class="token number">0.306</span>        <span class="token number">0.1</span>      <span class="token number">0.278</span>      <span class="token number">0.178</span>
                blue         <span class="token number">10</span>         <span class="token number">10</span>          <span class="token number">0</span>          <span class="token number">0</span>      <span class="token number">0.144</span>     <span class="token number">0.0721</span>
             qingdao         <span class="token number">10</span>          <span class="token number">9</span>          <span class="token number">1</span>          <span class="token number">0</span>      <span class="token number">0.345</span>      <span class="token number">0.234</span>
                  dp         <span class="token number">10</span>          <span class="token number">9</span>          <span class="token number">1</span>          <span class="token number">0</span>      <span class="token number">0.245</span>      <span class="token number">0.149</span>
<span class="token number">10</span> epochs completed <span class="token keyword">in</span> <span class="token number">0.011</span> hours.

Optimizer stripped from runs<span class="token punctuation">\</span>train<span class="token punctuation">\</span>exp35<span class="token punctuation">\</span>weights<span class="token punctuation">\</span>last.pt, <span class="token number">14</span>.4MB
Optimizer stripped from runs<span class="token punctuation">\</span>train<span class="token punctuation">\</span>exp35<span class="token punctuation">\</span>weights<span class="token punctuation">\</span>best.pt, <span class="token number">14</span>.4MB

</code></pre> 
<h3><a id="_199"></a>模型预测</h3> 
<p>这里点击文件夹下yolov5\detect.py，对文件进行修改后即可进行模型预测。</p> 
<p>具体修改第187-188行，其他参数有兴趣的可另行修改，比如cpu预测，图像大小等</p> 
<pre><code class="prism language-javascript">    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--weights'</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'runs/train/exp33/weights/best.pt'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'model.pt path(s)'</span><span class="token punctuation">)</span>#将模型位置替换为你训练得到的模型位置
    parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">'--source'</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">'VID_20210705_185429.mp4'</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'file/dir/URL/glob, 0 for webcam'</span><span class="token punctuation">)</span>#输入预测文件的位置，这里可以输入图片，视频等，输入视频会进行逐帧数预测
</code></pre> 
<p>修改完成后运行代码即可<br> 预测结束后文件会保存在yolov5\runs\detect中。</p> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="s9dNszsd-1626260478449" frameborder="0" src="https://player.bilibili.com/player.html?aid=716632779" allowfullscreen="true" data-mediaembed="bilibili"></iframe> 
 <p>YOLOv5目标检测</p> 
</div> 
<p></p> 
<h3><a id="_218"></a>遇到的问题</h3> 
<h4><a id="_219"></a>图片无法读入</h4> 
<p>再训练时数据读入环节会出现问题，可能会出现图像无法读入的问题，或者爆内存。<br> 这里修改虚拟内存可以解决问题，找一个大点的盘，在设置中修改下虚拟内存大小，就可以实现图像的读入。当然显存要够，否则训练的时候还是会报错。</p> 
<pre><code class="prism language-bash">train: Scanning <span class="token string">'..\datasets\coco\labels\train.cache'</span> images and labels<span class="token punctuation">..</span>. <span class="token number">216</span> found, <span class="token number">0</span> missing, <span class="token number">0</span> empty, <span class="token number">0</span> corrupted: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">216</span>/216 <span class="token punctuation">[</span>00:1<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>?, ?it/s<span class="token punctuation">]</span>
val: Scanning <span class="token string">'..\datasets\coco\labels\val.cache'</span> images and labels<span class="token punctuation">..</span>. <span class="token number">10</span> found, <span class="token number">0</span> missing, <span class="token number">0</span> empty, <span class="token number">0</span> corrupted: <span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">10</span>/10 <span class="token punctuation">[</span>00:0<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span>?, ?it/s<span class="token punctuation">]</span>
Plotting labels<span class="token punctuation">..</span>. 
</code></pre> 
<h4><a id="_227"></a>训练模型后预测没效果</h4> 
<p>这个问题可能是因为数据集标注不对导致的，可能各种图片里有好几种东西，有些图片有标有些图片没标，导致最后啥都没训练出来，修改下数据集就好了。 还有就是输入图像大小设置最好是640，小了好像总是出现模型训练失败的问题。</p> 
<h4><a id="no_moddule_named_nnmobilenetv3__230"></a>no moddule named ‘nn.mobilenetv3’ 问题</h4> 
<p>类似的问题大多都是pytorch安装出问题导致的，pip卸载后重装即可，注意不要重复安装torch的CPU和GPU版本，会导致冲突，这里记不到报错啥样了，会提示有俩个版本不知道用哪个，卸载掉其中之一即可。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2c635de871306c56111400d11cb8a646/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">YOLOv7快速上手训练自定义数据集</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/157700d8dd8571b4c864a78c6c0c5623/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">nlp知识点总结（上）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>