<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>leetcode 787. Cheapest Flights Within K Stops - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="leetcode 787. Cheapest Flights Within K Stops" />
<meta property="og:description" content="leetcode 787. Cheapest Flights Within K Stops leetcode 787 Cheapest Flights Within K Stops 题目描述解答思路代码 题目描述 There are n cities connected by m flights. Each fight starts from city u and arrives at v with a price w.
Now given all the cities and fights, together with starting city src and the destination dst, your task is to find the cheapest price from src to dst with up to k stops." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2f1fb5456cd840f00544a1fa37ed0b69/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-03-18T16:24:47+08:00" />
<meta property="article:modified_time" content="2018-03-18T16:24:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">leetcode 787. Cheapest Flights Within K Stops</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="leetcode-787-cheapest-flights-within-k-stops">leetcode 787. Cheapest Flights Within K Stops</h2> 
<p></p> 
<div class="toc"> 
 <div class="toc"> 
  <ul><li><a href="#leetcode-787-cheapest-flights-within-k-stops" rel="nofollow noopener noreferrer" target="_blank">leetcode 787 Cheapest Flights Within K Stops</a> 
    <ul><li><a href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0" rel="nofollow noopener noreferrer" target="_blank">题目描述</a></li><li><a href="#%E8%A7%A3%E7%AD%94%E6%80%9D%E8%B7%AF" rel="nofollow noopener noreferrer" target="_blank">解答思路</a></li><li><a href="#%E4%BB%A3%E7%A0%81" rel="nofollow noopener noreferrer" target="_blank">代码</a></li></ul> </li></ul> 
 </div> 
</div> 
<p></p> 
<h3 id="题目描述">题目描述</h3> 
<p><strong>There are <code>n</code> cities connected by <code>m</code> flights. Each fight starts from city <code>u</code> and arrives at <code>v</code> with a price <code>w</code>.</strong></p> 
<p><strong>Now given all the cities and fights, together with starting city <code>src</code> and the destination <code>dst</code>, your task is to find the cheapest price from <code>src</code> to <code>dst</code> with up to <code>k</code> stops. If there is no such route, output <code>-1</code>.</strong></p> 
<p><strong>Note:</strong></p> 
<ul><li><strong>The number of nodes <code>n</code> will be in range <code>[1, 100]</code>, with nodes labeled from <code>0</code> to <code>n - 1</code>.</strong></li><li><strong>The size of flights will be in range <code>[0, n * (n - 1) / 2]</code>.</strong></li><li><strong>The format of each flight will be <code>(src, dst, price)</code>.</strong></li><li><strong>The price of each flight will be in the range <code>[1, 10000]</code>.</strong></li><li><strong><code>k</code> is in the range of <code>[0, n - 1]</code>.</strong></li><li><strong>There will not be any duplicated flights or self cycles.</strong></li></ul> 
<p><strong>Difficulty: medium</strong> <br> <a href="https://leetcode.com/problems/cheapest-flights-within-k-stops/description/" rel="nofollow noopener noreferrer" target="_blank">787. Cheapest Flights Within K Stops</a></p> 
<hr> 
<p><strong>中文描述</strong> <br> <strong>给你有<code>n</code>个城市，<code>m</code>个航班，每个航班是一个三元组包含出发地<code>u</code>，终点<code>v</code>，价格<code>w</code>的三个信息，要求你在转乘不超过<code>k</code>次的情况下，从起始点<code>src</code>到终点<code>dst</code>的最便宜的方法。</strong></p> 
<hr> 
<p><strong>输入格式</strong> <br> <strong>第一个输入<code>n</code>表示城市个数，第二个输入列表<code>edges</code>表示每个航班的起始点，目的地，价格的信息，第三个输入<code>src</code>为出发点，第四个输入<code>dst</code>为终点，第五个输入<code>k</code>表示需要最多换乘<code>k</code>次。</strong></p> 
<hr> 
<p><strong>Examples:</strong></p> 
<ol><li><p><strong>Input: n = 3, edges = [[0,1,100],[1,2,100],[0,2,500]], src = 0, dst = 2, k = 1</strong> <br> <strong>Output: 200</strong> <br> <strong>解释:</strong> <br> <strong>从0到2有两种方法，可以从0 –&gt; 1 –&gt; 2，价格为200，或则0–&gt;2，价格500.</strong> <br> <strong>因为可以转乘一次，所以最少为200</strong></p></li><li><p><strong>Input: n = 3, edges = [[0,1,100],[1,2,100],[0,2,500]], src = 0, dst = 2, k = 0</strong> <br> <strong>Output: 500</strong> <br> <strong>解释:</strong> <br> <strong>从0到2有两种方法，可以从0 –&gt; 1 –&gt; 2，价格为200，或则0–&gt;2，价格500.</strong> <br> <strong>因为不能转乘，所以最少为500</strong></p></li></ol> 
<hr> 
<h3 id="解答思路">解答思路</h3> 
<ul><li><p>解法一：<strong>dfs + memory</strong></p> <p>原问题为在转机不超过<strong>k</strong>次的情况下，从<strong>src</strong>到<strong>dst</strong>的价格最少。记<strong>mid</strong>为从<strong>src</strong>起飞能到的城市之一。原问题转化为最小化在不超过<strong>k-1</strong>次的情况下，从<strong>mid</strong>到<strong>dst</strong>的价格+<strong>src</strong>到<strong>mid</strong>的价格。即<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-341-Frame" style=""> 
     
     <span class="math" id="MathJax-Span-9410" style="width: 17.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.24em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.871em, 1000em, 3.805em, -0.455em); top: -2.88em; left: 0em;"><span class="mrow" id="MathJax-Span-9411"><span class="munderover" id="MathJax-Span-9412"><span style="display: inline-block; position: relative; width: 1.653em; height: 0px;"><span style="position: absolute; clip: rect(1.998em, 1000em, 2.987em, -0.455em); top: -2.827em; left: 0em;"><span class="mo" id="MathJax-Span-9413" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 2.827em;"></span></span><span style="position: absolute; clip: rect(1.803em, 1000em, 2.721em, -0.465em); top: -1.796em; left: 0.213em;"><span class="texatom" id="MathJax-Span-9414"><span class="mrow" id="MathJax-Span-9415"><span class="mi" id="MathJax-Span-9416" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-9417" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-9418" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span><span class="mrow" id="MathJax-Span-9419" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-9420" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">{<!-- --></span></span><span class="msubsup" id="MathJax-Span-9421"><span style="display: inline-block; position: relative; width: 4.553em; height: 0px;"><span style="position: absolute; clip: rect(1.824em, 1000em, 2.827em, -0.447em); top: -2.667em; left: 0em;"><span class="mi" id="MathJax-Span-9422" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.667em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.638em;"><span class="texatom" id="MathJax-Span-9423"><span class="mrow" id="MathJax-Span-9424"><span class="mi" id="MathJax-Span-9425" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-9426" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-9427" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-9428" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mo" id="MathJax-Span-9429" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span><span class="mi" id="MathJax-Span-9430" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-9431" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-9432" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-9433" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-9434" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-9435" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-9436" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 5.459em; height: 0px;"><span style="position: absolute; clip: rect(1.824em, 1000em, 2.827em, -0.447em); top: -2.667em; left: 0em;"><span class="mi" id="MathJax-Span-9437" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.667em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.638em;"><span class="texatom" id="MathJax-Span-9438"><span class="mrow" id="MathJax-Span-9439"><span class="mi" id="MathJax-Span-9440" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-9441" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-9442" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-9443" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mo" id="MathJax-Span-9444" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span><span class="mi" id="MathJax-Span-9445" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-9446" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-9447" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-9448" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-9449" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-9450" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-9451" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-9452" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">}</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.88em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.152em; vertical-align: -1.023em;"></span></span> 
    </span><script type="math/tex" id="MathJax-Element-341">\min\limits_{mid}\left\{P_{src->mid, 1} + P_{mid->dst, k-1}\right\}</script>。可以用<strong>dfs</strong>，遍历所有情况，用<strong>memory</strong>记录下经历过的转态，避免重复计算。</p></li><li><p>解法二：应用<strong>heapq</strong></p> <p>思路和上述差不多，不过每次我们都从当前费用最小的往外扩展，如果遇到满足题目要求的方法后就可以直接跳出，可以减少一些不必要的计算。</p></li><li><p>解法三：动态规划</p> <p>用一个二维的<strong>dp</strong>数组，<strong>dp[i][j]</strong>表示在不超过<strong>i</strong>次转机的情况下，从<strong>j</strong>到达<strong>dst</strong>的最少费用。<strong>dp[i][j]=<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-342-Frame" style=""> 
      
      <span class="math" id="MathJax-Span-9453" style="width: 2.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.653em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.518em, 1000em, 3.272em, -0.455em); top: -2.347em; left: 0em;"><span class="mrow" id="MathJax-Span-9454"><span class="munderover" id="MathJax-Span-9455"><span style="display: inline-block; position: relative; width: 1.653em; height: 0px;"><span style="position: absolute; clip: rect(1.998em, 1000em, 2.987em, -0.455em); top: -2.827em; left: 0em;"><span class="mo" id="MathJax-Span-9456" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 2.827em;"></span></span><span style="position: absolute; clip: rect(1.803em, 1000em, 2.721em, -0.446em); top: -1.796em; left: 0.64em;"><span class="texatom" id="MathJax-Span-9457"><span class="mrow" id="MathJax-Span-9458"><span class="mi" id="MathJax-Span-9459" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.453em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.347em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.926em; vertical-align: -1.023em;"></span></span> 
     </span><script type="math/tex" id="MathJax-Element-342">\min\limits_{k}</script>{dp[i-1][k]+<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-343-Frame" style=""> 
      
      <span class="math" id="MathJax-Span-9460" style="width: 3.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.504em, 1000em, 2.801em, -0.447em); top: -2.347em; left: 0em;"><span class="mrow" id="MathJax-Span-9461"><span class="msubsup" id="MathJax-Span-9462"><span style="display: inline-block; position: relative; width: 2.473em; height: 0px;"><span style="position: absolute; clip: rect(1.824em, 1000em, 2.827em, -0.447em); top: -2.667em; left: 0em;"><span class="mi" id="MathJax-Span-9463" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.667em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.638em;"><span class="texatom" id="MathJax-Span-9464"><span class="mrow" id="MathJax-Span-9465"><span class="mi" id="MathJax-Span-9466" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-9467" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mo" id="MathJax-Span-9468" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span><span class="mi" id="MathJax-Span-9469" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.347em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.355em; vertical-align: -0.434em;"></span></span> 
     </span><script type="math/tex" id="MathJax-Element-343">P_{k->j}</script>}</strong>。 <br> （从自己到自己为0，<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-344-Frame" style=""> 
     
     <span class="math" id="MathJax-Span-9470" style="width: 23.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.453em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.867em, 1000em, 3.281em, -0.447em); top: -2.827em; left: 0em;"><span class="mrow" id="MathJax-Span-9471"><span class="msubsup" id="MathJax-Span-9472"><span style="display: inline-block; position: relative; width: 2.526em; height: 0px;"><span style="position: absolute; clip: rect(1.824em, 1000em, 2.827em, -0.447em); top: -2.667em; left: 0em;"><span class="mi" id="MathJax-Span-9473" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.667em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.638em;"><span class="texatom" id="MathJax-Span-9474"><span class="mrow" id="MathJax-Span-9475"><span class="mi" id="MathJax-Span-9476" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-9477" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mo" id="MathJax-Span-9478" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span><span class="mi" id="MathJax-Span-9479" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-9480" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-9481" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="texatom" id="MathJax-Span-9482"><span class="mrow" id="MathJax-Span-9483"><span class="mo" id="MathJax-Span-9484"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>，</span></span></span></span><span class="texatom" id="MathJax-Span-9485"><span class="mrow" id="MathJax-Span-9486"><span class="mo" id="MathJax-Span-9487"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>若</span></span></span></span><span class="texatom" id="MathJax-Span-9488"><span class="mrow" id="MathJax-Span-9489"><span class="mo" id="MathJax-Span-9490"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>是</span></span></span></span><span class="texatom" id="MathJax-Span-9491"><span class="mrow" id="MathJax-Span-9492"><span class="mo" id="MathJax-Span-9493"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>没</span></span></span></span><span class="texatom" id="MathJax-Span-9494"><span class="mrow" id="MathJax-Span-9495"><span class="mo" id="MathJax-Span-9496"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>有</span></span></span></span><span class="texatom" id="MathJax-Span-9497"><span class="mrow" id="MathJax-Span-9498"><span class="mo" id="MathJax-Span-9499"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>这</span></span></span></span><span class="texatom" id="MathJax-Span-9500"><span class="mrow" id="MathJax-Span-9501"><span class="mo" id="MathJax-Span-9502"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>个</span></span></span></span><span class="texatom" id="MathJax-Span-9503"><span class="mrow" id="MathJax-Span-9504"><span class="mo" id="MathJax-Span-9505"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>线</span></span></span></span><span class="texatom" id="MathJax-Span-9506"><span class="mrow" id="MathJax-Span-9507"><span class="mo" id="MathJax-Span-9508"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>路</span></span></span></span><span class="texatom" id="MathJax-Span-9509"><span class="mrow" id="MathJax-Span-9510"><span class="mo" id="MathJax-Span-9511"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>则</span></span></span></span><span class="texatom" id="MathJax-Span-9512"><span class="mrow" id="MathJax-Span-9513"><span class="mo" id="MathJax-Span-9514"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 80%; font-style: normal; font-weight: normal;'>，</span></span></span></span><span class="msubsup" id="MathJax-Span-9515"><span style="display: inline-block; position: relative; width: 2.473em; height: 0px;"><span style="position: absolute; clip: rect(1.824em, 1000em, 2.827em, -0.447em); top: -2.667em; left: 0em;"><span class="mi" id="MathJax-Span-9516" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.667em;"></span></span><span style="position: absolute; top: -2.357em; left: 0.638em;"><span class="texatom" id="MathJax-Span-9517"><span class="mrow" id="MathJax-Span-9518"><span class="mi" id="MathJax-Span-9519" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-9520" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mo" id="MathJax-Span-9521" style="font-size: 70.7%; font-family: MathJax_Main;">&gt;</span><span class="mi" id="MathJax-Span-9522" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.507em;"></span></span></span></span><span class="mo" id="MathJax-Span-9523" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-9524" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mi" id="MathJax-Span-9525" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-9526" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.827em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.501em; vertical-align: -0.434em;"></span></span> 
    </span><script type="math/tex" id="MathJax-Element-344">P_{k->k}=0，若是没有这个线路则，P_{k->j}=inf</script>）</p></li></ul> 
<hr> 
<h3 id="代码">代码</h3> 
<p>解法一</p> 
<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findCheapestPrice</span><span class="hljs-params">(self, n, flights, src, dst, K)</span>:</span>
        <span class="hljs-string">"""
        :type n: int
        :type flights: List[List[int]]
        :type src: int
        :type dst: int
        :type K: int
        :rtype: int
        315ms dfs + memory
        """</span>
        <span class="hljs-comment"># 把原始数据处理下，按起始点划分</span>
        <span class="hljs-keyword">import</span> collections
        flights_dict = collections.defaultdict(list)
        <span class="hljs-keyword">for</span> flight <span class="hljs-keyword">in</span> flights:
            flights_dict[flight[<span class="hljs-number">0</span>]].append(flight[<span class="hljs-number">1</span>:])
        <span class="hljs-comment"># 用来记录已经计算过的位置</span>
        memory = {}
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dfs</span><span class="hljs-params">(K, src, price)</span>:</span>
            <span class="hljs-comment"># 如果该位置已经被访问过，直接输出结果</span>
            <span class="hljs-keyword">if</span> (src, K) <span class="hljs-keyword">in</span> memory:
                <span class="hljs-keyword">return</span> memory[(src, K)]
            <span class="hljs-comment"># 不能到达的情况，记录下来</span>
            <span class="hljs-keyword">if</span> K &lt; <span class="hljs-number">0</span>:
                memory[(src, K)] = float(<span class="hljs-string">'inf'</span>)
                <span class="hljs-keyword">return</span> float(<span class="hljs-string">'inf'</span>)

            min_price = float(<span class="hljs-string">'inf'</span>)
            <span class="hljs-comment"># 遍历所有从该点出发的方案</span>
            <span class="hljs-keyword">for</span> next_src <span class="hljs-keyword">in</span> flights_dict[src]:
                price += next_src[<span class="hljs-number">1</span>]
                <span class="hljs-keyword">if</span> next_src[<span class="hljs-number">0</span>] == dst:
                    a = price
                <span class="hljs-keyword">else</span>:
                    a = dfs(K - <span class="hljs-number">1</span>, next_src[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>) + price
                <span class="hljs-comment"># 选择价格最少的</span>
                min_price = min(a, min_price)
                price -= next_src[<span class="hljs-number">1</span>]
            <span class="hljs-comment"># 记录下来</span>
            memory[(src, K)] = min_price
            <span class="hljs-keyword">return</span> memory[(src, K)]
        ans = dfs(K, src, <span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> ans <span class="hljs-keyword">if</span> ans != float(<span class="hljs-string">'inf'</span>) <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span></code></pre> 
<p>解法二，参考了其它人写的代码详细请见<a href="https://leetcode.com/problems/cheapest-flights-within-k-stops/discuss/115541/Easy-and-Concise-Solution-Using-Priority-Queue-JavaPython" rel="nofollow noopener noreferrer" target="_blank">Easy and Concise Solution Using Priority Queue [Java/Python]</a>：</p> 
<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findCheapestPrice</span><span class="hljs-params">(self, n, flights, src, dst, K)</span>:</span>
        <span class="hljs-string">"""
        :type n: int
        :type flights: List[List[int]]
        :type src: int
        :type dst: int
        :type K: int
        :rtype: int
        88ms heapq
        """</span>
        <span class="hljs-keyword">import</span> heapq, collections
        flights_dict = collections.defaultdict(list)
        <span class="hljs-keyword">for</span> flight <span class="hljs-keyword">in</span> flights:
            flights_dict[flight[<span class="hljs-number">0</span>]].append(flight[<span class="hljs-number">1</span>:])
        h = [(<span class="hljs-number">0</span>, src, <span class="hljs-number">0</span>)]
        <span class="hljs-keyword">while</span> h:
            a = heapq.heappop(h)
            <span class="hljs-keyword">if</span> a[<span class="hljs-number">1</span>] == dst:
                <span class="hljs-keyword">return</span> a[<span class="hljs-number">0</span>]
            <span class="hljs-keyword">for</span> next_src <span class="hljs-keyword">in</span> flights_dict[a[<span class="hljs-number">1</span>]]:
                <span class="hljs-keyword">if</span> a[<span class="hljs-number">2</span>] &lt; K + <span class="hljs-number">1</span>:
                    heapq.heappush(h, (next_src[<span class="hljs-number">1</span>] + a[<span class="hljs-number">0</span>], next_src[<span class="hljs-number">0</span>], a[<span class="hljs-number">2</span>] + <span class="hljs-number">1</span>))
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span></code></pre> 
<p>解法三：</p> 
<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span><span class="hljs-params">(object)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findCheapestPrice</span><span class="hljs-params">(self, n, flights, src, dst, K)</span>:</span>
        <span class="hljs-string">"""
        :type n: int
        :type flights: List[List[int]]
        :type src: int
        :type dst: int
        :type K: int
        :rtype: int
        176ms dp
        """</span>
        <span class="hljs-keyword">import</span> collections
        <span class="hljs-comment"># 记录同一个终点的不同起点和价格</span>
        flights_dict_end = collections.defaultdict(list)
        <span class="hljs-keyword">for</span> flight <span class="hljs-keyword">in</span> flights:
            flights_dict_end[flight[<span class="hljs-number">1</span>]].append([flight[<span class="hljs-number">0</span>], flight[<span class="hljs-number">2</span>]])
        <span class="hljs-comment"># 用来记录各种情况，n个站点，还剩K次，到达目的地最少价格</span>
        dp = [[float(<span class="hljs-string">'inf'</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(n)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(K + <span class="hljs-number">1</span>)]
        <span class="hljs-comment"># 初始化能直达的</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flights_dict_end[dst]:
            dp[<span class="hljs-number">0</span>][i[<span class="hljs-number">0</span>]] = i[<span class="hljs-number">1</span>]
        <span class="hljs-comment"># 反向推回去</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, K + <span class="hljs-number">1</span>):
            <span class="hljs-keyword">for</span> pos <span class="hljs-keyword">in</span> range(n):
                <span class="hljs-keyword">for</span> before <span class="hljs-keyword">in</span> flights_dict_end[pos]:
                    dp[k][before[<span class="hljs-number">0</span>]] = min(dp[k][before[<span class="hljs-number">0</span>]], dp[k-<span class="hljs-number">1</span>][pos] + before[<span class="hljs-number">1</span>])
                dp[k][pos] = min(dp[k][pos], dp[k-<span class="hljs-number">1</span>][pos])
        ans = dp[K][src]
        <span class="hljs-keyword">return</span> ans <span class="hljs-keyword">if</span> ans != float(<span class="hljs-string">'inf'</span>) <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span></code></pre> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1f4e331586b8fe56a405fa22dad09076/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">项目二 管理与维护Linux系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7494d453d6cac1185e6c517593060b0c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">NodeJS - 第一个应用程序Hello World</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>