<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>winform简易用户权限管理系统 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="winform简易用户权限管理系统" />
<meta property="og:description" content="一、功能简介
1. 数据库可使用sqlite、mssql、mysql等
2. 管理员账号不管控，其余账号进行权限管控（左侧菜单，表单按钮），且只能看到自己创建的角色、用户
二、操作界面
1. 管理员账号登陆后，左侧菜单栏自动添加 “菜单管理” ，菜单选择 Menu / Button
2. 角色分配权限
3. 用户绑定角色
4. 游客登陆后界面
三、数据库表
四、源码结构
五、权限控制代码
1. 菜单栏
public static void SetTreeView(TreeView treeView1, ImageList imageList1, string checkList, bool onlyMenu = false) { if (null == checkList) checkList = string.Empty; treeView1.Nodes.Clear(); treeView1.ImageList = imageList1; // 管理员特别权限 if (onlyMenu &amp;&amp; LoginUser.Root) { TreeNode tn = new TreeNode(); tn.Text = &#34;菜单管理&#34;; treeView1.Nodes.Add(tn); } var list = FreeSqlHelper." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/02d27ff92c99946fe0f6da40af1f564d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T14:46:27+08:00" />
<meta property="article:modified_time" content="2024-01-03T14:46:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">winform简易用户权限管理系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、功能简介</p> 
<p>1. 数据库可使用sqlite、mssql、mysql等</p> 
<p>2. 管理员账号不管控，其余账号进行权限管控（左侧菜单，表单按钮），且只能看到自己创建的角色、用户</p> 
<p></p> 
<p>二、操作界面</p> 
<p></p> 
<p><img alt="" class="left" height="153" src="https://images2.imgbox.com/1e/0a/MYHCncyG_o.png" width="216"></p> 
<p>1. 管理员账号登陆后，左侧菜单栏自动添加 “菜单管理” ，菜单选择 Menu / Button</p> 
<p></p> 
<p class="img-center"><img alt="" height="509" src="https://images2.imgbox.com/38/b0/db14l2Yd_o.png" width="706"></p> 
<p></p> 
<p><img alt="" class="left" height="169" src="https://images2.imgbox.com/9a/e4/2q2vwStR_o.png" width="259"></p> 
<p>2. 角色分配权限</p> 
<p></p> 
<p class="img-center"><img alt="" height="509" src="https://images2.imgbox.com/06/c4/VXDEFde2_o.png" width="706"></p> 
<p></p> 
<p><img alt="" class="left" height="512" src="https://images2.imgbox.com/da/16/Syb1nPFK_o.png" width="408"></p> 
<p>3. 用户绑定角色</p> 
<p></p> 
<p class="img-center"><img alt="" height="509" src="https://images2.imgbox.com/ce/4d/nWKgf2xN_o.png" width="706"></p> 
<p></p> 
<p><img alt="" class="left" height="140" src="https://images2.imgbox.com/d6/c4/InS4tEfM_o.png" width="254"></p> 
<p>4. 游客登陆后界面</p> 
<p></p> 
<p class="img-center"><img alt="" height="509" src="https://images2.imgbox.com/36/3b/wMtLl4b0_o.png" width="706"></p> 
<p>三、数据库表</p> 
<p></p> 
<p><img alt="" class="left" height="376" src="https://images2.imgbox.com/3c/cb/17n18R4H_o.png" width="611"></p> 
<p></p> 
<p></p> 
<p><img alt="" class="left" height="178" src="https://images2.imgbox.com/a5/84/Q4axsKZT_o.png" width="705"></p> 
<p></p> 
<p><img alt="" class="left" height="176" src="https://images2.imgbox.com/8f/a7/8H5Nrgct_o.png" width="594"></p> 
<p></p> 
<p>四、源码结构</p> 
<p></p> 
<p><img alt="" class="left" height="599" src="https://images2.imgbox.com/93/14/Opg39b01_o.png" width="197"></p> 
<p></p> 
<p>五、权限控制代码</p> 
<p>1. 菜单栏</p> 
<p></p> 
<p class="img-center"><img alt="复制代码" height="20" src="https://images2.imgbox.com/34/83/8fJ0A4lS_o.gif" width="20"></p> 
<pre>public static void SetTreeView(TreeView treeView1, ImageList imageList1, string checkList, bool onlyMenu = false)
        {
            if (null == checkList) checkList = string.Empty;

            treeView1.Nodes.Clear();
            treeView1.ImageList = imageList1;

            // 管理员特别权限
            if (onlyMenu &amp;&amp; LoginUser.Root)
            {
                TreeNode tn = new TreeNode();
                tn.Text = "菜单管理";
                treeView1.Nodes.Add(tn);
            }

            var list = FreeSqlHelper.GetMenu();
            var parents = list.Where(o =&gt; o.ParentId == 0);
            foreach (var item in parents)
            {
                var id = item.Id.ToString();
                var nodeSign = GetSignTag(id);
                //
                TreeNode tn = new TreeNode();
                tn.Text = item.MenuTag;
                tn.Tag = id;
                tn.ImageIndex = 0; 
                //
                FillTree(tn, list, checkList, onlyMenu);
                //
                if (checkList.Contains(nodeSign))
                {
                    tn.Checked = true;// 菜单设置用
                }
                //
                if (onlyMenu)
                {
                    // 添加左菜单栏时用(只包含菜单，且有权限时展示)
                    if (EnumMenuType.Menu == (EnumMenuType)item.MenuType)
                    {
                        if (string.IsNullOrEmpty(checkList))
                        {
                            treeView1.Nodes.Add(tn);
                        }
                        else
                        {
                            if (checkList.Contains(nodeSign))
                            {
                                treeView1.Nodes.Add(tn);
                            }
                        }
                    }
                }
                else
                {
                    treeView1.Nodes.Add(tn);
                }
            }

            if (treeView1.Nodes.Count &gt; 0)//展开一级节点
            {
                treeView1.Nodes[0].Expand();
            }
        }</pre> 
<p></p> 
<p class="img-center"><img alt="复制代码" height="20" src="https://images2.imgbox.com/57/a1/oIpxrpgo_o.gif" width="20"></p> 
<p>2. 表单按钮</p> 
<p></p> 
<p class="img-center"><img alt="复制代码" height="20" src="https://images2.imgbox.com/25/71/7Z9PMpjr_o.gif" width="20"></p> 
<pre>ToolStripButton btnAssign = new ToolStripButton();
        ToolStripTextBox txtQuery_Name = new ToolStripTextBox();
        ToolStripTextBox txtQuery_Tag = new ToolStripTextBox();

        public frmRole()
        {
            InitializeComponent();
            SetDataGridView();
            //
            // 控制按钮
            btnAssign = GetToolStripButton("btnAssign", "分配权限", Resources.btnAssign); 
            btnAssign.Click += new EventHandler(btnAssign_Click); 
            //
            // 查询按钮
            var label1 = new ToolStripLabel(); label1.Text = "角色名称"; toolStripQuery.Items.Insert(0, label1); toolStripQuery.Items.Insert(1, txtQuery_Name);
            var label2 = new ToolStripLabel(); label2.Text = "角色标记"; toolStripQuery.Items.Insert(2, label2); toolStripQuery.Items.Insert(3, txtQuery_Tag);
        }

        public void InitUI()
        { 
            if (!DataMgr.LoginUser.Root)
            {
                var roleMenu = DataMgr.LoginUser.RoleMenuNames.ToLower();
                btnAdd.Visible = roleMenu.Contains("add_role") ? true : false;
                btnEdit.Visible = roleMenu.Contains("edit_role") ? true : false;
                btnDelete.Visible = roleMenu.Contains("delete_role") ? true : false;
                btnAssign.Visible = roleMenu.Contains("assign_role") ? true : false;
            }
            //
            base.InitData();
        }</pre> 
<p></p> 
<p class="img-center"><img alt="复制代码" height="20" src="https://images2.imgbox.com/e0/88/X1HoPetz_o.gif" width="20"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f6048959d788a9edf819bc1fd65721c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【高录用-快速见刊-EI稳定检索】2024年计算机建模与信号处理国际学术会议（ICCMSP 2024）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/60dfd5e15dcc3a1dad4bb2cd0a547d8d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【EI会议--快速录用】2024年应用力学与半导体国际学术会议(IACAMS 2024)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>