<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python不属于鼠标事件的是_selenium-webdriver(python) (十五) -- 鼠标事件 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python不属于鼠标事件的是_selenium-webdriver(python) (十五) -- 鼠标事件" />
<meta property="og:description" content="本节重点：
ActionChains 类
context_click() 右击
double_click() 双击
drag_and_drop() 拖动
测试的产品中有一个操作是右键点击文件列表会弹出一个快捷菜单，可以方便的选择快捷菜单中的选择对文件进行操作(删除、移动、重命名)，之前学习元素的点击非常简单：
driver.find_element_by_id(“xxx”).click()
那么鼠标的双击、右击、拖动等是否也是这样的写法呢？例如右击：
driver.find_element_by_id(“xxx”).context_click()
经过运行脚本得到了下面的错误提示：
AttributeError: &#39;WebElement&#39; object has no attribute &#39;context_click&#39;
提示右点方法不属于webelement对象，通过查找文档，发现属于ActionChains 类，但文档中没有具体写法。这里要感谢 北京-QC-rabbit 的指点，其实整个python&#43;selenium 学习过程都要感谢 北京-QC-rabbit 的指点。
下面介绍鼠标右键的用法，以快播私有云为例：
#coding=utf-8
from selenium importwebdriverfrom selenium.webdriver.common.action_chains importActionChainsimporttime
driver=webdriver.Firefox()
driver.get(&#34;http://passport.kuaibo.com/login/?referrer=http%3A%2F%2Fwebcloud.kuaibo.com%2F&#34;)#登陆快播私有云
driver.find_element_by_id(&#34;user_name&#34;).send_keys(&#34;username&#34;)
driver.find_element_by_id(&#34;user_pwd&#34;).send_keys(&#34;123456&#34;)
driver.find_element_by_id(&#34;dl_an_submit&#34;).click()
time.sleep(3)#定位到要右击的元素
qqq =driver.find_element_by_xpath(&#34;/html/body/div/div[2]/div[2]/div/div[3]/table/tbody/tr/td[2]&#34;)#对定位到的元素执行鼠标右键操作
ActionChains(driver).context_click(qqq).perform()&#39;&#39;&#39;#你也可以使用三行的写法，但我觉得上面两行写法更容易理解
chain = ActionChains(driver)
implement = driver.find_element_by_xpath(&#34;/html/body/div/div[2]/div[2]/div/div[3]/table/tbody/tr/td[2]&#34;)
chain.context_click(implement).perform()&#39;&#39;&#39;time.sleep(3) #休眠3秒
driver.close()
这里需要注意的是，在使用ActionChains 类之前，要先将包引入。
右击的操作会了，下面的其它方法比葫芦画瓢也能写出来。
鼠标双击的写法：
#定位到要双击的元素
qqq =driver.find_element_by_xpath(&#34;xxx&#34;)#对定位到的元素执行鼠标双击操作
ActionChains(driver).double_click(qqq).perform()
鼠标拖放操作的写法：
#定位元素的原位置
element = driver.find_element_by_name(&#34;source&#34;)#定位元素要移动到的目标位置
target = driver.find_element_by_name(&#34;target&#34;)#执行元素的移动操作" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/1414bbb05606784e0f799f8cf2632f10/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-07T13:10:57+08:00" />
<meta property="article:modified_time" content="2020-12-07T13:10:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python不属于鼠标事件的是_selenium-webdriver(python) (十五) -- 鼠标事件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>本节重点：</p> 
 <p>ActionChains 类</p> 
 <p>context_click()  右击</p> 
 <p>double_click()   双击</p> 
 <p>drag_and_drop()  拖动</p> 
 <p>测试的产品中有一个操作是右键点击文件列表会弹出一个快捷菜单，可以方便的选择快捷菜单中的选择对文件进行操作(删除、移动、重命名)，之前学习元素的点击非常简单：</p> 
 <p>driver.find_element_by_id(“xxx”).click()</p> 
 <p>那么鼠标的双击、右击、拖动等是否也是这样的写法呢？例如右击：</p> 
 <p>driver.find_element_by_id(“xxx”).context_click()</p> 
 <p>经过运行脚本得到了下面的错误提示：</p> 
 <p>AttributeError: 'WebElement' object has no attribute 'context_click'</p> 
 <p>提示右点方法不属于webelement对象，通过查找文档，发现属于ActionChains 类，但文档中没有具体写法。这里要感谢 北京-QC-rabbit 的指点，其实整个python+selenium 学习过程都要感谢 北京-QC-rabbit 的指点。</p> 
 <p>下面介绍鼠标右键的用法，以快播私有云为例：</p> 
 <p>#coding=utf-8</p> 
 <p>from selenium importwebdriverfrom selenium.webdriver.common.action_chains importActionChainsimporttime</p> 
 <p>driver=webdriver.Firefox()</p> 
 <p>driver.get("http://passport.kuaibo.com/login/?referrer=http%3A%2F%2Fwebcloud.kuaibo.com%2F")#登陆快播私有云</p> 
 <p>driver.find_element_by_id("user_name").send_keys("username")</p> 
 <p>driver.find_element_by_id("user_pwd").send_keys("123456")</p> 
 <p>driver.find_element_by_id("dl_an_submit").click()</p> 
 <p>time.sleep(3)#定位到要右击的元素</p> 
 <p>qqq =driver.find_element_by_xpath("/html/body/div/div[2]/div[2]/div/div[3]/table/tbody/tr/td[2]")#对定位到的元素执行鼠标右键操作</p> 
 <p>ActionChains(driver).context_click(qqq).perform()'''#你也可以使用三行的写法，但我觉得上面两行写法更容易理解</p> 
 <p>chain = ActionChains(driver)</p> 
 <p>implement = driver.find_element_by_xpath("/html/body/div/div[2]/div[2]/div/div[3]/table/tbody/tr/td[2]")</p> 
 <p>chain.context_click(implement).perform()'''time.sleep(3) #休眠3秒</p> 
 <p>driver.close()</p> 
 <p>这里需要注意的是，在使用ActionChains 类之前，要先将包引入。</p> 
 <p>右击的操作会了，下面的其它方法比葫芦画瓢也能写出来。</p> 
 <p>鼠标双击的写法：</p> 
 <p>#定位到要双击的元素</p> 
 <p>qqq =driver.find_element_by_xpath("xxx")#对定位到的元素执行鼠标双击操作</p> 
 <p>ActionChains(driver).double_click(qqq).perform()</p> 
 <p>鼠标拖放操作的写法：</p> 
 <p>#定位元素的原位置</p> 
 <p>element = driver.find_element_by_name("source")#定位元素要移动到的目标位置</p> 
 <p>target = driver.find_element_by_name("target")#执行元素的移动操作</p> 
 <p>ActionChains(driver).drag_and_drop(element, target).perform()</p> 
 <p>ActionChains 类不仅仅是只包含了上面的三个方法，下面将方法列出：</p> 
 <p>class ActionChains(driver)</p> 
 <p>driver:The WebDriver instance which performs user actions.</p> 
 <p>Generate user actions. All actions are stored in the ActionChains object. Call perform() to fire stored actions.</p> 
 <p>– perform()</p> 
 <p>Performs all stored actions.</p> 
 <p>– click(on_element=None)</p> 
 <p>Clicks an element.</p> 
 <p>on_element:The element to click. If None, clicks on current mouse position.</p> 
 <p>– click_and_hold(on_element)</p> 
 <p>Holds down the left mouse button on an element.</p> 
 <p>on_element:The element to mouse down. If None, clicks on current mouse position.</p> 
 <p>– context_click(on_element)</p> 
 <p>Performs a context-click (right click) on an element.</p> 
 <p>on_element:The element to context-click. If None, clicks on current mouse position.</p> 
 <p>– double_click(on_element)</p> 
 <p>Double-clicks an element.</p> 
 <p>on_element:The element to double-click. If None, clicks on current mouse position.</p> 
 <p>– drag_and_drop(source, target)</p> 
 <p>Holds down the left mouse button on the source element, then moves to the target element and releases the mouse button.</p> 
 <p>source:The element to mouse down.</p> 
 <p>target: The element to mouse up.</p> 
 <p>– key_down(key, element=None)</p> 
 <p>Sends a key press only, without releasing it. Should only be used with modifier keys (Control, Alt andShift).</p> 
 <p>key:The modifier key to send. Values are defined in Keys class.</p> 
 <p>element:The element to send keys. If None, sends a key to current focused element.</p> 
 <p>– key_up(key, element=None)</p> 
 <p>Releases a modifier key.</p> 
 <p>key:The modifier key to send. Values are defined in Keys class.</p> 
 <p>element:The element to send keys. If None, sends a key to current focused element.</p> 
 <p>– move_by_offset(xoffset, yoffset)</p> 
 <p>Moving the mouse to an offset from current mouse position.</p> 
 <p>xoffset:X offset to move to.yoffset:Y offset to move to.</p> 
 <p>– move_to_element(to_element)</p> 
 <p>Moving the mouse to the middle of an element.</p> 
 <p>to_element: The element to move to.</p> 
 <p>– move_to_element_with_offset(to_element, xoffset, yoffset)</p> 
 <p>Move the mouse by an offset of the specificed element. Offsets are relative to the top-left corner of the</p> 
 <p>element.</p> 
 <p>to_element: The element to move to.xoffset:X offset to move to.yoffset:Y offset to move to.</p> 
 <p>– release(on_element)</p> 
 <p>Releasing a held mouse button.</p> 
 <p>on_element:The element to mouse up.</p> 
 <p>– send_keys(*keys_to_send)</p> 
 <p>Sends keys to current focused element.</p> 
 <p>keys_to_send:The keys to send.</p> 
 <p>– send_keys_to_element(self, element,*keys_to_send):</p> 
 <p>Sends keys to an element.</p> 
 <p>element:The element to send keys.keys_to_send:The keys to send.</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8b51e998131b1a2b4db24bbffcc87627/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">QT QSqlError(“2036“, “QMYSQL3: Unable to bind value“）解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7d77b1d3876edddb56adba891fd474c6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python库在哪个文件夹下？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>