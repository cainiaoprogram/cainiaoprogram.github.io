<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>1.LTE  S1 切换数据面流程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="1.LTE  S1 切换数据面流程" />
<meta property="og:description" content="1、UE根据测控满足条件后上报测量结果，源站PCI&#43;频点查找目标站点，发送handover required；
S1AP ：handover required
MME-UE-S1AP-ID；eNB-UE-S1AP-ID；Handover type；Cause；Target ID（MCC、MNC、ENB_ID、TAI–其中TAI可以查找是否有MME变更）；Source to Target TransparentContainer（包含内容如下）：
→1、RRC Container：
→2、erab infomation list：
这里和Direct Forwarding Path Available是有区别，不带Direct Forwarding Path Available说明是间接隧道。
→3、target cellid
2、MME发送handover request到目标基站
其中transport address是sgw地址，还有上行隧道teid，当目标基站收到后已经具备发送上行数据（SGW不变场景下），但是还缺UU口的承载建立。
3、目标基站回复handover request acknowledge
包含handover command、gtp下行隧道信息（已经发送给MME，只是MME还未转发给sgw）、以及数据转发的间接隧道信息。
**4、MME发送create indirect data Forwarding tunnel request **
包含IMSI、上下行转发隧道信息，sgw创建间接隧道。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20210103141517340.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNjgwNTQyOQ==,size_16,color_FFFFFF,t_70
**5、MME发送到源基站handover command **
透明容器内包含rrc configuration 内容，之后源基站口空下切换命令，UE向目标基站接入实现同步。
6、源基站发送ENB transfer status，MME发送到目标基站MME transfer status
7、目标基站发送handover notify给MME
通知切换完成，这里不含下行s1-u teid，在handover request acknowledge中已有。
8、MME发送到sgw modify bearer request
之后删除间接隧道，及源基站释放UE上下文。
9、小结
→1.上下行隧道建立：
①：当目标基站收到handover request后，即可实现s1-u及s5/s8隧道建立，等待ue接入目标站点后，数据面上行隧道建立成功；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/84546c333881a64e9bd6f434a7b939e2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-15T11:01:24+08:00" />
<meta property="article:modified_time" content="2021-01-15T11:01:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">1.LTE  S1 切换数据面流程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1、UE根据测控满足条件后上报测量结果，源站PCI+频点查找目标站点，发送handover required；<br> <img src="https://images2.imgbox.com/2b/a4/pI3XzKtw_o.png" alt="在这里插入图片描述"><br> <strong>S1AP ：handover required</strong></p> 
<p>MME-UE-S1AP-ID；eNB-UE-S1AP-ID；Handover type；Cause；Target ID（MCC、MNC、ENB_ID、<strong>TAI</strong>–其中TAI可以查找是否有MME变更）；Source to Target TransparentContainer（包含内容如下）：</p> 
<p>→1、RRC Container：<br> <img src="https://images2.imgbox.com/8f/18/5T59aIuC_o.png" alt="在这里插入图片描述"><br> →2、erab infomation list：<br> 这里和Direct Forwarding Path Available是有区别，不带Direct Forwarding Path Available说明是间接隧道。<br> <img src="https://images2.imgbox.com/2c/3d/ow53AtdT_o.png" alt="在这里插入图片描述"><br> →3、target cellid<br> <img src="https://images2.imgbox.com/e3/31/ycz7Ckox_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2、MME发送handover request到目标基站</strong><br> 其中transport address是sgw地址，还有上行隧道teid，当目标基站收到后已经具备发送上行数据（SGW不变场景下），但是还缺UU口的承载建立。<br> <img src="https://images2.imgbox.com/69/f3/5706wBMq_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3f/93/JMMwSbpG_o.png" alt="在这里插入图片描述"></p> 
<p><strong>3、目标基站回复handover request acknowledge</strong><br> 包含handover command、gtp下行隧道信息（已经发送给MME，只是MME还未转发给sgw）、以及数据转发的间接隧道信息。<br> <img src="https://images2.imgbox.com/bb/22/CrrtwTMt_o.png" alt="在这里插入图片描述"><br> **4、MME发送create indirect data Forwarding tunnel request **<br> 包含IMSI、上下行转发隧道信息，sgw创建间接隧道。<br> <img src="https://images2.imgbox.com/8e/14/L1BgXfaM_o.png" alt="在这里插入图片描述"><br> ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210103141517340.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNjgwNTQyOQ==,size_16,color_FFFFFF,t_70<img src="https://images2.imgbox.com/f1/04/nNoP18pR_o.png" alt="在这里插入图片描述"></p> 
<p>**5、MME发送到源基站handover command **<br> 透明容器内包含rrc configuration 内容，之后源基站口空下切换命令，UE向目标基站接入实现同步。<br> <img src="https://images2.imgbox.com/21/c8/rmLQFKyo_o.png" alt="在这里插入图片描述"><br> <strong>6、源基站发送ENB transfer status，MME发送到目标基站MME transfer status</strong></p> 
<p><img src="https://images2.imgbox.com/23/0c/I8DAC106_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c3/df/4HfLKtXA_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b6/39/rj2R7VzZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/98/30/KR8MjBNV_o.png" alt="在这里插入图片描述"></p> 
<p><strong>7、目标基站发送handover notify给MME</strong><br> 通知切换完成，这里不含下行s1-u teid，在handover request acknowledge中已有。<br> <img src="https://images2.imgbox.com/81/cb/FMhIPh1i_o.png" alt="在这里插入图片描述"><br> <strong>8、MME发送到sgw modify bearer request</strong><br> 之后删除间接隧道，及源基站释放UE上下文。<br> <img src="https://images2.imgbox.com/ba/02/hn8eRS4i_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/44/c3/EMSMyKo0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/73/jh1HLV9x_o.png" alt="在这里插入图片描述"><br> <strong>9、小结</strong><br> →1.上下行隧道建立：<br> ①：当目标基站收到handover request后，即可实现s1-u及s5/s8隧道建立，等待ue接入目标站点后，数据面上行隧道建立成功；<br> ②：当handover request acknowledge回复及下行隧道teid，等待mme转发给sgw modify bearer request后下行隧道即可建立成功；<br> →2.间接隧道建立：<br> ①：由于单节点看，sgw是未知源uu口已经断开，源基站通过间接隧道转发下行数据到目标站；<br> ②：转发还未经过PDCP处理或者已经处理但未收到回复（RLC AM）的数据；<br> ③：转发PDCP状态，以便通知UE是否进行重传，以及重复检测和按序唯一转交给sgw；</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3ac07a526bf77c30fdf9b67c4dcbd256/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">计算机网络体系结构-外部路由</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/da6d35ef3c42749e62f8a6f885fc61a7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微博登录接入出现错误码21322(重定向地址不匹配)，其他解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>