<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>实现Postman&#43;Newman&#43;Git&#43;Jenkins&#43;钉钉/邮件提醒接口自动化测试持续集成 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="实现Postman&#43;Newman&#43;Git&#43;Jenkins&#43;钉钉/邮件提醒接口自动化测试持续集成" />
<meta property="og:description" content="下面是介绍文字内容介绍，这边还有视频详细讲解，推荐看视频
B站讲的最详细的Python接口自动化测试实战教程全集（实战最新版）
团队成员协作编写接口用例-&gt;用例归档到git/svn-&gt;脚本集成jenkins,在环境更新后自动触发执行或定时执行。当然git/SVN不熟悉也可以在本地文件操作。
Windows系统Newman安装 1、下载Node.js进行安装，然后配置node的环境变量 2、借助npm工具，安装Newman npm install -g newman 3、运行Newman 通过Newman来运行某个postman脚本： newman run mycollection.json 用newman执行postman脚本的效果如下： Centos系统Newman安装 1、先下载安装nodejs （必须安装10.0以上的版本）
从http://nodejs.cn/download/下载linux系统压缩包 ,，解压，配置环境变量
tar xvJf ***.tar.xz echo &#34;export PATH=\&#34;\$PATH:/root/tools/node-v14.8.0-linux-x64/bin\&#34;&#34; \ &gt;&gt; ~/.bash_profile &amp;&amp; source ~/.bash_profile 2、安装Newman
npm install -g newman 以上通过命令安装如果问题的话 ，可以百度解决
命令行执行Postman脚本生成测试报告 1、命令行执行脚本的最基本的命令
newman run xxx.json newman run xxx.json -e xx环境变量.json -g xx全局变量.json 2、生成html格式的报告
先安装插件：npm install -g newman-reporter-html 再执行：newman run demo.postman_collection.json -r html 3、优化报告显示格式，生成美观一点的html格式报告
先安装插件：npm install -g newman-reporter-htmlextra 再执行：newman run demo." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8343c8a05629e2fa55402a069c2c8563/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-08T21:30:20+08:00" />
<meta property="article:modified_time" content="2023-03-08T21:30:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">实现Postman&#43;Newman&#43;Git&#43;Jenkins&#43;钉钉/邮件提醒接口自动化测试持续集成</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>下面是介绍文字内容介绍，这边还有视频详细讲解，推荐看视频</p> 
<div class="csdn-video-box"> 
 <iframe id="Jh9iIXod-1678282206386" frameborder="0" src="https://player.bilibili.com/player.html?aid=970817796" allowfullscreen="true" data-mediaembed="bilibili"></iframe> 
 <p>B站讲的最详细的Python接口自动化测试实战教程全集（实战最新版）</p> 
</div> 
<p></p> 
<p>团队成员协作编写接口用例-&gt;用例归档到git/svn-&gt;脚本集成jenkins,在环境更新后自动触发执行或定时执行。当然git/SVN不熟悉也可以在本地文件操作。</p> 
<h4 id="Windows%E7%B3%BB%E7%BB%9FNewman%E5%AE%89%E8%A3%85"><a name="t1"></a><strong>Windows系统Newman安装</strong></h4> 
<pre><code class="language-python">1、下载Node.js进行安装，然后配置node的环境变量                                                
 
2、借助npm工具，安装Newman
 
npm install -g newman
 
3、运行Newman
 
通过Newman来运行某个postman脚本：
 
newman run  mycollection.json
 
用newman执行postman脚本的效果如下：</code></pre> 
<p><img alt="" height="427" src="https://images2.imgbox.com/b3/89/hZTRLvsX_o.png" width="732"></p> 
<h4 id="Centos%E7%B3%BB%E7%BB%9FNewman%E5%AE%89%E8%A3%85"><strong>Centos系统Newman安装</strong></h4> 
<p>1、先下载安装nodejs （必须安装10.0以上的版本）</p> 
<p>从http://nodejs.cn/download/下载linux系统压缩包 ,，解压，配置环境变量</p> 
<pre><code class="language-python">tar xvJf ***.tar.xz
echo "export PATH=\"\$PATH:/root/tools/node-v14.8.0-linux-x64/bin\"" \ &gt;&gt; ~/.bash_profile &amp;&amp;
source ~/.bash_profile</code></pre> 
<p> 2、安装<a href="https://so.csdn.net/so/search?q=Newman&amp;spm=1001.2101.3001.7020" title="Newman">Newman</a></p> 
<pre><code>npm install -g newman</code></pre> 
<p>以上通过命令安装如果问题的话 ，可以百度解决</p> 
<h4 id="%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%89%A7%E8%A1%8CPostman%E8%84%9A%E6%9C%AC%E7%94%9F%E6%88%90%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A"><a name="t3"></a><strong>命令行执行Postman脚本生成测试报告</strong></h4> 
<p>1、命令行执行脚本的最基本的命令</p> 
<pre><code class="language-python">newman run xxx.json
 
newman run xxx.json -e xx环境变量.json -g xx全局变量.json</code></pre> 
<p><img alt="" height="428" src="https://images2.imgbox.com/ab/40/vaALYNzL_o.png" width="733"></p> 
<p> </p> 
<p>2、生成html格式的报告</p> 
<pre><code class="language-python">先安装插件：npm install -g newman-reporter-html
 
再执行：newman run demo.postman_collection.json -r html</code></pre> 
<p><img alt="" height="799" src="https://images2.imgbox.com/b8/c3/nbtlL1SV_o.png" width="929"></p> 
<p> </p> 
<p> 3、优化报告显示格式，生成美观一点的html格式报告</p> 
<pre><code class="language-python">先安装插件：npm install -g newman-reporter-htmlextra
 
再执行：newman run demo.postman_collection.json -r htmlextra</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/ab/70/0lYzquRu_o.png"></p> 
<p>注意事项：</p> 
<p>1、-r参数是--reporters的缩写，可以在参数后面指定需要生成的报告格式 ，比如 -r html,junit,json,htmlextra ，这个会在当前目录下生成一个newman的文件夹，报告都在newman的文件夹下面：</p> 
<p> <img alt="" height="131" src="https://images2.imgbox.com/d0/95/pgjCLTfG_o.png" width="433"></p> 
<p> 2、也可以加上下面的参数指定报告名称：(报告默认生成在当前执行命令的路径下 ，也可以自己在报告名称前加上指定路径生成)</p> 
<blockquote> 
 <p>--reporter-html-export htmlReport.html</p> 
 <p>--reporter-htmlextra-export htmlExtraReport.html</p> 
 <p>--reporter-junit-export junitReport.html</p> 
 <p>--reporter-json-export jsonReport.html</p> 
</blockquote> 
<p> 3、在使用npm命令安装newman以及其他的包时，建议都加上-g 参数 ，给所有用户都安装对应的包，避免在使用命令时报错。</p> 
<p>使用npm安装如果比较慢，可以先执行下面的命令，切换下载源的地址：</p> 
<blockquote> 
 <p>npm config set registry https://registry.npm.taobao.org</p> 
</blockquote> 
<p>4、通过newman-reporter-htmlextra插件生成的html报告，默认是不包含css样式文件的，如果是发给别人访问 ，在断网的情况下查看报告，样式是加载不了的。目前查了一下，好像没有类似allure里面的那种参数，可以把报告所需的样式和报告一起导出，不过这个插件支持自定义报告模板，可以自己手动将css样式文件导出到某个位置，然后修改报告模板汇总引用的文件去解决这个问题。</p> 
<p><strong>Postman脚本持续集成</strong></p> 
<p>通过上面的描述 ，现在已经可以将postman脚本生成报告了，离集成jenkins只差最后的配置工作了：</p> 
<p>1、在gitee上新建一个仓库，将postman调试好的脚本导出成json文件，上传到gitee上 （上传到gitee仓库的话，可以方便团队不同成员之间可以更改和查看用例），后续有脚本变更的时候也可以直接更新到git上进行存储，git上也可以按版本按分支存放你的测试脚本</p> 
<p>2、搭建好jenkins环境，并配置好npm的环境以及安装好newman执行环境</p> 
<p>3、新建一个自由风格的job，配置从git上获取脚本：</p> 
<p>勾选构建环境下的清除工作空间目录的配置，将之前的报告清除（如果执行命令生成报告时自己指定了报告名称的话 ，也可以不清除工作空间的文件）</p> 
<p>添加执行batch命令 / shell命令,命令内容如下：</p> 
<pre><code class="language-python">
# batch命令
cd /d  %WORKSPACE%
newman run demo.postman_collection.json -r htmlextra --reporter-htmlextra-export ./report/htmlExtraReport.html 
或者
# shell 命令
cd $WORKSPACE
newman run demo.postman_collection.json -r htmlextra --reporter-htmlextra-export ./report/htmlExtraReport.html newman run demo.postman_collection.json -r htmlextra --reporter-htmlextra-export ./report/htmlExtraReport.html</code></pre> 
<p>然后再构建后操作那里 ，添加报告的展示：</p> 
<p>需安装HTML Publisher plugin插件</p> 
<p>构建后 ，即可在jenkins上看到HTML报告：</p> 
<p>发送钉钉通知<br> 由于现在很多企业办公通讯都是用钉钉 ，那么接口自动化的脚本执行完之后，是可以讲结果发送到指定的钉钉群里面的。</p> 
<p>准备工作：钉钉帐号，在钉钉上创建指定机器人 ，jenkins上安装DingTalk插件。</p> 
<p>钉钉PC端机器人创建操作：</p> 
<p>钉钉左上角用户头像处-&gt;机器人管理-&gt;创建自定义机器人</p> 
<p>设置机器人名称、指定消息通知的群、安全设置下可以设置自定义关键字，然后点击完成，然后页面会生成一个webhook的地址</p> 
<p>安装Jenkins上的DingTalk插件，进入系统配置页面，找到钉钉的配置：</p> 
<p>然后进入postman脚本执行的job配置页面，勾选需要通知的机器人名称即可。</p> 
<p>构建开始和结束后就会收到钉钉通知：</p> 
<h3 id="%E8%A7%A3%E5%86%B3jenkins%E4%B8%8A%E6%97%A0%E6%B3%95%E5%B1%95%E7%A4%BAHTML%E6%A0%B7%E5%BC%8F%E7%9A%84%E9%97%AE%E9%A2%98"><strong>解决jenkins上无法展示HTML样式的问题</strong></h3> 
<p>由于安全考虑，jenkins默认是禁止了外部的css和js的加载的，因此html报告显示会出现异常，常见的解决方案有以下几种：</p> 
<p>1、在jenkins系统管理-&gt;脚本命令行 输入以下脚本运行：（此方案重启jenkins失效）</p> 
<pre><code class="language-python">System.setProperty("hudson.model.DirectoryBrowserSupport.CSP", "")</code></pre> 
<p>2、利用jenkins的插件，在启动节点的时候自动触发某个job去执行groovy脚本。搜索安装Startup Trigger和Groovy插件即可。</p> 
<p>配置一个job，然后在job中执行groovy脚本：</p> 
<pre><code class="language-python">System.setProperty("hudson.model.DirectoryBrowserSupport.CSP", "")</code></pre> 
<p>3、以windows服务或者java -jar的方式启动的jenkins，可以修改jenkin.xml文件中的启动命令，加入参数</p> 
<pre><code class="language-python">-Dhudson.model.DirectoryBrowserSupport.CSP=</code></pre> 
<p>4、用tomcat部署的jenkins，可以直接改catalina.bat文件，找到tomcat/bin下的catalina.bat文件,用Notepad++打开，加上一行代码</p> 
<p>set JAVA_OPTS="-Dhudson.model.DirectoryBrowserSupport.CSP"</p> 
<h3 id="%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0"><strong>扩展学习</strong></h3> 
<p>1、newman的其他用法(比如执行命令的时候加载环境变配置、设置执行次数等)：</p> 
<p>https://www.npmjs.com/package/newman</p> 
<p>2、newman-reporter-htmlextra插件的其他用法(比如报告过滤数据，设置标题等)：</p> 
<p>https://www.npmjs.com/package/newman-reporter-htmlextra</p> 
<p>3、钉钉通知在jenkins上的配置，还可以指定具体通知的人等高级用法，可以自己查资料扩展一下.觉得钉钉插件提醒不好用的话，也可以自己写脚本调用钉钉的接口发送消息提醒。<br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/21af86debb977b2623887ff80b9120a5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Elasticsearch基础概念和Python操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/14dd24abb3e0e9a6f4da9a5266e40164/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一小时搞定c#微信支付</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>