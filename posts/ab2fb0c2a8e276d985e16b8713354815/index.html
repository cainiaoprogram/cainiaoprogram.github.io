<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习篇-逻辑回归的分类预测 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习篇-逻辑回归的分类预测" />
<meta property="og:description" content="机器学习篇-逻辑回归的分类预测 1 逻辑回归的介绍和应用 1.1 逻辑回归的介绍 逻辑回归（Logistic regression，简称LR）虽然其中带有&#34;回归&#34;两个字，但逻辑回归其实是一个分类模型，并且广泛应用于各个领域之中。虽然现在深度学习相对于这些传统方法更为火热，但实则这些传统方法由于其独特的优势依然广泛应用于各个领域中。
而对于逻辑回归而且，最为突出的两点就是其模型简单和模型的可解释性强。
逻辑回归模型的优劣势:
优点：实现简单，易于理解和实现；计算代价不高，速度很快，存储资源低；
缺点：容易欠拟合，分类精度可能不高
1.2 逻辑回归的应用 逻辑回归模型广泛用于各个领域，包括机器学习，大多数医学领域和社会科学。例如，最初由Boyd 等人开发的创伤和损伤严重度评分（TRISS）被广泛用于预测受伤患者的死亡率，使用逻辑回归 基于观察到的患者特征（年龄，性别，体重指数,各种血液检查的结果等）分析预测发生特定疾病（例如糖尿病，冠心病）的风险。逻辑回归模型也用于预测在给定的过程中，系统或产品的故障的可能性。还用于市场营销应用程序，例如预测客户购买产品或中止订购的倾向等。在经济学中它可以用来预测一个人选择进入劳动力市场的可能性，而商业应用则可以用来预测房主拖欠抵押贷款的可能性。条件随机字段是逻辑回归到顺序数据的扩展，用于自然语言处理。
逻辑回归模型现在同样是很多分类算法的基础组件,比如 分类任务中基于GBDT算法&#43;LR逻辑回归实现的信用卡交易反欺诈，CTR(点击通过率)预估等，其好处在于输出值自然地落在0到1之间，并且有概率意义。模型清晰，有对应的概率学理论基础。它拟合出来的参数就代表了每一个特征(feature)对结果的影响。也是一个理解数据的好工具。但同时由于其本质上是一个线性的分类器，所以不能应对较为复杂的数据情况。很多时候我们也会拿逻辑回归模型去做一些任务尝试的基线（基础水平）。
说了这些逻辑回归的概念和应用，大家应该已经对其有所期待了吧，那么我们现在开始吧！！！
2 学习目标 了解 逻辑回归 的理论
掌握 逻辑回归 的 sklearn 函数调用使用并将其运用到鸢尾花数据集预测
3 代码流程 基于鸢尾花（iris）数据集的逻辑回归分类实践
Step1:库函数导入
Step2:数据读取/载入
Step3:数据信息简单查看
Step4:可视化描述
Step5:利用 逻辑回归模型 在二分类上 进行训练和预测
Step5:利用 逻辑回归模型 在三分类(多分类)上 进行训练和预测
4 基于鸢尾花（iris）数据集的逻辑回归分类实践 在实践的最开始，我们首先需要导入一些基础的函数库包括：numpy （Python进行科学计算的基础软件包），pandas（pandas是一种快速，强大，灵活且易于使用的开源数据分析和处理工具），matplotlib和seaborn绘图。
Step1： 库函数的导入 ## 基础函数库 import numpy as np import pandas as pd ## 绘图函数库 import matplotlib.pyplot as plt import seaborn as sns 本次我们选择鸢花数据（iris）进行方法的尝试训练，该数据集一共包含5个变量，其中4个特征变量，1个目标分类变量。共有150个样本，目标变量为 花的类别 其都属于鸢尾属下的三个亚属，分别是山鸢尾 (Iris-setosa)，变色鸢尾(Iris-versicolor)和维吉尼亚鸢尾(Iris-virginica)。包含的三种鸢尾花的四个特征，分别是花萼长度(cm)、花萼宽度(cm)、花瓣长度(cm)、花瓣宽度(cm)，这些形态特征在过去被用来识别物种。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ab2fb0c2a8e276d985e16b8713354815/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-31T10:07:57+08:00" />
<meta property="article:modified_time" content="2022-05-31T10:07:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习篇-逻辑回归的分类预测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>机器学习篇-逻辑回归的分类预测</h2> 
<h3><a id="1__1"></a>1 逻辑回归的介绍和应用</h3> 
<h4><a id="11__2"></a>1.1 逻辑回归的介绍</h4> 
<p>逻辑回归（Logistic regression，简称LR）虽然其中带有"回归"两个字，但逻辑回归其实是一个分类模型，并且广泛应用于各个领域之中。虽然现在深度学习相对于这些传统方法更为火热，但实则这些传统方法由于其独特的优势依然广泛应用于各个领域中。</p> 
<p>而对于逻辑回归而且，最为突出的两点就是其模型简单和模型的可解释性强。</p> 
<p>逻辑回归模型的优劣势:</p> 
<p>优点：实现简单，易于理解和实现；计算代价不高，速度很快，存储资源低；<br> 缺点：容易欠拟合，分类精度可能不高</p> 
<h4><a id="12__11"></a>1.2 逻辑回归的应用</h4> 
<p>逻辑回归模型广泛用于各个领域，包括机器学习，大多数医学领域和社会科学。例如，最初由Boyd 等人开发的创伤和损伤严重度评分（TRISS）被广泛用于预测受伤患者的死亡率，使用逻辑回归 基于观察到的患者特征（年龄，性别，体重指数,各种血液检查的结果等）分析预测发生特定疾病（例如糖尿病，冠心病）的风险。逻辑回归模型也用于预测在给定的过程中，系统或产品的故障的可能性。还用于市场营销应用程序，例如预测客户购买产品或中止订购的倾向等。在经济学中它可以用来预测一个人选择进入劳动力市场的可能性，而商业应用则可以用来预测房主拖欠抵押贷款的可能性。条件随机字段是逻辑回归到顺序数据的扩展，用于自然语言处理。</p> 
<p>逻辑回归模型现在同样是很多分类算法的基础组件,比如 分类任务中基于GBDT算法+LR逻辑回归实现的信用卡交易反欺诈，CTR(点击通过率)预估等，其好处在于输出值自然地落在0到1之间，并且有概率意义。模型清晰，有对应的概率学理论基础。它拟合出来的参数就代表了每一个特征(feature)对结果的影响。也是一个理解数据的好工具。但同时由于其本质上是一个线性的分类器，所以不能应对较为复杂的数据情况。很多时候我们也会拿逻辑回归模型去做一些任务尝试的基线（基础水平）。</p> 
<p>说了这些逻辑回归的概念和应用，大家应该已经对其有所期待了吧，那么我们现在开始吧！！！</p> 
<h3><a id="2__17"></a>2 学习目标</h3> 
<p>了解 逻辑回归 的理论<br> 掌握 逻辑回归 的 sklearn 函数调用使用并将其运用到鸢尾花数据集预测</p> 
<h3><a id="3__20"></a>3 代码流程</h3> 
<p>基于鸢尾花（iris）数据集的逻辑回归分类实践<br> Step1:库函数导入<br> Step2:数据读取/载入<br> Step3:数据信息简单查看<br> Step4:可视化描述<br> Step5:利用 逻辑回归模型 在二分类上 进行训练和预测<br> Step5:利用 逻辑回归模型 在三分类(多分类)上 进行训练和预测</p> 
<h3><a id="4_iris_29"></a>4 基于鸢尾花（iris）数据集的逻辑回归分类实践</h3> 
<p>在实践的最开始，我们首先需要导入一些基础的函数库包括：numpy （Python进行科学计算的基础软件包），pandas（pandas是一种快速，强大，灵活且易于使用的开源数据分析和处理工具），matplotlib和seaborn绘图。</p> 
<h5><a id="Step1__31"></a>Step1： 库函数的导入</h5> 
<pre><code class="prism language-python"><span class="token comment">##  基础函数库</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment">## 绘图函数库</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
</code></pre> 
<p>本次我们选择鸢花数据（iris）进行方法的尝试训练，该数据集一共包含5个变量，其中4个特征变量，1个目标分类变量。共有150个样本，目标变量为 花的类别 其都属于鸢尾属下的三个亚属，分别是山鸢尾 (Iris-setosa)，变色鸢尾(Iris-versicolor)和维吉尼亚鸢尾(Iris-virginica)。包含的三种鸢尾花的四个特征，分别是花萼长度(cm)、花萼宽度(cm)、花瓣长度(cm)、花瓣宽度(cm)，这些形态特征在过去被用来识别物种。</p> 
<p><img src="https://images2.imgbox.com/8c/76/n4WLplRh_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="Step2_44"></a>Step2：数据读取/载入</h5> 
<pre><code class="prism language-python"><span class="token comment">## 我们利用 sklearn 中自带的 iris 数据作为数据载入，并利用Pandas转化为DataFrame格式</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
data <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#得到数据特征</span>
iris_target <span class="token operator">=</span> data<span class="token punctuation">.</span>target <span class="token comment">#得到数据对应的标签</span>
iris_features <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">.</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span>data<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span> <span class="token comment">#利用Pandas转化为DataFrame格式</span>

</code></pre> 
<h5><a id="Step3_54"></a>Step3：数据信息简单查看</h5> 
<pre><code class="prism language-python"><span class="token comment">## 利用.info()查看数据的整体信息</span>
iris_features<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/7e/2c/gS20hlwD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_head_tail_61"></a>进行简单的数据查看，我们可以利用 .head() 头部.tail()尾部</h3> 
<pre><code class="prism language-python"><span class="token comment">## 进行简单的数据查看，我们可以利用 .head() 头部.tail()尾部</span>
iris_features<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/09/7e/BT2vi8VO_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">
<span class="token comment">## 其对应的类别标签为，其中0，1，2分别代表'setosa', 'versicolor', 'virginica'三种不同花的类别。</span>
iris_target

</code></pre> 
<p><img src="https://images2.imgbox.com/69/9b/Ke0xWJif_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python">
<span class="token comment">## 利用value_counts函数查看每个类别数量</span>
pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>iris_target<span class="token punctuation">)</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/17/cf/wLByHG73_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment">## 对于特征进行一些统计描述</span>
iris_features<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/17/56/atOL9GYw_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="Step4_93"></a>Step4:可视化描述</h5> 
<pre><code class="prism language-python"><span class="token comment">## 合并标签和特征信息</span>
iris_all <span class="token operator">=</span> iris_features<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">##进行浅拷贝，防止对于原始数据的修改</span>
iris_all<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span> <span class="token operator">=</span> iris_target
<span class="token comment">## 特征与标签组合的散点可视化</span>
sns<span class="token punctuation">.</span>pairplot<span class="token punctuation">(</span>data<span class="token operator">=</span>iris_all<span class="token punctuation">,</span>diag_kind<span class="token operator">=</span><span class="token string">'hist'</span><span class="token punctuation">,</span> hue<span class="token operator">=</span> <span class="token string">'target'</span><span class="token punctuation">)</span><span class="token comment">#这个用来展现变量两两之间的关系，线性、非线性、相关等等</span>
<span class="token comment">#diag_kind用来控制对角线上的图的类型，hue是针对某一字段进行分类</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/28/ea/GfTWU9Tm_o.png" alt="在这里插入图片描述"><br> 从上图可以发现，在2D情况下不同的特征组合对于不同类别的花的散点分布，以及大概的区分能力。</p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> col <span class="token keyword">in</span> iris_features<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'target'</span><span class="token punctuation">,</span> y<span class="token operator">=</span>col<span class="token punctuation">,</span> saturation<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>palette<span class="token operator">=</span><span class="token string">'pastel'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>iris_all<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/d9/8Uzze9tb_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bb/38/96caTZlb_o.png" alt="在这里插入图片描述"><br> 利用箱型图我们也可以得到不同类别在不同特征上的分布差异情况。</p> 
<pre><code class="prism language-python">
<span class="token comment"># 选取其前三个特征绘制三维散点图</span>
<span class="token keyword">from</span> mpl_toolkits<span class="token punctuation">.</span>mplot3d <span class="token keyword">import</span> Axes3D

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">,</span> projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>

iris_all_class0 <span class="token operator">=</span> iris_all<span class="token punctuation">[</span>iris_all<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
iris_all_class1 <span class="token operator">=</span> iris_all<span class="token punctuation">[</span>iris_all<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
iris_all_class2 <span class="token operator">=</span> iris_all<span class="token punctuation">[</span>iris_all<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
<span class="token comment"># 'setosa'(0), 'versicolor'(1), 'virginica'(2)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>iris_all_class0<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris_all_class0<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris_all_class0<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'setosa'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>iris_all_class1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris_all_class1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris_all_class1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'versicolor'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>iris_all_class2<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris_all_class2<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iris_all_class2<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'virginica'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b6/9f/qMvd7moJ_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="Step5____140"></a>Step5:利用 逻辑回归模型 在二分类上 进行训练和预测</h5> 
<pre><code class="prism language-python">
<span class="token comment">## 为了正确评估模型性能，将数据划分为训练集和测试集，并在训练集上训练模型，在测试集上验证模型性能。</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment">## 选择其类别为0和1的样本 （不包括类别为2的样本）</span>
iris_features_part <span class="token operator">=</span> iris_features<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>
iris_target_part <span class="token operator">=</span> iris_target<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>

<span class="token comment">## 测试集大小为20%， 80%/20%分</span>
x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>iris_features_part<span class="token punctuation">,</span> iris_target_part<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">2020</span><span class="token punctuation">)</span>

<span class="token comment">## 从sklearn中导入逻辑回归模型</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression

<span class="token comment">## 定义 逻辑回归模型 </span>
clf <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">'lbfgs'</span><span class="token punctuation">)</span>

<span class="token comment"># 在训练集上训练逻辑回归模型</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment">## 查看其对应的w,因为是4个特征值，所以有4个数字</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the weight of Logistic Regression:'</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>

<span class="token comment">## 查看其对应的w0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the intercept(w0) of Logistic Regression:'</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>
</code></pre> 
<p>the weight of Logistic Regression: [[ 0.45181973 -0.81743611 2.14470304 0.89838607]]</p> 
<p>the intercept(w0) of Logistic Regression: [-6.53367714]</p> 
<pre><code class="prism language-python">
<span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">## 查看混淆矩阵 (预测值和真实值的各类情况统计矩阵)</span>
confusion_matrix_result <span class="token operator">=</span> metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>test_predict<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The confusion matrix result:\n'</span><span class="token punctuation">,</span>confusion_matrix_result<span class="token punctuation">)</span>

<span class="token comment"># 利用热力图对于结果进行可视化</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>confusion_matrix_result<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'Blues'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predicted labels'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True labels'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>The accuracy of the Logistic Regression is: 1.0</p> 
<p>The accuracy of the Logistic Regression is: 1.0</p> 
<p>The confusion matrix result:</p> 
<p>[[ 9 0]</p> 
<p>[ 0 11]]<br> <img src="https://images2.imgbox.com/10/93/DouTc1j1_o.png" alt="在这里插入图片描述"><br> 我们可以发现其准确度为1，代表所有的样本都预测正确了。</p> 
<h5><a id="Step6____209"></a>Step6:利用 逻辑回归模型 在三分类(多分类)上 进行训练和预测</h5> 
<pre><code class="prism language-python">
<span class="token comment">## 测试集大小为20%， 80%/20%分</span>
x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>iris_features<span class="token punctuation">,</span> iris_target<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">2020</span><span class="token punctuation">)</span>
<span class="token comment">## 定义 逻辑回归模型 </span>
clf <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">'lbfgs'</span><span class="token punctuation">)</span>

<span class="token comment"># 在训练集上训练逻辑回归模型</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment">## 查看其对应的w</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the weight of Logistic Regression:\n'</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>

<span class="token comment">## 查看其对应的w0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the intercept(w0) of Logistic Regression:\n'</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>

<span class="token comment">## 由于这个是3分类，所有我们这里得到了三个逻辑回归模型的参数，其三个逻辑回归组合起来即可实现三分类。</span>
</code></pre> 
<p>the weight of Logistic Regression:</p> 
<p>[[-0.45928925 0.83069886 -2.26606531 -0.9974398 ]</p> 
<p>[ 0.33117319 -0.72863423 -0.06841147 -0.9871103 ]</p> 
<p>[ 0.12811606 -0.10206463 2.33447679 1.9845501 ]]</p> 
<p>the intercept(w0) of Logistic Regression:</p> 
<p>[ 9.43880677 3.93047364 -13.36928041]</p> 
<pre><code class="prism language-python"><span class="token comment">## 在训练集和测试集上分布利用训练好的模型进行预测</span>
train_predict <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

<span class="token comment">## 由于逻辑回归模型是概率预测模型（前文介绍的 p = p(y=1|x,\theta)）,所有我们可以利用 predict_proba 函数预测其概率</span>
train_predict_proba <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>
test_predict_proba <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The test predict Probability of each class:\n'</span><span class="token punctuation">,</span>test_predict_proba<span class="token punctuation">)</span>
<span class="token comment">## 其中第一列代表预测为0类的概率，第二列代表预测为1类的概率，第三列代表预测为2类的概率。</span>

<span class="token comment">## 利用accuracy（准确度）【预测正确的样本数目占总预测样本数目的比例】评估模型效果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>train_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The accuracy of the Logistic Regression is:'</span><span class="token punctuation">,</span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>test_predict<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<p>The test predict Probability of each class:</p> 
<p>[[1.03461734e-05 2.33279475e-02 9.76661706e-01]</p> 
<p>[9.69926591e-01 3.00732875e-02 1.21676996e-07]</p> 
<p>[2.09992547e-02 8.69156617e-01 1.09844128e-01]</p> 
<p>[3.61934870e-03 7.91979966e-01 2.04400685e-01]</p> 
<p>[7.90943202e-03 8.00605300e-01 1.91485268e-01]</p> 
<p>[7.30034960e-04 6.60508053e-01 3.38761912e-01]</p> 
<p>[1.68614209e-04 1.86322045e-01 8.13509341e-01]</p> 
<p>[1.06915332e-01 8.90815532e-01 2.26913667e-03]</p> 
<p>[9.46928070e-01 5.30707294e-02 1.20016057e-06]</p> 
<p>[9.62346385e-01 3.76532233e-02 3.91897289e-07]</p> 
<p>[1.19533384e-04 1.38823468e-01 8.61056998e-01]</p> 
<p>[8.78881883e-03 6.97207361e-01 2.94003820e-01]</p> 
<p>[9.73938143e-01 2.60617346e-02 1.22613836e-07]</p> 
<p>[1.78434056e-03 4.79518177e-01 5.18697482e-01]</p> 
<p>[5.56924342e-04 2.46776841e-01 7.52666235e-01]</p> 
<p>[9.83549842e-01 1.64500670e-02 9.13617258e-08]</p> 
<p>[1.65201477e-02 9.54672749e-01 2.88071038e-02]</p> 
<p>[8.99853708e-03 7.82707576e-01 2.08293887e-01]</p> 
<p>[2.98015025e-05 5.45900066e-02 9.45380192e-01]</p> 
<p>[9.35695863e-01 6.43039513e-02 1.85301359e-07]</p> 
<p>[9.80621190e-01 1.93787400e-02 7.00125246e-08]</p> 
<p>[1.68478815e-04 3.30167226e-01 6.69664295e-01]</p> 
<p>[3.54046163e-03 4.02267805e-01 5.94191734e-01]</p> 
<p>[9.70617284e-01 2.93824740e-02 2.42443967e-07]</p> 
<p>[2.56895205e-04 1.54631583e-01 8.45111522e-01]</p> 
<p>[3.48668490e-02 9.11966141e-01 5.31670105e-02]</p> 
<p>[1.47218847e-02 6.84038115e-01 3.01240001e-01]</p> 
<p>[9.46510447e-04 4.28641987e-01 5.70411503e-01]</p> 
<p>[9.64848137e-01 3.51516748e-02 1.87917880e-07]</p> 
<p>[9.70436779e-01 2.95624025e-02 8.18591606e-07]]</p> 
<p>The accuracy of the Logistic Regression is: 0.9833333333333333</p> 
<p>The accuracy of the Logistic Regression is: 0.8666666666666667</p> 
<pre><code class="prism language-python">
<span class="token comment">## 查看混淆矩阵</span>
confusion_matrix_result <span class="token operator">=</span> metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>test_predict<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The confusion matrix result:\n'</span><span class="token punctuation">,</span>confusion_matrix_result<span class="token punctuation">)</span>

<span class="token comment"># 利用热力图对于结果进行可视化</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>confusion_matrix_result<span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'Blues'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predicted labels'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True labels'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/7e/77/x3IIjUi5_o.png" alt="在这里插入图片描述"><br> 通过结果我们可以发现，其在三分类的结果的预测准确度上有所下降，其在测试集上的准确度为:<br> 86.67<br> %<br> ，这是由于’versicolor’（1）和 ‘virginica’（2）这两个类别的特征，我们从可视化的时候也可以发现，其特征的边界具有一定的模糊性（边界类别混杂，没有明显区分边界），所有在这两类的预测上出现了一定的错误。</p> 
<h3><a id="5___347"></a>5 重要知识点</h3> 
<p><img src="https://images2.imgbox.com/36/fc/6lQYTzea_o.png" alt="在这里插入图片描述"><br> 其对应的函数图像可以表示如下:</p> 
<pre><code class="prism language-python">
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre> 
<p><img src="https://images2.imgbox.com/ea/80/tQKQeRUS_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0da5275234b87e8fdd60f5cf2d04836d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot启动报错The Bean Validation API is on the classpath but no implementation could be found</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3fe289a104bde01da79c7757486cbfe6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java自定义异常并处理异常</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>