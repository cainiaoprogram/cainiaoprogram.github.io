<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一个傻瓜式构建可视化 web的 Python 神器 -- streamlit 教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一个傻瓜式构建可视化 web的 Python 神器 -- streamlit 教程" />
<meta property="og:description" content="正常在学习一个新框架之前， 肯定要先调研下这个框架究竟能做些什么事吧？
但对于 streamlit 来说，请你相信我，这是一个你可以无脑去学习的框架，我之所以这么说，是因为我相信终有一天，你一定能用得上它。
如果你真的需要一些理由的话，那我随便给你举几个例子：
做数据分析的同学，想要把数据分析的成果做成应用展示给其他人，怎么办？想做一些用户数据的收集，但某些公有平台又却仅有收集，没有对应的开发能力提供数据的处理与反馈，怎么办？ 难道真的要为了这种简单的需求，去折腾 html &#43; css &#43; js &#43; flask (or django) 吗？
这是大多数非专业开发者的痛点，也是 streamlit 这个框架流行开来的主要原因。
Streamlit 是一个用于机器学习、数据可视化的 Python 框架，它能几行代码就构建出一个精美的在线 app 应用。
它能做什么，取决于你想干什么？
streamlit 的功能强大，要学习的函数虽然多，但非常容易上手，学习成本却远比 前端&#43;Flask 来得低得低。接下来，我会一一介绍。
1. 如何安装？ 和安装其他包一样，安装 streamlit 非常简单，一条命令即可
➜ pip install streamlit 考虑到 streamlit 会附带安装比较多的工具依赖包，为了不污染当前的主要环境，我使用 venv 新建一个虚拟环境。
➜ python3 -m venv . 然后使用如下命令进入该虚拟环境
➜ source ./venv/bin/activate 接下来，再安装 streamlit ，命令在上边。
安装的包比较多（数了下竟然接近 92 个？），过程也会很久，需要点耐心
➜ pip list | wc -l 92 在安装过程中，可能会遇到一些问题，但也不一定，这取决于你的机器，如遇到问题请自行借助搜索引擎解决。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6aac6f62b5e0b07ce24129c32f54eab8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-23T13:03:42+08:00" />
<meta property="article:modified_time" content="2021-12-23T13:03:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一个傻瓜式构建可视化 web的 Python 神器 -- streamlit 教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>正常在学习一个新框架之前， 肯定要先调研下这个框架究竟能做些什么事吧？</p> 
<p>但对于 streamlit 来说，请你相信我，这是一个你可以无脑去学习的框架，我之所以这么说，是因为我相信终有一天，你一定能用得上它。</p> 
<p>如果你真的需要一些理由的话，那我随便给你举几个例子：</p> 
<ul><li>做数据分析的同学，想要把数据分析的成果做成应用展示给其他人，怎么办？</li><li>想做一些用户数据的收集，但某些公有平台又却仅有收集，没有对应的开发能力提供数据的处理与反馈，怎么办？</li></ul> 
<p>难道真的要为了这种简单的需求，去折腾 html + css + js + flask (or django) 吗？</p> 
<p>这是大多数非专业开发者的痛点，也是 streamlit 这个框架流行开来的主要原因。</p> 
<p>Streamlit 是一个用于机器学习、数据可视化的 Python 框架，它能几行代码就构建出一个精美的在线 app 应用。</p> 
<p>它能做什么，取决于你想干什么？</p> 
<p>streamlit 的功能强大，要学习的函数虽然多，但非常容易上手，学习成本却远比 前端+Flask 来得低得低。接下来，我会一一介绍。</p> 
<h3><a id="1__19"></a>1. 如何安装？</h3> 
<p>和安装其他包一样，安装 streamlit 非常简单，一条命令即可</p> 
<pre><code class="prism language-bash">➜ pip <span class="token function">install</span> streamlit 
</code></pre> 
<p>考虑到 streamlit 会附带安装比较多的工具依赖包，为了不污染当前的主要环境，我使用 venv 新建一个虚拟环境。</p> 
<pre><code class="prism language-bash">➜ python3 -m venv <span class="token builtin class-name">.</span>
</code></pre> 
<p>然后使用如下命令进入该虚拟环境</p> 
<pre><code class="prism language-bash">➜ <span class="token builtin class-name">source</span> ./venv/bin/activate
</code></pre> 
<p>接下来，再安装 streamlit ，命令在上边。</p> 
<p>安装的包比较多（数了下竟然接近 92 个？），过程也会很久，需要点耐心</p> 
<pre><code class="prism language-bash">➜ pip list <span class="token operator">|</span> <span class="token function">wc</span> -l
      <span class="token number">92</span>
</code></pre> 
<p>在安装过程中，可能会遇到一些问题，但也不一定，这取决于你的机器，如遇到问题请自行借助搜索引擎解决。</p> 
<h3><a id="2__50"></a>2. 入门示例</h3> 
<p>Streamlit 提供了一些入门示例，执行如下命令即可</p> 
<pre><code class="prism language-bash">➜ streamlit hello
</code></pre> 
<p>执行后 streamlit 会自动打开浏览器加载一个本地页面 <code>http://localhost:8501/</code></p> 
<p>这里面有很多的 demo，你可以看一下，这些 Demo 还有对应的配套代码</p> 
<p><img src="https://images2.imgbox.com/24/7e/g3xd2VOR_o.gif" alt=""></p> 
<p>这些代码直接拷贝保存，就可以在本地直接通过如下命令直接运行</p> 
<pre><code class="prism language-bash">➜ streamlit run st-demo.py
</code></pre> 
<h3><a id="2_Markdown__70"></a>2. Markdown 文本</h3> 
<p>导入 streamlit 后，就可以直接使用 st.markdown() 初始化，调用不同的方法，就可以往文档对象中填入内容</p> 
<ul><li>st.title()：文章大标题</li><li>st.header()：一级标题</li><li>st.subheader()：二级标题</li><li>st.text()：文本</li><li>st.code()：代码，同时可设置代码的语言，显示的时候会高亮</li><li>st.latex()：latex 公式</li><li>st.caption()：小字体文本</li></ul> 
<p>如下我自己写的一个小 Demo，供你参考</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> streamlit <span class="token keyword">as</span> st

<span class="token comment"># markdown</span>
st<span class="token punctuation">.</span>markdown<span class="token punctuation">(</span><span class="token string">'Streamlit Demo'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置网页标题</span>
st<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'一个傻瓜式构建可视化 web的 Python 神器 -- streamlit'</span><span class="token punctuation">)</span>

<span class="token comment"># 展示一级标题</span>
st<span class="token punctuation">.</span>header<span class="token punctuation">(</span><span class="token string">'1. 安装'</span><span class="token punctuation">)</span>

st<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">'和安装其他包一样，安装 streamlit 非常简单，一条命令即可'</span><span class="token punctuation">)</span>
code1 <span class="token operator">=</span> <span class="token triple-quoted-string string">'''pip3 install streamlit'''</span>
st<span class="token punctuation">.</span>code<span class="token punctuation">(</span>code1<span class="token punctuation">,</span> language<span class="token operator">=</span><span class="token string">'bash'</span><span class="token punctuation">)</span>


<span class="token comment"># 展示一级标题</span>
st<span class="token punctuation">.</span>header<span class="token punctuation">(</span><span class="token string">'2. 使用'</span><span class="token punctuation">)</span>

<span class="token comment"># 展示二级标题</span>
st<span class="token punctuation">.</span>subheader<span class="token punctuation">(</span><span class="token string">'2.1 生成 Markdown 文档'</span><span class="token punctuation">)</span>

<span class="token comment"># 纯文本</span>
st<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">'导入 streamlit 后，就可以直接使用 st.markdown() 初始化'</span><span class="token punctuation">)</span>

<span class="token comment"># 展示代码，有高亮效果</span>
code2 <span class="token operator">=</span> <span class="token triple-quoted-string string">'''import streamlit as st
st.markdown('Streamlit Demo')'''</span>
st<span class="token punctuation">.</span>code<span class="token punctuation">(</span>code2<span class="token punctuation">,</span> language<span class="token operator">=</span><span class="token string">'python'</span><span class="token punctuation">)</span>
</code></pre> 
<p>Streamlit 运行的方式 与普通的脚本 有所不同，应该使用 <code>streamlit run st-demo.py</code></p> 
<p><img src="https://images2.imgbox.com/c0/c1/66QVjEQW_o.png" alt=""></p> 
<p>运行后就会自动打开浏览器加载这个页面，如果没有自动打开，也可以手动拷贝上图中的链接打开访问。</p> 
<p>是不是有点那个味了？就这，还只是开胃菜～</p> 
<p><img src="https://images2.imgbox.com/19/a2/p4zI7NUo_o.png" alt=""></p> 
<h3><a id="3__126"></a>3. 数据图表支持</h3> 
<h4><a id="31__128"></a>3.1 图表组件</h4> 
<p>关于数据的展示，streamlit 由两个组件进行支持</p> 
<ul><li>table：普通的表格，用于静态数据的展示</li><li>dataframe：高级的表格，可以进行数据的操作，比如排序</li></ul> 
<p>Table 的示例</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'第%d列'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

st<span class="token punctuation">.</span>table<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>效果如下</p> 
<p><img src="https://images2.imgbox.com/15/ab/qL2eYQ7H_o.png" alt=""></p> 
<p>Datafram 的示例</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'第%d列'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

st<span class="token punctuation">.</span>dataframe<span class="token punctuation">(</span>df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>highlight_max<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>效果如下，可以看到在图示外，有个向下的小箭头，你点一下，就会进行排序</p> 
<p>除此之外，你还能看到我对最大值进行了高亮显示，原因是我传入的参数是 df.style.highlight_max(axis=0)</p> 
<p><img src="https://images2.imgbox.com/98/9f/xaV6klZb_o.png" alt=""></p> 
<p>其实还有 n 多种样式，比如：</p> 
<ul><li>highlight_null：空值高亮</li><li>highlight_min：最小值高亮</li><li>highlight_max：最大值高亮</li><li>highlight_between：某区间内的值高亮</li><li>highlight_quantile：暂没用过</li></ul> 
<p>这些你都可以在源代码中找到示例</p> 
<h4><a id="32__177"></a>3.2 监控组件</h4> 
<p>在采集到一些监控数据后，若你需要做一个监控面板， streamlit 也为你提供的 metric 组件</p> 
<p>如下代码创建 三个指标，并且填入对应的数据</p> 
<pre><code class="prism language-python">col1<span class="token punctuation">,</span> col2<span class="token punctuation">,</span> col3 <span class="token operator">=</span> st<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
col1<span class="token punctuation">.</span>metric<span class="token punctuation">(</span><span class="token string">"Temperature"</span><span class="token punctuation">,</span> <span class="token string">"70 °F"</span><span class="token punctuation">,</span> <span class="token string">"1.2 °F"</span><span class="token punctuation">)</span>
col2<span class="token punctuation">.</span>metric<span class="token punctuation">(</span><span class="token string">"Wind"</span><span class="token punctuation">,</span> <span class="token string">"9 mph"</span><span class="token punctuation">,</span> <span class="token string">"-8%"</span><span class="token punctuation">)</span>
col3<span class="token punctuation">.</span>metric<span class="token punctuation">(</span><span class="token string">"Humidity"</span><span class="token punctuation">,</span> <span class="token string">"86%"</span><span class="token punctuation">,</span> <span class="token string">"4%"</span><span class="token punctuation">)</span>
</code></pre> 
<p>刷新页面，就能看到下面的效果</p> 
<p><img src="https://images2.imgbox.com/83/09/sgMfkc9t_o.png" alt=""></p> 
<h4><a id="33__194"></a>3.3 原生图表组件</h4> 
<p>Streamlit 原生支持多种图表：</p> 
<ul><li>st.line_chart：折线图</li><li>st.area_chart：面积图</li><li>st.bar_chart：柱状图</li><li>st.map：地图</li></ul> 
<p>下面一一展示</p> 
<p><strong>折线图</strong></p> 
<pre><code class="prism language-python">chart_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

st<span class="token punctuation">.</span>line_chart<span class="token punctuation">(</span>chart_data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b4/a2/b3ELfRKe_o.png" alt=""></p> 
<p><strong>面积图</strong></p> 
<pre><code class="prism language-python">chart_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

st<span class="token punctuation">.</span>area_chart<span class="token punctuation">(</span>chart_data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/40/35/lN8WaeJP_o.png" alt=""></p> 
<p><strong>柱状图</strong></p> 
<pre><code class="prism language-python">chart_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
st<span class="token punctuation">.</span>bar_chart<span class="token punctuation">(</span>chart_data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d8/c9/jVRiMQu6_o.png" alt=""></p> 
<p><strong>地图</strong></p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">37.76</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">122.4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'lat'</span><span class="token punctuation">,</span> <span class="token string">'lon'</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
st<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a6/f8/K1r1NxE2_o.png" alt=""></p> 
<h4><a id="34__252"></a>3.4 外部图表组件</h4> 
<p>Streamlit 的一些原生图表组件，虽然做到了傻瓜式，但仅能输入数据、高度和宽度，如果你想更漂亮的图表，就像 matplotlib.pyplot、Altair、vega-lite、Plotly、Bokeh、PyDeck、Graphviz 那样，streamlit 也提供了支持：</p> 
<ul><li> <p>st.pyplot</p> </li><li> <p>st.bokeh_chart</p> </li><li> <p>st.altair_chart</p> </li><li> <p>st.altair_chart</p> </li><li> <p>st.vega_lite_chart</p> </li><li> <p>st.plotly_chart</p> </li><li> <p>st.pydeck_chart</p> </li><li> <p>st.graphviz_chart</p> </li></ul> 
<p>对于这部分，熟悉的同学自行尝试了，这里不再演示。</p> 
<p><img src="https://images2.imgbox.com/62/3b/U7sEIRNF_o.png" alt=""></p> 
<h3><a id="4__270"></a>4. 用户操作支持</h3> 
<p>前面 streamlit 都只是展示文本和数据，如果仅是如此，那 streamlit 也就 just so so</p> 
<p>对于那些不会前端，并且平时有需要写一些简单的页面的人说，能写一些交互界面才是硬需求。</p> 
<p>庆幸的是，你平时在网页上、app 上能看到的交互组件，Streamlit 几乎都能支持。。</p> 
<ul><li>button：按钮</li><li>download_button：文件下载</li><li>file_uploader：文件上传</li><li>checkbox：复选框</li><li>radio：单选框</li><li>selectbox：下拉单选框</li><li>multiselect：下拉多选框</li><li>slider：滑动条</li><li>select_slider：选择条</li><li>text_input：文本输入框</li><li>text_area：文本展示框</li><li>number_input：数字输入框，支持加减按钮</li><li>date_input：日期选择框</li><li>time_input：时间选择框</li><li>color_picker：颜色选择器</li></ul> 
<p>这些内容非常多，也比较简单，一个一个举例也没必要，大家直接去看 streamlit 源码里的注释即可。</p> 
<p><img src="https://images2.imgbox.com/68/55/18Yo3ZVc_o.png" alt=""></p> 
<h3><a id="5__298"></a>5. 多媒体组件</h3> 
<p>想要在页面上播放图片、音频和视频，可以使用 streamlit 的这三个组件：</p> 
<ul><li>st.image</li><li>st.audio</li><li>st.video</li></ul> 
<p><img src="https://images2.imgbox.com/02/fd/RIr0JPO5_o.png" alt=""></p> 
<h3><a id="6__308"></a>6. 状态组件</h3> 
<p>状态组件用来向用户展示当前程序的运行状态，包括：</p> 
<ul><li>progress：进度条，如游戏加载进度</li><li>spinner：等待提示</li><li>balloons：页面底部飘气球，表示祝贺</li><li>error：显示错误信息</li><li>warning：显示报警信息</li><li>info：显示常规信息</li><li>success：显示成功信息</li><li>exception：显示异常信息（代码错误栈）</li></ul> 
<p>效果如下：</p> 
<p><img src="https://images2.imgbox.com/67/ca/iTGXQSUL_o.png" alt="img"></p> 
<h3><a id="7__325"></a>7. 页面布局</h3> 
<p>Streamlit 是自上而下渲染的，组件在页面上的排列顺序与代码的执行顺序一致。</p> 
<p>一个精美的 web app ，只有上下单栏式的布局肯定是不够的。</p> 
<p>实际上 streamlit 还提供了多种多样的布局：</p> 
<p><strong>st.sidebar：侧边栏</strong></p> 
<p>侧边栏可以做一些用户操作控件</p> 
<p><img src="https://images2.imgbox.com/1d/e3/0DFbReQj_o.png" alt=""></p> 
<p>st.columns：列容器，处在同一个 columns 内组件，按照从左至右顺序展示</p> 
<p>st.expander：隐藏信息，点击后可展开展示详细内容，如：展示更多</p> 
<p>st.container：包含多组件的容器</p> 
<p>st.empty：包含单组件的容器</p> 
<h3><a id="8__347"></a>8. 流程控制系统</h3> 
<p>Streamlit 是自上而下逐步渲染出来的，若你的应用场景需要对渲染做一些控制，streamlit 也有提供对应的方法</p> 
<ul><li>st.stop：可以让 Streamlit 应用停止而不向下执行，如：验证码通过后，再向下运行展示后续内容。</li><li>st.form：表单，Streamlit 在某个组件有交互后就会重新执行页面程序，而有时候需要等一组组件都完成交互后再刷新（如：登录填用户名和密码），这时候就需要将这些组件添加到 form 中</li><li>st.form_submit_button：在 form 中使用，提交表单。</li></ul> 
<h3><a id="9__355"></a>9. 缓存特性提升速度</h3> 
<p>当用户在页面上做一些操作的时候，比如输入数据，都会触发整个 streamlit 应用代码的重新执行，如果其中有读取外部数据的步骤（数 GB 的数据），那这种性能损耗是非常可怕的。</p> 
<p>但 streamlit 提供了一个缓存装饰器，当要重新执行代码渲染页面的时候，就会先去缓存里查一下，如果代码或者数据没有发生变化，就直接调用缓存的结果即可。</p> 
<p>使用方法也简单，在需要缓存的函数加上 @st.cache 装饰器即可。</p> 
<pre><code class="prism language-python">DATE_COLUMN <span class="token operator">=</span> <span class="token string">'date/time'</span>
DATA_URL <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'https://s3-us-west-2.amazonaws.com/'</span>
            <span class="token string">'streamlit-demo-data/uber-raw-data-sep14.csv.gz'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@st<span class="token punctuation">.</span>cache</span>
<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>DATA_URL<span class="token punctuation">,</span> nrows<span class="token operator">=</span>nrows<span class="token punctuation">)</span>
    lowercase <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>lowercase<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    data<span class="token punctuation">[</span>DATE_COLUMN<span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">[</span>DATE_COLUMN<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> data
</code></pre> 
<h3><a id="10__377"></a>10. 部署上线</h3> 
<p>在本地编写的 streamlit 应用，运行起来后只能在本地访问。</p> 
<p>如果需要让别人也能访问这个应用，那你需要有一台服务器，这样才能通过公网ip进行访问</p> 
<p>如果你需要服务器，可以点 <a href="https://www.aliyun.com/minisite/goods?taskPkg=1111ydsrwb&amp;pkgSid=3650&amp;userCode=x1rep02u" rel="nofollow">这个链接</a> 领个卷有优惠。</p> 
<p>另外，还有一个选择，就是使用 Heroku （https://heroku.com）部署你的应用。</p> 
<p>Heroku是一个支持多种编程语言的云平台即服务，你只要注册一个帐号（听说网易和 QQ 邮箱不行，我使用的 Gmail 注册的）</p> 
<p><img src="https://images2.imgbox.com/8d/4a/dEnha0Go_o.png" alt=""></p> 
<p>然后创建自己的 app</p> 
<p><img src="https://images2.imgbox.com/24/52/5XGCpCWn_o.png" alt=""></p> 
<p>这个 App 名字好像是要全网唯一，本想取个 hello-streamlit 的，发现早有人取过了。</p> 
<p><img src="https://images2.imgbox.com/9a/75/YJYOFK7B_o.png" alt=""></p> 
<p>然后为你的应用，创建几个 Heroku 规定的文件</p> 
<ul><li>requirements.txt：依赖包文件</li><li>setup.sh：安装脚本，主要是创建文件夹，写入配置文件</li><li>Procfile：启动脚本，告诉 Heroku 如何安装并启动应用</li></ul> 
<p>这些文件的编程有固定的格式，我这边编写好了一份模板下载地址 https://www.lanzout.com/ikMWkxqktgj</p> 
<p><img src="https://images2.imgbox.com/e3/4e/HE5959DJ_o.png" alt=""></p> 
<p>拿到了这份模板后，你就可以基于这份模板创建你的 git 仓库</p> 
<pre><code>git init
git add --all
git commit -m "init"
</code></pre> 
<p>然后部署到 Heroku</p> 
<pre><code>heroku login
heroku create
git push heroku master
heroku ps:scale web=1
</code></pre> 
<p>按照命令行输出的URL就可以访问你的应用了。</p> 
<p>查看Heroku日志：</p> 
<pre><code>heroku logs --tail
</code></pre> 
<p>要想使用自己域名，需要先通过Heroku验证。然后运行：</p> 
<pre><code>heroku domains:add hivecnstats.iswbm.com
</code></pre> 
<p>使用 Heroku 唯一的缺点就是 Heroku 是需要梯子的，一般人访问不了，没条件的还是乖乖的备台服务器吧。</p> 
<h3><a id="12__442"></a>12. 总结一下</h3> 
<p>Streamlit 一个开箱即用的工具集，它可以让一个普通的个人开发者免于学习繁杂的前端知识，就可以轻松、快速的构建一个简洁、优雅的 web app 应用，这是 streamlit 最吸引人的地方。</p> 
<p>对于从事数据分析，机器学习领域的人来说，它绝对是开发神器，但即使你不是这些领域的人，你肯定也会有搭建一个 web app 需求的时候，streamlit 正是你需要的。</p> 
<h3><a id="_449"></a>絮叨一下</h3> 
<p>我在CSDN上写过很多的 Python 相关文章，其中包括 Python 实用工具，Python 高效技巧，PyCharm 使用技巧，很高兴得到了很多知乎朋友的认可和支持。在他们的鼓励之下，我将过往文章分门别类整理成三本 PDF 电子书</p> 
<p><strong>PyCharm 中文指南</strong></p> 
<p>《PyCharm 中文指南》使用 300 多张 GIF 动态图的形式，详细讲解了最贴合实际开发的 105个 PyCharm 高效使用技巧，内容通俗易懂，适合所有 Python 开发者。</p> 
<p>在线体验地址：https://pycharm.iswbm.com</p> 
<p><img src="https://images2.imgbox.com/04/39/6WhHErZE_o.png" alt=""></p> 
<p><strong>Python 黑魔法指南</strong></p> 
<p>《Python黑魔法指南》目前迎来了 v3.0 的版本，囊集了 100 多个开发小技巧，非常适合在闲时进行碎片阅读。</p> 
<p>在线体验地址：https://magic.iswbm.com</p> 
<p><img src="https://images2.imgbox.com/e6/76/ZxHH4zu0_o.png" alt=""></p> 
<p><strong>Python 中文指南</strong></p> 
<p>学 Python 最好的学习资料永远是 Python 官方文档，可惜现在的官方文档大都是英文，虽然有中文的翻译版了，但是进度实在堪忧。为了照顾英文不好的同学，我自己写了一份 面向零基础的朋友 的在线 Python 文档 – 《Python中文指南》</p> 
<p>在线体验地址：https://python.iswbm.com</p> 
<p><img src="https://images2.imgbox.com/7e/36/E9A2WQ9e_o.png" alt=""></p> 
<p><strong>有帮助的话，记得帮我</strong> <a href="https://www.zhihu.com/people/ac8f1e98cbb8948467b6d7534f7785a8" rel="nofollow">@王炳明</a> <strong>点个赞哟~</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/304f888e20152fdc33a792a4bfda1806/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java集合</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4fa3606abc9e482135277bbf4d367978/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flink Checkpoint超时 引发TaskManager进程挂掉</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>