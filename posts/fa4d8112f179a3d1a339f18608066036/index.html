<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos 修改时间 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos 修改时间" />
<meta property="og:description" content="文章目录 centos 修改时间1. 查询时间常用命令2. 修改时区3. 修改时间3.1 手动修改时间3.2 联网修改时间 centos 修改时间 Centos系统时间分为系统时间和硬件时间。二者必须都修改，重启系统才会永久生效。
背景
突然不知道什么原因，服务器时间不正确了，参照之前配置的 ntp 同步好像没用不知道为什么。然后本次手动同步还有个疑问，在使用 ntp 同步的时候使用 systemctl status ntpd 查看 ntp 服务如果是 active (running) 启动的那么则使用命令 ntpdate time.windows.com 时会报错 12 Dec 15:34:31 ntpdate[50679]: the NTP socket is in use, exiting 查看说是因为重复启动导致的，所以将 ntp stop 之后在执行 ntpdate time.windows.com 就可以了，然后使用 ps 查看 ntpd 进程也是没有的。目前这里还没查是为什么。
1. 查询时间常用命令 # 查询时间常用命令 [root@master ~]# date 2022年 12月 13日 星期二 10:10:23 CST # 时间&#43;时区 [root@demo169 ~]# date -R Tue, 13 Dec 2022 10:11:07 &#43;0800 # 时区 [root@demo169 ~]# date &#43;%z &#43;0800 [root@demo169 ~]# hwclock -r 2022年12月12日 星期一 15时54分19秒 -0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fa4d8112f179a3d1a339f18608066036/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-13T14:09:37+08:00" />
<meta property="article:modified_time" content="2022-12-13T14:09:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos 修改时间</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#centos__1" rel="nofollow">centos 修改时间</a></li><li><ul><li><a href="#1__11" rel="nofollow">1. 查询时间常用命令</a></li><li><a href="#2__32" rel="nofollow">2. 修改时区</a></li><li><a href="#3__43" rel="nofollow">3. 修改时间</a></li><li><ul><li><a href="#31__45" rel="nofollow">3.1 手动修改时间</a></li><li><a href="#32__64" rel="nofollow">3.2 联网修改时间</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="centos__1"></a>centos 修改时间</h2> 
<p>Centos系统时间分为系统时间和硬件时间。二者必须都修改，重启系统才会永久生效。</p> 
<p><strong>背景</strong></p> 
<blockquote> 
 <p>突然不知道什么原因，服务器时间不正确了，参照之前配置的 ntp 同步好像没用不知道为什么。然后本次手动同步还有个疑问，在使用 ntp 同步的时候使用 <code>systemctl status ntpd</code> 查看 ntp 服务如果是 <code>active (running)</code> 启动的那么则使用命令 <code>ntpdate time.windows.com</code> 时会报错 <code>12 Dec 15:34:31 ntpdate[50679]: the NTP socket is in use, exiting</code> 查看说是因为重复启动导致的，所以将 ntp stop 之后在执行 <code>ntpdate time.windows.com</code> 就可以了，然后使用 ps 查看 ntpd 进程也是没有的。目前这里还没查是为什么。</p> 
</blockquote> 
<h3><a id="1__11"></a>1. 查询时间常用命令</h3> 
<pre><code class="prism language-shell"><span class="token comment"># 查询时间常用命令</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># date</span>
<span class="token number">2022</span>年 <span class="token number">12</span>月 <span class="token number">13</span>日 星期二 <span class="token number">10</span>:10:23 CST

<span class="token comment"># 时间+时区</span>
<span class="token punctuation">[</span>root@demo169 ~<span class="token punctuation">]</span><span class="token comment"># date -R</span>
Tue, <span class="token number">13</span> Dec <span class="token number">2022</span> <span class="token number">10</span>:11:07 +0800

<span class="token comment"># 时区</span>
<span class="token punctuation">[</span>root@demo169 ~<span class="token punctuation">]</span><span class="token comment"># date +%z</span>
+0800

<span class="token punctuation">[</span>root@demo169 ~<span class="token punctuation">]</span><span class="token comment"># hwclock -r</span>
<span class="token number">2022</span>年12月12日 星期一 <span class="token number">15</span>时54分19秒  <span class="token parameter variable">-0.598757</span> 秒
</code></pre> 
<h3><a id="2__32"></a>2. 修改时区</h3> 
<pre><code class="prism language-shell"><span class="token comment"># 修改时区</span>
<span class="token function">ln</span> <span class="token parameter variable">-sf</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
<span class="token comment"># </span>
hwclock <span class="token parameter variable">-w</span>
</code></pre> 
<h3><a id="3__43"></a>3. 修改时间</h3> 
<h4><a id="31__45"></a>3.1 手动修改时间</h4> 
<blockquote> 
 <p>如果在机器不能联网的时候可以选择手动修改时间，缺点是不是特别准确</p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token comment"># 修改系统时间</span>
<span class="token function">date</span>  <span class="token parameter variable">-s</span>  <span class="token string">"2022-12-13 10:28:00"</span>
<span class="token comment"># 修改硬件时间</span>
hwclock  <span class="token parameter variable">--set</span>  <span class="token parameter variable">--date</span>  <span class="token string">"2022-12-13 10:28:00"</span>
<span class="token comment"># 同步系统时间和硬件时间</span>
hwclock  <span class="token parameter variable">--hctosys</span>
<span class="token comment"># 保存</span>
hwclock  <span class="token parameter variable">-w</span> 或者  clock  <span class="token parameter variable">-w</span>
<span class="token comment"># 重启系统</span>
<span class="token function">reboot</span>
</code></pre> 
<h4><a id="32__64"></a>3.2 联网修改时间</h4> 
<blockquote> 
 <p>相比于手动修改时间，联网更新时间更准确</p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token comment"># 安装ntpdate工具</span>
yum  <span class="token parameter variable">-y</span>  <span class="token function">install</span>  ntp  ntpdate
<span class="token comment"># 设置系统时间与网络时间同步</span>
ntpdate  cn.pool.ntp.org
或者
ntpdate  time.windows.com
<span class="token comment"># 将系统时间写入硬件时间</span>
hwclock  <span class="token parameter variable">--systohc</span>
<span class="token comment"># 强制系统时间写入CMOS中防止重启失效</span>
hwclock  <span class="token parameter variable">-w</span> 或者  clock  <span class="token parameter variable">-w</span>
<span class="token comment"># 重启系统</span>
<span class="token function">reboot</span>
</code></pre> 
<p> <br>  <br>  <br>  <br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1733373f64e7304022138240bdf9dab5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">工作中实用的 Git 操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e4f67ac93825129fae78c7886ea8b1a1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">（一) RK3566 Android11 系统编译</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>