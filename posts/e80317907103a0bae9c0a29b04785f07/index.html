<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>总结Ansible中常用模块 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="总结Ansible中常用模块" />
<meta property="og:description" content="文章目录 一、ansible实现管理的方式二、Ad-Hoc执行方式中如何获得帮助三、ansible命令运行方式及常用参数四、ansible的基本颜色代表信息五、ansible中的常用模块1.command：远程主机执行命令2.shell：command模块的升级版3.script：执行脚本4.copy：文件管理5.fetch：文件管理6.file：文件管理7.unarchive：解压8.archive：打包9.hostname：管理主机名称10.cron：计划任务11.yum_repository：仓库12.dnf：管理软件13.service：管理系统服务状态14.firewalld：火墙管理15.user：管理远程主机上的用户16.group：管理远程主机上的组17.lineinfile：替换18.playbook19.replace：替换20.setup：采集信息21.debug：显示信息echo 六、其他模块的用法：ansible-doc 命令 一、ansible实现管理的方式 Ad-Hoc ##利用ansible命令直接完成管理，主要用于临时命令使用场景 playbook ##ansible脚本，主要用于大型项目场景，需要前期的规划 二、Ad-Hoc执行方式中如何获得帮助 ansible-doc ##显示模块帮助的指令 #格式 ansible-doc [参数] [模块...] #常用参数 -l ##列出可用模块 -s ##显示指定模块的playbook片段 三、ansible命令运行方式及常用参数 #格式：
ansible 清单 -m 模块 -a 模块参数
#常用参数 #--version ##显示版本 #-m module ##指定模块，默认为command模块 #-v ##详细过程 -vv -vvv更详细过程 #--list ##显示主机列表，也可以用--list-hosts #-k ##提示输入ssh连接密码，默认key认证 #-C ##预执行检测 #-T ##执行命令的超时时间，默认10s #-u ##指定远程执行的用户 #-b ##执行sudo切换身份操作 #--become-user=USERNAME ##指定sudo的用户 #-K ##提示输入sudo密码 四、ansible的基本颜色代表信息 绿色 ##执行成功但为对远程主机做任何改变 黄色 ##执行成功并对远程主机做改变 红色 ##执行失败 五、ansible中的常用模块 1.command：远程主机执行命令 #功能: 在远程主机执行命令，此模块为默认模块 #常用参数 chdir ##执行命令前先进入到指定目录 cmd ##运行命令指定 creates ##如果文件存在将不运行 removes ##如果文件存在将运行 free_form ##在远程主机中执行的命令，此参数不需要加 #实例 ansible all -m command -a &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e80317907103a0bae9c0a29b04785f07/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-19T09:26:50+08:00" />
<meta property="article:modified_time" content="2023-04-19T09:26:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">总结Ansible中常用模块</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#ansible_10" rel="nofollow">一、ansible实现管理的方式</a></li><li><a href="#AdHoc_15" rel="nofollow">二、Ad-Hoc执行方式中如何获得帮助</a></li><li><a href="#ansible_30" rel="nofollow">三、ansible命令运行方式及常用参数</a></li><li><a href="#ansible_49" rel="nofollow">四、ansible的基本颜色代表信息</a></li><li><a href="#ansible_55" rel="nofollow">五、ansible中的常用模块</a></li><li><ul><li><a href="#1command_57" rel="nofollow">1.command：远程主机执行命令</a></li><li><a href="#2shellcommand_79" rel="nofollow">2.shell：command模块的升级版</a></li><li><a href="#3script_94" rel="nofollow">3.script：执行脚本</a></li><li><a href="#4copy_105" rel="nofollow">4.copy：文件管理</a></li><li><a href="#5fetch_125" rel="nofollow">5.fetch：文件管理</a></li><li><a href="#6file_139" rel="nofollow">6.file：文件管理</a></li><li><a href="#7unarchive_168" rel="nofollow">7.unarchive：解压</a></li><li><a href="#8archive_186" rel="nofollow">8.archive：打包</a></li><li><a href="#9hostname_200" rel="nofollow">9.hostname：管理主机名称</a></li><li><a href="#10cron_210" rel="nofollow">10.cron：计划任务</a></li><li><a href="#11yum_repository_231" rel="nofollow">11.yum_repository：仓库</a></li><li><a href="#12dnf_249" rel="nofollow">12.dnf：管理软件</a></li><li><a href="#13service_281" rel="nofollow">13.service：管理系统服务状态</a></li><li><a href="#14firewalld_300" rel="nofollow">14.firewalld：火墙管理</a></li><li><a href="#15user_318" rel="nofollow">15.user：管理远程主机上的用户</a></li><li><a href="#16group_353" rel="nofollow">16.group：管理远程主机上的组</a></li><li><a href="#17lineinfile_369" rel="nofollow">17.lineinfile：替换</a></li><li><a href="#18playbook_408" rel="nofollow">18.playbook</a></li><li><a href="#19replace_419" rel="nofollow">19.replace：替换</a></li><li><a href="#20setup_434" rel="nofollow">20.setup：采集信息</a></li><li><a href="#21debugecho_446" rel="nofollow">21.debug：显示信息echo</a></li></ul> 
  </li><li><a href="#ansibledoc__457" rel="nofollow">六、其他模块的用法：ansible-doc 命令</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="ansible_10"></a>一、ansible实现管理的方式</h2> 
<pre><code>Ad-Hoc         ##利用ansible命令直接完成管理，主要用于临时命令使用场景
playbook       ##ansible脚本，主要用于大型项目场景，需要前期的规划
</code></pre> 
<h2><a id="AdHoc_15"></a>二、Ad-Hoc执行方式中如何获得帮助</h2> 
<pre><code>ansible-doc       ##显示模块帮助的指令

#格式
ansible-doc [参数] [模块...]

#常用参数
-l      ##列出可用模块
-s      ##显示指定模块的playbook片段
</code></pre> 
<p><img src="https://images2.imgbox.com/42/55/zUrtyshs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/51/16/iRo3AaBg_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="ansible_30"></a>三、ansible命令运行方式及常用参数</h2> 
<p>#格式：<br> <mark>ansible 清单 -m 模块 -a 模块参数</mark></p> 
<pre><code>#常用参数
#--version            ##显示版本
#-m module            ##指定模块，默认为command模块
#-v                   ##详细过程 -vv -vvv更详细过程
#--list               ##显示主机列表，也可以用--list-hosts
#-k                   ##提示输入ssh连接密码，默认key认证
#-C                   ##预执行检测
#-T                   ##执行命令的超时时间，默认10s
#-u                   ##指定远程执行的用户
#-b                   ##执行sudo切换身份操作
#--become-user=USERNAME    ##指定sudo的用户
#-K                   ##提示输入sudo密码
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/e5/AEIinjRb_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c2/b6/myYEEKpO_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="ansible_49"></a>四、ansible的基本颜色代表信息</h2> 
<pre><code>绿色     ##执行成功但为对远程主机做任何改变
黄色     ##执行成功并对远程主机做改变
红色     ##执行失败
</code></pre> 
<h2><a id="ansible_55"></a>五、ansible中的常用模块</h2> 
<h3><a id="1command_57"></a>1.command：远程主机执行命令</h3> 
<pre><code>#功能: 在远程主机执行命令，此模块为默认模块

#常用参数
chdir       ##执行命令前先进入到指定目录
cmd         ##运行命令指定
creates     ##如果文件存在将不运行
removes     ##如果文件存在将运行
free_form   ##在远程主机中执行的命令，此参数不需要加

#实例
ansible all -m command -a "useradd lee" -u root -k
ansible all -m command -a "userdel -r lee" -u root -k
ansible all -m command -a "chdir=/etc cat passwd " -u root -k
ansible all -m command -a "chdir=/etc creates=/etc/passwd cat passwd " -u root -k 
ansible all -m command -a "chdir=/etc removes=/etc/passwd cat passwd " -u root -k

注意：#Linux中的很多通配符在command模块中不支持
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/b3/Hc8BV982_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2shellcommand_79"></a>2.shell：command模块的升级版</h3> 
<pre><code>#功能：和command功能类似，相当于command模块的升级版
#常用参数
chdir         ##执行命令前先进入到指定目录
cmd           ##运行命令指定
creates       ##如果文件存在将不运行
removes       ##如果文件存在在将运行
free_form     ##在远程主机中执行的命令，此参数不需要加
executable    ##指定执行环境，默认为sh
#实例
ansible all -m shell -a "executable=sh ps ax | grep $$ " -k
</code></pre> 
<p><img src="https://images2.imgbox.com/e4/3d/Uv8IcOA0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3script_94"></a>3.script：执行脚本</h3> 
<pre><code>#功能:在ansible主机中写好的脚本在受控主机中执行
#实例
vim /mnt/westos.sh
#!/bin/bash
echo $HOSTNAME

ansible all -m script -a "/mnt/westos.sh" -k
</code></pre> 
<p><img src="https://images2.imgbox.com/ea/56/FXsaydz7_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4copy_105"></a>4.copy：文件管理</h3> 
<pre><code>#功能：从ansible主机复制文件到受控主机

#常用参数
src        ##源文件
dest       ##目的地文件
owner      ##指定目的地文件所有人
group      ##指定目的地文件所有组
mode       ##指定目的地文件权限
backup=yes ##当受控主机中存在文件时备份原文件
content    ##指定文本内容直接在受控主机中生成文件

#实例
ansible all -m copy -a "src=/root/westos dest=/mnt/westos owner=lee mode=777 backup=yes"
ansible all -m copy -a "content='hello westos\nhello linux\n' dest=/mnt/westosfile1 owner=lee 
mode=600"
</code></pre> 
<p><img src="https://images2.imgbox.com/55/58/Z840FnJX_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5fetch_125"></a>5.fetch：文件管理</h3> 
<pre><code>#功能：从受控主机把文件复制到ansible主机,但不支持目录
#常用参数
src      ##受控主机的源文件
dest     ##本机目录
flat     ##基本名称功能
#实例
ansible all -m fetch -a "src=/etc/hostname dest=/mnt" -k
ansible all -m fetch -a "src=/etc/hostname dest=/mnt flat=yes" -k
</code></pre> 
<p><img src="https://images2.imgbox.com/5a/bf/75vmZFU9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b8/23/FN023WYT_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6file_139"></a>6.file：文件管理</h3> 
<pre><code>#功能：设置文件的属性
#常用参数#
path      ##指定文件名称
state     ##指定操作状态
          ##touch      建立
          ##absent     删除
          ##directory  递归
          ##link       建立链接
          #hard
mode      ##设定权限
owner     ##设定文件用户
group     ##设定文件组
src       ##源文件
dest      ##目标文件
recurse=yes ##递归更改

#example
ansible all -m file -a 'path=/mnt/test.sh state=touch'
ansible all -m file -a 'path=/mnt/test.sh state=absent'
ansible all -m file -a 'path=/mnt/westos state=directory'
ansible all -m file -a 'path=/mnt/westos state=directory mode=777 recurse=yes'
ansible all -m file -a 'src=/mnt/file dest=/mnt/westos state=link'
ansible all -m file -a 'src=/mnt/file dest=/mnt/westos1 state=hard'
ansible all -m file -a 'path=/mnt/file state=touch owner=lee group=westos mode=777'
</code></pre> 
<p><img src="https://images2.imgbox.com/70/4d/cH8NuBy8_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a9/4c/S7MTrCP9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="7unarchive_168"></a>7.unarchive：解压</h3> 
<pre><code>#功能：解压缩
#常用参数
copy         ##默认为yes  从ansible主机复制文件到受控主机
             ##设定为no   从受控主机中寻找src源文件
remote_src   ##功能同copy且相反
             ##设定为yes 表示包在受控主机
             ##设定为no表示包在ansible主机
src          ##包路径，可以使ansible主机也可以使受控主机
dest         ##受控主机目录
mode         ##加压后文件权限 &lt;与copy=yes配合使用&gt;
#实例
ansible all -m unarchive -a 'src=/mnt/etc.tar.gz dest=/mnt owner=lee' -k
ansible all -m unarchive -a "src=/opt/etc.tar.gz dest=/mnt copy=no"
</code></pre> 
<p><img src="https://images2.imgbox.com/19/d9/yW5iLKuj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="8archive_186"></a>8.archive：打包</h3> 
<pre><code>#作用：压缩
#常用参数
path     ##打包目录名称
dest     ##声称打包文件名称
format   ##打包格式
owner    ##指定文件所属人
mode     ##指定文件权限
#实例
ansible all -m archive -a 'path=/etc dest=/opt/etc.tar.gz format=gz owner=lee mode=700' -k
</code></pre> 
<p><img src="https://images2.imgbox.com/37/d9/ylNGUDy0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="9hostname_200"></a>9.hostname：管理主机名称</h3> 
<pre><code>#作用：管理主机名称
#常用参数
name   ##指定主机名称
#实例
ansbile 172.25.254.100 -m hostname -a 'name=lee.westos.com'
</code></pre> 
<p><img src="https://images2.imgbox.com/77/bd/SqALrTUB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="10cron_210"></a>10.cron：计划任务</h3> 
<pre><code>#作用：计划任务
#常用参数
minute     ##分钟
hour       ##小时
day        ##天
month      ##月
weekday    ##周
name       ##任务名称
job        ##任务脚本或命令
disabled   ##yes 禁用计划任务
           ##no 启动计划任务
state      ##absent 删除计划任务
##实例##
ansible list1 -m cron -a "job='echo hello' name=test disable=yes" -k
ansible list1 -m cron -a "job='echo hello' name=test disabled=yes" -k
ansible list1 -m cron -a "job='echo hello' name=test state=absent" -k
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/8c/cb0yvSme_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="11yum_repository_231"></a>11.yum_repository：仓库</h3> 
<pre><code>#作用：配置系统软件仓库源文件
#常用参数
name        ##指定仓库名称
baseurl     ##指定源路径
description ##指定仓库描述
file        ##指定仓库文件名称
enabled     ##仓库是否启用
gpgcheck    ##仓库是否检测gpgkey
state       ##默认值present 建立
            #absent 为删除
#实例
ansible all -m yum_repository -a "name=AppStream baseurl=http://172.25.254.250/rhel8.2/AppStream 
description=AppStream_westos gpgcheck=no file=westos_test" -k
ansible all -m yum_repository -a "name=AppStream file=westos_test state=absent" -k
</code></pre> 
<p><img src="https://images2.imgbox.com/4c/86/QluP2APk_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12dnf_249"></a>12.dnf：管理软件</h3> 
<pre><code>#作用：管理系统中的dnf仓库及管理软件
#常用参数
name     ##指定包
state    ##指定动作
         #present  安装
         #latest   更新
         #absent   删除
list     ##列出指定信息
         # httpd
         # installed
         # all
         # available
disable_gpg_check   #禁用gpgkey检测
enablerepo          ##指定安装包来源
disablerepo         ##禁用安装包来源
##实例
ansible all -m dnf -a "name=httpd state=latest"
ansible all -m dnf -a 'name="httpd,mariadb-server" state=present'
ansible all -m dnf -a 'name=httpd state=absent'
ansible all -m dnf -a 'name=httpd state=absent autoremove=no'
ansible all -m dnf -a 'name=httpd state=present enablerepo=AppStream'
ansible all -m dnf -a 'name="*" state=latest'
ansible all -m dnf -a 'name=http://172.25.254.250/software/wps-office-xxx.rpm state=present'
ansible all -m dnf -a 'name="@Virtual Tools" state=present'
</code></pre> 
<p><img src="https://images2.imgbox.com/bc/66/3at79FZQ_o.png" alt="在这里插入图片描述"><br> <mark>安装QQ</mark><br> <img src="https://images2.imgbox.com/6f/b4/qVOp4Zn2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/82/e3/oY6uYASS_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="13service_281"></a>13.service：管理系统服务状态</h3> 
<pre><code>#作用：管理系统服务状态
#常用参数
name       ##指定服务名称
state      ##指定对服务的动作
           #started
           #stoped
           #restarted
           #reloaded
enabled    ##设定服务开机是否启动
           #yes开启启动
           #no开机不启动
##实例
ansible all -m service -a "name=httpd state=started enabled=yes" -k
ansible all -m service -a "name=httpd state=restarted enabled=yes" -k
</code></pre> 
<p><img src="https://images2.imgbox.com/94/00/oa4YyRAV_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="14firewalld_300"></a>14.firewalld：火墙管理</h3> 
<pre><code>#常用参数
zone       ##火墙的域
service    ##服务名称
permanent  ##永久生效
state
 enabled   ##允许
 disabled  ##拒绝
immediate  ##立即生效
</code></pre> 
<pre><code>ansible all -m shell -a 'echo "`hostname`" &gt; /var/www/html/index.html'
ansible all -m firewalld -a 'zone=public service=http permanent=yes state=enabled immediate=yes'
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/45/KcTZwzdy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/36/e3/UXiOuz0B_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="15user_318"></a>15.user：管理远程主机上的用户</h3> 
<p>作用：模块可以帮助我们管理远程主机上的用户，比如创建用户、修改用户、删除用户、为用户创建密钥对等操作</p> 
<pre><code>#常用参数
name            ##必须参数，用于指定要操作的用户名称。
group           ##指定用户所在的基本组。
gourps          ##指定用户所在的附加组。
append          ##指定添加附加组默认值为no
shell           ##指定用户的默认 shell。
uid             ##指定用户的 uid 号。
comment         ##指定用户的注释信息。
state           ##用于指定用户是否存在于远程主机
                #present 建立
                #absent 删除
remove          ##当删除用户是删除用户家目录，默认值为no
password        ##此参数用于指定用户的密码。但密码为明文，
                ##可以用openssl password -6 '密码'生成加密字符
generate_ssh_key    ##生成sshkey
##实例
ansible all -m user -a 'name=lee'
ansible all -m user -a 'name=lee state=absent'
ansible all -m user -a 'name=lee remove=yes state=absent'
ansible all -m user -a 'name=lee group=888'
ansible all -m user -a 'name=lee group=888 groups="user1,user2"'
ansible all -m user -a 'name=lee groups="user3"'
ansible all -m user -a 'name=lee groups="user1,user2" append=yes'
openssl passwd -6 'westos'
ansible all -m user -a 'name=lee 
password="$6$F4OBwqoXAigDV.dn$I2OgEPB3kfyl8CPmdh3Y8vKDqewZKrVMIDPPIt8GKnhs/
DW4gZHfxrZX5ziQN7rVjISX7l14KwDQHEd.uprlV/"'
ansible all -m user -a 'name=lee generate_ssh_key=yes'
</code></pre> 
<p><img src="https://images2.imgbox.com/4b/95/t9YBOSYN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="16group_353"></a>16.group：管理远程主机上的组</h3> 
<p>作用：group 模块可以帮助我们管理远程主机上的组。</p> 
<pre><code>#常用参数
name           ##用于指定要操作的组名称。
state          ##用于指定组的状态
               #present 建立
               #absent 删除
gid            ##用于指定组的gid。
##实例
ansible all -m group -a 'name=westoslee'
ansible all -m group -a 'name=westoslee state=absent'
ansible all -m group -a 'name=westoslee gid=8888'
</code></pre> 
<p><img src="https://images2.imgbox.com/dd/7d/5966SGJP_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="17lineinfile_369"></a>17.lineinfile：替换</h3> 
<pre><code>path         ##指定要操作的文件。
line         ##指定文本内容。 "|+" 表示格式化输入
regexp       ##使用正则表达式匹配对应的行当替换文本时
             ##如果有多行文本都能被匹配
             ##则只有最后面被匹配到的那行文本才会被替换
             ##当删除文本时，如果有多行文本都能被匹配
             ##这么这些行都会被删除。
state        ##当想要删除对应的文本时需要将state参数的值设置为absent
             #state的默认值为present。
backrefs     ##当内容无匹配规则时不对文件做任何更改,默认值为no
             ##向后引用regexp变量信息
insertafter  ##借助insertafter参数可以将文本插入到“指定的行”之后
             ##insertafter参数的值可以设置为EOF或者正则表达式
insertbefore ##借助insertbefore参数可以将文本插入到“指定的行”之前
             #insertbefore参数的值可以设置为BOF或者正则表达式
backup       ##是否在修改文件之前对文件进行备份。
create       ##当要操作的文件并不存在时，是否创建对应的文件。
vim /mnt/westos
hello westos
hello test
hello linux
##实例
ansible all -m lineinfile -a 'path=/mnt/westos line="hello westos"'
ansible all -m lineinfile -a 'path=/mnt/westos regexp="^westos" line="hello westos" '
ansible all -m lineinfile -a 'path=/mnt/westos regexp="^test" line="westos test"'
ansible all -m lineinfile -a 'path=/mnt/westos regexp='^test' line="westos test new" 
backrefs=yes'
ansible all -m lineinfile -a 'path=/mnt/westos regexp="(h.{4}).*(w.{5})" line="\1" backrefs=yes'
ansible all -m lineinfile -a 'path=/mnt/westos line="###### westos end #####" insertafter=EOF'
ansible all -m lineinfile -a 'path=/mnt/westos line="###### westos end lee #####" 
insertafter="hello"'
ansible all -m lineinfile -a 'path=/mnt/westos line="###### westos test #####" insertbefore=BOF'
ansible all -m lineinfile -a 'path=/mnt/westos line="###### westos test lee #####" 
insertbefore="hello"'
</code></pre> 
<p><img src="https://images2.imgbox.com/d8/26/91WmJ2kC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="18playbook_408"></a>18.playbook</h3> 
<pre><code>##line |+
lineinfile:
 path: /mnt/test
 line: |+
 westos
 linux
 lee
 create: yes
</code></pre> 
<h3><a id="19replace_419"></a>19.replace：替换</h3> 
<p>作用：replace 模块可以根据我们指定的正则表达式替换文件中的字符串，文件中所有被匹配到的字符串都会被替换</p> 
<pre><code>#常用参数
path       ##指定要操作的文件
regexp     ##指定一个正则表达式
           #文件中与正则匹配的字符串将会被替换。
replace    ##指定最终要替换成的字符串。
backup     ##是否在修改文件之前对文件进行备份，最好设置为yes。
##实例
ansible all -m replace -a 'path=/mnt/westos regexp="WESTOS" replace="westos_lee" backup=yes'
</code></pre> 
<p><img src="https://images2.imgbox.com/98/e5/KcVsxtOR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="20setup_434"></a>20.setup：采集信息</h3> 
<p>#作用：setup模块用于收集远程主机的一些基本信息</p> 
<pre><code>#常用参数
filter   ##用于进行条件过滤。如果设置，仅返回匹配过滤条件的信息。
##实例
ansible all -m setup -k
ansible all -m setup -a "filter='ansible_all_ipv4_addresses'" -k
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/db/nDr6MLAl_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="21debugecho_446"></a>21.debug：显示信息echo</h3> 
<pre><code>#作用：调试模块，用于在调试中输出信息
#常用参数：
msg：       ##调试输出的消息
var:        ##将某个任务执行的输出作为变量传递给debug模块
            ##debug会直接将其打印输出
verbosity： ##debug的级别（默认是0级，全部显示）
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/36/KQVYLOrn_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="ansibledoc__457"></a>六、其他模块的用法：ansible-doc 命令</h2> 
<p><img src="https://images2.imgbox.com/8c/33/yTJi4yen_o.png" alt="在这里插入图片描述"></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c8d151e864c4e5971840575793ac1206/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PHP&#43;xshell线上同步</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9c4183c31dc2e105c2d154a37a37bbde/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一、eNSP模拟器命令行基础操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>