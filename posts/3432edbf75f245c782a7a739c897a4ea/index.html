<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PCL 基于对应分组的3D物体识别 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PCL 基于对应分组的3D物体识别" />
<meta property="og:description" content="本教程旨在说明如何基于pcl_recognition模块执行 3D 对象识别。具体而言，它解释了如何使用对应分组算法，以便将 3D 描述符匹配阶段之后获得的点对点对应关系集聚类到当前场景中存在的模型实例中。对于每个表示场景中可能的模型实例的聚类，对应分组算法还会输出转换矩阵，用于标识该模型在当前场景中的 6DOF 姿态估计。
#include &lt;pcl/io/pcd_io.h&gt; #include &lt;pcl/point_cloud.h&gt; #include &lt;pcl/correspondence.h&gt; #include &lt;pcl/features/normal_3d_omp.h&gt; #include &lt;pcl/features/shot_omp.h&gt; #include &lt;pcl/features/board.h&gt; #include &lt;pcl/filters/uniform_sampling.h&gt; #include &lt;pcl/recognition/cg/hough_3d.h&gt; #include &lt;pcl/recognition/cg/geometric_consistency.h&gt; #include &lt;pcl/visualization/pcl_visualizer.h&gt; #include &lt;pcl/kdtree/kdtree_flann.h&gt; #include &lt;pcl/kdtree/impl/kdtree_flann.hpp&gt; #include &lt;pcl/common/transforms.h&gt; #include &lt;pcl/console/parse.h&gt; typedef pcl::PointXYZRGBA PointType; typedef pcl::Normal NormalType; typedef pcl::ReferenceFrame RFType; typedef pcl::SHOT352 DescriptorType; std::string model_filename_; std::string scene_filename_; //Algorithm params bool show_keypoints_(false); bool show_correspondences_(false); bool use_cloud_resolution_(false); bool use_hough_(true); float model_ss_(0.01f); float scene_ss_(0.03f); float rf_rad_(0.015f); float descr_rad_(0.02f); float cg_size_(0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/3432edbf75f245c782a7a739c897a4ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-15T17:00:19+08:00" />
<meta property="article:modified_time" content="2022-09-15T17:00:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PCL 基于对应分组的3D物体识别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本教程旨在说明如何基于pcl_recognition模块执行 3D 对象识别。具体而言，它解释了如何使用对应分组算法，以便将 3D 描述符匹配阶段之后获得的点对点对应关系集聚类到当前场景中存在的模型实例中。对于每个表示场景中可能的模型实例的聚类，对应分组算法还会输出转换矩阵，用于标识该模型在当前场景中的 6DOF 姿态估计。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/io/pcd_io.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/point_cloud.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/correspondence.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/features/normal_3d_omp.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/features/shot_omp.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/features/board.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/filters/uniform_sampling.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/recognition/cg/hough_3d.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/recognition/cg/geometric_consistency.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/visualization/pcl_visualizer.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/kdtree/kdtree_flann.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/kdtree/impl/kdtree_flann.hpp&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/common/transforms.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcl/console/parse.h&gt;</span></span>

<span class="token keyword">typedef</span> pcl<span class="token double-colon punctuation">::</span>PointXYZRGBA PointType<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> pcl<span class="token double-colon punctuation">::</span>Normal NormalType<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> pcl<span class="token double-colon punctuation">::</span>ReferenceFrame RFType<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> pcl<span class="token double-colon punctuation">::</span>SHOT352 DescriptorType<span class="token punctuation">;</span>

std<span class="token double-colon punctuation">::</span>string model_filename_<span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>string scene_filename_<span class="token punctuation">;</span>

<span class="token comment">//Algorithm params</span>
<span class="token keyword">bool</span> <span class="token function">show_keypoints_</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">show_correspondences_</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">use_cloud_resolution_</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">use_hough_</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token function">model_ss_</span><span class="token punctuation">(</span><span class="token number">0.01f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token function">scene_ss_</span><span class="token punctuation">(</span><span class="token number">0.03f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token function">rf_rad_</span><span class="token punctuation">(</span><span class="token number">0.015f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token function">descr_rad_</span><span class="token punctuation">(</span><span class="token number">0.02f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token function">cg_size_</span><span class="token punctuation">(</span><span class="token number">0.01f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token function">cg_thresh_</span><span class="token punctuation">(</span><span class="token number">5.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span>
<span class="token function">showHelp</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> filename<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"***************************************************************************"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*                                                                         *"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*             Correspondence Grouping Tutorial - Usage Guide              *"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*                                                                         *"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"***************************************************************************"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Usage: "</span> <span class="token operator">&lt;&lt;</span> filename <span class="token operator">&lt;&lt;</span> <span class="token string">" model_filename.pcd scene_filename.pcd [Options]"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Options:"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -h:                     Show this help."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -k:                     Show used keypoints."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -c:                     Show used correspondences."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -r:                     Compute the model cloud resolution and multiply"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"                             each radius given by that value."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --algorithm (Hough|GC): Clustering algorithm used (default Hough)."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --model_ss val:         Model uniform sampling radius (default 0.01)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --scene_ss val:         Scene uniform sampling radius (default 0.03)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --rf_rad val:           Reference frame radius (default 0.015)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --descr_rad val:        Descriptor radius (default 0.02)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --cg_size val:          Cluster size (default 0.01)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --cg_thresh val:        Clustering threshold (default 5)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span>
<span class="token function">parseCommandLine</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//Show help</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">find_switch</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"-h"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">showHelp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//Model &amp; scene filenames</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> filenames<span class="token punctuation">;</span>
    filenames <span class="token operator">=</span> pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_file_extension_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">".pcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>filenames<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Filenames missing.\n"</span><span class="token punctuation">;</span>
        <span class="token function">showHelp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    model_filename_ <span class="token operator">=</span> argv<span class="token punctuation">[</span>filenames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    scene_filename_ <span class="token operator">=</span> argv<span class="token punctuation">[</span>filenames<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">//Program behavior</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">find_switch</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"-k"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        show_keypoints_ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">find_switch</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        show_correspondences_ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">find_switch</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"-r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        use_cloud_resolution_ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    std<span class="token double-colon punctuation">::</span>string used_algorithm<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--algorithm"</span><span class="token punctuation">,</span> used_algorithm<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>used_algorithm<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"Hough"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            use_hough_ <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>used_algorithm<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"GC"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            use_hough_ <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Wrong algorithm name.\n"</span><span class="token punctuation">;</span>
            <span class="token function">showHelp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//General parameters</span>
    pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--model_ss"</span><span class="token punctuation">,</span> model_ss_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--scene_ss"</span><span class="token punctuation">,</span> scene_ss_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--rf_rad"</span><span class="token punctuation">,</span> rf_rad_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--descr_rad"</span><span class="token punctuation">,</span> descr_rad_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--cg_size"</span><span class="token punctuation">,</span> cg_size_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>console<span class="token double-colon punctuation">::</span><span class="token function">parse_argument</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> <span class="token string">"--cg_thresh"</span><span class="token punctuation">,</span> cg_thresh_<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">double</span>
<span class="token function">computeCloudResolution</span><span class="token punctuation">(</span><span class="token keyword">const</span> pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>ConstPtr<span class="token operator">&amp;</span> cloud<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">double</span> res <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> n_points <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> nres<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">indices</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> <span class="token function">sqr_distances</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>search<span class="token double-colon punctuation">::</span>KdTree<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span> tree<span class="token punctuation">;</span>
    tree<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>cloud<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cloud<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>std<span class="token double-colon punctuation">::</span><span class="token function">isfinite</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>cloud<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//Considering the second neighbor since the first is the point itself.</span>
        nres <span class="token operator">=</span> tree<span class="token punctuation">.</span><span class="token function">nearestKSearch</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> indices<span class="token punctuation">,</span> sqr_distances<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nres <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            res <span class="token operator">+=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>sqr_distances<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">++</span>n_points<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n_points <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        res <span class="token operator">/=</span> n_points<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">parseCommandLine</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//  correspondence_grouping milk.pcd milk_cartoon_all_small_clorox.pcd</span>
  <span class="token comment">//  parseCommandLine(correspondence_grouping, milk.pcd milk_cartoon_all_small_clorox.pcd);</span>

    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">model</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">model_keypoints</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">scene</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">scene_keypoints</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>NormalType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">model_normals</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>NormalType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>NormalType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">scene_normals</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>NormalType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>DescriptorType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">model_descriptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>DescriptorType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>DescriptorType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">scene_descriptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>DescriptorType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Load clouds</span>
    <span class="token comment">//</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>io<span class="token double-colon punctuation">::</span><span class="token function">loadPCDFile</span><span class="token punctuation">(</span>model_filename_<span class="token punctuation">,</span> <span class="token operator">*</span>model<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Error loading model cloud."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token function">showHelp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>io<span class="token double-colon punctuation">::</span><span class="token function">loadPCDFile</span><span class="token punctuation">(</span>scene_filename_<span class="token punctuation">,</span> <span class="token operator">*</span>scene<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Error loading scene cloud."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token function">showHelp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Set up resolution invariance</span>
    <span class="token comment">//</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>use_cloud_resolution_<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">float</span> resolution <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token function">computeCloudResolution</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resolution <span class="token operator">!=</span> <span class="token number">0.0f</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            model_ss_ <span class="token operator">*=</span> resolution<span class="token punctuation">;</span>
            scene_ss_ <span class="token operator">*=</span> resolution<span class="token punctuation">;</span>
            rf_rad_ <span class="token operator">*=</span> resolution<span class="token punctuation">;</span>
            descr_rad_ <span class="token operator">*=</span> resolution<span class="token punctuation">;</span>
            cg_size_ <span class="token operator">*=</span> resolution<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Model resolution:       "</span> <span class="token operator">&lt;&lt;</span> resolution <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Model sampling size:    "</span> <span class="token operator">&lt;&lt;</span> model_ss_ <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Scene sampling size:    "</span> <span class="token operator">&lt;&lt;</span> scene_ss_ <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"LRF support radius:     "</span> <span class="token operator">&lt;&lt;</span> rf_rad_ <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"SHOT descriptor radius: "</span> <span class="token operator">&lt;&lt;</span> descr_rad_ <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Clustering bin size:    "</span> <span class="token operator">&lt;&lt;</span> cg_size_ <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Compute Normals</span>
    <span class="token comment">//</span>
    pcl<span class="token double-colon punctuation">::</span>NormalEstimationOMP<span class="token operator">&lt;</span>PointType<span class="token punctuation">,</span> NormalType<span class="token operator">&gt;</span> norm_est<span class="token punctuation">;</span>
    norm_est<span class="token punctuation">.</span><span class="token function">setKSearch</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    norm_est<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    norm_est<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token operator">*</span>model_normals<span class="token punctuation">)</span><span class="token punctuation">;</span>

    norm_est<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
    norm_est<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token operator">*</span>scene_normals<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Downsample Clouds to Extract keypoints</span>
    <span class="token comment">//</span>

    pcl<span class="token double-colon punctuation">::</span>UniformSampling<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span> uniform_sampling<span class="token punctuation">;</span>
    uniform_sampling<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    uniform_sampling<span class="token punctuation">.</span><span class="token function">setRadiusSearch</span><span class="token punctuation">(</span>model_ss_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    uniform_sampling<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token operator">*</span>model_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Model total points: "</span> <span class="token operator">&lt;&lt;</span> model<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"; Selected Keypoints: "</span> <span class="token operator">&lt;&lt;</span> model_keypoints<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

    uniform_sampling<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
    uniform_sampling<span class="token punctuation">.</span><span class="token function">setRadiusSearch</span><span class="token punctuation">(</span>scene_ss_<span class="token punctuation">)</span><span class="token punctuation">;</span>
    uniform_sampling<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token operator">*</span>scene_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Scene total points: "</span> <span class="token operator">&lt;&lt;</span> scene<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"; Selected Keypoints: "</span> <span class="token operator">&lt;&lt;</span> scene_keypoints<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>


    <span class="token comment">//</span>
    <span class="token comment">//  Compute Descriptor for keypoints</span>
    <span class="token comment">//</span>
    pcl<span class="token double-colon punctuation">::</span>SHOTEstimationOMP<span class="token operator">&lt;</span>PointType<span class="token punctuation">,</span> NormalType<span class="token punctuation">,</span> DescriptorType<span class="token operator">&gt;</span> descr_est<span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">setRadiusSearch</span><span class="token punctuation">(</span>descr_rad_<span class="token punctuation">)</span><span class="token punctuation">;</span>

    descr_est<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">setInputNormals</span><span class="token punctuation">(</span>model_normals<span class="token punctuation">)</span><span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">setSearchSurface</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token operator">*</span>model_descriptors<span class="token punctuation">)</span><span class="token punctuation">;</span>

    descr_est<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>scene_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">setInputNormals</span><span class="token punctuation">(</span>scene_normals<span class="token punctuation">)</span><span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">setSearchSurface</span><span class="token punctuation">(</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
    descr_est<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token operator">*</span>scene_descriptors<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Find Model-Scene Correspondences with KdTree</span>
    <span class="token comment">//</span>
    pcl<span class="token double-colon punctuation">::</span>CorrespondencesPtr <span class="token function">model_scene_corrs</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token function">Correspondences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    pcl<span class="token double-colon punctuation">::</span>KdTreeFLANN<span class="token operator">&lt;</span>DescriptorType<span class="token operator">&gt;</span> match_search<span class="token punctuation">;</span>
    match_search<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model_descriptors<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//  For each scene keypoint descriptor, find nearest neighbor into the model keypoints descriptor cloud and add it to the correspondences vector.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> scene_descriptors<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">neigh_indices</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> <span class="token function">neigh_sqr_dists</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>std<span class="token double-colon punctuation">::</span><span class="token function">isfinite</span><span class="token punctuation">(</span>scene_descriptors<span class="token operator">-&gt;</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>descriptor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//skipping NaNs</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> found_neighs <span class="token operator">=</span> match_search<span class="token punctuation">.</span><span class="token function">nearestKSearch</span><span class="token punctuation">(</span>scene_descriptors<span class="token operator">-&gt;</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> neigh_indices<span class="token punctuation">,</span> neigh_sqr_dists<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>found_neighs <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> neigh_sqr_dists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0.25f</span><span class="token punctuation">)</span> <span class="token comment">//  add match only if the squared descriptor distance is less than 0.25 (SHOT descriptor distances are between 0 and 1 by design)</span>
        <span class="token punctuation">{<!-- --></span>
            pcl<span class="token double-colon punctuation">::</span>Correspondence <span class="token function">corr</span><span class="token punctuation">(</span>neigh_indices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> neigh_sqr_dists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            model_scene_corrs<span class="token operator">-&gt;</span><span class="token function">push_back</span><span class="token punctuation">(</span>corr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Correspondences found: "</span> <span class="token operator">&lt;&lt;</span> model_scene_corrs<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Actual Clustering</span>
    <span class="token comment">//</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Matrix4f<span class="token punctuation">,</span> Eigen<span class="token double-colon punctuation">::</span>aligned_allocator<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Matrix4f<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> rototranslations<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>pcl<span class="token double-colon punctuation">::</span>Correspondences<span class="token operator">&gt;</span> clustered_corrs<span class="token punctuation">;</span>

    <span class="token comment">//  Using Hough3D</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>use_hough_<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//</span>
        <span class="token comment">//  Compute (Keypoints) Reference Frames only for Hough</span>
        <span class="token comment">//</span>
        pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>RFType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">model_rf</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>RFType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>RFType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">scene_rf</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>RFType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        pcl<span class="token double-colon punctuation">::</span>BOARDLocalReferenceFrameEstimation<span class="token operator">&lt;</span>PointType<span class="token punctuation">,</span> NormalType<span class="token punctuation">,</span> RFType<span class="token operator">&gt;</span> rf_est<span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">setFindHoles</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">setRadiusSearch</span><span class="token punctuation">(</span>rf_rad_<span class="token punctuation">)</span><span class="token punctuation">;</span>

        rf_est<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">setInputNormals</span><span class="token punctuation">(</span>model_normals<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">setSearchSurface</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token operator">*</span>model_rf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        rf_est<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>scene_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">setInputNormals</span><span class="token punctuation">(</span>scene_normals<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">setSearchSurface</span><span class="token punctuation">(</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rf_est<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token operator">*</span>scene_rf<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//  Clustering</span>
        pcl<span class="token double-colon punctuation">::</span>Hough3DGrouping<span class="token operator">&lt;</span>PointType<span class="token punctuation">,</span> PointType<span class="token punctuation">,</span> RFType<span class="token punctuation">,</span> RFType<span class="token operator">&gt;</span> clusterer<span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setHoughBinSize</span><span class="token punctuation">(</span>cg_size_<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setHoughThreshold</span><span class="token punctuation">(</span>cg_thresh_<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setUseInterpolation</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setUseDistanceWeight</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        clusterer<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setInputRf</span><span class="token punctuation">(</span>model_rf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setSceneCloud</span><span class="token punctuation">(</span>scene_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setSceneRf</span><span class="token punctuation">(</span>scene_rf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clusterer<span class="token punctuation">.</span><span class="token function">setModelSceneCorrespondences</span><span class="token punctuation">(</span>model_scene_corrs<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//clusterer.cluster (clustered_corrs);</span>
        clusterer<span class="token punctuation">.</span><span class="token function">recognize</span><span class="token punctuation">(</span>rototranslations<span class="token punctuation">,</span> clustered_corrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token comment">// Using GeometricConsistency</span>
    <span class="token punctuation">{<!-- --></span>
        pcl<span class="token double-colon punctuation">::</span>GeometricConsistencyGrouping<span class="token operator">&lt;</span>PointType<span class="token punctuation">,</span> PointType<span class="token operator">&gt;</span> gc_clusterer<span class="token punctuation">;</span>
        gc_clusterer<span class="token punctuation">.</span><span class="token function">setGCSize</span><span class="token punctuation">(</span>cg_size_<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gc_clusterer<span class="token punctuation">.</span><span class="token function">setGCThreshold</span><span class="token punctuation">(</span>cg_thresh_<span class="token punctuation">)</span><span class="token punctuation">;</span>

        gc_clusterer<span class="token punctuation">.</span><span class="token function">setInputCloud</span><span class="token punctuation">(</span>model_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gc_clusterer<span class="token punctuation">.</span><span class="token function">setSceneCloud</span><span class="token punctuation">(</span>scene_keypoints<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gc_clusterer<span class="token punctuation">.</span><span class="token function">setModelSceneCorrespondences</span><span class="token punctuation">(</span>model_scene_corrs<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//gc_clusterer.cluster (clustered_corrs);</span>
        gc_clusterer<span class="token punctuation">.</span><span class="token function">recognize</span><span class="token punctuation">(</span>rototranslations<span class="token punctuation">,</span> clustered_corrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Output results</span>
    <span class="token comment">//</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Model instances found: "</span> <span class="token operator">&lt;&lt;</span> rototranslations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rototranslations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n    Instance "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"        Correspondences belonging to this instance: "</span> <span class="token operator">&lt;&lt;</span> clustered_corrs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

        <span class="token comment">// Print the rotation matrix and translation vector</span>
        Eigen<span class="token double-colon punctuation">::</span>Matrix3f rotation <span class="token operator">=</span> rototranslations<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">block</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Eigen<span class="token double-colon punctuation">::</span>Vector3f translation <span class="token operator">=</span> rototranslations<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">block</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"            | %6.3f %6.3f %6.3f | \n"</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"        R = | %6.3f %6.3f %6.3f | \n"</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"            | %6.3f %6.3f %6.3f | \n"</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rotation</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"        t = &lt; %0.3f, %0.3f, %0.3f &gt;\n"</span><span class="token punctuation">,</span> <span class="token function">translation</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">translation</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">translation</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">//  Visualization</span>
    <span class="token comment">//</span>
    pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PCLVisualizer <span class="token function">viewer</span><span class="token punctuation">(</span><span class="token string">"Correspondence Grouping"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    viewer<span class="token punctuation">.</span><span class="token function">addPointCloud</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> <span class="token string">"scene_cloud"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">off_scene_model</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">off_scene_model_keypoints</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>show_correspondences_ <span class="token operator">||</span> show_keypoints_<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//  We are translating the model so that it doesn't end in the middle of the scene representation</span>
        pcl<span class="token double-colon punctuation">::</span><span class="token function">transformPointCloud</span><span class="token punctuation">(</span><span class="token operator">*</span>model<span class="token punctuation">,</span> <span class="token operator">*</span>off_scene_model<span class="token punctuation">,</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Quaternionf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pcl<span class="token double-colon punctuation">::</span><span class="token function">transformPointCloud</span><span class="token punctuation">(</span><span class="token operator">*</span>model_keypoints<span class="token punctuation">,</span> <span class="token operator">*</span>off_scene_model_keypoints<span class="token punctuation">,</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Quaternionf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PointCloudColorHandlerCustom<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span> <span class="token function">off_scene_model_color_handler</span><span class="token punctuation">(</span>off_scene_model<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewer<span class="token punctuation">.</span><span class="token function">addPointCloud</span><span class="token punctuation">(</span>off_scene_model<span class="token punctuation">,</span> off_scene_model_color_handler<span class="token punctuation">,</span> <span class="token string">"off_scene_model"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>show_keypoints_<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PointCloudColorHandlerCustom<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span> <span class="token function">scene_keypoints_color_handler</span><span class="token punctuation">(</span>scene_keypoints<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewer<span class="token punctuation">.</span><span class="token function">addPointCloud</span><span class="token punctuation">(</span>scene_keypoints<span class="token punctuation">,</span> scene_keypoints_color_handler<span class="token punctuation">,</span> <span class="token string">"scene_keypoints"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewer<span class="token punctuation">.</span><span class="token function">setPointCloudRenderingProperties</span><span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PCL_VISUALIZER_POINT_SIZE<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"scene_keypoints"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PointCloudColorHandlerCustom<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span> <span class="token function">off_scene_model_keypoints_color_handler</span><span class="token punctuation">(</span>off_scene_model_keypoints<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewer<span class="token punctuation">.</span><span class="token function">addPointCloud</span><span class="token punctuation">(</span>off_scene_model_keypoints<span class="token punctuation">,</span> off_scene_model_keypoints_color_handler<span class="token punctuation">,</span> <span class="token string">"off_scene_model_keypoints"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewer<span class="token punctuation">.</span><span class="token function">setPointCloudRenderingProperties</span><span class="token punctuation">(</span>pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PCL_VISUALIZER_POINT_SIZE<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"off_scene_model_keypoints"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rototranslations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        pcl<span class="token double-colon punctuation">::</span>PointCloud<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>Ptr <span class="token function">rotated_model</span><span class="token punctuation">(</span><span class="token keyword">new</span> pcl<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">PointCloud</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pcl<span class="token double-colon punctuation">::</span><span class="token function">transformPointCloud</span><span class="token punctuation">(</span><span class="token operator">*</span>model<span class="token punctuation">,</span> <span class="token operator">*</span>rotated_model<span class="token punctuation">,</span> rototranslations<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        std<span class="token double-colon punctuation">::</span>stringstream ss_cloud<span class="token punctuation">;</span>
        ss_cloud <span class="token operator">&lt;&lt;</span> <span class="token string">"instance"</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">;</span>

        pcl<span class="token double-colon punctuation">::</span>visualization<span class="token double-colon punctuation">::</span>PointCloudColorHandlerCustom<span class="token operator">&lt;</span>PointType<span class="token operator">&gt;</span> <span class="token function">rotated_model_color_handler</span><span class="token punctuation">(</span>rotated_model<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewer<span class="token punctuation">.</span><span class="token function">addPointCloud</span><span class="token punctuation">(</span>rotated_model<span class="token punctuation">,</span> rotated_model_color_handler<span class="token punctuation">,</span> ss_cloud<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>show_correspondences_<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> clustered_corrs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                std<span class="token double-colon punctuation">::</span>stringstream ss_line<span class="token punctuation">;</span>
                ss_line <span class="token operator">&lt;&lt;</span> <span class="token string">"correspondence_line"</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">"_"</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">;</span>
                PointType<span class="token operator">&amp;</span> model_point <span class="token operator">=</span> off_scene_model_keypoints<span class="token operator">-&gt;</span><span class="token function">at</span><span class="token punctuation">(</span>clustered_corrs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>index_query<span class="token punctuation">)</span><span class="token punctuation">;</span>
                PointType<span class="token operator">&amp;</span> scene_point <span class="token operator">=</span> scene_keypoints<span class="token operator">-&gt;</span><span class="token function">at</span><span class="token punctuation">(</span>clustered_corrs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>index_match<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//  We are drawing a line for each pair of clustered correspondences found between the model and the scene</span>
                viewer<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">addLine</span><span class="token generic class-name"><span class="token operator">&lt;</span>PointType<span class="token punctuation">,</span> PointType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>model_point<span class="token punctuation">,</span> scene_point<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ss_line<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>viewer<span class="token punctuation">.</span><span class="token function">wasStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        viewer<span class="token punctuation">.</span><span class="token function">spinOnce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>使用VS调试时，在项目—属性—配置属性—调试—命令参数填写指令</p> 
<pre><code class="prism language-cpp">milk<span class="token punctuation">.</span>pcd milk_cartoon_all_small_clorox<span class="token punctuation">.</span>pcd  <span class="token operator">-</span>k <span class="token operator">-</span>c
</code></pre> 
<p>请记住按此确切顺序将 和 替换为模型和场景文件名。如果需要，可以添加其他命令行选项，显示不同的效果，具体指令见提示：</p> 
<pre><code class="prism language-cpp"> std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"***************************************************************************"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*                                                                         *"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*             Correspondence Grouping Tutorial - Usage Guide              *"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*                                                                         *"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"***************************************************************************"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Usage: "</span> <span class="token operator">&lt;&lt;</span> filename <span class="token operator">&lt;&lt;</span> <span class="token string">" model_filename.pcd scene_filename.pcd [Options]"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Options:"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -h:                     Show this help."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -k:                     Show used keypoints."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -c:                     Show used correspondences."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     -r:                     Compute the model cloud resolution and multiply"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"                             each radius given by that value."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --algorithm (Hough|GC): Clustering algorithm used (default Hough)."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --model_ss val:         Model uniform sampling radius (default 0.01)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --scene_ss val:         Scene uniform sampling radius (default 0.03)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --rf_rad val:           Reference frame radius (default 0.015)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --descr_rad val:        Descriptor radius (default 0.02)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --cg_size val:          Cluster size (default 0.01)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"     --cg_thresh val:        Clustering threshold (default 5)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/c4/4c/PPAYsTMj_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/cf/a4/6n15Z5X3_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/fa/4b/28trxrVF_o.png" alt="在这里插入图片描述"><br> 点云文件链接：https://download.csdn.net/download/baidu_41706898/86522095?spm=1001.2014.3001.5503</p> 
<p>参考链接：https://pcl.readthedocs.io/projects/tutorials/en/latest/correspondence_grouping.html#correspondence-grouping</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/962d8c3d42b0c7598f908f342be61f0f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue3简单的前端权限路由实现（通过前端鉴权&#43;侧边栏过滤）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c4feaa888aea02e9b82efdd2210b6481/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue 设置动态 ref</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>