<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>node-red 插件使用教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="node-red 插件使用教程" />
<meta property="og:description" content="一 java 编写 coap 客户端与服务端
概述：
CoAP是为物联网而生，短小精悍，它底层基于UDP协议的，其它具体参考百度百科，本例子是基于Californium框架。
1、先决条件
java环境
eclipse工具
Maven插件（有最好，不需要手动下载jar引入，没有的话手动引入）
2、下载Californium框架核心jar
californium-core.jar ： 包括CoAP核心部分
element-connector.jar 包括适用于UDP和DTLS的java套接字抽象层
scandium.jar: 包括DTLS
&lt;dependency&gt; &lt;groupId&gt;org.eclipse.californium&lt;/groupId&gt; &lt;artifactId&gt;californium-core&lt;/artifactId&gt; &lt;version&gt;2.0.0-M7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.eclipse.californium&lt;/groupId&gt; &lt;artifactId&gt;element-connector&lt;/artifactId&gt; &lt;version&gt;2.0.0-M7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.eclipse.californium&lt;/groupId&gt; &lt;artifactId&gt;scandium&lt;/artifactId&gt; &lt;version&gt;2.0.0-M7&lt;/version&gt; &lt;/dependency&gt; 3、创建java工程或Maven工程，创建一个Server类
import org.eclipse.californium.core.CoapResource; import org.eclipse.californium.core.CoapServer; import org.eclipse.californium.core.coap.CoAP.ResponseCode; import org.eclipse.californium.core.server.resources.CoapExchange; public class HelloCoAPServer { public static void main(String[] args) { CoapServer server = new CoapServer();//主机为localhost 端口为默认端口5683 server.add(new CoapResource(&#34;hello&#34;){//创建一个资源为hello 请求格式为 主机：端口\hello @Override public void handleGET(CoapExchange exchange) { //重写处理GET请求的方法 exchange." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a4f9b15423c59341981ef3b8362dd79c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-30T12:50:40+08:00" />
<meta property="article:modified_time" content="2019-11-30T12:50:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">node-red 插件使用教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一  java 编写 coap 客户端与服务端</p> 
<p>概述：</p> 
<p>CoAP是为物联网而生，短小精悍，它底层基于UDP协议的，其它具体参考百度百科，本例子是基于Californium框架。</p> 
<p>1、先决条件<br> java环境</p> 
<p>eclipse工具</p> 
<p>Maven插件（有最好，不需要手动下载jar引入，没有的话手动引入）</p> 
<p>2、下载Californium框架核心jar<br> californium-core.jar ： 包括CoAP核心部分</p> 
<p>element-connector.jar  包括适用于UDP和DTLS的java套接字抽象层</p> 
<p>scandium.jar: 包括DTLS</p> 
<pre><code class="language-XML">&lt;dependency&gt;
        &lt;groupId&gt;org.eclipse.californium&lt;/groupId&gt;
        &lt;artifactId&gt;californium-core&lt;/artifactId&gt;
        &lt;version&gt;2.0.0-M7&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.eclipse.californium&lt;/groupId&gt;
        &lt;artifactId&gt;element-connector&lt;/artifactId&gt;
        &lt;version&gt;2.0.0-M7&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;dependency&gt;
        &lt;groupId&gt;org.eclipse.californium&lt;/groupId&gt;
        &lt;artifactId&gt;scandium&lt;/artifactId&gt;
        &lt;version&gt;2.0.0-M7&lt;/version&gt;
    &lt;/dependency&gt;</code></pre> 
<p>3、创建java工程或Maven工程，创建一个Server类</p> 
<pre><code class="language-java">import org.eclipse.californium.core.CoapResource;
import org.eclipse.californium.core.CoapServer;
import org.eclipse.californium.core.coap.CoAP.ResponseCode;
import org.eclipse.californium.core.server.resources.CoapExchange;
 
public class HelloCoAPServer {
 
    public static void main(String[] args) {
        CoapServer server = new CoapServer();//主机为localhost 端口为默认端口5683
        server.add(new CoapResource("hello"){//创建一个资源为hello 请求格式为 主机：端口\hello
 
            @Override
            public void handleGET(CoapExchange exchange) { //重写处理GET请求的方法
                exchange.respond(ResponseCode.CONTENT, "Hello CoAP!");  
            }
            
        });
        server.add(new CoapResource("time"){ //创建一个资源为time 请求格式为 主机：端口\time
 
            @Override
            public void handleGET(CoapExchange exchange) {
                Date date = new Date();
                exchange.respond(ResponseCode.CONTENT,
                        new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(date));
            }
            
        });
        server.start();
    }
}</code></pre> 
<p><br> 4、创建一个客户端：</p> 
<pre><code class="language-java">public class GETClient {
 
    public static void main(String[] args) throws URISyntaxException {
        URI uri = null;
        uri = new URI("localhost:5683/hello");  //创建一个资源请求hello资源，注意默认端口为5683
        CoapClient client = new CoapClient(uri);
        CoapResponse response = client.get();
        if(response !=null){
            System.out.println(response.getCode());  //打印请求状态码
            System.out.println(response.getOptions());  //选项参数
            System.out.println(response.getResponseText());  //获取内容文本信息
            System.out.println("\nAdvanced\n");    // 
            System.out.println(Utils.prettyPrint(response));  //打印格式良好的输出
        }
    }
}</code></pre> 
<p><br> 5、测试<br> 先运行HelloCoAPServer的main方法</p> 
<p>然后运行GETClient的main方法</p> 
<p>6、日志：</p> 
<pre><code>2.05
{"Content-Format":"text/plain"}
Hello CoAP!
 
Advanced
 
==[ CoAP Response ]============================================
MID    : 10763
Token  : [aab3ac5818d1e598]
Type   : ACK
Status : 2.05
Options: {"Content-Format":"text/plain"}
RTT    : 26 ms
Payload: 11 Bytes
---------------------------------------------------------------
Hello CoAP!
===============================================================</code></pre> 
<p>二 node-red安装node-red-contrib-coap</p> 
<p><img alt="" class="has" height="394" src="https://images2.imgbox.com/73/c2/IHXjgDaN_o.png" width="754"></p> 
<p> </p> 
<p><img alt="" class="has" height="368" src="https://images2.imgbox.com/6e/20/bBfrw20q_o.png" width="742"></p> 
<p> </p> 
<p>安装之后拖拽配置</p> 
<p><img alt="" class="has" height="144" src="https://images2.imgbox.com/b8/b6/2waMzpkv_o.png" width="616"></p> 
<p>coap请求节点配置如下</p> 
<p><img alt="" class="has" height="445" src="https://images2.imgbox.com/ac/52/9OlCcXS3_o.png" width="498"></p> 
<p> </p> 
<p> </p> 
<p>coap 服务端节点配置如下</p> 
<p><img alt="" class="has" height="335" src="https://images2.imgbox.com/80/d0/Cdy4gQoV_o.png" width="487"></p> 
<p> </p> 
<p>服务端响应节点配置如下,获取get请求参数</p> 
<p><img alt="" class="has" height="267" src="https://images2.imgbox.com/28/61/BtqYN8mh_o.png" width="443"></p> 
<p>可以自定义响应的格式,注意访问coap服务器的时候,如果有配置hosts,应该使用hosts访问这个地址</p> 
<p> </p> 
<p>三 msyql插件 node-red-node-mysql</p> 
<p>1. 安装</p> 
<p><img alt="" class="has" height="335" src="https://images2.imgbox.com/21/45/70VDJbQr_o.png" width="654"></p> 
<p>2.配置调试</p> 
<p> 找到mysql组件,然后编辑节点</p> 
<p><img alt="" class="has" height="256" src="https://images2.imgbox.com/55/fd/q3S5pp9C_o.png" width="204"></p> 
<p> 配置新的节点</p> 
<p><img alt="" class="has" height="231" src="https://images2.imgbox.com/5d/83/jSPOImNd_o.png" width="482"></p> 
<p>设置参数</p> 
<p><img alt="" class="has" height="389" src="https://images2.imgbox.com/80/04/IE8slPKb_o.png" width="461"></p> 
<p>组件连接</p> 
<p><img alt="" class="has" height="120" src="https://images2.imgbox.com/f2/4e/ChnNWg1r_o.png" width="779"></p> 
<p>sql编写组件</p> 
<p><img alt="" class="has" height="49" src="https://images2.imgbox.com/df/93/XLcaniEI_o.png" width="142"></p> 
<p>内容</p> 
<p><img alt="" class="has" height="271" src="https://images2.imgbox.com/af/12/7HnzdVow_o.png" width="456"></p> 
<p> </p> 
<p> </p> 
<p>三 kafka组件</p> 
<p><img alt="" class="has" height="326" src="https://images2.imgbox.com/ba/b6/ErC95vqR_o.png" width="704"></p> 
<p> </p> 
<p>输入输出kafka组件</p> 
<p><img alt="" class="has" height="88" src="https://images2.imgbox.com/57/3b/qccenBHU_o.png" width="401"></p> 
<p>配置添加节点</p> 
<p><img alt="" class="has" height="581" src="https://images2.imgbox.com/e2/0a/V5BlWw0Y_o.png" width="460"></p> 
<p><img alt="" class="has" height="441" src="https://images2.imgbox.com/6f/d5/SW9POPKT_o.png" width="580"></p> 
<p> </p> 
<p>四 http</p> 
<p><img alt="" class="has" height="57" src="https://images2.imgbox.com/7f/58/iBNPEqXm_o.png" width="505"></p> 
<p> </p> 
<p><img alt="" class="has" height="266" src="https://images2.imgbox.com/42/df/ApsZ83hu_o.png" width="441"></p> 
<p> </p> 
<p>部署后访问nodered端口的/test路径</p> 
<p><a href="http://39.100.228.221:1880/test?a=1&amp;b=3" rel="nofollow">http://127.0.0.1:1880/test?a=1&amp;b=3</a></p> 
<p><img alt="" class="has" height="171" src="https://images2.imgbox.com/70/8f/moHRwprD_o.png" width="377"></p> 
<p> </p> 
<p> </p> 
<p>串口插件</p> 
<p>使用方式如下博客</p> 
<p><a href="https://blog.csdn.net/geek_monkey/article/details/80755719">https://blog.csdn.net/geek_monkey/article/details/80755719</a></p> 
<p>串口安装权限异常等问题失败 使用离线安装</p> 
<pre><code>sudo npm install node-pre-gyp --save
sudo npm install serialport --unsafe-perm --build-from-source --save
npm i npm to update 
npm install -g serialport</code></pre> 
<p> </p> 
<p>node-red 自定义插件</p> 
<p>先找到对应的自定义插件所在的目录</p> 
<p><img alt="" class="has" height="198" src="https://images2.imgbox.com/e0/a4/X7z3FifE_o.png" width="944"></p> 
<p> </p> 
<p><img alt="" class="has" height="274" src="https://images2.imgbox.com/6e/5a/lwhFKTpB_o.png" width="1200"></p> 
<p>将后缀的demo删除后重启nodered,输入组件中会多一个sample,即为自定义组件</p> 
<p>修改自定义组件内容 99-sample.js</p> 
<p>核心部分</p> 
<p><img alt="" class="has" height="471" src="https://images2.imgbox.com/fb/b4/Hchrr7cI_o.png" width="916"></p> 
<p> </p> 
<p>编码格式为js语法,但是部分api不存在.例如数组遍历map不存在</p> 
<p>按照自己的要求修改好之后,重启node-red</p> 
<p> </p> 
<p> </p> 
<p>node-red全局变量</p> 
<p>使用函数组件</p> 
<p>编辑内容</p> 
<pre><code class="language-javascript">if (local.action===undefined)//获取全局变量,如果不存在,赋默认值
{
  local.action="站立";
  local.x=0;
  local.y=0;
}else{//如果存在,进入计算
    switch(msg.payload.token){
        case "move_x":
            local.x+=parseInt(msg.payload.value)
            break;
        case "move_y":
             local.y+=parseInt(msg.payload.value)
            break;
    }
}
context.set('data',local);//保存全局变量</code></pre> 
<p>函数节点使用16进制字节数组</p> 
<pre><code class="language-javascript">msg.payload = Buffer.from([0x12,0x22,0xd3,0x23])</code></pre> 
<p> </p> 
<p>node-red的用户权限与密码配置</p> 
<p>首先找到配置文件,启动node-red的时候,启动日志会显示配置文件位置,如下图所示</p> 
<p><img alt="" class="has" height="563" src="https://images2.imgbox.com/95/b4/dmCwD8AD_o.png" width="792"></p> 
<p>修改配置文件</p> 
<p><img alt="" class="has" height="24" src="https://images2.imgbox.com/45/0b/BswEMn8S_o.png" width="474"></p> 
<p>找到这个位置,放开注释</p> 
<p>password是经过加密处理的</p> 
<p>permissions 表示用户权限,分为 读写 -&gt; *    只读  -&gt; read</p> 
<p><img alt="" class="has" height="299" src="https://images2.imgbox.com/68/69/icvejXfz_o.png" width="801"></p> 
<p>获取加密后的秘钥</p> 
<p>首先进入找到加密工具所在的目录</p> 
<p><img alt="" class="has" height="162" src="https://images2.imgbox.com/a0/63/CivPqD77_o.png" width="1142"></p> 
<p>进入开始转化秘钥</p> 
<p>node -e "console.log(require('bcryptjs').hashSync(process.argv[1], 8));" mypassword</p> 
<p><img alt="" class="has" height="97" src="https://images2.imgbox.com/7e/be/MKZndCFi_o.png" width="973"></p> 
<p> </p> 
<p>得到的$2a$08$Dk6dTjxEPi85sObY1HRYZ.QDoB53m/J5M1MFulhgKTvpwuuC5AzOW表示新的秘钥,将他写入配置文件setting中的pasword中,即下一次登录使用的密码为mypassword</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/33113cec27ea8bc86be4c18892dd913c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pytorch报错：RuntimeError: CUDA error: device-side assert triggered</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/578ea0ac12f6134f84096b7e6dc2b8c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">安卓开发 自定义ScrollView 实现滚动，停止状态的监听</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>