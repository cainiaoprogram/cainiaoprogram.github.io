<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>文献阅读（7）：YOLO 检测网络加速 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="文献阅读（7）：YOLO 检测网络加速" />
<meta property="og:description" content="目录
一、简介
1.题目：
2.时间：
3.来源：
4.简介：
5.论文主要贡献：
二、相关名词
三、 相关背景知识
1.YOLO网络
2.Winograd快速卷积计算（针对3x3卷积层）
3.GEMM快速卷积计算（针对1x1卷积层）
4.卷积层、归一化层的合并计算
四、处理流程概述
1.动态量化
2.针对3x3卷积层的加速计算引擎PE1
3.针对1x1卷积层的加速计算引擎PE2（融合了重排序计算模块）
4.双缓存系统和多DMA通道
一、简介 1.题目： YOLO 检测网络的 FPGA 加速计算模型的研究
2.时间： 2022.08
3.来源： Journal of Chinese Computer Systems（小型微型计算机系统）
4.简介： 伴随着检测精度的提高，YOLO系列网络的深度以及参数量越来越大，因而需要更大的计算量和内存。文中基于FPGA 验证平台研究并实现了 YOLO系列神经网络的加速计算模型，使用了动态定点量化、流水线、循环展开、模块融合等策略，提高了fpga计算资源的利用率，降低了数据传输的时延，提高了整体性能。
5.论文主要贡献： 从三个方面（当前基于fpga的神经网络加速计算模型的相关工作主要集中在这三个方面）提高fpga加速计算的性能：
①通过对网络模型参数的量化和压缩实现加速。
②针对卷积层加速计算的研究。
③ 基于不同硬件执行架构的加速器设计。
本文使用了 Winograd、 GEMM 快速卷积方法，以及融合卷积层和归一化层参数的合并计算方法，采用多 DMA 通道传输和非卷积模块的融合计算进一步降低数据传输的延时，此外还设计了双缓存系统提高资源利用率以提高整体性能。
二、相关名词 YOLO：You Only Look Once
HLS：High Level Synthesis，高层次综合
IP：Intellectual Property，知识产权
GEMM：General Matrix Multiplication，通用矩阵乘
SIMD：Single Instruction Multiple Data，单指令多数据流
DMA：Direct Memory Access，一种快速传输数据的机制" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/18b4193820fcb93a09a70099b06d1f4e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-26T21:40:17+08:00" />
<meta property="article:modified_time" content="2023-01-26T21:40:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">文献阅读（7）：YOLO 检测网络加速</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B" rel="nofollow">一、简介</a></p> 
<p id="1.%E9%A2%98%E7%9B%AE%EF%BC%9A-toc" style="margin-left:40px;"><a href="#1.%E9%A2%98%E7%9B%AE%EF%BC%9A" rel="nofollow">1.题目：</a></p> 
<p id="2.%E6%97%B6%E9%97%B4%EF%BC%9A-toc" style="margin-left:40px;"><a href="#2.%E6%97%B6%E9%97%B4%EF%BC%9A" rel="nofollow">2.时间：</a></p> 
<p id="3.%E6%9D%A5%E6%BA%90%EF%BC%9A-toc" style="margin-left:40px;"><a href="#3.%E6%9D%A5%E6%BA%90%EF%BC%9A" rel="nofollow">3.来源：</a></p> 
<p id="4.%E7%AE%80%E4%BB%8B%EF%BC%9A-toc" style="margin-left:40px;"><a href="#4.%E7%AE%80%E4%BB%8B%EF%BC%9A" rel="nofollow">4.简介：</a></p> 
<p id="5.%E8%AE%BA%E6%96%87%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE%EF%BC%9A-toc" style="margin-left:40px;"><a href="#5.%E8%AE%BA%E6%96%87%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE%EF%BC%9A" rel="nofollow">5.论文主要贡献：</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%9B%B8%E5%85%B3%E5%90%8D%E8%AF%8D-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E7%9B%B8%E5%85%B3%E5%90%8D%E8%AF%8D" rel="nofollow">二、相关名词</a></p> 
<p id="%E4%B8%89%E3%80%81%20%E7%9B%B8%E5%85%B3%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%20%E7%9B%B8%E5%85%B3%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86" rel="nofollow">三、 相关背景知识</a></p> 
<p id="1.YOLO%E7%BD%91%E7%BB%9C-toc" style="margin-left:40px;"><a href="#1.YOLO%E7%BD%91%E7%BB%9C" rel="nofollow">1.YOLO网络</a></p> 
<p id="2.Winograd%E5%BF%AB%E9%80%9F%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97%EF%BC%88%E9%92%88%E5%AF%B93x3%E5%8D%B7%E7%A7%AF%E5%B1%82%EF%BC%89-toc" style="margin-left:40px;"><a href="#2.Winograd%E5%BF%AB%E9%80%9F%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97%EF%BC%88%E9%92%88%E5%AF%B93x3%E5%8D%B7%E7%A7%AF%E5%B1%82%EF%BC%89" rel="nofollow">2.Winograd快速卷积计算（针对3x3卷积层）</a></p> 
<p id="3.GEMM%E5%BF%AB%E9%80%9F%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97%EF%BC%88%E9%92%88%E5%AF%B91x1%E5%8D%B7%E7%A7%AF%E5%B1%82%EF%BC%89-toc" style="margin-left:40px;"><a href="#3.GEMM%E5%BF%AB%E9%80%9F%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97%EF%BC%88%E9%92%88%E5%AF%B91x1%E5%8D%B7%E7%A7%AF%E5%B1%82%EF%BC%89" rel="nofollow">3.GEMM快速卷积计算（针对1x1卷积层）</a></p> 
<p id="4.%E5%8D%B7%E7%A7%AF%E5%B1%82%E3%80%81%E5%BD%92%E4%B8%80%E5%8C%96%E5%B1%82%E7%9A%84%E5%90%88%E5%B9%B6%E8%AE%A1%E7%AE%97-toc" style="margin-left:40px;"><a href="#4.%E5%8D%B7%E7%A7%AF%E5%B1%82%E3%80%81%E5%BD%92%E4%B8%80%E5%8C%96%E5%B1%82%E7%9A%84%E5%90%88%E5%B9%B6%E8%AE%A1%E7%AE%97" rel="nofollow">4.卷积层、归一化层的合并计算</a></p> 
<p id="%E5%9B%9B%E3%80%81%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0" rel="nofollow">四、处理流程概述</a></p> 
<p id="1.%E5%8A%A8%E6%80%81%E9%87%8F%E5%8C%96-toc" style="margin-left:40px;"><a href="#1.%E5%8A%A8%E6%80%81%E9%87%8F%E5%8C%96" rel="nofollow">1.动态量化</a></p> 
<p id="2.%E9%92%88%E5%AF%B93x3%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%8A%A0%E9%80%9F%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8EPE1-toc" style="margin-left:40px;"><a href="#2.%E9%92%88%E5%AF%B93x3%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%8A%A0%E9%80%9F%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8EPE1" rel="nofollow">2.针对3x3卷积层的加速计算引擎PE1</a></p> 
<p id="3.%E9%92%88%E5%AF%B91x1%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%8A%A0%E9%80%9F%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8EPE2%EF%BC%88%E8%9E%8D%E5%90%88%E4%BA%86%E9%87%8D%E6%8E%92%E5%BA%8F%E8%AE%A1%E7%AE%97%E6%A8%A1%E5%9D%97%EF%BC%89-toc" style="margin-left:40px;"><a href="#3.%E9%92%88%E5%AF%B91x1%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%8A%A0%E9%80%9F%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8EPE2%EF%BC%88%E8%9E%8D%E5%90%88%E4%BA%86%E9%87%8D%E6%8E%92%E5%BA%8F%E8%AE%A1%E7%AE%97%E6%A8%A1%E5%9D%97%EF%BC%89" rel="nofollow">3.针对1x1卷积层的加速计算引擎PE2（融合了重排序计算模块）</a></p> 
<p id="4.%E5%8F%8C%E7%BC%93%E5%AD%98%E7%B3%BB%E7%BB%9F%E5%92%8C%E5%A4%9ADMA%E9%80%9A%E9%81%93-toc" style="margin-left:40px;"><a href="#4.%E5%8F%8C%E7%BC%93%E5%AD%98%E7%B3%BB%E7%BB%9F%E5%92%8C%E5%A4%9ADMA%E9%80%9A%E9%81%93" rel="nofollow">4.双缓存系统和多DMA通道</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B">一、简介</h2> 
<h3 id="1.%E9%A2%98%E7%9B%AE%EF%BC%9A">1.题目：</h3> 
<p>YOLO 检测网络的 FPGA 加速计算模型的研究</p> 
<h3 id="2.%E6%97%B6%E9%97%B4%EF%BC%9A">2.时间：</h3> 
<p>2022.08</p> 
<h3 id="3.%E6%9D%A5%E6%BA%90%EF%BC%9A">3.来源：</h3> 
<p>Journal of Chinese Computer Systems（小型微型计算机系统）</p> 
<h3 id="4.%E7%AE%80%E4%BB%8B%EF%BC%9A">4.简介：</h3> 
<p>伴随着检测精度的提高，YOLO系列网络的深度以及参数量越来越大，因而需要更大的计算量和内存。文中基于FPGA 验证平台研究并实现了 YOLO系列神经网络的加速计算模型，使用了动态定点量化、流水线、循环展开、模块融合等策略，提高了fpga计算资源的利用率，降低了数据传输的时延，提高了整体性能。</p> 
<h3 id="5.%E8%AE%BA%E6%96%87%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE%EF%BC%9A">5.论文主要贡献：</h3> 
<p>从三个方面（当前基于fpga的神经网络加速计算模型的相关工作主要集中在这三个方面）提高fpga加速计算的性能：</p> 
<p>①通过对网络模型参数的量化和压缩实现加速。</p> 
<p>②针对卷积层加速计算的研究。</p> 
<p>③ 基于不同硬件执行架构的加速器设计。</p> 
<p>本文使用了 Winograd、 GEMM 快速卷积方法，以及融合卷积层和归一化层参数的合并计算方法，采用多 DMA 通道传输和非卷积模块的融合计算进一步降低数据传输的延时，此外还设计了双缓存系统提高资源利用率以提高整体性能。</p> 
<hr> 
<h2 id="%E4%BA%8C%E3%80%81%E7%9B%B8%E5%85%B3%E5%90%8D%E8%AF%8D">二、相关名词</h2> 
<p>YOLO：You Only Look Once</p> 
<p>HLS：High Level Synthesis，高层次综合</p> 
<p>IP：Intellectual Property，知识产权</p> 
<p>GEMM：General Matrix Multiplication，通用矩阵乘</p> 
<p>SIMD：Single Instruction Multiple Data，单指令多数据流</p> 
<p>DMA：Direct Memory Access，一种快速传输数据的机制</p> 
<hr> 
<h2 id="%E4%B8%89%E3%80%81%20%E7%9B%B8%E5%85%B3%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86">三、 相关背景知识</h2> 
<h3 id="1.YOLO%E7%BD%91%E7%BB%9C">1.YOLO网络</h3> 
<p>在上篇文章文献阅读（6）中，介绍了目标检测一阶段和二阶段以及tiny-yolov2的简单结构<a class="link-info" href="https://blog.csdn.net/qq_54444533/article/details/128696447?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167473655216782429785369%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=167473655216782429785369&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-128696447-null-null.blog_rank_default&amp;utm_term=yolo&amp;spm=1018.2226.3001.4450" title="文献阅读（6）：AI Deep Learning Accelerator">文献阅读（6）：AI Deep Learning Accelerator</a></p> 
<p>YOLO属于单阶段检测模型，将目标定位和识别融合在一起。YOLO系列的模型由骨干网络和检测网络组成。本文中选用的模型为YOLOv2，结构如下所示。</p> 
<p><img alt="" height="1169" src="https://images2.imgbox.com/47/cf/RxqdaZdX_o.png" width="1200"></p> 
<h3 id="2.Winograd%E5%BF%AB%E9%80%9F%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97%EF%BC%88%E9%92%88%E5%AF%B93x3%E5%8D%B7%E7%A7%AF%E5%B1%82%EF%BC%89">2.Winograd快速卷积计算（针对3x3卷积层）</h3> 
<p>通过减少乘法次数（加法次数会增加）来增加计算速度。首先将输入特征图和卷积核分别变换成相同维度矩阵，再通过矩阵点乘来实现卷积计算。具体做法知乎有篇文章写的挺清晰的→<a class="link-info" href="https://zhuanlan.zhihu.com/p/409050916" rel="nofollow" title="https://zhuanlan.zhihu.com/p/409050916">https://zhuanlan.zhihu.com/p/409050916</a></p> 
<h3 id="3.GEMM%E5%BF%AB%E9%80%9F%E5%8D%B7%E7%A7%AF%E8%AE%A1%E7%AE%97%EF%BC%88%E9%92%88%E5%AF%B91x1%E5%8D%B7%E7%A7%AF%E5%B1%82%EF%BC%89">3.GEMM快速卷积计算（针对1x1卷积层）</h3> 
<p>简单来说就是将两个输入矩阵乘法在一起，得到一个输出矩阵。对于卷积核大小大于 1 × 1 的卷积层需要先对输入特征图进行 Im2col 操作，将输入特征图上的每个卷积窗口滑过的数据扩展成列，然后再与连续存储的卷积核进行通用矩阵乘法 GEMM 得到卷积结果。</p> 
<h3 id="4.%E5%8D%B7%E7%A7%AF%E5%B1%82%E3%80%81%E5%BD%92%E4%B8%80%E5%8C%96%E5%B1%82%E7%9A%84%E5%90%88%E5%B9%B6%E8%AE%A1%E7%AE%97">4.卷积层、归一化层的合并计算</h3> 
<p>前一篇文章中有提到将卷积和最大池化相结合同时执行，提高数据重用性。本文中将卷积层和归一化的参数进行融合，fpga推理计算时把新参数直接用于卷积计算，减少了模型的计算量和数据传输量。</p> 
<h2 id="%E5%9B%9B%E3%80%81%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0">四、处理流程概述</h2> 
<h3 id="1.%E5%8A%A8%E6%80%81%E9%87%8F%E5%8C%96">1.动态量化</h3> 
<p>动态量化是对模型权重进行压缩的一种方式，在训练时针对模型进行量化，在后续进行模型测试的时候再决定是否针对激活值采取量化。本文中用16 位定点整数计算取代 32 位浮点计算，数据传输量减半，节约片上存储资源的同时提高了计算执行速度。</p> 
<h3 id="2.%E9%92%88%E5%AF%B93x3%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%8A%A0%E9%80%9F%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8EPE1">2.针对3x3卷积层的加速计算引擎PE1</h3> 
<p>采用了循环分块来降低片上卷积规模，在分块后又被分为了内循环、外循环两个循环组。右边方块中最大池化计算和卷积计算相融合，得益于Winograd 的卷积输出窗口与池化窗口的滑动规律完全相同。</p> 
<p><img alt="" height="379" src="https://images2.imgbox.com/95/66/DDMxZReX_o.png" width="851"></p> 
<p> </p> 
<h3 id="3.%E9%92%88%E5%AF%B91x1%E5%8D%B7%E7%A7%AF%E5%B1%82%E7%9A%84%E5%8A%A0%E9%80%9F%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8EPE2%EF%BC%88%E8%9E%8D%E5%90%88%E4%BA%86%E9%87%8D%E6%8E%92%E5%BA%8F%E8%AE%A1%E7%AE%97%E6%A8%A1%E5%9D%97%EF%BC%89">3.针对1x1卷积层的加速计算引擎PE2（融合了重排序计算模块）</h3> 
<p>该卷积层也采取循环分块策略，外循环和内循环基本与上方策略相同，不同的是在内循环的最里层采用了通用矩阵乘法 GEMM 实现卷积。</p> 
<p><img alt="" height="362" src="https://images2.imgbox.com/cb/d2/FVvnLw8d_o.png" width="836"></p> 
<p> </p> 
<h3 id="4.%E5%8F%8C%E7%BC%93%E5%AD%98%E7%B3%BB%E7%BB%9F%E5%92%8C%E5%A4%9ADMA%E9%80%9A%E9%81%93">4.双缓存系统和多DMA通道</h3> 
<p>论文中采用了双缓存存储系统来重叠数据载 入、数据计算、数据输出这 3 个阶段的时延，还采用了多 DMA 通道数据传输策略进一步降低传输延时。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/014f3094357f065a32a91a446de25bc0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端学习笔记1（基于Vue框架）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f19c1293754f43e19109af95b9c0312e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ddr3 端口地址 用户程序地址 例化IP地址</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>