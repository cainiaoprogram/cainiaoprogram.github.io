<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>TCP/IP协议详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="TCP/IP协议详解" />
<meta property="og:description" content="TCP/IP（Transmission Control Protocol/Internet Protocol，传输控制协议/互联网协议）是互联网的基本协议，也是国际互联网络的基础。
TCP/IP 不是指一个协议，也不是 TCP 和 IP 这两个协议的合称，而是一个协议族，包括多个网络协议，比如 IP、ICMP（Internet Control Message Protocol，互联网控制报文协议）、TCP、HTTP（Hyper Text Transfer Protocol，超文本传输协议）、FTP（File Transfer Protocol，文件传输协议）、POP3（Post Office Protocol version 3，邮局协议）等。
TCP/IP 定义了计算机操作系统如何连入互联网，以及数据传输的标准。
TCP/IP 是为了解决不同系统的计算机之间的传输通信而提出的一个标准，不同系统的计算机采用了同一种协议后，就能相互通信，从而能够建立网络连接，实现资源共享和网络通信。就像两个不同国家的人，用同一种语言就能相互交流了。
1. 协议介绍：
TCP/IP协议族包括许多协议，其中一些最重要的包括：
IP协议（Internet Protocol）： 它定义了互联网上的唯一标识符（IP地址），并负责数据包的路由和转发。
TCP协议（Transmission Control Protocol）： 提供可靠的、面向连接的数据传输。它确保数据以正确的顺序到达目标，并具有错误检测和重传机制。
UDP协议（User Datagram Protocol）： 提供无连接的、不可靠的数据传输。它用于一些实时应用程序，如音频和视频流。
ICMP协议（Internet Control Message Protocol）： 用于网络故障诊断和错误报告。
ARP协议（Address Resolution Protocol）： 用于将IP地址映射到物理MAC地址。
HTTP协议（Hypertext Transfer Protocol）： 用于在Web上传输超文本文档，是万维网的基础。
FTP协议（File Transfer Protocol）： 用于文件传输。
SMTP协议（Simple Mail Transfer Protocol）： 用于电子邮件的发送。
DNS协议（Domain Name System）： 用于将域名解析为IP地址。
2. 数据传输：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/22d5fa8aadd9b157f222456c1f903ec1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-14T09:20:41+08:00" />
<meta property="article:modified_time" content="2023-09-14T09:20:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">TCP/IP协议详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>TCP/IP（Transmission Control Protocol/Internet Protocol，传输控制协议/互联网协议）是互联网的基本协议，也是国际互联网络的基础。</p> 
<p>TCP/IP 不是指一个协议，也不是 TCP 和 IP 这两个协议的合称，而是一个协议族，包括多个网络协议，比如 IP、ICMP（Internet Control Message Protocol，互联网控制报文协议）、TCP、HTTP（Hyper Text Transfer Protocol，超文本传输协议）、FTP（File Transfer Protocol，文件传输协议）、POP3（Post Office Protocol version 3，邮局协议）等。</p> 
<p>TCP/IP 定义了计算机操作系统如何连入互联网，以及数据传输的标准。</p> 
<p>TCP/IP 是为了解决不同系统的计算机之间的传输通信而提出的一个标准，不同系统的计算机采用了同一种协议后，就能相互通信，从而能够建立网络连接，实现资源共享和网络通信。就像两个不同国家的人，用同一种语言就能相互交流了。</p> 
<p><strong>1. 协议介绍：</strong></p> 
<p>TCP/IP协议族包括许多协议，其中一些最重要的包括：</p> 
<ul><li> <p><strong>IP协议（Internet Protocol）：</strong> 它定义了互联网上的唯一标识符（IP地址），并负责数据包的路由和转发。</p> </li><li> <p><strong>TCP协议（Transmission Control Protocol）：</strong> 提供可靠的、面向连接的数据传输。它确保数据以正确的顺序到达目标，并具有错误检测和重传机制。</p> </li><li> <p><strong>UDP协议（User Datagram Protocol）：</strong> 提供无连接的、不可靠的数据传输。它用于一些实时应用程序，如音频和视频流。</p> </li><li> <p><strong>ICMP协议（Internet Control Message Protocol）：</strong> 用于网络故障诊断和错误报告。</p> </li><li> <p><strong>ARP协议（Address Resolution Protocol）：</strong> 用于将IP地址映射到物理MAC地址。</p> </li><li> <p><strong>HTTP协议（Hypertext Transfer Protocol）：</strong> 用于在Web上传输超文本文档，是万维网的基础。</p> </li><li> <p><strong>FTP协议（File Transfer Protocol）：</strong> 用于文件传输。</p> </li><li> <p><strong>SMTP协议（Simple Mail Transfer Protocol）：</strong> 用于电子邮件的发送。</p> </li><li> <p><strong>DNS协议（Domain Name System）：</strong> 用于将域名解析为IP地址。</p> </li></ul> 
<p><strong>2. 数据传输：</strong></p> 
<p>TCP/IP协议的数据传输是端到端的，意味着数据从一个端点（例如计算机）传输到另一个端点，通过一系列的中间路由器和交换机。数据被分为数据包，每个数据包包含源和目标IP地址以及端口号。</p> 
<p>数据传输过程如下：</p> 
<ul><li>发送端将数据划分为数据包，添加源IP地址、目标IP地址和端口号。</li><li>数据包从源计算机发送到目标计算机，经过中间路由器和交换机。</li><li>路由器根据目标IP地址将数据包路由到下一跳。</li><li>目标计算机接收数据包，根据端口号将数据传递给相应的应用程序。</li></ul> 
<p><strong>3. 子网和路由：</strong></p> 
<p>TCP/IP网络通常分为多个子网，每个子网有自己的IP地址范围。路由器用于连接不同的子网，负责数据包的转发。</p> 
<p><strong>4. 安全性：</strong></p> 
<p>TCP/IP协议并不特别关注安全性，因此需要额外的安全协议来确保数据的保密性和完整性。例如，SSL/TLS协议用于加密数据传输，IPSec协议用于虚拟专用网络（VPN）的安全性。</p> 
<p><strong>5.TCP/IP的分层结构：</strong></p> 
<p>TCP/IP 协议族按照层次由上到下分成 4 层，分别是应用层（Application Layer）、传输层（Transport Layer）、网络层（Internet Layer，或称网际层）和网络接口层（Network Interface Layer，或称数据链路层）。</p> 
<p>应用层包含所有的高层协议，比如 Telnet（Telecommunications Network，远程登录协议）、FTP、SMTP（Simple Mail Transfer Protocol，简单邮件传输协议）、DNS（Domain Name Service，域名服务）、NNTP（Net News Transfer Protocol，网络新闻传输协议）和 HTTP 等。Telnet 允许一台机器上的用户登录远程机器进行工作，FTP 提供将文件从一台机器上移到另一台机器上的有效方法，SMTP用于电子邮件的收发，DNS 用于把主机名映射到网络地址，NNTP 用于新闻的发布、检索和获取，HTTP 用于在 WWW 上获取主页。</p> 
<p>应用层的下面一层是传输层，著名的 TCP 和 UDP（User Datagram Protocol，用户数据报协议）就在这一层。TCP 是面向连接的协议，它提供可靠的报文传输和对上层应用的连接服务。为此，除了基本的数据传输外，它还有可靠性保证、流量控制、多路复用、优先权和安全性控制等功能。UDP 是面向无连接的不可靠传输协议，主要用于不需要TCP的排序和流量控制等功能的应用程序。</p> 
<p>传输层的下面一层是网络层，该层是整个 TCP/IP 体系结构的关键部分，其功能是使主机可以把数据报（Packet，或称为分组）发往任何网络，并使分组独立地传向目标。这些分组经由不同的网络到达的顺序和发送的顺序可能不同。网络层使用的协议有 IP。</p> 
<p>网络层的下面是数据链路层，该层是整个体系结构的基础部分，负责接收 IP 层的 IP 数据报，通过网络向外发送，或接收从网络上来的物理帧，抽出 IP 数据报，向 IP 层发送。该层是主机与网络的实际连接层。</p> 
<p>数据链路层下面就是实体线路（比如以太网络、光纤网络等）。数据链路层有以太网、令牌环网等标准，负责网卡设备的驱动、帧同步（就是从网线上检测到什么信号算作新帧的开始）、冲突检测（如果检测到冲突就自动重发）、数据差错校验等工作。交换机可以在不同的数据链路层的网络之间（比如十兆以太网和百兆以太网之间、以太网和令牌环网之间）转发数据帧，由于不同数据链路层的帧格式不同，交换机要将进来的数据报拆掉报头重新封装之后再转发。</p> 
<p>不同的协议层对数据报有不同的称谓，在传输层叫作段（Segment），在网络层叫作数据报（Datagram），在数据链路层叫作帧（Frame）。数据封装成帧后发送到传输介质上，到达目的主机后，每层协议再剥掉相应的报头，最后将应用层数据交给应用程序处理。</p> 
<p>不同层包含不同的协议，可以使用下图来表示各个协议及其所在的层。<br> <img src="https://images2.imgbox.com/96/c3/QoTLw6go_o.png" alt="在这里插入图片描述"></p> 
<p>在主机发送端，从传输层开始会把上一层的数据加上一个报头形成本层的数据，这个过程称为数据封装。在主机接收端，从最下层开始，每一层数据会去掉报头信息，该过程称为数据解封。其过程如下图所示。<br> <img src="https://images2.imgbox.com/a6/25/1v6E2JAy_o.png" alt="在这里插入图片描述"></p> 
<p>我们来看一个例子。以浏览某个网页为例，看一下浏览网页的过程中 TCP/IP 各层做了哪些工作。</p> 
<p>发送方：<br> 打开浏览器，输入网址 www.xxx.com，按回车键来访问网页，其实就是访问 Web 服务器上的网页，在应用层采用的协议是 HTTP，浏览器将网址等信息组成 HTTP 数据，并将数据传送给传输层。<br> 传输层在数据前面加上 TCP 报头，并标记端口为 80（Web 服务器的默认端口），将这个数据段给了网络层。<br> 网络层在这个数据段前面加上自己机器的 IP 和目的 IP，这时该段被称为 IP 数据报，然后将这个 IP 数据报给了数据链路层。<br> 数据链路层先在 IP 数据报前面加上自己机器的 MAC 地址以及目的 MAC 地址，加上 MAC 地址的数据称为帧，然后通过物理网卡把这个帧以比特流的方式发送到网络上。</p> 
<p>互联网上有路由器，它会读取比特流中的 IP 地址进行路由操作，到达正确的网段后，这个网段的交换机读取比特流中的 MAC 地址，从而找到要接收的对应机器。</p> 
<p>接收方：<br> 数据链路层用网卡接收到了比特流，读取比特流中的帧，将帧中的 MAC 地址去掉，就成了 IP 数据报，传递给网络层。<br> 网络层接收下层传来的 IP 数据报，将 IP 从包的前面拿掉，取出带有 TCP 的数据（数据段）交给传输层。<br> 传输层拿到了这个数据段，看到 TCP 标记的端口是 80，说明应用层协议是 HTTP，之后将 TCP 头去掉并将数据交给应用层，告诉应用层对方请求的是 HTTP 数据。<br> 应用层得知发送方请求的是 HTTP 数据，因此调用 Web 服务器程序把 www.xxx.com 的首页文件发送回去。</p> 
<p>如果两台计算机位于不同的网段中，那么数据从一台计算机到另一台计算机传输的过程中要经过一个或多个路由器，如下图所示。</p> 
<p><img src="https://images2.imgbox.com/46/20/HQPUc3Vj_o.png" alt="在这里插入图片描述"></p> 
<p>目的主机收到数据报后，如何经过各层协议栈最终到达应用程序呢？整个过程如下图所示：</p> 
<p><img src="https://images2.imgbox.com/38/eb/0wUbw57T_o.png" alt="在这里插入图片描述"></p> 
<p>以太网驱动程序首先根据以太网报头中的“上层协议”字段确定该数据帧的有效载荷（Payload，指除去协议报头之外实际传输的数据）是 IP、ARP 或 RARP 的数据报，然后交给相应的协议处理。假如是 IP 数据报，IP 再根据 IP 报头中的“上层协议”字段确定该数据报的有效载荷是 TCP、UDP、ICMP 或 IGMP，然后交给相应的协议处理。假如是 TCP 段或 UDP 段，TCP 或 UDP 再根据 TCP 报头或 UDP 报头的“端口号”字段确定应该将应用层数据交给哪个用户进程。IP 地址是标识网络中不同主机的地址，而端口号是同一台主机上标识不同进程的地址，IP 地址和端口号合起来标识网络中唯一的进程。</p> 
<p>注意，虽然 IP、ARP 和 RARP 数据报都需要以太网驱动程序来封装成帧，但是从功能上划分，ARP 和 RARP 属于数据链路层，而 IP 属于网络层。虽然 ICMP、IGMP、TCP、UDP 的数据都需要 IP 协议来封装成数据报，但是从功能上划分，ICMP、IGMP 与 IP 同属于网络层，而 TCP 和 UDP 属于传输层。</p> 
<p>上面可能讲得有点繁杂，再用一张简图来总结一下 TCP/IP 模型对数据的封装，如下图所示。<br> <img src="https://images2.imgbox.com/39/0a/W1RkJFbs_o.png" alt="在这里插入图片描述"></p> 
<p>每一层数据是由上一层数据+本层报头信息组成的，其中每一层的数据称为本层的协议数据单元（Protocol Data Unit，PDU）。<br> 应用层：用户数据在应用层中会被加密、编码传输。<br> 传输层：在传输层中，经过 TCP 封装的数据将会加上 TCP 报头，此时的 PDU 被称为 TCP 报文段，或简称为 TCP 段。经过 UDP 封装的数据将会加上 UDP 报头，此时的 PDU 被称为 UDP 报文段。该层的数据单元也可以统称为段。TCP/UDP 报头主要包含源进程端口号和目的进程端口号。<br> 网络层：经过 IP 封装的 PDU 被称为 IP 数据报，也被称为包。IP 报头主要包含源 IP 地址和目的 IP 地址，以及上层传输层协议的类型。<br> 数据链路层：在数据链路层中，PDU 被进一步封装为帧。传输媒介不同，帧的类型也不同，比如通过以太网传输的就是以太网帧，而令牌环网上传输的则是令牌环帧。以太网帧报头主要包含源 MAC 地址和目的 MAC 地址，以及帧类型（用于确定上层协议类型）。最终，帧被以比特流的形式通过物理传输介质传输给目的主机，此时数据传输的单位就是比特。</p> 
<p>当目的主机收到一个以太网数据帧时，通过匹配帧中的 MAC 地址发现目的地是本机，数据就开始在协议栈中由底向上升，同时去掉各层协议加上的报头。每层协议盒都要去检查报头中的协议标识，以确定接收数据的上层协议。</p> 
<p>总之，TCP/IP协议是互联网通信的基础，它定义了网络通信的分层结构和一组协议，允许不同的计算机在全球范围内进行通信。这个协议族的设计使得它非常灵活，适用于各种应用和网络环境。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c0e71d5851e7d419d6780c7adbabd1c3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">QT QAxWidget控件 使用详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bdb45e8531bf969fe959a600fad07224/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">KJ2201X1-BA1 12P3162C092 SLS1508 VS3202逻辑运算器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>