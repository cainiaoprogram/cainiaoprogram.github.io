<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python的界面神器Streamlit初使用,一个漂亮的界面有多简单,超乎想象 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python的界面神器Streamlit初使用,一个漂亮的界面有多简单,超乎想象" />
<meta property="og:description" content="Python的界面神器Streamlit初使用,一个漂亮的界面有多简单,超乎想象 废话不多说,直接上干货
首先安装好所需要的库 pip install streamlit 新建一个 Python 文件(test.py)，导入所需要的库， import streamlit as st import pandas as pd 打开命令，行输入命令， streamlit run test.py 启动服务，可以看到输出信息证明已经成功启动了一个服务，浏览器会自动打开这个地址。
现在页面什么东西都没有，加一句代码，打印一些文字
import streamlit as st import pandas as pd st.text(&#34;走过路过不要错过&#34;) 保存文件，此时页面右上角出现了一些选项按钮，选择总是返回，回到代码修改内容，现在页面可以自动刷新了。
接下来添加一个文件上传的组件参数type，指定接受的文件后缀名可以指定多种文件类型，所以是一个列表函数返回的是一个文件对象。我们可以直接使用 Pandas 读取数据，然后试试输出到界面上，这里有一个快捷方式，直接把变量 df写在这里，就会在界面上显示成一个表格。不过保存文件后发现页面出现报错信息。
uploaded_file = st.file_uploader(&#39;excel文件&#39;,type=[&#39;xlsx&#39;]) df = pd.read_excel(uploaded_file) st.dataframe(df) streamlit每次页面更新都会执行一遍代码，我们还没有选择任何文件，所以文件上传组件的函数返回了一个None，到了 Pandas 加载数据就会报错。
这里要划重点了。 streamlit与其他框架非常不一样的地方就在于，我们写的代码就像一个描述了整个界面的文档， streamlit 每次都要从头到尾执行一次，才能知道画面上应该描绘出哪些内容。因此每当调用一个组件函数，就要注意判断空的情况。这里在上传组件函数之后，判断返回的文件对象是否有东西。这里有一个技巧，逻辑，尽可能描述空的情况下，然后跳出执行有专门的函数 stop 做这个事情，这样可以避免我们的代码出现大量的判断嵌套。
uploaded_file= st.file_uploader(&#39;excel文件&#39;,type=[&#39;xlsx&#39;]) if uploaded_file is None: st.stop() 选择一个文件看看效果，可以正常显示。接着我们让 Pandas 一次性加载所有的工作表，不需要直接显示数据，而是做一个下拉列表框，让用户选择工作表名字，看看页面效果。
为了让大家更好理解其过程，我们再次分解其显示过程。第一次执行时，上传文件组件函数由于没有选择任何文件，所以返回了none，从而在下面的判断中执行了stop。因此这次执行只收集到上传文件组件的描绘，页面只显示这个组件。在页面上点击组件，选择了一个文件，页面上的上传文件组件数据有了变化，于是页面通知后台重新执行一遍代码，同时页面把上传文件组件的文件数据返回给后台，代码开始重新执行第一句代码时，函数返回了页面给的文件数据，因此函数有了返回值，不再是None。后续的创建，下拉选择框的代码也顺利被执行。本次执行结果收集到两个组件的创建信息，所以页面上创建了下拉框。接下来使用多选下拉框函数返回的列表创建页签，每个页签内创建表格即可。千万别忘了，如果没有选择任何工作表，要提前跳出执行看看，效果，很不错。
dfs=pd.read_excel(uploaded_file,None) names = list(dfs.keys()) sheet_selected = st." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6245e7602215eb70cb4e21ed35935405/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-10T17:40:58+08:00" />
<meta property="article:modified_time" content="2023-04-10T17:40:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python的界面神器Streamlit初使用,一个漂亮的界面有多简单,超乎想象</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Python的界面神器Streamlit初使用,一个漂亮的界面有多简单,超乎想象</h4> 
</div> 
<p></p> 
<p>废话不多说,直接上干货</p> 
<ol><li>首先安装好所需要的库</li></ol> 
<pre><code class="prism language-python">pip install streamlit
</code></pre> 
<ol start="2"><li>新建一个 Python 文件(test.py)，导入所需要的库，</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> streamlit <span class="token keyword">as</span> st
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</code></pre> 
<ol start="3"><li>打开命令，行输入命令，</li></ol> 
<pre><code class="prism language-python">streamlit run test<span class="token punctuation">.</span>py
</code></pre> 
<p><img src="https://images2.imgbox.com/3d/75/Zh3vMWXe_o.png" alt="在这里插入图片描述"></p> 
<ol start="4"><li> <p>启动服务，可以看到输出信息证明已经成功启动了一个服务，浏览器会自动打开这个地址。<br> <img src="https://images2.imgbox.com/10/dd/KgW5zrhC_o.png" alt="在这里插入图片描述"></p> </li><li> <p>现在页面什么东西都没有，加一句代码，打印一些文字</p> </li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> streamlit <span class="token keyword">as</span> st
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
st<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token string">"走过路过不要错过"</span><span class="token punctuation">)</span>
</code></pre> 
<p>保存文件，此时页面右上角出现了一些选项按钮，选择总是返回，回到代码修改内容，现在页面可以自动刷新了。<br> <img src="https://images2.imgbox.com/96/52/mPGwyaPo_o.png" alt="在这里插入图片描述"></p> 
<ol start="6"><li></ol> 
<p>接下来添加一个文件上传的组件参数type，指定接受的文件后缀名可以指定多种文件类型，所以是一个列表函数返回的是一个文件对象。我们可以直接使用 Pandas 读取数据，然后试试输出到界面上，这里有一个快捷方式，直接把变量 df写在这里，就会在界面上显示成一个表格。不过保存文件后发现页面出现报错信息。</p> 
<pre><code class="prism language-python">uploaded_file <span class="token operator">=</span> st<span class="token punctuation">.</span>file_uploader<span class="token punctuation">(</span><span class="token string">'excel文件'</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'xlsx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>uploaded_file<span class="token punctuation">)</span>
st<span class="token punctuation">.</span>dataframe<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1a/ce/qw5Hzrl1_o.png" alt="在这里插入图片描述"><br> streamlit每次页面更新都会执行一遍代码，我们还没有选择任何文件，所以文件上传组件的函数返回了一个None，到了 Pandas 加载数据就会报错。<br> <img src="https://images2.imgbox.com/56/39/dyIRhIZP_o.png" alt="在这里插入图片描述"></p> 
<p>这里要划重点了。 streamlit与其他框架非常不一样的地方就在于，我们写的代码就像一个描述了整个界面的文档， streamlit 每次都要从头到尾执行一次，才能知道画面上应该描绘出哪些内容。因此每当调用一个组件函数，就要注意判断空的情况。这里在上传组件函数之后，判断返回的文件对象是否有东西。这里有一个技巧，逻辑，尽可能描述空的情况下，然后跳出执行有专门的函数 stop 做这个事情，这样可以避免我们的代码出现大量的判断嵌套。</p> 
<pre><code class="prism language-python">uploaded_file<span class="token operator">=</span> st<span class="token punctuation">.</span>file_uploader<span class="token punctuation">(</span><span class="token string">'excel文件'</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'xlsx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> uploaded_file <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    st<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/13/14/9Ix3BDB8_o.png" alt="在这里插入图片描述"></p> 
<p>选择一个文件看看效果，可以正常显示。接着我们让 Pandas 一次性加载所有的工作表，不需要直接显示数据，而是做一个下拉列表框，让用户选择工作表名字，看看页面效果。<br> <img src="https://images2.imgbox.com/27/9e/MDmIy3l9_o.png" alt="在这里插入图片描述"><br> 为了让大家更好理解其过程，我们再次分解其显示过程。第一次执行时，上传文件组件函数由于没有选择任何文件，所以返回了none，从而在下面的判断中执行了stop。因此这次执行只收集到上传文件组件的描绘，页面只显示这个组件。在页面上点击组件，选择了一个文件，页面上的上传文件组件数据有了变化，于是页面通知后台重新执行一遍代码，同时页面把上传文件组件的文件数据返回给后台，代码开始重新执行第一句代码时，函数返回了页面给的文件数据，因此函数有了返回值，不再是None。后续的创建，下拉选择框的代码也顺利被执行。本次执行结果收集到两个组件的创建信息，所以页面上创建了下拉框。接下来使用多选下拉框函数返回的列表创建页签，每个页签内创建表格即可。千万别忘了，如果没有选择任何工作表，要提前跳出执行看看，效果，很不错。</p> 
<pre><code class="prism language-python">dfs<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>uploaded_file<span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dfs<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sheet_selected <span class="token operator">=</span> st<span class="token punctuation">.</span>multiselect<span class="token punctuation">(</span><span class="token string">'工作表'</span><span class="token punctuation">,</span>names<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sheet_selected<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
    st<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
tabs <span class="token operator">=</span> st<span class="token punctuation">.</span>tabs<span class="token punctuation">(</span>sheet_selected<span class="token punctuation">)</span>
<span class="token keyword">for</span> tab<span class="token punctuation">,</span>name <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>tabs<span class="token punctuation">,</span>sheet_selected<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> tab<span class="token punctuation">:</span>
        df <span class="token operator">=</span> dfs<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
        st<span class="token punctuation">.</span>dataframe<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>根据streamlit的更新规则,不管页面上的任何组件有变化,整个代码都会被重新执行,那就意味着意味着 Pandas 加载数据的代码会被重复执行很多次。实际上数据文件根本没有变化，有没有什么办法可以让它只在我们重新选择其他文件的时候才执行？加载数据？方法很简单，独定义一个函数，接收文件对象，函数里面就是 Pandas 加载数据的代码，然后在函数上方打上装饰器，表明这是一个缓存函数，为了证明其缓存函数生效，我们在函数里面打印内容，到控制台。</p> 
<pre><code class="prism language-python"><span class="token decorator annotation punctuation">@st<span class="token punctuation">.</span>cache_data</span>
<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在执行加载数据......"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
dfs<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>uploaded_file<span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dfs<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sheet_selected <span class="token operator">=</span> st<span class="token punctuation">.</span>multiselect<span class="token punctuation">(</span><span class="token string">'工作表'</span><span class="token punctuation">,</span>names<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sheet_selected<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
    st<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>
tabs <span class="token operator">=</span> st<span class="token punctuation">.</span>tabs<span class="token punctuation">(</span>sheet_selected<span class="token punctuation">)</span>
<span class="token keyword">for</span> tab<span class="token punctuation">,</span>name <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>tabs<span class="token punctuation">,</span>sheet_selected<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> tab<span class="token punctuation">:</span>
        df <span class="token operator">=</span> dfs<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
        st<span class="token punctuation">.</span>dataframe<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f84ee1de6542dd4433b86e6afc4827fb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android开发之截图当前view并保存到相册的标准姿势</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c6acd62296011e8494bfb274a5e6086f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LSTM 易用代码 (pytorch)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>