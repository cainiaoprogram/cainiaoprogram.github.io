<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Wargames与bash知识09 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Wargames与bash知识09" />
<meta property="og:description" content="Wargames与bash知识09 Bandit Level 16 关卡提示：
扫描服务器localhost（本地主机上）31000到32000范围内的端口，找出使用SSL唯一端口，将本级密码发送给这个端口获取下一级凭据。只有一个端口会提供下一个凭据，其他服务器只需将您发送给它的任何内容发送回您。
推荐命令：
ssh, telnet, nc, openssl, s_client, nmap
nc和nmap都可以扫描端口，前面已经谈过nc命令，让我们看看大名鼎鼎nmap命令：
Nmap简介 Nmap，也就是Network Mapper，是Linux下的网络扫描和嗅探工具包。它由Fyodor编写并维护。由于Nmap品质卓越，使用灵活，它已经是渗透测试人员必备的工具。
其基本功能有三个：
（1）是扫描主机端口，嗅探所提供的网络服务
（2）是探测一组主机是否在线
（3）还可以推断主机所用的操作系统，到达主机经过的路由，系统已开放端口的软件版本
Nmap命令常用格式 Nmap常用参数
1.执行快速扫描
使用以下参数可加快扫描速度：
-sS：TCP SYN 扫描；
-sT：TCP Connect 扫描；
-sU：UDP 扫描；
-T0～T5：设置不同级别的时间延迟。
2.隐藏IP地址 使用以下参数可隐藏源IP地址：
-S：指定源IP地址；
-D：伪装成其他IP地址。 l
3.指定端口范围 使用以下参数可指定端口范围：
-p：指定单个端口或端口范围；
–top-ports：指定前n个常见端口。
4.指定输出格式 使用以下参数可指定输出格式：
-oA：同时输出到三个文件（XML、nmap、grepable）中；
-oX：XML 格式输出； -oG：grepable 格式输出；
-oN：普通文本格式输出。
Nmap演示 尝试使用本地端机扫描失败：
gyj@guyanjun:~$ nmap bandit.labs.overthewire.org Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-05 09:38 CST Note: Host seems down." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2ffb5416f30bbd4b336b71e32221c487/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T13:54:56+08:00" />
<meta property="article:modified_time" content="2024-01-05T13:54:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Wargames与bash知识09</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Wargamesbash09_0"></a>Wargames与bash知识09</h3> 
<h3><a id="Bandit_Level_16_2"></a>Bandit Level 16</h3> 
<p>关卡提示：<br> 扫描服务器localhost（本地主机上）31000到32000范围内的端口，找出使用SSL唯一端口，将本级密码发送给这个端口获取下一级凭据。只有一个端口会提供下一个凭据，其他服务器只需将您发送给它的任何内容发送回您。<br> 推荐命令：<br> ssh, telnet, nc, openssl, s_client, nmap<br> nc和nmap都可以扫描端口，前面已经谈过nc命令，让我们看看大名鼎鼎nmap命令：</p> 
<h3><a id="Nmap_10"></a>Nmap简介</h3> 
<p>Nmap，也就是Network Mapper，是Linux下的网络扫描和嗅探工具包。它由Fyodor编写并维护。由于Nmap品质卓越，使用灵活，它已经是渗透测试人员必备的工具。</p> 
<p>其基本功能有三个：</p> 
<p>（1）是扫描主机端口，嗅探所提供的网络服务</p> 
<p>（2）是探测一组主机是否在线</p> 
<p>（3）还可以推断主机所用的操作系统，到达主机经过的路由，系统已开放端口的软件版本</p> 
<h3><a id="Nmap_22"></a>Nmap命令常用格式</h3> 
<p>Nmap常用参数<br> 1.执行快速扫描<br> 使用以下参数可加快扫描速度：<br> -sS：TCP SYN 扫描；<br> -sT：TCP Connect 扫描；<br> -sU：UDP 扫描；<br> -T0～T5：设置不同级别的时间延迟。<br> 2.隐藏IP地址 使用以下参数可隐藏源IP地址：<br> -S：指定源IP地址；<br> -D：伪装成其他IP地址。 l<br> 3.指定端口范围 使用以下参数可指定端口范围：<br> -p：指定单个端口或端口范围；<br> –top-ports：指定前n个常见端口。<br> 4.指定输出格式 使用以下参数可指定输出格式：<br> -oA：同时输出到三个文件（XML、nmap、grepable）中；<br> -oX：XML 格式输出； -oG：grepable 格式输出；<br> -oN：普通文本格式输出。</p> 
<h3><a id="Nmap_43"></a>Nmap演示</h3> 
<p>尝试使用本地端机扫描失败：</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ nmap bandit.labs.overthewire.org
Starting Nmap <span class="token number">7.94</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 09:38 CST
Note: Host seems down. If it is really up, but blocking our <span class="token function">ping</span> probes, try <span class="token parameter variable">-Pn</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">0</span> hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">3.50</span> seconds
gyj@guyanjun:~$ nmap <span class="token parameter variable">-pn</span> bandit.labs.overthewire.org <span class="token number">31000</span>-32000
Starting Nmap <span class="token number">7.94</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 09:40 CST
段错误
gyj@guyanjun:~$ nmap <span class="token parameter variable">-pn</span> <span class="token number">30000</span> bandit.labs.overthewire.org
Starting Nmap <span class="token number">7.94</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 09:42 CST
段错误
</code></pre> 
<p>为了验证，使用nmap扫描局域网其他机器正常</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ nmap <span class="token number">192.168</span>.0.102
Starting Nmap <span class="token number">7.94</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 09:43 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.0.102
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.071s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">997</span> closed tcp ports <span class="token punctuation">(</span>conn-refused<span class="token punctuation">)</span>
PORT    STATE SERVICE
<span class="token number">22</span>/tcp  <span class="token function">open</span>  <span class="token function">ssh</span>
<span class="token number">139</span>/tcp <span class="token function">open</span>  netbios-ssn
<span class="token number">445</span>/tcp <span class="token function">open</span>  microsoft-ds
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">2.20</span> seconds

Nmap扫描一个网段<span class="token variable"><span class="token variable">`</span>

<span class="token variable">`</span></span>``bash
gyj@guyanjun:~$ nmap <span class="token number">192.168</span>.0.*
Starting Nmap <span class="token number">7.94</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 09:46 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.0.1
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0021s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">997</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>
PORT     STATE  SERVICE
<span class="token number">80</span>/tcp   <span class="token function">open</span>   http
<span class="token number">1900</span>/tcp <span class="token function">open</span>   upnp
<span class="token number">2004</span>/tcp closed mailbox
</code></pre> 
<pre><code class="prism language-bash">Nmap scan report <span class="token keyword">for</span> <span class="token number">192.168</span>.0.102
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.0013s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">997</span> closed tcp ports <span class="token punctuation">(</span>conn-refused<span class="token punctuation">)</span>
PORT    STATE SERVICE
<span class="token number">22</span>/tcp  <span class="token function">open</span>  <span class="token function">ssh</span>
<span class="token number">139</span>/tcp <span class="token function">open</span>  netbios-ssn
<span class="token number">445</span>/tcp <span class="token function">open</span>  microsoft-ds
Nmap done: <span class="token number">256</span> IP addresses <span class="token punctuation">(</span><span class="token number">2</span> hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">8.22</span> seconds
</code></pre> 
<pre><code>
## 开始解题

ls -al 发现bandit15的密码文件：.bandit15.password

```bash
bandit16@bandit:~$ ls -al
total 24
drwxr-xr-x  2 root     root     4096 Oct  5 06:19 .
drwxr-xr-x 70 root     root     4096 Oct  5 06:20 ..
-rw-r-----  1 bandit16 bandit16   33 Oct  5 06:19 .bandit15.password
-rw-r--r--  1 root     root      220 Jan  6  2022 .bash_logout
-rw-r--r--  1 root     root     3771 Jan  6  2022 .bashrc
-rw-r--r--  1 root     root      807 Jan  6  2022 .profile
bandit16@bandit:~$ cat .bandit15.password
jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt
bandit16@bandit:~$
</code></pre> 
<p>插曲1：nc 扫描的输出是STDERR（文件描述符2），而非STDOUT，在将nc的输出传入管道时然后使用grep过滤会得不到结果。</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">nc</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-z</span> localhost <span class="token number">31040</span>-31050 <span class="token operator">|</span>  <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">"succeeded!"</span>
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31040</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31041</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31042</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31043</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31044</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31045</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31046</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31047</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31048</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31049</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
nc: connect to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> port <span class="token number">31050</span> <span class="token punctuation">(</span>tcp<span class="token punctuation">)</span> failed: Connection refused
</code></pre> 
<p>验证nc的输出为STDERR</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">nc</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-z</span> localhost <span class="token number">31000</span>-32000 <span class="token operator"><span class="token file-descriptor important">2</span>&gt;&gt;</span>/tmp/nc_1
bandit16@bandit:~$ <span class="token function">grep</span> <span class="token string">"succ"</span> /tmp/nc_1
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31046</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31518</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31691</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31790</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31960</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
</code></pre> 
<p>将nc输出到管道要使用“|&amp;”</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">nc</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-z</span> localhost <span class="token number">31000</span>-32000 <span class="token operator">|&amp;</span>  <span class="token function">grep</span> <span class="token parameter variable">-E</span> <span class="token string">"succeeded!"</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31046</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31518</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31691</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31790</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31960</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
bandit16@bandit:~$
</code></pre> 
<p>插曲2：服务器资源紧张导致卡顿。可能这个服务器有自动恢复机制，需要等一会再试。</p> 
<p><img src="https://images2.imgbox.com/6d/fe/Jk38tb2E_o.png" alt="在这里插入图片描述"></p> 
<p>Nmap 扫描服务器开放端口</p> 
<pre><code class="prism language-bash">pbandit16@bandit:~$ nmap <span class="token parameter variable">-p</span> <span class="token number">31000</span>-32000 localhost
Starting Nmap <span class="token number">7.80</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 02:27 UTC
Nmap scan report <span class="token keyword">for</span> localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00016s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">996</span> closed ports
PORT      STATE SERVICE
<span class="token number">31046</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">31518</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">31691</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">31790</span>/tcp <span class="token function">open</span>  unknown
<span class="token number">31960</span>/tcp <span class="token function">open</span>  unknown
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">0.08</span> seconds
</code></pre> 
<p>Nc扫描服务器开放端口</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">nc</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-z</span> localhost <span class="token number">31000</span>-32000 <span class="token operator">|&amp;</span> <span class="token function">grep</span> <span class="token string">"succee"</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31046</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31518</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31691</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31790</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
Connection to localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span> <span class="token number">31960</span> port <span class="token punctuation">[</span>tcp/*<span class="token punctuation">]</span> succeeded<span class="token operator">!</span>
bandit16@bandit:~$ nmap <span class="token parameter variable">-sV</span> <span class="token number">31046</span> <span class="token number">31518</span> <span class="token number">31691</span> <span class="token number">31790</span> <span class="token number">31960</span> localhost
Starting Nmap <span class="token number">7.80</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 02:32 UTC
</code></pre> 
<p>Nmap扫描端口的服务。很慢需要耐心等待</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ nmap <span class="token parameter variable">-sV</span> <span class="token number">31046,31518</span>,31691,31790,31960 localhost
Starting Nmap <span class="token number">7.80</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 02:34 UTC
Failed to resolve <span class="token string">"31046,31518,31691,31790,31960"</span><span class="token builtin class-name">.</span>

bandit16@bandit:~$ nmap <span class="token parameter variable">-sV</span> <span class="token parameter variable">-p</span> <span class="token number">31046,31518</span>,31691,31790,31960 localhost
Starting Nmap <span class="token number">7.80</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2024</span>-01-05 02:35 UTC
Stats: <span class="token number">0</span>:00:58 elapsed<span class="token punctuation">;</span> <span class="token number">0</span> hosts completed <span class="token punctuation">(</span><span class="token number">1</span> up<span class="token punctuation">)</span>, <span class="token number">1</span> undergoing Service Scan
Service scan Timing: About <span class="token number">80.00</span>% <span class="token keyword">done</span><span class="token punctuation">;</span> ETC: 02:36 <span class="token punctuation">(</span><span class="token number">0</span>:00:15 remaining<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> localhost <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.00085s latency<span class="token punctuation">)</span>.

PORT      STATE SERVICE     VERSION
<span class="token number">31046</span>/tcp <span class="token function">open</span>  <span class="token builtin class-name">echo</span>
<span class="token number">31518</span>/tcp <span class="token function">open</span>  ssl/echo
<span class="token number">31691</span>/tcp <span class="token function">open</span>  <span class="token builtin class-name">echo</span>
<span class="token number">31790</span>/tcp <span class="token function">open</span>  ssl/unknown
<span class="token number">31960</span>/tcp <span class="token function">open</span>  <span class="token builtin class-name">echo</span>
 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.省略部分输出
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">99.33</span> seconds
</code></pre> 
<p>openssl s_client 尝试端口31518</p> 
<pre><code class="prism language-bash">bandit16@bandit:~<span class="token variable">$bandit16</span>@bandit:~$ openssl s_client <span class="token parameter variable">-connect</span> localhost:31518
CONNECTED<span class="token punctuation">(</span>00000003<span class="token punctuation">)</span>
Can't use SSL_get_servername
 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.   省略输出
  rtificate has expired<span class="token punctuation">)</span>
    Extended master secret: no
    Max Early Data: <span class="token number">0</span>
---
<span class="token builtin class-name">read</span> R BLOCK
JQttfApK4SeyHwDlI9SXGR50qclOAil1
JQttfApK4SeyHwDlI9SXGR50qclOAil1
^C
</code></pre> 
<p>返回结果为输入结果， 排除此端口。</p> 
<p>尝试端口31790</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ openssl s_client <span class="token parameter variable">-connect</span> localhost:31790
CONNECTED<span class="token punctuation">(</span>00000003<span class="token punctuation">)</span>
Can't use SSL_get_servername
<span class="token assign-left variable">depth</span><span class="token operator">=</span><span class="token number">0</span> CN <span class="token operator">=</span> localhost
verify error:num<span class="token operator">=</span><span class="token number">18</span>:self-signed certificate
verify return:1
 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span> 省略输出
    Extended master secret: no
    Max Early Data: <span class="token number">0</span>
---
<span class="token builtin class-name">read</span> R BLOCK
JQttfApK4SeyHwDlI9SXGR50qclOAil1
Correct<span class="token operator">!</span>
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY<span class="token operator">=</span>
-----END RSA PRIVATE KEY-----

closed
</code></pre> 
<p>得到一个眼熟的东东，应该是个私钥吧。我查很多资料，好像没有办法将上面的私钥内容保存到一个文件中，我尝试了重定向和tee命令均没有实现。好在终端MobaXterm支持使用鼠标选取复制，不然把这些字符全部输入一个文件几乎是一个不可能完成的任务。</p> 
<p>使用nano编辑文件/tmp/gyj16/aa，将上面内容粘贴。</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">nano</span> /tmp/gyj16/aa
Unable to create directory /home/bandit16/.local/share/nano/: No such <span class="token function">file</span> or directory
It is required <span class="token keyword">for</span> saving/loading search <span class="token function">history</span> or cursor positions.
</code></pre> 
<p>尝试使用私钥登录bandit17用户</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">ssh</span> <span class="token parameter variable">-i</span> /tmp/gyj16/aa <span class="token parameter variable">-l</span> bandit17 localhost <span class="token number">2220</span>
The authenticity of <span class="token function">host</span> <span class="token string">'localhost (127.0.0.1)'</span> can<span class="token string">'t be established.
......
Permissions 0664 for '</span>/tmp/gyj16/aa' are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key <span class="token string">"/tmp/gyj16/aa"</span><span class="token builtin class-name">:</span> bad permissions
bandit17@localhost: Permission denied <span class="token punctuation">(</span>publickey<span class="token punctuation">)</span>.
bandit16@bandit:~$
</code></pre> 
<p>登录失败，提示/tmp/gyj16/aa权限太大，不能保证私钥安全</p> 
<pre><code class="prism language-bash">bandit16@bandit:/tmp/gyj16$ <span class="token function">chmod</span> <span class="token number">400</span> aa
</code></pre> 
<p>再次登录</p> 
<pre><code class="prism language-bash">bandit16@bandit:~$ <span class="token function">ssh</span> <span class="token parameter variable">-i</span> /tmp/gyj16/aa <span class="token parameter variable">-p</span> <span class="token number">2220</span> <span class="token parameter variable">-l</span> bandit17 localhost
<span class="token punctuation">..</span><span class="token punctuation">..</span>.                         _                     _ _ _
                        <span class="token operator">|</span> <span class="token operator">|</span>__   __ _ _ __   __<span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">|</span>_
                        <span class="token operator">|</span> <span class="token string">'_ \ / _` | '</span>_ <span class="token punctuation">\</span> / _` <span class="token operator">|</span> <span class="token operator">|</span> __<span class="token operator">|</span>
                        <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>_
                        <span class="token operator">|</span>_.__/ <span class="token punctuation">\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>__<span class="token operator">|</span>


<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> 
<p>这个套路有点熟悉：在/etc/bandit_pass找到密码</p> 
<pre><code class="prism language-bash">bandit17@bandit:/etc/bandit_pass$ <span class="token function">cat</span> banndit17
cat: banndit17: No such <span class="token function">file</span> or directory
bandit17@bandit:/etc/bandit_pass$ <span class="token function">cat</span> bandit17
VwOSWtCA7lRKkTfbr2IDh6awj9RNZM5e
</code></pre> 
<p>Bandit17家目录找到.bandit16.password</p> 
<pre><code class="prism language-bash">bandit17@bandit:/etc/bandit_pass$ <span class="token builtin class-name">cd</span> ~
bandit17@bandit:~$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">36</span>
drwxr-xr-x  <span class="token number">3</span> root     root     <span class="token number">4096</span> Oct  <span class="token number">5</span> 06:19 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">70</span> root     root     <span class="token number">4096</span> Oct  <span class="token number">5</span> 06:20 <span class="token punctuation">..</span>
-rw-r-----  <span class="token number">1</span> bandit17 bandit17   <span class="token number">33</span> Oct  <span class="token number">5</span> 06:19 .bandit16.password
-rw-r--r--  <span class="token number">1</span> root     root      <span class="token number">220</span> Jan  <span class="token number">6</span>  <span class="token number">2022</span> .bash_logout
-rw-r--r--  <span class="token number">1</span> root     root     <span class="token number">3771</span> Jan  <span class="token number">6</span>  <span class="token number">2022</span> .bashrc
-rw-r-----  <span class="token number">1</span> bandit18 bandit17 <span class="token number">3300</span> Oct  <span class="token number">5</span> 06:19 passwords.new
-rw-r-----  <span class="token number">1</span> bandit18 bandit17 <span class="token number">3300</span> Oct  <span class="token number">5</span> 06:19 passwords.old
-rw-r--r--  <span class="token number">1</span> root     root      <span class="token number">807</span> Jan  <span class="token number">6</span>  <span class="token number">2022</span> .profile
drwxr-xr-x  <span class="token number">2</span> root     root     <span class="token number">4096</span> Oct  <span class="token number">5</span> 06:19 .ssh
bandit17@bandit:~$ <span class="token function">cat</span> .bandit16.password
JQttfApK4SeyHwDlI9SXGR50qclOAil1
</code></pre> 
<p>查看.ssh目录：cat authorized_keys为公钥文件，id_rsa为私钥文件。</p> 
<pre><code class="prism language-bash">bandit17@bandit:~$ <span class="token builtin class-name">cd</span> .ssh
bandit17@bandit:~/.ssh$ <span class="token function">ls</span>
authorized_keys  id_rsa
bandit17@bandit:~/.ssh$ <span class="token function">ls</span> <span class="token parameter variable">-al</span>
total <span class="token number">16</span>
drwxr-xr-x <span class="token number">2</span> root     root     <span class="token number">4096</span> Oct  <span class="token number">5</span> 06:19 <span class="token builtin class-name">.</span>
drwxr-xr-x <span class="token number">3</span> root     root     <span class="token number">4096</span> Oct  <span class="token number">5</span> 06:19 <span class="token punctuation">..</span>
-rw-r----- <span class="token number">1</span> bandit17 bandit17  <span class="token number">396</span> Oct  <span class="token number">5</span> 06:19 authorized_keys
-rw-r----- <span class="token number">1</span> bandit17 bandit17 <span class="token number">1675</span> Oct  <span class="token number">5</span> 06:19 id_rsa
bandit17@bandit:~/.ssh$ <span class="token function">cat</span> id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY<span class="token operator">=</span>
-----END RSA PRIVATE KEY-----
bandit17@bandit:~/.ssh$ <span class="token function">cat</span> authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC+Y6S6J+YyDocvZg8g6OifqJZ9untzePHfhiRhapQfntJR3ImKZnN7IYLSC1k8a6NRLGIlJYj+hOp7GH5wAxNIyU4l/v4Gsk5sCufF31jthPZtE9AlrovNvnnxhbcVmXzs5GI76tbgsIMI13aVS8sT8YvYZbK4o3QrmIJ3lNu0nMSRBO4NK3aZw2fiuEAv4kWvnqjhPrPxZYBbXwFHrIasyrtD+QAsdhbc56R49ADMvRVRhtYkZOLrkLFsKfNz/Dj6apDK+bOla0wDMlPMDNDE1uRHYwEbJLEMuuODQtY3qwrvA1fHRhXO3P/NsiQ+N+RTWMdL70RtU2P4PVcU4m5p rudy@localhost
bandit17@bandit:~/.ssh$
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1eab1ce0bc5f762d1067756931a51830/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">copilot插件使用介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31f3f077270c04959cfe66354df33dfd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">记一次RabbitMQ服务器异常断电之后，服务重启异常的处理过程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>