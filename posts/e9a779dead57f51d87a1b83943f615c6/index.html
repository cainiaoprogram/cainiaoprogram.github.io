<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql中的find_in_set() 函数用法详解及使用场景 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mysql中的find_in_set() 函数用法详解及使用场景" />
<meta property="og:description" content="一、find_in_set() 函数详解
示例：
select FIND_IN_SET(&#39;1&#39;, &#39;1,2,3&#39;); // 结果：1 select FIND_IN_SET(&#39;3&#39;, &#39;1,2,3&#39;); // 结果：3 select FIND_IN_SET(&#39;4&#39;, &#39;1,2,3&#39;); // 结果：0 // 后一个包含前一个返回大于0的元素所在位置,不包含前一个则返回0 相信大家看完以上示例就知道这个函数的大概作用了，以下是MySQL手册中官方说明
FIND_IN_SET(str,strlist)，该函数的作用是查询字段(strlist)中是否包含(str)的结果， 返回结果为null或记录 。 str 要查询的字符串 strlist 需查询的字段，参数以”,”分隔，例如如 &#39;1,2,3&#39; 假如字符串str在由N个子链组成的字符串列表strlist 中，则返回值的范围在 1 到 N 之间。 一个字符串列表 就是一个由一些被’,‘ 符号分开的子链组成的字符串。如果第一个参数是一个常数字符串，而第二个是type SET列， 则FIND_IN_SET() 函数被优化，使用比特计算。 如果str不在strlist 或strlist 为空字符串，则返回值为 0 。 如任意一个参数为NULL，则返回值为 NULL。 这个函数在第一个参数包含一个逗号( , )时将无法正常运行。 概括一下就是（前一个字符串是A，后一个字符串是B）：
如果B字符串包含A字符串：则返回大于0的值，这个值就是A字符串在B字符串的所在位置；
如果B字符串不包含A字符串：则返回0；
如果B字符串或者A字符串有任意一个是null，则返回null；
如果A字符串包含逗号，则无法执行。
二、应用场景
就拿若依的权限认证的其中一条sql来给大家举例吧：
SELECT dept_id, parent_id, ancestors, order_num, leader, phone FROM sys_dept WHERE dept_id = 101 or FIND_IN_SET(101, ancestors) ; 查询结果：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/e9a779dead57f51d87a1b83943f615c6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-19T19:50:22+08:00" />
<meta property="article:modified_time" content="2022-12-19T19:50:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql中的find_in_set() 函数用法详解及使用场景</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-kimbie-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>一、find_in_set() 函数详解<br> 示例：</p> 
<pre><code class="prism language-xml">select FIND_IN_SET('1', '1,2,3');
// 结果：1
select FIND_IN_SET('3', '1,2,3');
// 结果：3
select FIND_IN_SET('4', '1,2,3');
// 结果：0
// 后一个包含前一个返回大于0的元素所在位置,不包含前一个则返回0
</code></pre> 
<p>相信大家看完以上示例就知道这个函数的大概作用了，以下是MySQL手册中官方说明</p> 
<pre><code class="prism language-kotlin"><span class="token function">FIND_IN_SET</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>strlist<span class="token punctuation">)</span>，该函数的作用是查询字段<span class="token punctuation">(</span>strlist<span class="token punctuation">)</span>中是否包含<span class="token punctuation">(</span>str<span class="token punctuation">)</span>的结果，
返回结果为<span class="token keyword">null</span>或记录 。

str 要查询的字符串
strlist 需查询的字段，参数以”<span class="token punctuation">,</span>”分隔，例如如 '<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span>'
假如字符串str在由N个子链组成的字符串列表strlist 中，则返回值的范围在 <span class="token number">1</span> 到 N 之间。 一个字符串列表
就是一个由一些被’<span class="token punctuation">,</span>‘ 符号分开的子链组成的字符串。如果第一个参数是一个常数字符串，而第二个是type SET列，
则<span class="token function">FIND_IN_SET</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 函数被优化，使用比特计算。 
如果str不在strlist 或strlist 为空字符串，则返回值为 <span class="token number">0</span> 。
如任意一个参数为NULL，则返回值为 NULL。
这个函数在第一个参数包含一个逗号<span class="token punctuation">(</span> <span class="token punctuation">,</span> <span class="token punctuation">)</span>时将无法正常运行。
</code></pre> 
<p>概括一下就是（前一个字符串是A，后一个字符串是B）：<br> 如果B字符串包含A字符串：则返回大于0的值，这个值就是A字符串在B字符串的所在位置；<br> 如果B字符串不包含A字符串：则返回0；<br> 如果B字符串或者A字符串有任意一个是null，则返回null；<br> 如果A字符串包含逗号，则无法执行。</p> 
<p>二、应用场景<br> 就拿若依的权限认证的其中一条sql来给大家举例吧：</p> 
<pre><code class="prism language-java"><span class="token class-name">SELECT</span> dept_id<span class="token punctuation">,</span> parent_id<span class="token punctuation">,</span> ancestors<span class="token punctuation">,</span> order_num<span class="token punctuation">,</span> leader<span class="token punctuation">,</span> phone <span class="token constant">FROM</span> sys_dept 
<span class="token class-name">WHERE</span> dept_id <span class="token operator">=</span> <span class="token number">101</span> or <span class="token function">FIND_IN_SET</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span> ancestors<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre> 
<p>查询结果：<br> <img src="https://images2.imgbox.com/c7/b8/J8UMzhgu_o.png" alt="在这里插入图片描述"><br> sql想要实现的功能就是查询部门id是101的，或者其他部门的ancestors字段（祖先）中有101的所有部门。使用FIND_IN_SET（）函数完全可以实现。<br> 那有的朋友就会说了，为什么不用in或者like呢，区别如下：<br> 三、FIND_IN_SET（）和IN、LIKE的区别：<br> 1.IN和FIND_IN_SET的区别：</p> 
<pre><code class="prism language-java"><span class="token class-name">SELECT</span> dept_id<span class="token punctuation">,</span> parent_id<span class="token punctuation">,</span> ancestors<span class="token punctuation">,</span> order_num<span class="token punctuation">,</span> leader<span class="token punctuation">,</span> phone <span class="token constant">FROM</span> sys_dept 
<span class="token constant">WHERE</span> <span class="token char">'101'</span> <span class="token constant">IN</span> <span class="token punctuation">(</span>'<span class="token number">101</span><span class="token punctuation">,</span><span class="token number">102</span>'<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ac/dc/tJG7Zxmt_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java">in后面只能跟常量， 如果跟字符串的话，就会和字符串的值进行完全匹配，所以上面的sql查询不到记录。
但是<span class="token function">find_in_set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数可以使用常量或字段。
</code></pre> 
<p>2.like和FIND_IN_SET的区别：</p> 
<pre><code class="prism language-java"><span class="token class-name">SELECT</span> dept_id<span class="token punctuation">,</span> parent_id<span class="token punctuation">,</span> ancestors<span class="token punctuation">,</span> order_num<span class="token punctuation">,</span> leader<span class="token punctuation">,</span> phone <span class="token constant">FROM</span> sys_dept 
<span class="token constant">WHERE</span> ancestors <span class="token constant">LIKE</span> <span class="token char">'%10%'</span> <span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/ba/LEhMVV3m_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token class-name">SELECT</span> dept_id<span class="token punctuation">,</span> parent_id<span class="token punctuation">,</span> ancestors<span class="token punctuation">,</span> order_num<span class="token punctuation">,</span> leader<span class="token punctuation">,</span> phone <span class="token constant">FROM</span> sys_dept 
<span class="token class-name">WHERE</span> <span class="token function">FIND_IN_SET</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> ancestors<span class="token punctuation">)</span>  <span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e6/1d/ApElhl5Z_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java">like是广泛的模糊匹配，字符串中没有分隔符，<span class="token class-name">Find_IN_SET</span> 是精确匹配，字段值会以英文”<span class="token punctuation">,</span>”分隔，
<span class="token class-name">Find_IN_SET</span>查询的结果要小于like查询的结果。
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/57cc293423dbf34be591c008f54f12e0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">手机也可以轻松码代码！两款手机端代码最佳神器Pydroid和Pythonista！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8d99f69da58be6ae0a1b89edc088745f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">机器人开发--CanOpen</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>