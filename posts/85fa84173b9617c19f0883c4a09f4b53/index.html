<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql练习：经典50道基础题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql练习：经典50道基础题" />
<meta property="og:description" content="目录 一、环境准备50道题目练习1、查询&#34;01&#34;课程比&#34;02&#34;课程成绩高的学生的信息及课程分数2、查询学生选课存在&#34; 01 &#34;课程但可能不存在&#34; 02 &#34;课程的情况（不存在时显示为 null）3、查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩4、查询在 SC 表存在成绩的学生信息5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的成绩总和6、查询「李」姓老师的数量7、查询学过「张三」老师授课的同学的信息8、查询没有学全所有课程的同学的信息9、查询至少有一门课与学号为&#34;01&#34;的同学所学相同的同学的信息10、查询和&#34;01&#34;号的同学学习的课程完全相同的其他同学的信息11、查询没学过&#34;张三&#34;老师讲授的任一门课程的学生姓名12、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩13、查询&#34;01&#34;课程分数小于 60，按分数降序排列的学生信息14、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩15、查询各科成绩最高分、最低分和平均分16、按各科成绩进行排序，并显示排名， Score 重复时保留名次空缺17、查询学生的总成绩，并进行排名，总分重复时保留名次空缺18、查询学生的总成绩，并进行排名，总分重复时不保留名次空缺19、统计各科成绩各分数段人数：课程编号，[100-85)，[85-70)，[70-60)，[60-0] 及所占百分比20、查询各科成绩前三名的记录21、查询每门课程被选修的学生数22、查询出只选修两门课程的学生学号和姓名23、查询男生、女生人数24、查询名字中含有「风」字的学生信息25、查询同名同性学生名单，并统计同名人数26、查询 1990 年出生的学生名单27、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列28、 查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩29、查询课程名称为「数学」，且分数低于 60 的学生姓名和分数30、查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）31、查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数32、查询不及格的课程33、查询课程编号为 01 且课程成绩在 60 分以上的学生的学号和姓名34、求每门课程的学生人数35、成绩没有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩36、成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩37、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩38、查询每门课程成绩最好的前两名39、统计每门课程的学生选修人数（超过 5 人的课程才统计）40、检索至少选修两门课程的学生学号41、查询选修了全部课程的学生信息42、查询各学生的年龄，只按年份来算43、按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一44、查询本周过生日的学生45、查询下周过生日的学生46、查询本月过生日的学生47、查询下月过生日的学生48、查询下周过生日的学生49、查询本月过生日的学生50、查询下月过生日的学生 参考文章 一、环境准备 建表共4张表，分别对应学生信息（Student）、课程信息（Course）、教师信息（Teacher）以及成绩信息（SC）
-- 学生表 create table Student(sid varchar(10),sname varchar(10),sage datetime,ssex nvarchar(10)); insert into Student values(&#39;01&#39; , &#39;赵雷&#39; , &#39;1990-01-01&#39; , &#39;男&#39;); insert into Student values(&#39;02&#39; , &#39;钱电&#39; , &#39;1990-12-21&#39; , &#39;男&#39;); insert into Student values(&#39;03&#39; , &#39;孙风&#39; , &#39;1990-05-20&#39; , &#39;男&#39;); insert into Student values(&#39;04&#39; , &#39;李云&#39; , &#39;1990-08-06&#39; , &#39;男&#39;); insert into Student values(&#39;05&#39; , &#39;周梅&#39; , &#39;1991-12-01&#39; , &#39;女&#39;); insert into Student values(&#39;06&#39; , &#39;吴兰&#39; , &#39;1992-03-01&#39; , &#39;女&#39;); insert into Student values(&#39;07&#39; , &#39;郑竹&#39; , &#39;1989-07-01&#39; , &#39;女&#39;); insert into Student values(&#39;08&#39; , &#39;王菊&#39; , &#39;1990-01-20&#39; , &#39;女&#39;); -- 课程表 create table Course(cid varchar(10),cname varchar(10),tid varchar(10)); insert into Course values(&#39;01&#39; , &#39;语文&#39; , &#39;02&#39;); insert into Course values(&#39;02&#39; , &#39;数学&#39; , &#39;01&#39;); insert into Course values(&#39;03&#39; , &#39;英语&#39; , &#39;03&#39;); -- 教师表 create table Teacher(tid varchar(10),tname varchar(10)); insert into Teacher values(&#39;01&#39; , &#39;张三&#39;); insert into Teacher values(&#39;02&#39; , &#39;李四&#39;); insert into Teacher values(&#39;03&#39; , &#39;王五&#39;); -- 成绩表 create table SC(sid varchar(10),cid varchar(10),score decimal(18,1)); insert into SC values(&#39;01&#39; , &#39;01&#39; , 80); insert into SC values(&#39;01&#39; , &#39;02&#39; , 90); insert into SC values(&#39;01&#39; , &#39;03&#39; , 99); insert into SC values(&#39;02&#39; , &#39;01&#39; , 70); insert into SC values(&#39;02&#39; , &#39;02&#39; , 60); insert into SC values(&#39;02&#39; , &#39;03&#39; , 80); insert into SC values(&#39;03&#39; , &#39;01&#39; , 80); insert into SC values(&#39;03&#39; , &#39;02&#39; , 80); insert into SC values(&#39;03&#39; , &#39;03&#39; , 80); insert into SC values(&#39;04&#39; , &#39;01&#39; , 50); insert into SC values(&#39;04&#39; , &#39;02&#39; , 30); insert into SC values(&#39;04&#39; , &#39;03&#39; , 20); insert into SC values(&#39;05&#39; , &#39;01&#39; , 76); insert into SC values(&#39;05&#39; , &#39;02&#39; , 87); insert into SC values(&#39;06&#39; , &#39;01&#39; , 31); insert into SC values(&#39;06&#39; , &#39;03&#39; , 34); insert into SC values(&#39;07&#39; , &#39;02&#39; , 89); insert into SC values(&#39;07&#39; , &#39;03&#39; , 98); 50道题目练习 1、查询&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/85fa84173b9617c19f0883c4a09f4b53/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-17T13:23:07+08:00" />
<meta property="article:modified_time" content="2023-01-17T13:23:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql练习：经典50道基础题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、环境准备</a></li><li><a href="#50_47" rel="nofollow">50道题目练习</a></li><li><ul><li><a href="#10102_49" rel="nofollow">1、查询"01"课程比"02"课程成绩高的学生的信息及课程分数</a></li><li><a href="#2_01__02__null_76" rel="nofollow">2、查询学生选课存在" 01 "课程但可能不存在" 02 "课程的情况（不存在时显示为 null）</a></li><li><a href="#3_60__103" rel="nofollow">3、查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</a></li><li><a href="#4_SC__128" rel="nofollow">4、查询在 SC 表存在成绩的学生信息</a></li><li><a href="#5_159" rel="nofollow">5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的成绩总和</a></li><li><a href="#6_187" rel="nofollow">6、查询「李」姓老师的数量</a></li><li><a href="#7_205" rel="nofollow">7、查询学过「张三」老师授课的同学的信息</a></li><li><a href="#8_237" rel="nofollow">8、查询没有学全所有课程的同学的信息</a></li><li><a href="#901_262" rel="nofollow">9、查询至少有一门课与学号为"01"的同学所学相同的同学的信息</a></li><li><a href="#1001_291" rel="nofollow">10、查询和"01"号的同学学习的课程完全相同的其他同学的信息</a></li><li><a href="#11_320" rel="nofollow">11、查询没学过"张三"老师讲授的任一门课程的学生姓名</a></li><li><a href="#12_354" rel="nofollow">12、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</a></li><li><a href="#1301_60_387" rel="nofollow">13、查询"01"课程分数小于 60，按分数降序排列的学生信息</a></li><li><a href="#14_428" rel="nofollow">14、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</a></li><li><a href="#15_471" rel="nofollow">15、查询各科成绩最高分、最低分和平均分</a></li><li><a href="#16_Score__520" rel="nofollow">16、按各科成绩进行排序，并显示排名， Score 重复时保留名次空缺</a></li><li><a href="#17_569" rel="nofollow">17、查询学生的总成绩，并进行排名，总分重复时保留名次空缺</a></li><li><a href="#18_611" rel="nofollow">18、查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</a></li><li><a href="#191008585707060600__640" rel="nofollow">19、统计各科成绩各分数段人数：课程编号，[100-85)，[85-70)，[70-60)，[60-0] 及所占百分比</a></li><li><a href="#20_665" rel="nofollow">20、查询各科成绩前三名的记录</a></li><li><a href="#21_710" rel="nofollow">21、查询每门课程被选修的学生数</a></li><li><a href="#22_733" rel="nofollow">22、查询出只选修两门课程的学生学号和姓名</a></li><li><a href="#23_760" rel="nofollow">23、查询男生、女生人数</a></li><li><a href="#24_779" rel="nofollow">24、查询名字中含有「风」字的学生信息</a></li><li><a href="#25_797" rel="nofollow">25、查询同名同性学生名单，并统计同名人数</a></li><li><a href="#26_1990__818" rel="nofollow">26、查询 1990 年出生的学生名单</a></li><li><a href="#27_840" rel="nofollow">27、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</a></li><li><a href="#28__85__860" rel="nofollow">28、 查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</a></li><li><a href="#29_60__887" rel="nofollow">29、查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</a></li><li><a href="#30_915" rel="nofollow">30、查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</a></li><li><a href="#31_70__957" rel="nofollow">31、查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</a></li><li><a href="#32_994" rel="nofollow">32、查询不及格的课程</a></li><li><a href="#33_01__60__1023" rel="nofollow">33、查询课程编号为 01 且课程成绩在 60 分以上的学生的学号和姓名</a></li><li><a href="#34_1049" rel="nofollow">34、求每门课程的学生人数</a></li><li><a href="#35_1076" rel="nofollow">35、成绩没有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</a></li><li><a href="#36_1109" rel="nofollow">36、成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</a></li><li><a href="#37_1142" rel="nofollow">37、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</a></li><li><a href="#38_1168" rel="nofollow">38、查询每门课程成绩最好的前两名</a></li><li><a href="#39_5__1206" rel="nofollow">39、统计每门课程的学生选修人数（超过 5 人的课程才统计）</a></li><li><a href="#40_1229" rel="nofollow">40、检索至少选修两门课程的学生学号</a></li><li><a href="#41_1258" rel="nofollow">41、查询选修了全部课程的学生信息</a></li><li><a href="#42_1293" rel="nofollow">42、查询各学生的年龄，只按年份来算</a></li><li><a href="#43___1318" rel="nofollow">43、按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一</a></li><li><a href="#44_1349" rel="nofollow">44、查询本周过生日的学生</a></li><li><a href="#45_1360" rel="nofollow">45、查询下周过生日的学生</a></li><li><a href="#46_1371" rel="nofollow">46、查询本月过生日的学生</a></li><li><a href="#47_1382" rel="nofollow">47、查询下月过生日的学生</a></li><li><a href="#48_1390" rel="nofollow">48、查询下周过生日的学生</a></li><li><a href="#49_1397" rel="nofollow">49、查询本月过生日的学生</a></li><li><a href="#50_1404" rel="nofollow">50、查询下月过生日的学生</a></li></ul> 
  </li><li><a href="#_1419" rel="nofollow">参考文章</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、环境准备</h2> 
<p>建表共4张表，分别对应学生信息（Student）、课程信息（Course）、教师信息（Teacher）以及成绩信息（SC）</p> 
<pre><code class="prism language-sql"><span class="token comment">--  学生表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> Student<span class="token punctuation">(</span>sid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sage <span class="token keyword">datetime</span><span class="token punctuation">,</span>ssex nvarchar<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'赵雷'</span> <span class="token punctuation">,</span> <span class="token string">'1990-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'钱电'</span> <span class="token punctuation">,</span> <span class="token string">'1990-12-21'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'孙风'</span> <span class="token punctuation">,</span> <span class="token string">'1990-05-20'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'李云'</span> <span class="token punctuation">,</span> <span class="token string">'1990-08-06'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'周梅'</span> <span class="token punctuation">,</span> <span class="token string">'1991-12-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'吴兰'</span> <span class="token punctuation">,</span> <span class="token string">'1992-03-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'郑竹'</span> <span class="token punctuation">,</span> <span class="token string">'1989-07-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'08'</span> <span class="token punctuation">,</span> <span class="token string">'王菊'</span> <span class="token punctuation">,</span> <span class="token string">'1990-01-20'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 课程表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> Course<span class="token punctuation">(</span>cid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>tid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'语文'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'数学'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'英语'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 教师表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> Teacher<span class="token punctuation">(</span>tid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>tname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 成绩表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> SC<span class="token punctuation">(</span>sid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>score <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="50_47"></a>50道题目练习</h2> 
<h3><a id="10102_49"></a>1、查询"01"课程比"02"课程成绩高的学生的信息及课程分数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>t3<span class="token punctuation">.</span>sid <span class="token keyword">FROM</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score <span class="token keyword">FROM</span> 
	<span class="token punctuation">(</span><span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> sc <span class="token keyword">WHERE</span> cid <span class="token operator">=</span> <span class="token string">"01"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t1 
	<span class="token keyword">JOIN</span> 
	<span class="token punctuation">(</span><span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> sc <span class="token keyword">WHERE</span> cid <span class="token operator">=</span> <span class="token string">"02"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t2
	<span class="token keyword">ON</span> 
	t1<span class="token punctuation">.</span>sid <span class="token operator">=</span> t2<span class="token punctuation">.</span>sid <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> t3 
<span class="token keyword">JOIN</span> student
<span class="token keyword">ON</span> t3<span class="token punctuation">.</span>sid <span class="token operator">=</span> student<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-----+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> sid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-----+</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-----+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先将课程为01和02的课程及对应分数筛选出来，再join，on为01.sid = 02.sid，条件为01.score &gt;02.score，结果’存’为新表t3，再将Student表和t3表join</p> 
<h3><a id="2_01__02__null_76"></a>2、查询学生选课存在" 01 “课程但可能不存在” 02 "课程的情况（不存在时显示为 null）</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sc <span class="token keyword">WHERE</span> cid <span class="token operator">=</span> <span class="token string">"01"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t1 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sc <span class="token keyword">WHERE</span> cid <span class="token operator">=</span> <span class="token string">"02"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>sid <span class="token operator">=</span> t2<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+------+------+-------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span> sid  <span class="token operator">|</span> cid  <span class="token operator">|</span> score <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+------+------+-------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">01</span>   <span class="token operator">|</span> <span class="token number">02</span>   <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span> <span class="token number">02</span>   <span class="token operator">|</span> <span class="token number">02</span>   <span class="token operator">|</span> <span class="token number">60.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">03</span>   <span class="token operator">|</span> <span class="token number">02</span>   <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span> <span class="token number">04</span>   <span class="token operator">|</span> <span class="token number">02</span>   <span class="token operator">|</span> <span class="token number">30.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span> <span class="token number">05</span>   <span class="token operator">|</span> <span class="token number">02</span>   <span class="token operator">|</span> <span class="token number">87.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+------+------+-------+</span>
<span class="token number">6</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 即找出学生选了01课程没有选02课程的情况，用left join即可</p> 
<h3><a id="3_60__103"></a>3、查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token comment">#多表联合查询</span>
<span class="token keyword">SELECT</span>  sc<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">FROM</span> sc <span class="token punctuation">,</span>student <span class="token keyword">WHERE</span> sc<span class="token punctuation">.</span>sid <span class="token operator">=</span> student<span class="token punctuation">.</span>sid  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  sc<span class="token punctuation">.</span>sid  <span class="token keyword">HAVING</span> <span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
<span class="token comment">#多表连接查询</span>
<span class="token keyword">SELECT</span>  sc<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">FROM</span> sc <span class="token keyword">JOIN</span> student <span class="token keyword">on</span> sc<span class="token punctuation">.</span>sid <span class="token operator">=</span> student<span class="token punctuation">.</span>sid  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  sc<span class="token punctuation">.</span>sid  <span class="token keyword">HAVING</span> <span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> <span class="token function">avg</span><span class="token punctuation">(</span>sc<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">89.66667</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">70.00000</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">80.00000</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">81.50000</span>      <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">93.50000</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 首先确定的是两张表，student和sc，这里使用多表联合查询和多表连接查的方式都可以，关联条件是sid，然后分组，最后加一个having函数，条件是平均成绩大于60，即可查询出来</p> 
<h3><a id="4_SC__128"></a>4、查询在 SC 表存在成绩的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token comment">#多表联合查询方式</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>t2<span class="token punctuation">.</span>score <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> sc t2 <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>sid <span class="token operator">=</span> t2<span class="token punctuation">.</span>sid  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>

<span class="token comment">#多表连接查询方式</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>b<span class="token punctuation">.</span>score <span class="token keyword">FROM</span> student <span class="token keyword">as</span> a 
    <span class="token keyword">JOIN</span> sc <span class="token keyword">AS</span> b 
    <span class="token keyword">ON</span> a<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid 
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> score <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">1991</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">1992</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">1989</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 确定是两个表,student和sc，关联条件还是sid消除笛卡尔积，然后再group by，最后select 取需要的信息</p> 
<h3><a id="5_159"></a>5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的成绩总和</h3> 
<pre><code class="prism language-sql"><span class="token comment">#多表联合查询方式</span>
<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>sid <span class="token keyword">as</span> 学生编号<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sname <span class="token keyword">as</span> 学生姓名<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">as</span> 选课总数<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> 课程成绩总和 <span class="token keyword">FROM</span> student t1<span class="token punctuation">,</span> sc t2 <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>sid <span class="token operator">=</span> t2<span class="token punctuation">.</span>sid  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>

<span class="token comment">#多表连接查询</span>
<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>sid <span class="token keyword">as</span> 学生编号<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sname <span class="token keyword">as</span> 学生姓名<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">as</span> 选课总数<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> 课程成绩总和 <span class="token keyword">FROM</span> student t1 <span class="token keyword">JOIN</span> sc t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>sid <span class="token operator">=</span> t2<span class="token punctuation">.</span>sid  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">----------+----------+----------+--------------+</span>
<span class="token operator">|</span> 学生编号 <span class="token operator">|</span> 学生姓名 <span class="token operator">|</span> 选课总数 <span class="token operator">|</span> 课程成绩总和 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+----------+----------+--------------+</span>
<span class="token operator">|</span> <span class="token number">01</span>       <span class="token operator">|</span> 赵雷     <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">269.0</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>       <span class="token operator">|</span> 钱电     <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">210.0</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>       <span class="token operator">|</span> 孙风     <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">240.0</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>       <span class="token operator">|</span> 李云     <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">100.0</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>       <span class="token operator">|</span> 周梅     <span class="token operator">|</span>        <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">163.0</span>        <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>       <span class="token operator">|</span> 吴兰     <span class="token operator">|</span>        <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">65.0</span>         <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>       <span class="token operator">|</span> 郑竹     <span class="token operator">|</span>        <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">187.0</span>        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+----------+----------+--------------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 两个聚合函数（统计函数）一个count(cid),一个sum(score),同样join student表和sc表，再group by sid即可</p> 
<h3><a id="6_187"></a>6、查询「李」姓老师的数量</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tid<span class="token punctuation">)</span> <span class="token keyword">FROM</span> teacher t <span class="token keyword">WHERE</span> t<span class="token punctuation">.</span>tname <span class="token operator">like</span> <span class="token string">"%李%"</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>tid<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span>            <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> count加条件函数加通配符即可</p> 
<h3><a id="7_205"></a>7、查询学过「张三」老师授课的同学的信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> s<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>y<span class="token punctuation">.</span>tname <span class="token keyword">FROM</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> sc<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>x<span class="token punctuation">.</span>tname <span class="token keyword">FROM</span> 
        <span class="token punctuation">(</span><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>tname<span class="token punctuation">,</span>c<span class="token punctuation">.</span>cid <span class="token keyword">FROM</span> teacher <span class="token keyword">AS</span> t
            <span class="token keyword">JOIN</span> course <span class="token keyword">AS</span> c 
            <span class="token keyword">ON</span> t<span class="token punctuation">.</span>tid <span class="token operator">=</span> c<span class="token punctuation">.</span>tid
                <span class="token keyword">WHERE</span> t<span class="token punctuation">.</span>tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> x
        <span class="token keyword">JOIN</span> sc
        <span class="token keyword">ON</span> x<span class="token punctuation">.</span>cid <span class="token operator">=</span> sc<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">AS</span> y
<span class="token keyword">JOIN</span> student <span class="token keyword">AS</span> s
<span class="token keyword">ON</span> y<span class="token punctuation">.</span>sid <span class="token operator">=</span> s<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> tname <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> 张三  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> 张三  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> 张三  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> 张三  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">1991</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span> 张三  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">1989</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span> 张三  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token number">6</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 四表连接，teacher表里的tid与course表里的tid，条件为tname=‘张三’，再course表里的cid与sc表里的cid，最后sc表里的sid与student里的sid</p> 
<h3><a id="8_237"></a>8、查询没有学全所有课程的同学的信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 所学课程数
<span class="token keyword">FROM</span> student <span class="token keyword">AS</span> a
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sc <span class="token keyword">AS</span> b
    <span class="token keyword">ON</span> a<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>sid
            <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">FROM</span> course <span class="token keyword">as</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+------------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> 所学课程数 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+------------+</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">1991</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">1992</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">1989</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">08</span>  <span class="token operator">|</span> 王菊  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>          <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+------------+</span>
</code></pre> 
<p>解析：<br> 先查询总课程数，再查询所有同学的信息，筛选条件为其所学课程数小于总课程数</p> 
<h3><a id="901_262"></a>9、查询至少有一门课与学号为"01"的同学所学相同的同学的信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> s<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">AS</span> s
    <span class="token keyword">JOIN</span> sc
    <span class="token keyword">ON</span> s<span class="token punctuation">.</span>sid  <span class="token operator">=</span> sc<span class="token punctuation">.</span>sid 
        <span class="token keyword">WHERE</span> sc<span class="token punctuation">.</span>cid <span class="token operator">in</span> 
                    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> sc<span class="token punctuation">.</span>cid <span class="token keyword">FROM</span> sc <span class="token keyword">AS</span> sc <span class="token keyword">WHERE</span> sc<span class="token punctuation">.</span>sid <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">)</span> 
        <span class="token keyword">GROUP</span> <span class="token keyword">bY</span> s<span class="token punctuation">.</span>sid 
             <span class="token keyword">HAVING</span> s<span class="token punctuation">.</span>sid <span class="token operator">!=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">1991</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">1992</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">1989</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token number">6</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从成绩表里查询学号为01的同学所学的课程编号，筛选条件为sc.cid in 01同学所学编号，再使用学生表和成绩表两表关联，关联字段为sid，并且把课程编号作为子查询的条件，刷选，然后再group by sid 最后通过having筛选sid 不等于01</p> 
<h3><a id="1001_291"></a>10、查询和"01"号的同学学习的课程完全相同的其他同学的信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student t1 <span class="token keyword">where</span> t1<span class="token punctuation">.</span>sid <span class="token operator">not</span> <span class="token operator">in</span>
        <span class="token punctuation">(</span><span class="token keyword">select</span> p<span class="token punctuation">.</span>sid fro

        	
                <span class="token punctuation">(</span><span class="token keyword">select</span> t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>sc<span class="token punctuation">.</span>sid sc_sid <span class="token punctuation">,</span>sc<span class="token punctuation">.</span>cid sc_cid <span class="token keyword">from</span>
                        <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token punctuation">,</span>
                                <span class="token punctuation">(</span><span class="token keyword">select</span> cid <span class="token keyword">from</span> sc <span class="token keyword">where</span> sid <span class="token operator">=</span> <span class="token string">"01"</span><span class="token punctuation">)</span> s <span class="token punctuation">)</span> t 
                        <span class="token keyword">left</span> <span class="token keyword">join</span> sc <span class="token keyword">on</span> t<span class="token punctuation">.</span>sid <span class="token operator">=</span> sc<span class="token punctuation">.</span>sid <span class="token operator">and</span> t<span class="token punctuation">.</span>cid <span class="token operator">=</span> sc<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> p <span class="token keyword">where</span> sc_sid <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
        <span class="token operator">and</span> t1<span class="token punctuation">.</span>sid <span class="token operator">!=</span> <span class="token string">"01"</span>
<span class="token operator">and</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">from</span> sc t3 <span class="token keyword">where</span> t3<span class="token punctuation">.</span>sid <span class="token operator">=</span> t1<span class="token punctuation">.</span>sid<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> sc t2 <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>sid <span class="token operator">=</span> <span class="token string">"01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+---------------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> <span class="token function">count</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+---------------+</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>             <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>             <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>             <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+---------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从成绩表中查询学号为01的总课程数，然后使用学生表和成绩表关联查询，关联字段为sid，消除笛卡尔积，where条件语句过滤学号01，并且用学号字段分组，并且使用having函数，统计课程总数=学号为1的课程总数</p> 
<h3><a id="11_320"></a>11、查询没学过"张三"老师讲授的任一门课程的学生姓名</h3> 
<pre><code class="prism language-sql"><span class="token comment">#多表联合查询方式</span>
<span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname <span class="token keyword">FROM</span> student 
    <span class="token keyword">WHERE</span> student<span class="token punctuation">.</span>sid <span class="token operator">NOT</span> <span class="token operator">IN</span> 
        <span class="token punctuation">(</span><span class="token keyword">SELECT</span> sc<span class="token punctuation">.</span>sid <span class="token keyword">FROM</span> sc     
                    <span class="token keyword">JOIN</span> course 
                    <span class="token keyword">ON</span> sc<span class="token punctuation">.</span>cid<span class="token operator">=</span>course<span class="token punctuation">.</span>cid
                    <span class="token keyword">JOIN</span> teacher 
                    <span class="token keyword">ON</span> course<span class="token punctuation">.</span>tid<span class="token operator">=</span>teacher<span class="token punctuation">.</span>tid 
        <span class="token keyword">WHERE</span> tname<span class="token operator">=</span><span class="token string">'张三'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#多表连接查询方式</span>
<span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname <span class="token keyword">FROM</span> student 
    <span class="token keyword">WHERE</span> student<span class="token punctuation">.</span>sid <span class="token operator">NOT</span> <span class="token operator">IN</span> 
        <span class="token punctuation">(</span><span class="token keyword">SELECT</span> sc<span class="token punctuation">.</span>sid <span class="token keyword">FROM</span> sc<span class="token punctuation">,</span>course<span class="token punctuation">,</span>teacher <span class="token keyword">where</span> sc<span class="token punctuation">.</span>cid <span class="token operator">=</span> course<span class="token punctuation">.</span>cid <span class="token operator">and</span> course<span class="token punctuation">.</span>tid<span class="token operator">=</span>teacher<span class="token punctuation">.</span>tid <span class="token operator">and</span> tname<span class="token operator">=</span><span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span>
<span class="token operator">|</span> 王菊  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先找出所有学生选课信息及sid，再找出张三老师授课课程，将其连接，再用student里的sid not in 前面的sid</p> 
<h3><a id="12_354"></a>12、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> c<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student c
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span>
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">WHERE</span> score <span class="token operator">&lt;</span> <span class="token number">60</span>
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span>
    <span class="token punctuation">)</span> a
        <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>
            <span class="token keyword">FROM</span> sc
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
        <span class="token punctuation">)</span> b
        <span class="token keyword">ON</span> a<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">)</span> <span class="token keyword">ON</span> c<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-----+------------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> sid <span class="token operator">|</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+------------+</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">33.33333</span>   <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">32.50000</span>   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先查询出不及格两门或两门以上的数据，再查询出不及格的平均成绩，再三张表嵌套关联</p> 
<h3><a id="1301_60_387"></a>13、查询"01"课程分数小于 60，按分数降序排列的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token comment">#多表联合查询方式</span>
<span class="token keyword">SELECT</span> b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> student b
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span>
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">WHERE</span> cid <span class="token operator">=</span> <span class="token string">'01'</span>
            <span class="token operator">AND</span> score <span class="token operator">&lt;</span> <span class="token number">60</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> a
    <span class="token keyword">ON</span> a<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>

<span class="token comment">#多表连接查询方式</span>
<span class="token keyword">SELECT</span> b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> student b<span class="token punctuation">,</span>
    <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span>
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">WHERE</span> cid <span class="token operator">=</span> <span class="token string">'01'</span>
            <span class="token operator">AND</span> score <span class="token operator">&lt;</span> <span class="token number">60</span>
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> a
    <span class="token keyword">where</span> a<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> score <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">1992</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+-------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先查询出01课程分数小于60的sid ，按照分数降序，然后和学生表关联</p> 
<h3><a id="14_428"></a>14、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> a<span class="token punctuation">.</span>score<span class="token punctuation">,</span> a<span class="token punctuation">.</span>cid<span class="token punctuation">,</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>平均成绩<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> sc a
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均成绩
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
    <span class="token punctuation">)</span> b
    <span class="token keyword">ON</span> a<span class="token punctuation">.</span>sid <span class="token operator">=</span> b<span class="token punctuation">.</span>sid
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>平均成绩<span class="token punctuation">`</span></span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+-----+----------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> score <span class="token operator">|</span> cid <span class="token operator">|</span> 平均成绩 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+-----+----------+</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">93.50000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">98.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">93.50000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">89.66667</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">89.66667</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">99.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">89.66667</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">81.50000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">87.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">81.50000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.00000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">80.00000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.00000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">70.00000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">60.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">70.00000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">70.00000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">33.33333</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">30.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">33.33333</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">20.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">33.33333</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">32.50000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">34.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">32.50000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+-----+----------+</span>
<span class="token number">18</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先求平均成绩，注意，这里的平均成绩一定要取别名，然后取所有人的成绩，再关联，然后按照平均成绩降序排列</p> 
<h3><a id="15_471"></a>15、查询各科成绩最高分、最低分和平均分</h3> 
<p>以如下形式显示：</p> 
<p>课程 id，最高分，最低分，平均分，及格率，中等率，优良率，优秀率<br> 　　及格为&gt;=60，中等为：[70,80)，优良为：[80-90)，优秀为：&gt;=90<br> 　　要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> cid <span class="token keyword">AS</span> 课程id<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 最高分<span class="token punctuation">,</span> <span class="token function">MIN</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 最低分<span class="token punctuation">,</span> <span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均分
    <span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
        <span class="token keyword">ELSE</span> <span class="token number">0</span>
    <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 及格率
    <span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> score <span class="token operator">&gt;=</span> <span class="token number">70</span>
            <span class="token operator">AND</span> score <span class="token operator">&lt;</span> <span class="token number">80</span>
        <span class="token keyword">THEN</span> <span class="token number">1</span>
        <span class="token keyword">ELSE</span> <span class="token number">0</span>
    <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 中等率
    <span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span>
            <span class="token operator">AND</span> score <span class="token operator">&lt;</span> <span class="token number">90</span>
        <span class="token keyword">THEN</span> <span class="token number">1</span>
        <span class="token keyword">ELSE</span> <span class="token number">0</span>
    <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 优良率
    <span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> score <span class="token operator">&gt;=</span> <span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token number">1</span>
        <span class="token keyword">ELSE</span> <span class="token number">0</span>
    <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 优秀率
<span class="token keyword">FROM</span> sc
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cid
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> cid <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">--------+--------+--------+----------+--------+--------+--------+--------+</span>
<span class="token operator">|</span> 课程id <span class="token operator">|</span> 最高分 <span class="token operator">|</span> 最低分 <span class="token operator">|</span> 平均分   <span class="token operator">|</span> 及格率 <span class="token operator">|</span> 中等率 <span class="token operator">|</span> 优良率 <span class="token operator">|</span> 优秀率 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+--------+--------+----------+--------+--------+--------+--------+</span>
<span class="token operator">|</span> <span class="token number">01</span>     <span class="token operator">|</span> <span class="token number">80.0</span>   <span class="token operator">|</span> <span class="token number">31.0</span>   <span class="token operator">|</span> <span class="token number">64.50000</span> <span class="token operator">|</span> <span class="token number">0.6667</span> <span class="token operator">|</span> <span class="token number">0.3333</span> <span class="token operator">|</span> <span class="token number">0.3333</span> <span class="token operator">|</span> <span class="token number">0.0000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>     <span class="token operator">|</span> <span class="token number">90.0</span>   <span class="token operator">|</span> <span class="token number">30.0</span>   <span class="token operator">|</span> <span class="token number">72.66667</span> <span class="token operator">|</span> <span class="token number">0.8333</span> <span class="token operator">|</span> <span class="token number">0.0000</span> <span class="token operator">|</span> <span class="token number">0.5000</span> <span class="token operator">|</span> <span class="token number">0.1667</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>     <span class="token operator">|</span> <span class="token number">99.0</span>   <span class="token operator">|</span> <span class="token number">20.0</span>   <span class="token operator">|</span> <span class="token number">68.50000</span> <span class="token operator">|</span> <span class="token number">0.6667</span> <span class="token operator">|</span> <span class="token number">0.0000</span> <span class="token operator">|</span> <span class="token number">0.3333</span> <span class="token operator">|</span> <span class="token number">0.3333</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+--------+--------+----------+--------+--------+--------+--------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 重点在case when语句的用法，其实case when 就类似于 if函数 if x&gt;某个值，then 1 else 0。就只用一个表，只是对表头需要做修改，用聚合函数+AS</p> 
<h3><a id="16_Score__520"></a>16、按各科成绩进行排序，并显示排名， Score 重复时保留名次空缺</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- MySql8.0以上</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> cid <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> ranked <span class="token keyword">from</span> sc<span class="token punctuation">;</span>

<span class="token comment">-- MySql5.7为实现分组组内排名</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token variable">@rank</span>:<span class="token operator">=</span><span class="token variable">@rank</span><span class="token operator">+</span><span class="token number">1</span>  <span class="token keyword">as</span> ranked <span class="token keyword">from</span> sc <span class="token keyword">as</span> s<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token variable">@rank</span>:<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> p  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span> ranked <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span>      <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span>      <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span>      <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">87.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">60.0</span>  <span class="token operator">|</span>      <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">30.0</span>  <span class="token operator">|</span>      <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">99.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">98.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">34.0</span>  <span class="token operator">|</span>      <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">20.0</span>  <span class="token operator">|</span>      <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token number">18</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 注意：mysql8.0之前 是没有rank函数<br> MySQL可以实现Oracle中的排名公式，一共有三种</p> 
<ol><li>rank() over(order by col_name desc）</li><li>dense_rank() over()</li><li>row_number() over()<br> 第一个是如果出现了相同排名都为同一排名，下个排名跳过，例如1,1,3,4<br> 第二个是如果出现了相同排名都为同一排名，下个排名不跳过，例如1,1,2,3<br> 第三个是直接对行进行排名不分是否有相同值</li></ol> 
<p>此题目要按照各科成绩进行排序 over()中要填partition by col_name order by col_name<br> 第一个colname 为分组的内容，第二个是按什么值排的内容</p> 
<h3><a id="17_569"></a>17、查询学生的总成绩，并进行排名，总分重复时保留名次空缺</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- MySql8.0以上</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>总成绩 <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> Ranked
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 总成绩
    <span class="token keyword">FROM</span> sc
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
<span class="token punctuation">)</span> a<span class="token punctuation">;</span>


<span class="token comment">-- MySql5.7</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token variable">@rank</span> :<span class="token operator">=</span> <span class="token variable">@rank</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">AS</span> ranked
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> s<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 总成绩
    <span class="token keyword">FROM</span> sc s
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
<span class="token punctuation">)</span> a<span class="token punctuation">,</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token variable">@rank</span> :<span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">)</span> p
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>总成绩 <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+--------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span> 总成绩 <span class="token operator">|</span> Ranked <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+--------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">269.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">240.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span> <span class="token number">210.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span> <span class="token number">187.0</span>  <span class="token operator">|</span>      <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span> <span class="token number">163.0</span>  <span class="token operator">|</span>      <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span> <span class="token number">100.0</span>  <span class="token operator">|</span>      <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span> <span class="token number">65.0</span>   <span class="token operator">|</span>      <span class="token number">7</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+--------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 跟上题一样用rank（）over（），只是多了层嵌套</p> 
<h3><a id="18_611"></a>18、查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> a<span class="token punctuation">.</span>total_socre <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> Ranked
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_socre
    <span class="token keyword">FROM</span> sc
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
<span class="token punctuation">)</span> a<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+-------------+--------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span> total_socre <span class="token operator">|</span> Ranked <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+-------------+--------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">269.0</span>       <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">240.0</span>       <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span> <span class="token number">210.0</span>       <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span> <span class="token number">187.0</span>       <span class="token operator">|</span>      <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span> <span class="token number">163.0</span>       <span class="token operator">|</span>      <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span> <span class="token number">100.0</span>       <span class="token operator">|</span>      <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span> <span class="token number">65.0</span>        <span class="token operator">|</span>      <span class="token number">7</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+-------------+--------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 和上面一样，只是换成dense_rank () over()，只是总分没有重复无法看出区别</p> 
<h3><a id="191008585707060600__640"></a>19、统计各科成绩各分数段人数：课程编号，[100-85)，[85-70)，[70-60)，[60-0] 及所占百分比</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> cid <span class="token keyword">AS</span> 课程ID<span class="token punctuation">,</span> 
<span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> score <span class="token operator">&lt;=</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 百分比<span class="token number">1</span><span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> score <span class="token operator">&gt;</span><span class="token number">60</span> <span class="token operator">AND</span> score <span class="token operator">&lt;=</span><span class="token number">70</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 百分比<span class="token number">2</span><span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> score <span class="token operator">&gt;</span><span class="token number">70</span> <span class="token operator">AND</span> score <span class="token operator">&lt;=</span><span class="token number">85</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 百分比<span class="token number">3</span><span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> score <span class="token operator">&gt;</span><span class="token number">85</span> <span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 百分比<span class="token number">4</span>
<span class="token keyword">FROM</span> sc <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cid <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> cid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">--------+---------+---------+---------+---------+</span>
<span class="token operator">|</span> 课程ID <span class="token operator">|</span> 百分比<span class="token number">1</span> <span class="token operator">|</span> 百分比<span class="token number">2</span> <span class="token operator">|</span> 百分比<span class="token number">3</span> <span class="token operator">|</span> 百分比<span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+---------+---------+---------+---------+</span>
<span class="token operator">|</span> <span class="token number">01</span>     <span class="token operator">|</span> <span class="token number">0.3333</span>  <span class="token operator">|</span> <span class="token number">0.1667</span>  <span class="token operator">|</span> <span class="token number">0.5000</span>  <span class="token operator">|</span> <span class="token number">0.0000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>     <span class="token operator">|</span> <span class="token number">0.3333</span>  <span class="token operator">|</span> <span class="token number">0.0000</span>  <span class="token operator">|</span> <span class="token number">0.1667</span>  <span class="token operator">|</span> <span class="token number">0.5000</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>     <span class="token operator">|</span> <span class="token number">0.3333</span>  <span class="token operator">|</span> <span class="token number">0.0000</span>  <span class="token operator">|</span> <span class="token number">0.3333</span>  <span class="token operator">|</span> <span class="token number">0.3333</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+---------+---------+---------+---------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：</p> 
<p>使用case when</p> 
<h3><a id="20_665"></a>20、查询各科成绩前三名的记录</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- MySql8.0以上</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">by</span> cid <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ranked <span class="token keyword">FROM</span> sc<span class="token punctuation">)</span> <span class="token keyword">as</span> a
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>ranked <span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- MySql5.7</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> sc
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> sc a
    <span class="token keyword">WHERE</span> sc<span class="token punctuation">.</span>CId <span class="token operator">=</span> a<span class="token punctuation">.</span>CId
        <span class="token operator">AND</span> sc<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>score
<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId <span class="token keyword">ASC</span><span class="token punctuation">,</span> sc<span class="token punctuation">.</span>score <span class="token keyword">DESC</span>；

</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span> ranked <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">87.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">99.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">98.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+  </span>
<span class="token number">10</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 与上面rank一样，用rank（）over（）where ranked &lt;=3<br> 注意！where 的执行顺序在select前，嵌套一个select 语句就好</p> 
<p>MySql5.7版本：使用嵌套循环找出cid相同并且比自己score大但不超过三条的数据（前三名）</p> 
<h3><a id="21_710"></a>21、查询每门课程被选修的学生数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> cid <span class="token keyword">AS</span> 课程id<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修的学生数
<span class="token keyword">FROM</span> sc
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cid
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 课程id<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">--------+--------------+</span>
<span class="token operator">|</span> 课程id <span class="token operator">|</span> 选修的学生数 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+--------------+</span>
<span class="token operator">|</span> <span class="token number">01</span>     <span class="token operator">|</span>            <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>     <span class="token operator">|</span>            <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>     <span class="token operator">|</span>            <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+--------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 单表 查询，使用group by ，order by</p> 
<h3><a id="22_733"></a>22、查询出只选修两门课程的学生学号和姓名</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修课程数
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
        <span class="token keyword">HAVING</span> 选修课程数 <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token punctuation">)</span> a
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> a<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-----+------------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> sid <span class="token operator">|</span> 选修课程数 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+------------+</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+------------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从成绩表中查询出只选修两门课程的学生id和课程数，再和学生表进行关联查询</p> 
<h3><a id="23_760"></a>23、查询男生、女生人数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> ssex<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">FROM</span> student <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> ssex<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">------+------------+</span>
<span class="token operator">|</span> ssex <span class="token operator">|</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+------------+</span>
<span class="token operator">|</span> 男   <span class="token operator">|</span>          <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> 女   <span class="token operator">|</span>          <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 根据ssex group by后再count()</p> 
<h3><a id="24_779"></a>24、查询名字中含有「风」字的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> sname <span class="token operator">like</span> <span class="token string">"%风%"</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 通配符，%，‘%a’a结尾，‘a%’a开头，‘%a%’含有a</p> 
<h3><a id="25_797"></a>25、查询同名同性学生名单，并统计同名人数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 同名人数
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
    <span class="token keyword">FROM</span> student a
        <span class="token keyword">JOIN</span> student b
    <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>sname <span class="token operator">=</span> b<span class="token punctuation">.</span>sname
        <span class="token operator">AND</span> a<span class="token punctuation">.</span>ssex <span class="token operator">=</span> b<span class="token punctuation">.</span>ssex
<span class="token punctuation">)</span> c
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
<span class="token keyword">HAVING</span> 同名人数 <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p>解析：<br> 连接表student和student on ssname and ssex 在group by sid（因为id唯一，name可能重名），count sid</p> 
<h3><a id="26_1990__818"></a>26、查询 1990 年出生的学生名单</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student  <span class="token keyword">WHERE</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>sage<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1990</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">08</span>  <span class="token operator">|</span> 王菊  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 女   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> sage一列为datetime类型，用时间函数。MySQL里面能够对datetime类型函数截取年、月、周、日等等 ，用YEAR()来表示年，以此类推</p> 
<h3><a id="27_840"></a>27、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> cid<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均成绩 <span class="token keyword">FROM</span> sc <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cid <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 平均成绩 <span class="token keyword">DESC</span><span class="token punctuation">,</span>cid <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+----------+</span>
<span class="token operator">|</span> cid <span class="token operator">|</span> 平均成绩 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+----------+</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">72.66667</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">68.50000</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">64.50000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+----------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> order by x desc,y,z,… 先根据x排序，再根据y，然后z…</p> 
<h3><a id="28__85__860"></a>28、 查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> sid <span class="token keyword">AS</span> 学号<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> 平均成绩
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
        <span class="token keyword">HAVING</span> 平均成绩 <span class="token operator">&gt;</span> <span class="token number">85</span>
    <span class="token punctuation">)</span> a
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> a<span class="token punctuation">.</span>学号<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+------+----------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> 学号 <span class="token operator">|</span> 平均成绩 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+------+----------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">01</span>   <span class="token operator">|</span> <span class="token number">89.66667</span> <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">07</span>   <span class="token operator">|</span> <span class="token number">93.50000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+------+----------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从成绩表中查询出平均成绩大于85的学生好和平均成绩（记住，这里需要取别名），然后再和学生表关联，关联字段为sid，获取到学生名字</p> 
<h3><a id="29_60__887"></a>29、查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>cname<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>score<span class="token punctuation">,</span> t2<span class="token punctuation">.</span>sid
        <span class="token keyword">FROM</span> course t1
            <span class="token keyword">JOIN</span> sc t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>cid <span class="token operator">=</span> t2<span class="token punctuation">.</span>cid
        <span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span>
            <span class="token operator">AND</span> t1<span class="token punctuation">.</span>cname <span class="token operator">=</span> <span class="token string">'数学'</span>
    <span class="token punctuation">)</span> c
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> c<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-------+-------+-----+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> cname <span class="token operator">|</span> score <span class="token operator">|</span> sid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-------+-----+</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">30.0</span>  <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-------+-----+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先把课程表和成绩表关联，获取到低于60分的学生号、分数和课程名称，作为临时表，然后再和学生表关联，获取到最后一个字段，学生姓名</p> 
<h3><a id="30_915"></a>30、查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>cname<span class="token punctuation">,</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> b<span class="token punctuation">.</span>score
        <span class="token keyword">FROM</span> course a
            <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sc b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>cid <span class="token operator">=</span> b<span class="token punctuation">.</span>cid
    <span class="token punctuation">)</span> c
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> c<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-------+-----+-------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> cname <span class="token operator">|</span> sid <span class="token operator">|</span> score <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-----+-------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">99.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">60.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">30.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> <span class="token number">20.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">87.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span> <span class="token number">34.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">98.0</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-----+-------+</span>
<span class="token number">18</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先把课程表和成绩表关联，关联字段为cid，获取到课程名称，学生号和学科成绩，作为临时表，然后再和学生表关联，关联字段为sid，获取到学生名字</p> 
<h3><a id="31_70__957"></a>31、查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>cname<span class="token punctuation">,</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> b<span class="token punctuation">.</span>score
        <span class="token keyword">FROM</span> course a
            <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> sc b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>cid <span class="token operator">=</span> b<span class="token punctuation">.</span>cid
    <span class="token punctuation">)</span> c
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> c<span class="token punctuation">.</span>sid
<span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">70</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-------+-----+-------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> cname <span class="token operator">|</span> sid <span class="token operator">|</span> score <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-----+-------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">99.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">87.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">98.0</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-----+-------+</span>
<span class="token number">11</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 在上一题的基础上增加score &gt; 70,使用where 或and都可以</p> 
<h3><a id="32_994"></a>32、查询不及格的课程</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> cname<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> course
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> score<span class="token punctuation">,</span> cid
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">WHERE</span> score <span class="token operator">&lt;</span> <span class="token number">60</span>
    <span class="token punctuation">)</span> a
    <span class="token keyword">ON</span> course<span class="token punctuation">.</span>cid <span class="token operator">=</span> a<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<p>结果</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-------+-----+</span>
<span class="token operator">|</span> cname <span class="token operator">|</span> score <span class="token operator">|</span> cid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-----+</span>
<span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">50.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">30.0</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">20.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">31.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">34.0</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-------+-----+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从成绩表中获取到不及格的课程id和成绩，然后再和课程表关联，关联字典为课程id，获取到课程名称</p> 
<h3><a id="33_01__60__1023"></a>33、查询课程编号为 01 且课程成绩在 60 分以上的学生的学号和姓名</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span>c<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> student 
<span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span>  b<span class="token punctuation">.</span>sid <span class="token punctuation">,</span>b<span class="token punctuation">.</span>score<span class="token punctuation">,</span>a<span class="token punctuation">.</span>cid <span class="token punctuation">,</span>a<span class="token punctuation">.</span>cname <span class="token keyword">FROM</span> course <span class="token keyword">as</span> a
<span class="token keyword">JOIN</span>
sc <span class="token keyword">as</span> b
<span class="token keyword">ON</span> a<span class="token punctuation">.</span>cid <span class="token operator">=</span> b<span class="token punctuation">.</span>cid <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>cid <span class="token operator">=</span> <span class="token string">"01"</span> <span class="token operator">AND</span> b<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c  <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> c<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-----+-------+-----+-------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> sid <span class="token operator">|</span> score <span class="token operator">|</span> cid <span class="token operator">|</span> cname <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+-------+-----+-------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 语文  <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">70.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 语文  <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 语文  <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 语文  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+-------+-----+-------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从课程表和成绩表中获取到学生号、成绩、课程号和课程名称，关联字段为课程号，作为临时表，然后再和学生表关联，关联字段为学生号，获取到学生名字</p> 
<h3><a id="34_1049"></a>34、求每门课程的学生人数</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> course<span class="token punctuation">.</span>cname<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> course
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span><span class="token punctuation">,</span> cid
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cid
    <span class="token punctuation">)</span> a
    <span class="token keyword">ON</span> course<span class="token punctuation">.</span>cid <span class="token operator">=</span> a<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+------------+-----+</span>
<span class="token operator">|</span> cname <span class="token operator">|</span> <span class="token function">count</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token operator">|</span> cid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+------------+-----+</span>
<span class="token operator">|</span> 语文  <span class="token operator">|</span>          <span class="token number">6</span> <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 数学  <span class="token operator">|</span>          <span class="token number">6</span> <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span>
<span class="token operator">|</span> 英语  <span class="token operator">|</span>          <span class="token number">6</span> <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+------------+-----+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 先从成绩表中统计出每门课程的人数，再和课程表关联，关联字段为课程号，获取到课程名称</p> 
<h3><a id="35_1076"></a>35、成绩没有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>sid
        <span class="token keyword">FROM</span> sc d
            <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>tid<span class="token punctuation">,</span> a<span class="token punctuation">.</span>tname<span class="token punctuation">,</span> b<span class="token punctuation">.</span>cid<span class="token punctuation">,</span> b<span class="token punctuation">.</span>cname
                <span class="token keyword">FROM</span> teacher a
                    <span class="token keyword">JOIN</span> course b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>tid <span class="token operator">=</span> b<span class="token punctuation">.</span>tid
                <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>tname <span class="token operator">=</span> <span class="token string">'张三'</span>
            <span class="token punctuation">)</span> c
            <span class="token keyword">ON</span> d<span class="token punctuation">.</span>cid <span class="token operator">=</span> c<span class="token punctuation">.</span>cid
    <span class="token punctuation">)</span> e
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> e<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+--------------+-----+-------+-----+-------+-----+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> <span class="token function">MAX</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">|</span> tid <span class="token operator">|</span> tname <span class="token operator">|</span> cid <span class="token operator">|</span> cname <span class="token operator">|</span> sid <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+--------------+-----+-------+-----+-------+-----+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">90.0</span>         <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 张三  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+--------------+-----+-------+-----+-------+-----+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 教师表和课程表关联，获取到教师编号、教师名称和课程编号和课程名称，关联字段为教师编号<br> 作为临时表再和成绩表关联，关联字段为课程编号<br> 作为临时表再和学生表关联，关联字段为学生号</p> 
<h3><a id="36_1109"></a>36、成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>sid
            <span class="token punctuation">,</span> rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">MAX</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> Ranked
        <span class="token keyword">FROM</span> sc d
            <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>tid<span class="token punctuation">,</span> a<span class="token punctuation">.</span>tname<span class="token punctuation">,</span> b<span class="token punctuation">.</span>cid<span class="token punctuation">,</span> b<span class="token punctuation">.</span>cname
                <span class="token keyword">FROM</span> teacher a
                    <span class="token keyword">JOIN</span> course b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>tid <span class="token operator">=</span> b<span class="token punctuation">.</span>tid
                <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>tname <span class="token operator">=</span> <span class="token string">'张三'</span>
            <span class="token punctuation">)</span> c
            <span class="token keyword">ON</span> d<span class="token punctuation">.</span>cid <span class="token operator">=</span> c<span class="token punctuation">.</span>cid
    <span class="token punctuation">)</span> e
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> e<span class="token punctuation">.</span>sid
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>Ranked<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+--------------+-----+-------+-----+-------+-----+--------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> <span class="token function">MAX</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">|</span> tid <span class="token operator">|</span> tname <span class="token operator">|</span> cid <span class="token operator">|</span> cname <span class="token operator">|</span> sid <span class="token operator">|</span> Ranked <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+--------------+-----+-------+-----+-------+-----+--------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">90.0</span>         <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 张三  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+--------------+-----+-------+-----+-------+-----+--------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 用rank函数，然后再嵌套一个select，where rank = 1</p> 
<h3><a id="37_1142"></a>37、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> sc a
    <span class="token keyword">JOIN</span> sc b
    <span class="token keyword">ON</span> a<span class="token punctuation">.</span>score <span class="token operator">=</span> b<span class="token punctuation">.</span>score
        <span class="token operator">AND</span> a<span class="token punctuation">.</span>cid <span class="token operator">!=</span> b<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> sc表自连，distinct去重，cid 不同，score相同</p> 
<h3><a id="38_1168"></a>38、查询每门课程成绩最好的前两名</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- MySql8.0以上</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>dense_rank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> cid <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> ranked <span class="token keyword">FROM</span> sc <span class="token punctuation">)</span> a
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>ranked <span class="token operator">&lt;=</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- MySql5.7</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> sc
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> sc a
    <span class="token keyword">WHERE</span> sc<span class="token punctuation">.</span>CId <span class="token operator">=</span> a<span class="token punctuation">.</span>CId
        <span class="token operator">AND</span> sc<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>score
<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId <span class="token keyword">ASC</span><span class="token punctuation">,</span> sc<span class="token punctuation">.</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> cid <span class="token operator">|</span> score <span class="token operator">|</span> ranked <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">80.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">76.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">90.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> <span class="token number">89.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">99.0</span>  <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> <span class="token number">98.0</span>  <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-----+-------+--------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 我认为最好的前两名是排名的前2个，即第一个排名1 和第二个排名2，如果有两个并列第一，一个第二，那么前两名应该是3个人，用dense_rank，排名不跳过；如果说是最好的前两个人，就用rank，排名跳过</p> 
<h3><a id="39_5__1206"></a>39、统计每门课程的学生选修人数（超过 5 人的课程才统计）</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  course<span class="token punctuation">.</span>cname<span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> course 
<span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span>  cid<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">as</span> 选修人数 <span class="token keyword">FROM</span> sc <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> cid <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">as</span> a
<span class="token keyword">ON</span> course<span class="token punctuation">.</span>cid <span class="token operator">=</span> a<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-----+----------+</span>
<span class="token operator">|</span> cname <span class="token operator">|</span> cid <span class="token operator">|</span> 选修人数 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+----------+</span>
<span class="token operator">|</span> 语文  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>        <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> 数学  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span>        <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">|</span> 英语  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span>        <span class="token number">6</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+----------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> group by，having聚合</p> 
<h3><a id="40_1229"></a>40、检索至少选修两门课程的学生学号</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span>sname<span class="token punctuation">,</span> a<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> sid<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修课程总数
        <span class="token keyword">FROM</span> sc
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> sid
        <span class="token keyword">HAVING</span> 选修课程总数 <span class="token operator">&gt;=</span> <span class="token number">2</span>
    <span class="token punctuation">)</span> a
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> a<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-----+--------------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> sid <span class="token operator">|</span> 选修课程总数 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+--------------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span> <span class="token number">05</span>  <span class="token operator">|</span>            <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span> <span class="token number">06</span>  <span class="token operator">|</span>            <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span> <span class="token number">07</span>  <span class="token operator">|</span>            <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+--------------+</span>
<span class="token number">7</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<h3><a id="41_1258"></a>41、查询选修了全部课程的学生信息</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>选修课程总数<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> student
    <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> b<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token keyword">AS</span> 选修课程总数
        <span class="token keyword">FROM</span> course a
            <span class="token keyword">JOIN</span> sc b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>cid <span class="token operator">=</span> b<span class="token punctuation">.</span>cid
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> b<span class="token punctuation">.</span>sid
        <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>cid<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span>
            <span class="token keyword">FROM</span> course
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span> c
    <span class="token keyword">ON</span> student<span class="token punctuation">.</span>sid <span class="token operator">=</span> c<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+--------------+</span>
<span class="token operator">|</span> sid <span class="token operator">|</span> sname <span class="token operator">|</span> sage                <span class="token operator">|</span> ssex <span class="token operator">|</span> 选修课程总数 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+--------------+</span>
<span class="token operator">|</span> <span class="token number">01</span>  <span class="token operator">|</span> 赵雷  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">02</span>  <span class="token operator">|</span> 钱电  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">21</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">03</span>  <span class="token operator">|</span> 孙风  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">04</span>  <span class="token operator">|</span> 李云  <span class="token operator">|</span> <span class="token number">1990</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span> 男   <span class="token operator">|</span>            <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+---------------------+------+--------------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 从课程表中查询出总的课程数，作为后面子查询的条件<br> 从成绩表中查询出选修了全部课程数的的学生号和选修的课程总数<br> 作为临时表和学生表关联，关联字段为学生号，获取到全部的学生信息</p> 
<h3><a id="42_1293"></a>42、查询各学生的年龄，只按年份来算</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  sname<span class="token punctuation">,</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>sage<span class="token punctuation">)</span> <span class="token keyword">as</span> 年龄 <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+------+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> 年龄 <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+------+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span>   <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span>   <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span>   <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span>   <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span>   <span class="token number">30</span> <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span>   <span class="token number">29</span> <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span>   <span class="token number">32</span> <span class="token operator">|</span>
<span class="token operator">|</span> 王菊  <span class="token operator">|</span>   <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+------+</span>
<span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 使用year函数</p> 
<h3><a id="43___1318"></a>43、按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> sname
    <span class="token punctuation">,</span> <span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%m-%d'</span><span class="token punctuation">)</span> <span class="token operator">-</span> DATE_FORMAT<span class="token punctuation">(</span>sage<span class="token punctuation">,</span> <span class="token string">'%m-%d'</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>sage<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
        <span class="token keyword">ELSE</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>sage<span class="token punctuation">)</span>
    <span class="token keyword">END</span> <span class="token keyword">AS</span> age
<span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<pre><code class="prism language-sql"><span class="token operator">+</span><span class="token comment">-------+-----+</span>
<span class="token operator">|</span> sname <span class="token operator">|</span> age <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+</span>
<span class="token operator">|</span> 赵雷  <span class="token operator">|</span>  <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 钱电  <span class="token operator">|</span>  <span class="token number">30</span> <span class="token operator">|</span>
<span class="token operator">|</span> 孙风  <span class="token operator">|</span>  <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 李云  <span class="token operator">|</span>  <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">|</span> 周梅  <span class="token operator">|</span>  <span class="token number">29</span> <span class="token operator">|</span>
<span class="token operator">|</span> 吴兰  <span class="token operator">|</span>  <span class="token number">29</span> <span class="token operator">|</span>
<span class="token operator">|</span> 郑竹  <span class="token operator">|</span>  <span class="token number">32</span> <span class="token operator">|</span>
<span class="token operator">|</span> 王菊  <span class="token operator">|</span>  <span class="token number">31</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+-----+</span>
<span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span>
</code></pre> 
<p>解析：<br> 有两种方法，一种是利用date_format直接截取时间类型中的月日，直接比大小<br> 另外一种是用month()先比大小，相等再用day()比大小</p> 
<h3><a id="44_1349"></a>44、查询本周过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> sname <span class="token keyword">FROM</span> student  <span class="token keyword">WHERE</span> week<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> WEEK<span class="token punctuation">(</span>sage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：<br> Empty set</p> 
<p>解析：<br> week() 返回的是今年的第几周，即如果本周过生，返回数字相等</p> 
<h3><a id="45_1360"></a>45、查询下周过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> sname <span class="token keyword">FROM</span> student  <span class="token keyword">WHERE</span> week<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> WEEK<span class="token punctuation">(</span>sage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：<br> Empty set</p> 
<p>解析：<br> 加一就行</p> 
<h3><a id="46_1371"></a>46、查询本月过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> sname <span class="token keyword">FROM</span> student  <span class="token keyword">WHERE</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>sage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：<br> Empty set</p> 
<p>解析：<br> 使用month函数</p> 
<h3><a id="47_1382"></a>47、查询下月过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> sname <span class="token keyword">FROM</span> student  <span class="token keyword">WHERE</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>sage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：<br> Empty set</p> 
<h3><a id="48_1390"></a>48、查询下周过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> st<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student st
<span class="token keyword">WHERE</span> week<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">=</span> week<span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>st<span class="token punctuation">.</span>s_birth<span class="token punctuation">,</span> ‘ <span class="token operator">%</span> Y <span class="token operator">%</span> m <span class="token operator">%</span> d’<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="49_1397"></a>49、查询本月过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> st<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student st
<span class="token keyword">WHERE</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>st<span class="token punctuation">.</span>s_birth<span class="token punctuation">,</span> ‘ <span class="token operator">%</span> Y <span class="token operator">%</span> m <span class="token operator">%</span> d’<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="50_1404"></a>50、查询下月过生日的学生</h3> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> st<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student st
<span class="token keyword">WHERE</span> <span class="token keyword">month</span><span class="token punctuation">(</span>timestampadd<span class="token punctuation">(</span><span class="token keyword">month</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>st<span class="token punctuation">.</span>s_birth<span class="token punctuation">,</span> ‘ <span class="token operator">%</span> Y <span class="token operator">%</span> m <span class="token operator">%</span> d’<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 或者</span>

<span class="token keyword">SELECT</span> st<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> student st
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span><span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">12</span> <span class="token operator">=</span> <span class="token keyword">month</span><span class="token punctuation">(</span>date_format<span class="token punctuation">(</span>st<span class="token punctuation">.</span>s_birth<span class="token punctuation">,</span> ‘ <span class="token operator">%</span> Y <span class="token operator">%</span> m <span class="token operator">%</span> d’<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>注意:当当前月为12时,用month(now())+1为13而不是1,可用timestampadd()函数或mod取模</p> 
<h2><a id="_1419"></a>参考文章</h2> 
<p>MYSQL窗口函数：<a href="https://blog.csdn.net/Annabel_CM/article/details/125840831">https://blog.csdn.net/Annabel_CM/article/details/125840831</a></p> 
<p>MYSQL基础常见常用语句200条：<a href="https://blog.csdn.net/c361604199/article/details/79479398">https://blog.csdn.net/c361604199/article/details/79479398</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d1ea440f6eebb081095d72c81796efc7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">树莓派ubuntu mate系统安装pycharm</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/13e69a3a33da957673ec5c655e8b5e6e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue 父组件监听子组件的数据变化 父组件监听子组件的data</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>