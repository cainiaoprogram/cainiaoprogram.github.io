<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>traceroute 命令示例 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="traceroute 命令示例" />
<meta property="og:description" content="用途 显示 IP 信息包至某个网络主机的路由。
语法 traceroute [ -m Max_ttl ] [ -n ] [ -p Port ] [ -q Nqueries ] [ -r ] [ -d ] [ -g gateway_addr ] [ -s SRC_Addr ] [ -t TypeOfService ] [ -f flow ] [ -v ] [ -w WaitTime ] Host [ PacketSize ]
描述 注意： traceroute 命令适用于网络测试、评估和管理。它应主要用于手动故障隔离。由于它对网络施加的负荷， traceroute 命令不应用于正常的操作中或自动脚本。 traceroute 命令试图跟踪 IP 信息包至某个因特网主机的路由，其具体方法是：先启动具有小的最大存活时间值（Max_ttl 变量）的 UDP 探测信息包，然后侦听从网关开始一路上的 ICMP TIME_EXCEEDED 响应。探测以一个一跳跃位的 Max_ttl 值开始，该值一次增加一个跳跃值，直至返回 ICMP PORT_UNREACHABLE 消息。ICMP PORT_UNREACHABLE 消息可以指出主机已经被定位，或命令已经达到允许跟踪的最大跳跃数目。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/997bb953462ac329b72c0e454d1c6848/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-22T16:27:09+08:00" />
<meta property="article:modified_time" content="2018-10-22T16:27:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">traceroute 命令示例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>用途</h3> 
<p id="traceroute__a39c3b80297janb">显示 IP 信息包至某个网络主机的路由。</p> 
<h3>语法</h3> 
<p><strong>traceroute</strong> [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114065" rel="nofollow"><strong>-m</strong></a> <em>Max_ttl</em> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114073" rel="nofollow"><strong>-n</strong></a> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114079" rel="nofollow"><strong>-p</strong></a> <em>Port</em> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114099" rel="nofollow"><strong>-q</strong></a> <em>Nqueries</em> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114113" rel="nofollow"><strong>-r</strong></a> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__flagd" rel="nofollow"> <strong>-d</strong> </a> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__flagg" rel="nofollow"> <strong>-g</strong> </a> <em>gateway_addr</em> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114125" rel="nofollow"><strong>-s</strong></a> <em>SRC_Addr</em> ] [  <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114136" rel="nofollow"><strong>-t </strong></a><em>TypeOfService</em> ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114056" rel="nofollow"><strong>-f</strong></a> flow ] [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114163" rel="nofollow"><strong>-v</strong></a> ] [  <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114175" rel="nofollow"><strong>-w </strong></a><em>WaitTime </em>] <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114195" rel="nofollow"><em>Host</em></a> [ <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.cmds5/traceroute.htm?view=kc#traceroute__row-d3e114201" rel="nofollow"><em>PacketSize</em></a> ]</p> 
<h3>描述</h3> 
<blockquote> 
 <strong>注意：</strong> 
 <strong>traceroute</strong> 命令适用于网络测试、评估和管理。它应主要用于手动故障隔离。由于它对网络施加的负荷， 
 <strong> traceroute</strong> 命令不应用于正常的操作中或自动脚本。 
</blockquote> 
<p id="traceroute__a39c3b80325janb"><strong>traceroute</strong> 命令试图跟踪 IP 信息包至某个因特网主机的路由，其具体方法是：先启动具有小的最大存活时间值（<em>Max_ttl </em>变量）的 UDP 探测信息包，然后侦听从网关开始一路上的 ICMP <strong>TIME_EXCEEDED</strong> 响应。探测以一个一跳跃位的 <em>Max_ttl</em> 值开始，该值一次增加一个跳跃值，直至返回 ICMP <strong>PORT_UNREACHABLE</strong> 消息。ICMP <strong>PORT_UNREACHABLE</strong> 消息可以指出主机已经被定位，或命令已经达到允许跟踪的最大跳跃数目。</p> 
<p id="traceroute__a39c3b80336janb"><strong>traceroute</strong> 命令在每一个 <em>Max_ttl</em> 设置上发送三个探测值以记录以下一些内容：</p> 
<ul><li><em>Max_ttl</em> 值</li><li>网关地址</li><li>每次成功探测的往返时间</li></ul> 
<p id="traceroute__a39c3b80350janb">通过使用 <strong>-q</strong> 标志，可以增加发送的探测数目。如果探测的回答来自不同的网关，那么命令会显示各个响应系统的地址。如果在 3 秒的超时时间间隔中没有来自探测的应答，那么会针对该探测显示出 *（星号）。</p> 
<p id="traceroute__a39c3b80362janb">如果 <em>Max_ttl</em> 值为一个跳跃或更小，那么 <strong>traceroute</strong> 命令会在往返时间后显示一个“!”（感叹号）。一个跳跃或更小的最大存活时间值一般都指出了不同网络软件处理 ICMP 应答的方式的不兼容性。不兼容性通常是通过将上次使用的 <em>Max_ttl</em> 值加倍并再次尝试来解析的。</p> 
<p id="traceroute__a39c3b80373janb">在往返注释后，其他可能的注释有：</p> 
<table border="0" cellpadding="4" cellspacing="0"><thead><tr><th id="d372608e228">项目</th><th id="d372608e230">描述</th></tr></thead><tbody><tr id="traceroute__row-d3e114001"><td style="vertical-align:top;"><strong>!H</strong></td><td style="vertical-align:top;">主机不可到达</td></tr><tr id="traceroute__row-d3e114007"><td style="vertical-align:top;"><strong>!N</strong></td><td style="vertical-align:top;">网络不可达</td></tr><tr id="traceroute__row-d3e114013"><td style="vertical-align:top;"><strong>!P</strong></td><td style="vertical-align:top;">协议不可达</td></tr><tr id="traceroute__row-d3e114019"><td style="vertical-align:top;"><strong>!S</strong></td><td style="vertical-align:top;">源路由失败</td></tr><tr id="traceroute__row-d3e114025"><td style="vertical-align:top;"><strong>!F</strong></td><td style="vertical-align:top;">需要碎片</td></tr></tbody></table> 
<p id="traceroute__a39c3b80389janb">如果有许多探测都产生某一错误，那么 <strong>traceroute</strong> 命令退出。</p> 
<p id="traceroute__a39c3b80400janb"><strong>traceroute</strong> 命令唯一的强制性参数就是目标主机名称或 IP 数字。<strong>traceroute</strong> 命令将根据输出接口的最大传输单元（MTU）确定探测信息包的长度。UDP 探测信息包被设置为一个不可能的值，以防止目标主机的处理。</p> 
<h3>标志</h3> 
<table border="0" cellpadding="4" cellspacing="0"><thead><tr><th id="d372608e289">项目</th><th id="d372608e291">描述</th></tr></thead><tbody><tr id="traceroute__flagd"><td style="vertical-align:top;"> <strong>-d</strong> </td><td style="vertical-align:top;"> 启用套接字级别调试。 </td></tr><tr id="traceroute__row-d3e114056"><td style="vertical-align:top;"><strong>-f</strong> flow</td><td style="vertical-align:top;">在 IPv6 包头设置流量标签字段。缺省值为 0。</td></tr><tr id="traceroute__flagg"><td style="vertical-align:top;"> <strong>-g</strong> <em>gateway_addr</em> </td><td style="vertical-align:top;"> 通过 IP 源路由选项，使出局包通过指定网关。使用此标志之前，路由器必须启用 IP 源路由。此标志仅对 IPv6 地址可用。 </td></tr><tr id="traceroute__row-d3e114065"><td style="vertical-align:top;"><strong>-m</strong><em> Max_ttl</em></td><td style="vertical-align:top;">设置用于输出探测信息包的最大存活时间（最大的跳跃数）。缺省值为 30 个跳跃（TCP 连接也使用相同的缺省值）。</td></tr><tr id="traceroute__row-d3e114073"><td style="vertical-align:top;"><strong>-n</strong></td><td style="vertical-align:top;">以数字方式而不以符号加数字的方式显示跳跃地址。该标志为在路径上找到的每个网关保存名称服务器的“地址到姓名”查询。</td></tr><tr id="traceroute__row-d3e114079"><td style="vertical-align:top;"><strong>-p</strong><em>Port</em></td><td style="vertical-align:top;">设置用于探测的基本 UDP 端口号。缺省值为 33434。<strong>traceroute</strong> 命令取决于目标主机的开放式 UDP 端口范围，<em>base</em> 至 <em>base</em> + <em>nhops -</em> 1。如果 UDP 端口不可用，那么该选项可以用于选择一个未曾使用的端口范围。</td></tr><tr id="traceroute__row-d3e114099"><td style="vertical-align:top;"><strong>-q</strong><em> Nqueries</em></td><td style="vertical-align:top;">指定 <strong>traceroute</strong> 命令在每个 <em>Max_ttl</em> 设定值处发出的探测数目。缺省值为三次探测。</td></tr><tr id="traceroute__row-d3e114113"><td style="vertical-align:top;"><strong>-r</strong></td><td style="vertical-align:top;">忽略正常的路由表，并直接发送探测信息包至已链接网络上的主机。如果指定的主机不在直接连接的网络上，那么返回一个错误。该选项可以用于通过 <strong>routed</strong> 守护程序路由表中未注册的接口向本地主机发出 <strong>ping</strong>命令。</td></tr><tr id="traceroute__row-d3e114125"><td style="vertical-align:top;"><strong>-s</strong><em> SRC_Addr</em></td><td style="vertical-align:top;">以数字格式将下一 IP 地址用作输出探测信息包的源地址。在具有不止一个 IP 地址的主机上，可以使用 <strong>-s</strong> 标志强制将源地址转变成与发送探测包的接口的 IP 地址不同的地址。如果下一个 IP 地址不是机器接口地址之一，那么返回一个错误且不发送任何内容。</td></tr><tr id="traceroute__row-d3e114136"><td style="vertical-align:top;"><strong>-t</strong><em> TypeOfService</em></td><td style="vertical-align:top;">将探测信息包中的 <em>TypeOfService</em> 变量设置为 0 至 255 范围内的一个十进制整数。缺省值为 0。该标志可用于调查不同的服务类型是否产生了不同的路径。有关更多信息，请参阅<em>Performance Tools Guide and Reference</em>中的 <a href="https://www.ibm.com/support/knowledgecenter/zh/ssw_aix_72/com.ibm.aix.networkcomm/tcpip_protocols.htm?view=kc" rel="nofollow">TCP/IP 协议</a>。有用的数值为 <strong>-t</strong><strong> 16</strong>（低延迟）和 <strong>-t</strong><strong> 8</strong>（高吞吐量）。</td></tr><tr id="traceroute__row-d3e114163"><td style="vertical-align:top;"><strong>-v</strong></td><td style="vertical-align:top;">接收除 <strong>TIME_EXCEEDED</strong> 和 <strong>PORT_UNREACHABLE</strong> 以外的信息包（详细输出）。</td></tr><tr id="traceroute__row-d3e114175"><td style="vertical-align:top;"><strong>-w</strong><em> WaitTime</em></td><td style="vertical-align:top;">设置等待探测响应的时间（以秒为单位）。 缺省值为 3 秒。</td></tr></tbody></table> 
<h3>参数</h3> 
<table border="0" cellpadding="4" cellspacing="0"><thead><tr><th id="d372608e472">项目</th><th id="d372608e474">描述</th></tr></thead><tbody><tr id="traceroute__row-d3e114195"><td style="vertical-align:top;"><em>Host</em></td><td style="vertical-align:top;">通过主机名或 IP 数字指定目标主机。该参数是必要的。</td></tr><tr id="traceroute__row-d3e114201"><td style="vertical-align:top;"><em>PacketSize</em></td><td style="vertical-align:top;">指定探测数据报长度。缺省信息包大小可以通过 <strong>traceroute</strong> 命令根据输出接口的 MTU 来确定。</td></tr></tbody></table> 
<h3>安全性</h3> 
<p>RBAC 用户和可信 AIX 用户注意：此命令可以执行特权操作。只有特权用户才能运行特权操作。有关权限与特权的更多信息，请参阅<em>安全性</em>中的『特权命令数据库』。要获取与此命令相关联的特权和权限的列表，请参阅 lssecattr 命令或 getcmdattr 子命令。</p> 
<h3>示例</h3> 
<ol><li id="traceroute__c6a65cc755sylv">一个使用和输出的样本为： <pre id="traceroute__c6a65cc850sylv"><code>[yak 71]% traceroute nis.nsf.net.
traceroute to nis.nsf.net (35.1.1.48), 30 hops max, 56 byte packet
  1 helios.ee.lbl.gov (128.3.112.1) 19 ms 19 ms 0 ms
  2 lilac-dmc.Berkeley.EDU (128.32.216.1) 39 ms 39 ms 19 ms
  3 lilac-dmc.Berkeley.EDU (128.32.216.1) 39 ms 39 ms 19 ms
  4 ccngw-ner-cc.Berkeley.EDU (128.32.136.23) 39 ms 40 ms 39 ms
  5 ccn-nerif22.Berkeley.EDU (128.32.168.22) 39 ms 39 ms 39 ms
  6 128.32.197.4 (128.32.197.4) 40 ms 59 ms 59 ms
  7 131.119.2.5 (131.119.2.5) 59 ms 59 ms 59 ms
  8 129.140.70.13 (129.140.70.13) 99 ms 99 ms 80 ms
  9 129.140.71.6 (129.140.71.6) 139 ms 239 ms 319 ms
10 129.140.81.7 (129.140.81.7) 220 ms 199 ms 199 ms
11 nic.merit.edu (35.1.1.48) 239 ms 239 ms 239 ms</code></pre> 由于第二个跳跃系统（lbl-csam.arpa）内核中的错误（向前转发了零存活时间的信息包），结果第二行和第三行相同。在第 6 到第 10 行中，不显示主机名称，因为美国国家科学基金会网络（NSFNet，129.140）不提供其节点的地址到名称的转换。</li><li id="traceroute__c6a65cd176sylv">另外一个输出样本如下： <pre id="traceroute__c6a65cd259sylv"><code>[yak 72]% traceroute rip.Berkeley.EDU (128.32.131.22)
traceroute to rip.Berkeley.EDU (128.32.131.22), 30 hops max
  1 helios.ee.lbl.gov (128.3.112.1) 0 ms 0 ms 0 ms
  2 lilac-dmc.Berkeley.EDU (128.32.216.1) 39 ms 19 ms 39 ms
  3 lilac-dmc.Berkeley.EDU (128.32.216.1) 19 ms 39 ms 19 ms
  4 ccngw-ner-cc.Berkeley.EDU (128.32.136.23) 39 ms 40 ms 19 ms
  5 ccn-nerif35.Berkeley.EDU (128.32.168.35) 39 ms 39 ms 39 ms
  6 csgw/Berkeley.EDU (128.32.133.254) 39 ms 59 ms 39 ms
  7 * * *
  8 * * *
  9 * * *
10 * * *
11 * * *
12 * * *
13 rip.Berkeley.EDU (128.32.131.22) 59 ms! 39 ms! 39 ms</code></pre> 在本示例中，恰好“丢失”了 12 个网关跳跃的一半（13 是最后的目标）。但是，这些跳跃实际并不是网关。目标主机，一个运行 Sun OS3.5 的 Sun-3 工作站，将来自到达数据报的 ttl 用作其 ICMP 回复的 ttl，因此回复会在返回路径上发生超时。由于 ICMP 不是对 ICMP 发送的，因此不会接收到任何通知。命令（感叹号）每次往返时间只会指示某一类型软件的不兼容性问题。（其原因是在 <strong>traceroute</strong> 命令发布一个两倍路径长的探测之后进行诊断。目标主机实际只是在 7 个跳跃以外。）</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f48b38bdb6d4b4f768cdd2bc604bbacd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">房间类游戏后台框架(一)—介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f9cd63cafdeedb5b5b3bb80ff32b8fdb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言单链表的创建（使用函数）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>