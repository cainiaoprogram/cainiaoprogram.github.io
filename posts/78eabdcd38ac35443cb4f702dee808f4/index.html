<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>8种交叉验证类型的深入解释和可视化介绍 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="8种交叉验证类型的深入解释和可视化介绍" />
<meta property="og:description" content="交叉验证（也称为“过采样”技术）是数据科学项目的基本要素。 它是一种重采样过程，用于评估机器学习模型并访问该模型对独立测试数据集的性能。
在本文中，您可以阅读以下大约8种不同的交叉验证技术，各有其优缺点：
Leave p out cross-validationLeave one out cross-validationHoldout cross-validationRepeated random subsampling validationk-fold cross-validationStratified k-fold cross-validationTime Series cross-validationNested cross-validation 在介绍交叉验证技术之前，让我们知道为什么在数据科学项目中应使用交叉验证。
为什么交叉验证很重要？ 我们经常将数据集随机分为训练数据和测试数据，以开发机器学习模型。 训练数据用于训练ML模型，同一模型在独立的测试数据上进行测试以评估模型的性能。
随着分裂随机状态的变化，模型的准确性也会发生变化，因此我们无法为模型获得固定的准确性。 测试数据应与训练数据无关，以免发生数据泄漏。 在使用训练数据开发ML模型的过程中，需要评估模型的性能。 这就是交叉验证数据的重要性。
数据需要分为：
训练数据：用于模型开发验证数据：用于验证相同模型的性能 简单来说，交叉验证使我们可以更好地利用我们的数据。
1.Leave p-out cross-validation LpOCV是一种详尽的交叉验证技术，涉及使用p观测作为验证数据，而其余数据则用于训练模型。 以所有方式重复此步骤，以在p个观察值的验证集和一个训练集上切割原始样本。
已推荐使用p = 2的LpOCV变体（称为休假配对交叉验证）作为估计二进制分类器ROC曲线下面积的几乎无偏的方法。
2. Leave-one-out cross-validation 留一法交叉验证（LOOCV）是一种详尽的穷尽验证技术。 在p = 1的情况下，它是LpOCV的类别。
对于具有n行的数据集，选择第1行进行验证，其余(n-1)行用于训练模型。对于下一个迭代，选择第2行进行验证，然后重置来训练模型。类似地，这个过程重复进行，直到n步或达到所需的操作次数。
以上两种交叉验证技术都是详尽交叉验证的类型。穷尽性交叉验证方法是交叉验证方法，以所有可能的方式学习和测试。他们有相同的优点和缺点讨论如下:
优点： 简单，易于理解和实施
缺点： 该模型可能会导致较低的偏差、所需的计算时间长
3.Holdout cross-validation 保留技术是一种详尽的交叉验证方法，该方法根据数据分析将数据集随机分为训练数据和测试数据。
在保留交叉验证的情况下，数据集被随机分为训练和验证数据。 通常，训练数据的分割不仅仅是测试数据。 训练数据用于推导模型，而验证数据用于评估模型的性能。
用于训练模型的数据越多，模型越好。 对于保留交叉验证方法，需要从训练中隔离大量数据。
优点：和以前一样，简单，易于理解和实施
缺点： 不适合不平衡数据集、许多数据与训练模型隔离
4. k-fold cross-validation 在k折交叉验证中，原始数据集被平均分为k个子部分或折叠。 从k折或组中，对于每次迭代，选择一组作为验证数据，其余（k-1）个组选择为训练数据。
该过程重复k次，直到将每个组视为验证并保留为训练数据为止。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/78eabdcd38ac35443cb4f702dee808f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-22T08:37:21+08:00" />
<meta property="article:modified_time" content="2020-09-22T08:37:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">8种交叉验证类型的深入解释和可视化介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/53/14/zJVcMLFV_o.jpg" alt=""></p> 
<p>交叉验证（也称为“过采样”技术）是数据科学项目的基本要素。 它是一种重采样过程，用于评估机器学习模型并访问该模型对独立测试数据集的性能。</p> 
<p>在本文中，您可以阅读以下大约8种不同的交叉验证技术，各有其优缺点：</p> 
<ol><li>Leave p out cross-validation</li><li>Leave one out cross-validation</li><li>Holdout cross-validation</li><li>Repeated random subsampling validation</li><li>k-fold cross-validation</li><li>Stratified k-fold cross-validation</li><li>Time Series cross-validation</li><li>Nested cross-validation</li></ol> 
<p>在介绍交叉验证技术之前，让我们知道为什么在数据科学项目中应使用交叉验证。</p> 
<h3><a id="_19"></a>为什么交叉验证很重要？</h3> 
<p>我们经常将数据集随机分为训练数据和测试数据，以开发机器学习模型。 训练数据用于训练ML模型，同一模型在独立的测试数据上进行测试以评估模型的性能。</p> 
<p>随着分裂随机状态的变化，模型的准确性也会发生变化，因此我们无法为模型获得固定的准确性。 测试数据应与训练数据无关，以免发生数据泄漏。 在使用训练数据开发ML模型的过程中，需要评估模型的性能。 这就是交叉验证数据的重要性。</p> 
<p>数据需要分为：</p> 
<ul><li>训练数据：用于模型开发</li><li>验证数据：用于验证相同模型的性能</li></ul> 
<p><img src="https://images2.imgbox.com/7e/79/YsNGxzZj_o.png" alt=""></p> 
<p>简单来说，交叉验证使我们可以更好地利用我们的数据。</p> 
<h3><a id="1Leave_pout_crossvalidation_34"></a>1.Leave p-out cross-validation</h3> 
<p>LpOCV是一种详尽的交叉验证技术，涉及使用p观测作为验证数据，而其余数据则用于训练模型。 以所有方式重复此步骤，以在p个观察值的验证集和一个训练集上切割原始样本。</p> 
<p>已推荐使用p = 2的LpOCV变体（称为休假配对交叉验证）作为估计二进制分类器ROC曲线下面积的几乎无偏的方法。</p> 
<h3><a id="2_Leaveoneout_crossvalidation_40"></a>2. Leave-one-out cross-validation</h3> 
<p>留一法交叉验证（LOOCV）是一种详尽的穷尽验证技术。 在p = 1的情况下，它是LpOCV的类别。</p> 
<p><img src="https://images2.imgbox.com/ea/13/sZD8X3Zt_o.gif" alt=""></p> 
<p>对于具有n行的数据集，选择第1行进行验证，其余(n-1)行用于训练模型。对于下一个迭代，选择第2行进行验证，然后重置来训练模型。类似地，这个过程重复进行，直到n步或达到所需的操作次数。</p> 
<p>以上两种交叉验证技术都是详尽交叉验证的类型。穷尽性交叉验证方法是交叉验证方法，以所有可能的方式学习和测试。他们有相同的优点和缺点讨论如下:</p> 
<p>优点： 简单，易于理解和实施</p> 
<p>缺点： 该模型可能会导致较低的偏差、所需的计算时间长</p> 
<h3><a id="3Holdout_crossvalidation_54"></a>3.Holdout cross-validation</h3> 
<p>保留技术是一种详尽的交叉验证方法，该方法根据数据分析将数据集随机分为训练数据和测试数据。</p> 
<p><img src="https://images2.imgbox.com/fc/8c/kbHptXvs_o.png" alt=""></p> 
<p>在保留交叉验证的情况下，数据集被随机分为训练和验证数据。 通常，训练数据的分割不仅仅是测试数据。 训练数据用于推导模型，而验证数据用于评估模型的性能。</p> 
<p>用于训练模型的数据越多，模型越好。 对于保留交叉验证方法，需要从训练中隔离大量数据。</p> 
<p>优点：和以前一样，简单，易于理解和实施</p> 
<p>缺点： 不适合不平衡数据集、许多数据与训练模型隔离</p> 
<h3><a id="4_kfold_crossvalidation_69"></a>4. k-fold cross-validation</h3> 
<p>在k折交叉验证中，原始数据集被平均分为k个子部分或折叠。 从k折或组中，对于每次迭代，选择一组作为验证数据，其余（k-1）个组选择为训练数据。</p> 
<p><img src="https://images2.imgbox.com/9f/60/4Hk8XrH2_o.gif" alt=""></p> 
<p>该过程重复k次，直到将每个组视为验证并保留为训练数据为止。</p> 
<p><img src="https://images2.imgbox.com/29/ca/W6xKVFka_o.png" alt=""></p> 
<p>模型的最终精度是通过获取k模型验证数据的平均精度来计算的。</p> 
<p><img src="https://images2.imgbox.com/d7/33/f5xFZo60_o.png" alt=""></p> 
<p>LOOCV是k折交叉验证的变体，其中k = n。</p> 
<p>优点：</p> 
<ul><li>该模型偏差低</li><li>时间复杂度低</li><li>整个数据集可用于训练和验证</li></ul> 
<p>缺点：不适合不平衡数据集。</p> 
<h3><a id="5_Repeated_random_subsampling_validation_93"></a>5. Repeated random subsampling validation</h3> 
<p>重复的随机子采样验证（也称为蒙特卡洛交叉验证）将数据集随机分为训练和验证。 数据集的k倍交叉验证不太可能分成几类，而不是成组或成对，而是在这种情况下随机地成组。</p> 
<p>迭代次数不是固定的，而是由分析决定的。 然后将结果平均化。</p> 
<p><img src="https://images2.imgbox.com/02/4b/XvF1KXAv_o.png" alt=""></p> 
<p>重复随机二次抽样验证</p> 
<p><img src="https://images2.imgbox.com/23/9d/CElofPSB_o.png" alt=""></p> 
<p>优点： 训练和验证拆分的比例不取决于迭代或分区的数量</p> 
<p>缺点： 某些样本可能无法选择用于训练或验证、不适合不平衡数据集</p> 
<h3><a id="6_Stratified_kfold_crossvalidation_109"></a>6. Stratified k-fold cross-validation</h3> 
<p>对于上面讨论的所有交叉验证技术，它们可能不适用于不平衡的数据集。 分层k折交叉验证解决了数据集不平衡的问题。</p> 
<p>在分层k倍交叉验证中，数据集被划分为k个组或折叠，以使验证数据具有相等数量的目标类标签实例。 这样可以确保在验证或训练数据中不会出现一个特定的类，尤其是在数据集不平衡时。</p> 
<p><img src="https://images2.imgbox.com/69/39/idMaJD4Q_o.png" alt=""></p> 
<p>分层k折交叉验证，每折具有相等的目标类实例</p> 
<p>最终分数是通过取各折分数的平均值来计算的</p> 
<p>优点： 对于不平衡的数据集，效果很好。</p> 
<p>缺点： 现在适合时间序列数据集。</p> 
<h3><a id="7_Time_Series_crossvalidation_126"></a>7. Time Series cross-validation</h3> 
<p>数据的顺序对于与时间序列相关的问题非常重要。 对于与时间相关的数据集，将数据随机拆分或k折拆分为训练和验证可能不会产生良好的结果。</p> 
<p>对于时间序列数据集，根据时间将数据分为训练和验证，也称为前向链接方法或滚动交叉验证。 对于特定的迭代，可以将训练数据的下一个实例视为验证数据。</p> 
<p><img src="https://images2.imgbox.com/9d/98/FOnhwhVg_o.png" alt=""></p> 
<p>如上图所述，对于第一个迭代，第一个3行被视为训练数据，下一个实例T4是验证数据。 选择训练和验证数据的机会将被进一步迭代。</p> 
<h3><a id="8_Nested_crossvalidation_137"></a>8. Nested cross-validation</h3> 
<p>在进行k折和分层k折交叉验证的情况下，我们对训练和测试数据中的错误估计差。 超参数调整是在较早的方法中单独完成的。 当交叉验证同时用于调整超参数和泛化误差估计时，需要嵌套交叉验证。</p> 
<p>嵌套交叉验证可同时应用于k折和分层k折变体。</p> 
<h3><a id="_143"></a>结论</h3> 
<p>交叉验证用于比较和评估ML模型的性能。 在本文中，我们介绍了8种交叉验证技术及其优缺点。 k折和分层k折交叉验证是最常用的技术。 时间序列交叉验证最适合与时间序列相关的问题。</p> 
<p>这些交叉验证的实现可以在sklearn包中找到。 有兴趣的读者可以阅读sklearn文档以获取更多详细信息。</p> 
<p>https://scikit-learn.org/stable/modules/cross_validation.html</p> 
<p>作者：Satyam Kumar</p> 
<p>deephub翻译组</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee51062e17ed4d6b2b1f1892842f1e41/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">opencv入门：矩特征，Hu矩</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d6a93fe23023ce2dd0f179cce28fc589/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java大文件(百M以上)的上传下载讨论</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>