<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>org.apache.catalina.connector.ClientAbortException: java.io.IOException: 您的主机中的软件中止了一个已建立的连接。 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="org.apache.catalina.connector.ClientAbortException: java.io.IOException: 您的主机中的软件中止了一个已建立的连接。" />
<meta property="og:description" content="问题 org.apache.catalina.connector.ClientAbortException: java.io.IOException: 您的主机中的软件中止了一个已建立的连接。
org.apache.catalina.connector.ClientAbortException: java.net.SocketException: Software caused connection abort: socket write error at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:410) at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:371) at org.apache.catalina.connector.OutputBuffer.writeBytes(OutputBuffer.java:435) at org.apache.catalina.connector.OutputBuffer.write(OutputBuffer.java:423) at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:91) at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:84) at org.apache.commons.io.IOUtils.write(IOUtils.java:631) at com.wei.utils.CreateZipAndDownload.CreateZipAndDownload(CreateZipAndDownload.java:68) at com.wei.service.impl.ArticleServiceImpl.download(ArticleServiceImpl.java:128) at com.wei.web.servlet.ArticleServlet.download(ArticleServlet.java:70) at com.wei.web.servlet.ArticleServlet.doGet(ArticleServlet.java:61) at com.wei.web.servlet.ArticleServlet.doPost(ArticleServlet.java:180) at javax.servlet.http.HttpServlet.service(HttpServlet.java:650) at javax.servlet.http.HttpServlet.service(HttpServlet.java:731) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208) at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208) at com.wei.web.filter.EncodingFilter.doFilter(EncodingFilter.java:29) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:218) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:505) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103) at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:956) at org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/226d5d880d3c0c805da221ba83a4c41c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-19T13:09:24+08:00" />
<meta property="article:modified_time" content="2020-04-19T13:09:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">org.apache.catalina.connector.ClientAbortException: java.io.IOException: 您的主机中的软件中止了一个已建立的连接。</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>问题</h2> 
<p>org.apache.catalina.connector.ClientAbortException: java.io.IOException: 您的主机中的软件中止了一个已建立的连接。</p> 
<pre><code class="prism language-xml">org.apache.catalina.connector.ClientAbortException: java.net.SocketException: Software caused connection abort: socket write error
	at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:410)
	at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:371)
	at org.apache.catalina.connector.OutputBuffer.writeBytes(OutputBuffer.java:435)
	at org.apache.catalina.connector.OutputBuffer.write(OutputBuffer.java:423)
	at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:91)
	at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:84)
	at org.apache.commons.io.IOUtils.write(IOUtils.java:631)
	at com.wei.utils.CreateZipAndDownload.CreateZipAndDownload(CreateZipAndDownload.java:68)
	at com.wei.service.impl.ArticleServiceImpl.download(ArticleServiceImpl.java:128)
	at com.wei.web.servlet.ArticleServlet.download(ArticleServlet.java:70)
	at com.wei.web.servlet.ArticleServlet.doGet(ArticleServlet.java:61)
	at com.wei.web.servlet.ArticleServlet.doPost(ArticleServlet.java:180)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:650)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:731)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.wei.web.filter.EncodingFilter.doFilter(EncodingFilter.java:29)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:218)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:505)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:169)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:956)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:442)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1082)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:623)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Unknown Source)
Caused by: java.net.SocketException: Software caused connection abort: socket write error
	at java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.net.SocketOutputStream.socketWrite(Unknown Source)
	at java.net.SocketOutputStream.write(Unknown Source)
	at org.apache.coyote.http11.InternalOutputBuffer.realWriteBytes(InternalOutputBuffer.java:215)
	at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:480)
	at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:366)
	at org.apache.coyote.http11.InternalOutputBuffer$OutputStreamOutputBuffer.doWrite(InternalOutputBuffer.java:240)
	at org.apache.coyote.http11.filters.IdentityOutputFilter.doWrite(IdentityOutputFilter.java:84)
	at org.apache.coyote.http11.AbstractOutputBuffer.doWrite(AbstractOutputBuffer.java:192)
	at org.apache.coyote.Response.doWrite(Response.java:499)
	at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:405)
	... 36 more
</code></pre> 
<p><code>org.apache.catalina.connector.ClientAbortException: java.net.SocketException: Software caused connection abort: socket write error</code></p> 
<p>机翻：<code>org.apache.catalina.connector.ClientAbortException：java.net.SocketException：软件导致连接中止：套接字写入错误</code></p> 
<p><img src="https://images2.imgbox.com/4a/95/beE8BcB3_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_64"></a>解决</h2> 
<p>Stack Overflow：https://stackoverflow.com/search?q=Software+caused+connection+abort%3A+socket+write+error</p> 
<p>https://stackoverflow.com/questions/2126607/official-reasons-for-software-caused-connection-abort-socket-write-error?r=SearchResults</p> 
<p>https://docs.microsoft.com/en-us/previous-versions/ms832256(v=msdn.10)?redirectedfrom=MSDN</p> 
<p>https://community.oracle.com/thread/1691330</p> 
<h3><a id="_74"></a>他人分析</h3> 
<h4><a id="1_75"></a>1</h4> 
<p>程序运行正常，数据也没有出错，后台却老是报这个错误。在网上找了别人写的博客，这个问题的原因有几个：</p> 
<p>①：服务器的并发连接数超过了其承载量，服务器会将其中一些连接Down掉；<br> ②：客户关掉了浏览器，而服务器还在给客户端发送数据；<br> ③：浏览器端按了Stop<br> ④：用servlet的outputstream输出流下载图片时，当用户点击取消也会报这个错</p> 
<p>花了些功夫最后找出来的原因是：用servlet的response.getOutputStream时，写回多个数据，而客户端没全部接收，可能会报下面这个错误。如:</p> 
<p>服务器上写了两条数据</p> 
<p>out.writeObject(“1”);</p> 
<p>out.writeObject(“2”);</p> 
<p>客户端只接收一条<br> in.readObject(url);</p> 
<p>上面摘自：https://www.iteye.com/blog/asdzheng-1921858</p> 
<h4><a id="2tomcat_99"></a>2：tomcat超时？</h4> 
<p>在tomcat中出现这个错误是由于客户端在发送请求后，还没等服务器响应就断开了连接，有可能是因为网络原因，突然网断了，但是如果错误频繁出现的话，可能就是服务端的问题了。</p> 
<p>tomcat中配置了一个连接超时时间connectionTimeout，如果在这个时间之后客户端还未得到服务器端的响应的话，就会主动断开连接，这样就会出现上述异常了，tomcat中默认的连接超时时间是20秒，我们一般最好设置为60秒，从而避免后台程序处理时间长导致连接断开。</p> 
<p>解决方法：<br> 可以通过设置tomcat下conf文件夹的server.xml文件，对请求连接数和请求超时时间进行设置。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8080<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>HTTP/1.1<span class="token punctuation">"</span></span>   
              <span class="token attr-name">connectionTimeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20000<span class="token punctuation">"</span></span>   
              <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8443<span class="token punctuation">"</span></span> <span class="token attr-name">acceptCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span> <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>  
connectionTimeout以毫秒为单位，默认设置为20秒。通过修改该参数，可以修改tomcat的请求超时时间；
</code></pre> 
<p>关于修改最大并发请求连接数，需要修改<code>maxThreads</code>和<code>acceptCount</code>两个参数，</p> 
<p>其中，<code>maxThreads</code>的介绍如下：</p> 
<p>The maximum number of request processing threads to be created by this Connector, which therefore determines the maximum number of simultaneous requests that can be handled. If not specified, this attribute is set to 200. If an executor is associated with this connector, this attribute is ignored as the connector will execute tasks using the executor rather than an internal thread pool.</p> 
<p>此连接器要创建的请求处理线程的最大数目，从而确定可以处理的同时请求的最大数目。如果未指定，则此属性设置为200。如果执行器与此连接器关联，则忽略此属性，因为连接器将使用执行器而不是内部线程池执行任务。</p> 
<p>而<code>acceptCount</code>的介绍为：</p> 
<p>The maximum queue length for incoming connection requests when all possible request processing threads are in use. Any requests received when the queue is full will be refused. The default value is 100.</p> 
<p>当所有可能的请求处理线程都在使用时，传入连接请求的最大队列长度。当队列已满时收到的任何请求都将被拒绝。默认值为100。</p> 
<p>所以两者的默认值分别是200和100，要调整Tomcat的默认最大连接数，可以增加这两个属性的值，并且使acceptCount大于等于maxThreads</p> 
<p>摘自：：https://blog.csdn.net/persistencegoing/article/details/88850767</p> 
<h4><a id="3mysql_139"></a>3.mysql连接超时？</h4> 
<p>网上最多的还是mysql的8小时超时，根据他们所说的修改mysql的配置文件加入interactive_timeout=28800000 wait_timeout=28800000，然并卵，没用，依然没有解决问题。后面看到一篇关于spring+c3p0连接池配置的文章修改了自己连接池配置：</p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 指定连接池中保留的最大连接数. Default:15--&gt;</span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.maxPoolSize}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token comment">&lt;!-- 指定连接池中保留的最小连接数--&gt;</span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>minPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.minPoolSize}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token comment">&lt;!-- 指定连接池的初始化连接数  取值应在minPoolSize 与 maxPoolSize 之间.Default:3--&gt;</span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>initPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.initialPoolSize}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token comment">&lt;!-- 最大空闲时间,60秒内未使用则连接被丢弃。若为0则永不丢弃。 Default:0--&gt;</span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxIdleTime<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.maxIdleTime}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token comment">&lt;!-- 当连接池中的连接耗尽的时候c3p0一次同时获取的连接数. Default:3--&gt;</span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>acquireIncrement<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.acquireIncrement}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 每60秒检查所有连接池中的空闲连接.Default:0 --&gt;</span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>idleConnectionTestPeriod<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.idleConnectionTestPeriod}<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>  
</code></pre> 
<pre><code class="prism language-xml">jdbc.maxPoolSize=100
jdbc.minPoolSize=10
jdbc.initPoolSize=20
jdbc.maxIdleTime=120
jdbc.acquireIncrement=6
jdbc.idleConnectionTestPeriod=60
</code></pre> 
<p>原文链接：https://blog.csdn.net/z842667166/article/details/54943845</p> 
<h4><a id="_172"></a>我的</h4> 
<p>查了好多资料，总结如下</p> 
<h4><a id="_176"></a>原因</h4> 
<p>This error can occur when the local network system aborts a connection, such as when WinSock closes an established connection after data retransmission fails (receiver never acknowledges data sent on a datastream socket).</p> 
<p>当本地网络系统中止连接时，例如当WinSock在数据重新传输失败后关闭已建立的连接时（接收器从不确认在数据流套接字上发送的数据），可能会发生此错误。</p> 
<h4><a id="_181"></a>解决</h4> 
<p>Check the following: 1. Ping the remote host you were connected to. If it doesn’t respond, it might be off-line or there might be a network problem along the way. If it does respond, then this problem might have been a transient one (so you can reconnect now), or the server application you were connected to might have terminated (so you might not be able to connect again). 2. Ping a local host to verify that your local network is still functioning (if on a serial connection, see next step). 3. Ping your local router address. If you are on a serial connection, your local router is the IP address of the host you initially logged on to using SLIP or PPP. 4. Ping a host on the same subnet as the host you were connected to (if you know of one). This will verify that the destination network is functioning. 5. Use the tracert command at the command prompt to determine the path to the host you were connected to. This won’t reveal too much unless you know the router addresses at the remote end, but it might help to identify if the problem is somewhere along the way.<br> 检查以下各项：1。Ping连接到的远程主机。如果它不响应，可能是离线的，也可能是一路上的网络问题。如果它确实响应，则此问题可能是暂时的（因此您现在可以重新连接），或者您连接到的服务器应用程序可能已终止（因此您可能无法再次连接）。2。Ping本地主机以验证本地网络是否仍在运行（如果是串行连接，请参阅下一步）。三。Ping本地路由器地址。如果您使用串行连接，则本地路由器是您最初使用SLIP或PPP登录到的主机的IP地址。四。Ping与您连接的主机位于同一子网上的主机（如果您知道其中一个）。这将验证目标网络是否正常工作。5个。在命令提示下使用tracert命令确定连接到的主机的路径。除非您知道远程端的路由器地址，否则这不会透露太多信息，但它可能有助于确定问题是否在某个地方。</p> 
<p>https://docs.microsoft.com/en-us/previous-versions/ms832256(v=msdn.10)?redirectedfrom=MSDN</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b5087f127894a27166880bcf5be5ed80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IDEA 快速生成增强 for 循环</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6e701180db568c21c71a657ff7f43dae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">log4j2配置文件解读</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>