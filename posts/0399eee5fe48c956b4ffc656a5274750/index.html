<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一步步学习黑盒优化算法，借助达摩院MindOpt的RABBO榜单【系列1/4】 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一步步学习黑盒优化算法，借助达摩院MindOpt的RABBO榜单【系列1/4】" />
<meta property="og:description" content="1 黑盒优化的概念 什么是黑盒优化？「黑盒优化问题」泛指目标函数难以从数学上解析表达，缺少可直接利用的梯度信息，仅可利用目标函数输入和对应输出函数值进行最优解搜索的优化问题。
太抽象，不懂，根据达摩院优化求解器MindOpt团队的教程，它“通过获取不同控制参数(输入变量)对应的系统表现，来推断和搜寻优化解&#34;、“可用于强化学习策略搜索、工业冶炼方案设计、计算资源额度预算优化等”。
云栖大会上王孟昌博士有讲解： https://yunqi.aliyun.com/2021/agenda/session170 在这个直播回放大约20分钟的时候，截图如下：
其中的黑盒优化的架构就像下面的图这样，我们假设我们要求解的问题不好描述，就把这个问题做成一个仿真系统，这个系统可以根据输入的变量值（“候选解”）来给出对应的评价（“观测值”)，然后黑盒优化算法，就是接上这个仿真系统，通过不断地去提供候选解和得到观测值，来搜索可能的最优表现的候选解。
2 黑盒优化benchmark：RABBO 这次达摩院MindOpt优化求解器团队出的「开发者福利」RABBO V1.0看起来挺有意思的，题目集包含4种问题：
从这儿可以看到他们的网页介绍：https://tianchi.aliyun.com/specials/promotion/BlackBox
2.1 瞄一眼长长的文档 点击“查看文档”，会进入个长长的文档，供了解细节。提交评测实际是进的同一个页面，上面有一排tab不要错过，有“排行榜”和“提交结果”。太长，瞄一眼文档结构就行。
2.2 看git项目 点击首页的“下载数据”按钮，和数据列表的“guide.html.zip”文件，都会引导到阿里云家的git（code.aliyun.com），用阿里云的账号登录，第一次用需要根据指引把自己的账号设置好，账号折腾好后，在https://code.aliyun.com/mindopt001/RABBO 可以看到文件截图如下图。
点击“3.27MB”的图标，可以看到文件如下图：
​
2.3 下载它 然后根据自己的喜好下载它。考虑到官方好像在不停更新的样子，我们fork这个项目，在页面上点击“派生”，等待系统完成
这个页面会转很久很久，好像有bug的样纸。 点击左侧导航栏的“项目”就可以看到项目已经有了，地址是
https://code.aliyun.com/你的Username/RABBO，比如我的名字是wuyoy520。可以进项目设置将“可见等级”改成Private。
然后clone克隆到本地自己喜欢的文件夹内。
git clone git@code.aliyun.com:你的Username/RABBO.git clone完了后，根据git指导来安装它，“Note: RABBO supports Python3.6 or newer.” 由于我的python3是分开的指令所以我是这样做的：
cd RABBO pip3 install -r requirements.txt python3 setup.py install pip3 install -e . 运行看结果的主程序示例程序在这儿：
python3 examples/experiment_example.py 最后的运行结果好像是不OK的，没解出来：
​
2.3.1 偷懒的换git账号方法 这里分享一个我切换git账号的偷懒方法：建立一个空的empty项目，然后里面会有Git全局设置参数，复制这两句到终端命令行运行。
3 参考文档，学习RABBO 3.1 RABBO V1.0 问题集 4个问题分别对应文件夹中的不同文件。在目录 blackbox_starter_kit -&gt; problems文件夹下面。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/0399eee5fe48c956b4ffc656a5274750/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-07T11:56:19+08:00" />
<meta property="article:modified_time" content="2022-02-07T11:56:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一步步学习黑盒优化算法，借助达摩院MindOpt的RABBO榜单【系列1/4】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1__1"></a>1 黑盒优化的概念</h3> 
<p>什么是黑盒优化？「黑盒优化问题」泛指目标函数难以从数学上解析表达，缺少可直接利用的梯度信息，仅可利用目标函数输入和对应输出函数值进行最优解搜索的优化问题。</p> 
<p>太抽象，不懂，根据达摩院优化求解器MindOpt团队的教程，它“通过获取不同控制参数(输入变量)对应的系统表现，来推断和搜寻优化解"、“可用于强化学习策略搜索、工业冶炼方案设计、计算资源额度预算优化等”。</p> 
<p>云栖大会上王孟昌博士有讲解： <a href="https://yunqi.aliyun.com/2021/agenda/session170" rel="nofollow">https://yunqi.aliyun.com/2021/agenda/session170</a> 在这个直播回放大约20分钟的时候，截图如下：<img src="https://images2.imgbox.com/56/f9/mMnB2OK2_o.png" alt="image.png"><br> 其中的黑盒优化的架构就像下面的图这样，我们假设我们要求解的问题不好描述，就把这个问题做成一个仿真系统，这个系统可以根据输入的变量值（“候选解”）来给出对应的评价（“观测值”)，然后黑盒优化算法，就是接上这个仿真系统，通过不断地去提供候选解和得到观测值，来搜索可能的最优表现的候选解。<br> <img src="https://images2.imgbox.com/12/2f/mkg3Pnjg_o.png" alt="image.png"></p> 
<h3><a id="2_benchmarkRABBO_16"></a>2 黑盒优化benchmark：RABBO</h3> 
<p>这次达摩院MindOpt优化求解器团队出的「开发者福利」RABBO V1.0看起来挺有意思的，题目集包含4种问题：<br> <img src="https://images2.imgbox.com/dc/79/hrCkHguc_o.png" alt="image.png"></p> 
<p>从这儿可以看到他们的网页介绍：<a href="https://tianchi.aliyun.com/specials/promotion/BlackBox" rel="nofollow">https://tianchi.aliyun.com/specials/promotion/BlackBox</a><br> <img src="https://images2.imgbox.com/f4/e4/V23CUAs3_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="21__26"></a>2.1 瞄一眼长长的文档</h4> 
<p>点击“查看文档”，会进入个长长的文档，供了解细节。提交评测实际是进的同一个页面，上面有一排tab不要错过，有“排行榜”和“提交结果”。太长，瞄一眼文档结构就行。<br> <img src="https://images2.imgbox.com/43/58/qwtcPSor_o.png" alt="image.png"></p> 
<h4><a id="22_git_33"></a>2.2 看git项目</h4> 
<p><img src="https://images2.imgbox.com/25/10/HcS3RZf3_o.png" alt="image.png"><br> 点击首页的“下载数据”按钮，和数据列表的“guide.html.zip”文件，都会引导到阿里云家的git（code.aliyun.com），用阿里云的账号登录，第一次用需要根据指引把自己的账号设置好，账号折腾好后，在<a href="https://code.aliyun.com/mindopt001/RABBO" rel="nofollow">https://code.aliyun.com/mindopt001/RABBO</a> 可以看到文件截图如下图。<br> <img src="https://images2.imgbox.com/f6/47/OpR7EUjE_o.png" alt="image.png"><br> 点击“3.27MB”的图标，可以看到文件如下图：<br> <img src="https://images2.imgbox.com/8e/58/o05E8SIc_o.png" alt="image.png"><br> ​</p> 
<h4><a id="23__44"></a>2.3 下载它</h4> 
<p>然后根据自己的喜好下载它。考虑到官方好像在不停更新的样子，我们fork这个项目，在页面上点击“派生”，等待系统完成<br> <img src="https://images2.imgbox.com/16/3e/JhBTddM0_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/cc/7a/TEvlw0EH_o.png" alt="image.png"><br> 这个页面会转很久很久，好像有bug的样纸。 点击左侧导航栏的“项目”就可以看到项目已经有了，地址是<br> <code>https://code.aliyun.com/你的Username/RABBO</code>，比如我的名字是wuyoy520。可以进项目设置将“可见等级”改成Private。<br> <img src="https://images2.imgbox.com/5e/b1/bwkFFW6K_o.png" alt="image.png"><br> 然后clone克隆到本地自己喜欢的文件夹内。</p> 
<pre><code>git clone git@code.aliyun.com:你的Username/RABBO.git
</code></pre> 
<p>clone完了后，根据git指导来安装它，“Note: RABBO supports Python3.6 or newer.” 由于我的python3是分开的指令所以我是这样做的：</p> 
<pre><code>cd RABBO
pip3 install -r requirements.txt
python3 setup.py install
pip3 install -e .
</code></pre> 
<p>运行看结果的主程序示例程序在这儿：</p> 
<pre><code>python3 examples/experiment_example.py
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/4f/IpEM41HN_o.png" alt="image.png"><br> 最后的运行结果好像是不OK的，没解出来：<br> <img src="https://images2.imgbox.com/a5/19/tzpwRp3D_o.png" alt="image.png"><br> ​</p> 
<h5><a id="231_git_84"></a>2.3.1 偷懒的换git账号方法</h5> 
<p>这里分享一个我切换git账号的偷懒方法：建立一个空的empty项目，然后里面会有Git全局设置参数，复制这两句到终端命令行运行。<br> <img src="https://images2.imgbox.com/b8/f6/nUQSOgOY_o.png" alt="image.png"></p> 
<h3><a id="3_RABBO_91"></a>3 参考文档，学习RABBO</h3> 
<h4><a id="31_RABBO_V10__94"></a>3.1 RABBO V1.0 问题集</h4> 
<p>4个问题分别对应文件夹中的不同文件。在目录 <code>blackbox_starter_kit</code> -&gt; <code>problems</code>文件夹下面。<br> <img src="https://images2.imgbox.com/4a/1b/B9zGA19Y_o.png" alt="image.png"><br> 只有4个文件夹，是因为里面的2 金属冶炼配比优化并没有开放直接下载，参与公开测评，也就是评分的分数里会有它。<br> <img src="https://images2.imgbox.com/42/04/ZpBuNHKI_o.png" alt=""></p> 
<h4><a id="32_1copy_102"></a>3.2 步骤1，实现一个自己的算法，嗯，姑且先copy一个</h4> 
<p>前面说运行看结果的主程序示例程序<code>examples/experiment_example.py</code>，内容是：<br> <img src="https://images2.imgbox.com/27/0f/8ES84RE0_o.png" alt="image.png"></p> 
<p>直接不改的运行结果好像是不OK的，没解出来：<br> <img src="https://images2.imgbox.com/85/a4/hbDCsyvv_o.png" alt="image.png"></p> 
<p>我们要改的文件在<code>blackbox_starter_kit/algorithms/submission/submission_algorithm.py</code><br> <img src="https://images2.imgbox.com/92/2d/E5PP5pvt_o.png" alt="image.png"></p> 
<p>里面有一些指导，我们先copy一份示例算法过来，示例算法在<code>blackbox_starter_kit/algoriths/</code>文件夹下的<code>cmaes/cma_algorithm.py</code> 和<code>random_search/random_search_algorithm.py</code>。<br> 将cma的算法代码“有技巧”地拷贝至<code>submission/submission_algorithm.py</code>，不要动函数名，其他的copy进去。然后将<code>examples/experiment_example.py</code>中的算法改成选手算法：<br> <img src="https://images2.imgbox.com/94/ef/MsvxZBnE_o.png" alt="image.png"><br> 运行，可以看到有类似的输出了，后续就在这个<code>submission_algorithm.py</code>改造自己的算法就行。</p> 
<h4><a id="33_21_123"></a>3.3 步骤2，额，上1步运行过了，改算法后面再研究，先跳过</h4> 
<h4><a id="34_3_126"></a>3.4 步骤3，打包算法提交测评</h4> 
<p>文档写的很轻松的几句话，但是前面需要安装docker，点击进入标的<a href="https://tianchi.aliyun.com/competition/entrance/531863/tab/253" rel="nofollow">链接</a>，根据这个页面的内容来安装、开通容器镜像服务，打镜像，和推仓库。<br> <img src="https://images2.imgbox.com/34/a4/VLD9wfIU_o.png" alt="image.png"><br> 首先，先安装docker；<br> 然后，从<a href="https://www.aliyun.com/product/acr" rel="nofollow">https://www.aliyun.com/product/acr</a>容器镜像服务ACR的产品页，开通进入“管理控制台”，如下图，创建个人版（免费）实例。根据文档指引，在页面上操作，创建一个私有的命名空间，然后再创建一个本地镜像仓库。<br> <img src="https://images2.imgbox.com/2a/c8/zFPbsq4B_o.png" alt="image.png"></p> 
<p>然后，回到rabbo的目录，运行sh build.sh来打包仓库:</p> 
<pre><code>cd RABBO
sh build.sh
</code></pre> 
<p>由于我电脑多个Python版本，因此要进build.sh把<code>python</code>改成<code>python3</code>。<br> <img src="https://images2.imgbox.com/6d/b9/ZOwPG5Ia_o.png" alt="image.png"><br> 然后我家的龟速网络就要漫长地等待了。。。<br> <img src="https://images2.imgbox.com/72/83/kHhrLENV_o.png" alt="image.png"><br> 镜像打结束后，注意，最后一行显示：<br> naming to docker.io/library/mind-blackbox-bench:20211218，<br> 复制mind-blackbox-bench:20211218，后面要这个ImageId。</p> 
<p>然后，推镜像到仓库。从推镜像的指令在仓库里面复制更方便：<br> <img src="https://images2.imgbox.com/64/be/s64bKdwn_o.png" alt="image.png"><br> <img src="https://images2.imgbox.com/be/6a/TBp7vV4c_o.png" alt="image.png"><br> 第一次推不晓得啥米原因它卡住了，然后取消了后重新推又很快就上去了。这时候刷新镜像版本就能看到多了个镜像啦。<br> <img src="https://images2.imgbox.com/41/b5/xmsECOjX_o.png" alt="image.png"></p> 
<p>最后，提交评测。提交结果的tab页。镜像的地址从奖项的基本信息里面拷贝公网的地址，并在后面加上刚刚提交的版本，如<code>:0.1</code>。<br> <img src="https://images2.imgbox.com/4a/e9/YJ8zNIax_o.png" alt="image.png"></p> 
<p>提交了后，等待一会后，出现结果。<br> <img src="https://images2.imgbox.com/da/90/fraTkqrX_o.png" alt="image.png"><br> 注意，如果前面一个没结束的时候重复提交，上一个任务会被停掉，之前提交的任务会获得一个“task terminated”的已经失败提示。<br> 点击模型的超链接，会弹出日志先是各个分数。排行榜不是实时更新的，需要等待。<br> <img src="https://images2.imgbox.com/62/23/b1y5xREI_o.png" alt="image.png"><br> 至此，整个流程走通了。<br> ​</p> 
<h3><a id="4__174"></a>4 其他文</h3> 
<p>后面我会发如何去读官方参考算法代码，和如何研发自己的算法。<br> 先立个flag:</p> 
<p>借助阿里达摩院的MindOpt的RABBO榜单系列：<br> 1.（本篇）《<a href="https://blog.csdn.net/wuyoy520/article/details/122095015">新手一步步学习黑盒优化算法，借助达摩院MindOpt的RABBO榜单【系列1/4】</a>》<br> 2. 《<a href="https://blog.csdn.net/wuyoy520/article/details/122333422">学习一下黑盒优化榜单RABBO提供的两个参考算法</a>》<br> 3. todo：《改编一个自己的黑盒优化算法或开源算法》<br> 4. todo：《将我要解决的业务问题建模成RABBO的问题格式，然后去求解》</p> 
<p><a href="https://tianchi.aliyun.com/specials/promotion/BlackBox" rel="nofollow"><img src="https://images2.imgbox.com/63/7e/0O3Cd7I9_o.png" alt="image.png"></a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b911658c2c47e69c854e20581bde025e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">语义分割网络-STDC_CVPR2021</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e483d1fea8eb819d65a74c1feb5bb548/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>