<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习：线性回归模型(python) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习：线性回归模型(python)" />
<meta property="og:description" content="目录
符号
一、线性回归模型（Linear regression model）
（1）什么是线性回归模型
（2）线性回归模型的数学形式
理论
实践
二、成本函数（Cost function）
（1）什么是成本函数
（2）成本函数的数学形式
理论
实践
符号 以下是本文所需要用到的符号
符号 描述 python（如果适用）
x 特征值 x_train
y 目标值 y_train
示例 x_i
m 示例数量 y_i
w 参数：权重 m b 参数：偏移 n
模型预估值 f_wb 一、线性回归模型（Linear regression model） （1）什么是线性回归模型 线性回归模型是一种用于建立输入和连续输出之间关系的模型。它假设输入和输出之间存在线性关系。该模型可以用于预测连续变量的值，例如房价、销售额、股票价格等。
（2）线性回归模型的数学形式 理论 线性回归的模型函数（这是一个从映射到的函数）表示为xy
python中可表示为：
f_wb = w * x[i] &#43; b
实践 # 导入numpy、matplotlib模块 import numpy as np from matplotlib import pyplot as plt # 设定特征值 x = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/f68fe94abcfae848763da8bc2b2f0769/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-29T16:11:32+08:00" />
<meta property="article:modified_time" content="2023-07-29T16:11:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习：线性回归模型(python)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E7%AC%A6%E5%8F%B7-toc" style="margin-left:0px;"><a href="#%E7%AC%A6%E5%8F%B7" rel="nofollow">符号</a></p> 
<p id="%E4%B8%80%E3%80%81%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" rel="nofollow">一、线性回归模型（Linear regression model）</a></p> 
<p id="%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B" rel="nofollow">（1）什么是线性回归模型</a></p> 
<p id="%EF%BC%882%EF%BC%89%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BD%A2%E5%BC%8F-toc" style="margin-left:40px;"><a href="#%EF%BC%882%EF%BC%89%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BD%A2%E5%BC%8F" rel="nofollow">（2）线性回归模型的数学形式</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E7%90%86%E8%AE%BA-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E7%90%86%E8%AE%BA" rel="nofollow">        理论</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E5%AE%9E%E8%B7%B5-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E5%AE%9E%E8%B7%B5" rel="nofollow">        实践</a></p> 
<p id="%C2%A0%E4%BA%8C%E3%80%81%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0%EF%BC%88Cost%20function%EF%BC%89-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%BA%8C%E3%80%81%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0%EF%BC%88Cost%20function%EF%BC%89" rel="nofollow"> 二、成本函数（Cost function）</a></p> 
<p id="%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0" rel="nofollow">（1）什么是成本函数</a></p> 
<p id="%EF%BC%882%EF%BC%89%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BD%A2%E5%BC%8F-toc" style="margin-left:40px;"><a href="#%EF%BC%882%EF%BC%89%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BD%A2%E5%BC%8F" rel="nofollow">（2）成本函数的数学形式</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E7%90%86%E8%AE%BA-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E7%90%86%E8%AE%BA" rel="nofollow">        理论</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E5%AE%9E%E8%B7%B5-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E5%AE%9E%E8%B7%B5" rel="nofollow">        实践</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E7%AC%A6%E5%8F%B7">符号</h2> 
<p>以下是本文所需要用到的符号</p> 
<p>符号                                                             描述                                               python（如果适用）</p> 
<hr> 
<p>x                                                                 特征值                                            x_train</p> 
<p>y                                                                 目标值                                            y_train</p> 
<p><img alt="x_{}^{(i)},y_{}^{(i)}" class="mathcode" src="https://images2.imgbox.com/1c/bb/2B3EXghU_o.png">                                                     示例                                                x_i</p> 
<p>m                                                                示例数量                                         y_i</p> 
<p>w                                                                参数：权重                                      m        </p> 
<p>b                                                                 参数：偏移                                      n</p> 
<p><img alt="f_{w,b}(x_{}^{(i)})" class="mathcode" src="https://images2.imgbox.com/46/57/lJOobniW_o.png">                                                      模型预估值                                      f_wb   </p> 
<h2 id="%E4%B8%80%E3%80%81%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">一、线性回归模型（Linear regression model）</h2> 
<h3 id="%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B">（1）什么是线性回归模型</h3> 
<p>        线性回归模型是一种用于建立输入和连续输出之间关系的模型。它假设输入和输出之间存在线性关系。该模型可以用于预测连续变量的值，例如房价、销售额、股票价格等。</p> 
<h3 id="%EF%BC%882%EF%BC%89%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BD%A2%E5%BC%8F">（2）线性回归模型的数学形式</h3> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E7%90%86%E8%AE%BA">        理论</h4> 
<p>        线性回归的模型函数（这是一个从映射到的函数）表示为xy</p> 
<p style="text-align:center;"><img alt="f_{w,b}(x_{}^{(i)})=wx_{}^{(i)}+b" class="mathcode" src="https://images2.imgbox.com/ed/d0/X0WWgUzj_o.png"></p> 
<p>        python中可表示为：</p> 
<p style="text-align:center;">f_wb = w * x[i] + b</p> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%E5%AE%9E%E8%B7%B5">        实践</h4> 
<p></p> 
<p style="text-align:center;"><img alt="" height="332" src="https://images2.imgbox.com/d5/16/wc3pqSUN_o.png" width="442"></p> 
<p></p> 
<pre><code class="language-python"># 导入numpy、matplotlib模块
import numpy as np
from matplotlib import pyplot as plt
# 设定特征值
x = np.array([1, 2, 3, 4, 5])
# 设定权重、偏移
w=1
b=0
# 设定线性回归函数
f_wb = w*x+b
# 绘制数据点
plt.scatter(x, f_wb)
# 绘制回归线
plt.plot(x, f_wb, color='red')
# 添加标题和标签
plt.title('Linear Regression')
plt.xlabel('x')
plt.ylabel('f_wb')
# 显示图形
plt.show()</code></pre> 
<p></p> 
<h2 id="%C2%A0%E4%BA%8C%E3%80%81%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0%EF%BC%88Cost%20function%EF%BC%89"> 二、成本函数（Cost function）</h2> 
<h3 id="%EF%BC%881%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0">（1）什么是成本函数</h3> 
<p>        在线性回归模型中，成本函数（Cost function）通常采用最小二乘法（Least Square Method）来定义。</p> 
<h3 id="%EF%BC%882%EF%BC%89%E6%88%90%E6%9C%AC%E5%87%BD%E6%95%B0%E7%9A%84%E6%95%B0%E5%AD%A6%E5%BD%A2%E5%BC%8F">（2）成本函数的数学形式</h3> 
<h4>        理论</h4> 
<p>        成本函数就是所有训练样本的预测值与实际值之间的误差平方和。</p> 
<p style="text-align:center;"><img alt="$J(w,b) = \frac{1}{2m}\sum\limits_{i=0}^{m-1}(f_{w,b}(x^{(i)})-y^{(i)})^2$" class="mathcode" src="https://images2.imgbox.com/4e/0e/NDqgvXYZ_o.png"></p> 
<p>         <img alt="(f_{w,b}(x^{(i)})-y^{(i)})^2" class="mathcode" src="https://images2.imgbox.com/bc/66/8Hd2IplR_o.png">：目标值和预测之间的平方差。</p> 
<p>        <img alt="\sum\limits_{i=0}^{m-1}(f_{w,b}(x^{(i)})-y^{(i)})^2" class="mathcode" src="https://images2.imgbox.com/5e/51/CO2eM4Gn_o.png">：每个目标值和预测之间平方差的和</p> 
<p>        <img alt="$J(w,b) = \frac{1}{2m}\sum\limits_{i=0}^{m-1}(f_{w,b}(x^{(i)})-y^{(i)})^2$" class="mathcode" src="https://images2.imgbox.com/55/26/ByJIyXGQ_o.png">：总的平均方差</p> 
<blockquote> 
 <p>请注意，求和范围通常从1到m，而代码将从0到m-1。</p> 
</blockquote> 
<h4>        实践</h4> 
<p><img alt="" height="480" src="https://images2.imgbox.com/e5/94/vJaa6P3q_o.png" width="640"></p> 
<blockquote> 
 <p> 由上图可以清晰看到随着w的变化，总的平均方差也在改变，因此可以通过梯度下降的方法最小化成本来改变w和b就可以得到一条与数据完美拟合的线</p> 
</blockquote> 
<pre><code class="language-python"># 导入numpy、matplotlib模块
import numpy as np
from matplotlib import pyplot as plt
# 设定特征值
x_train = np.array([1, 2 , 3])
y_train = np.array([1, 2 , 3])
x = np.array([1, 2, 3])
# 设定权重
w=[]
for n in range(-1,6,1):
    w.append(n/2)
# 设定偏移
b=0
# 获取x（特征值）数量
m = len(x)
# 定义变量
cost_sum = 0
J_wb=[]
# 计算成本函数
for j in range(len(w)):
    for i in range(m):
        f_wb = w[j] * x[i] + b
        cost = (f_wb - y_train[i]) ** 2
        cost_sum = cost_sum + cost
    j_wb = (1 / (2 * (m+1))) * cost_sum
    cost_sum = 0
    J_wb.append(j_wb)
# 绘制成本函数点
plt.scatter(w, J_wb)
# 绘制成本函数线
plt.plot(w, J_wb, color='red')
# 添加标题和标签
plt.title('Cost function')
plt.xlabel('w')
plt.ylabel('J_wb')
# 显示图形
plt.show()</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c1553bcbd23b5349cc7db5d9cc2401b9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue2通过点击渲染循环的echarts</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b0349d0ccb55cd47b3def28e4d4c4ac2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Pearson correlation皮尔逊相关性分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>