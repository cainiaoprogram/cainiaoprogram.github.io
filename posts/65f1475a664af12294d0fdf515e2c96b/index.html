<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>5.docker容器及相关命令 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="5.docker容器及相关命令" />
<meta property="og:description" content="docker中的容器实际上就是宿主机中的一个进程
目录
1 创建并启动容器 docker run
1.1 如果没有指定的镜像的话，docker会尝试从源拉取
1.2 给容器起名字 --name
1.3 交互方式启动(-i)与弹出客户端(-t)
1.4 指定端口 -p
1.5 自动分配端口 -P
1.6 后台运行(以守护进程方式运行) -d
2 查看运行中的容器 docker ps
3 以新的进程进入正在启动的容器内部 docker exec -it [容器ID] /bin/bash
4 删除容器 docker rm
5 以当前的进程进入正在启动的容器内部 docker attach
6 启动容器 docker restart
7 停止容器 docker stop
8 显示容器在宿主机的运行情况 docker top
9 查看日志docker logs
9.1 从指定时间到现在的日志 --since
9.2 最后n行 --tail
9.3 从日志的开头到指定的时间 --until
9.4 添加日志的时间戳 -t
9.5 获得动态日志 -f" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/65f1475a664af12294d0fdf515e2c96b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-18T16:39:06+08:00" />
<meta property="article:modified_time" content="2023-12-18T16:39:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">5.docker容器及相关命令</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>docker中的容器实际上就是宿主机中的一个进程</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="创建并启动容器-docker-run-toc" style="margin-left:0px;"><a href="#%E5%88%9B%E5%BB%BA%E5%B9%B6%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8-docker-run" rel="nofollow">1  创建并启动容器 docker run</a></p> 
<p id="如果没有指定的镜像的话，docker会尝试从源拉取-toc" style="margin-left:40px;"><a href="#%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E6%8C%87%E5%AE%9A%E7%9A%84%E9%95%9C%E5%83%8F%E7%9A%84%E8%AF%9D%EF%BC%8Cdocker%E4%BC%9A%E5%B0%9D%E8%AF%95%E4%BB%8E%E6%BA%90%E6%8B%89%E5%8F%96" rel="nofollow">1.1  如果没有指定的镜像的话，docker会尝试从源拉取</a></p> 
<p id="给容器起名字---name-toc" style="margin-left:40px;"><a href="#%E7%BB%99%E5%AE%B9%E5%99%A8%E8%B5%B7%E5%90%8D%E5%AD%97---name" rel="nofollow">1.2  给容器起名字 --name</a></p> 
<p id="交互方式启动(-i)与弹出客户端(-t)-toc" style="margin-left:40px;"><a href="#%E4%BA%A4%E4%BA%92%E6%96%B9%E5%BC%8F%E5%90%AF%E5%8A%A8%28-i%29%E4%B8%8E%E5%BC%B9%E5%87%BA%E5%AE%A2%E6%88%B7%E7%AB%AF%28-t%29" rel="nofollow">1.3  交互方式启动(-i)与弹出客户端(-t)</a></p> 
<p id="指定端口--p-toc" style="margin-left:40px;"><a href="#%E6%8C%87%E5%AE%9A%E7%AB%AF%E5%8F%A3--p" rel="nofollow">1.4  指定端口 -p</a></p> 
<p id="自动分配端口--P-toc" style="margin-left:40px;"><a href="#%E8%87%AA%E5%8A%A8%E5%88%86%E9%85%8D%E7%AB%AF%E5%8F%A3--P" rel="nofollow">1.5  自动分配端口 -P</a></p> 
<p id="后台运行(以守护进程方式运行)--d-toc" style="margin-left:40px;"><a href="#%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C%28%E4%BB%A5%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%E6%96%B9%E5%BC%8F%E8%BF%90%E8%A1%8C%29--d" rel="nofollow">1.6  后台运行(以守护进程方式运行) -d</a></p> 
<p id="查看运行中的容器-docker-ps-toc" style="margin-left:0px;"><a href="#%E6%9F%A5%E7%9C%8B%E8%BF%90%E8%A1%8C%E4%B8%AD%E7%9A%84%E5%AE%B9%E5%99%A8-docker-ps" rel="nofollow">2  查看运行中的容器 docker ps</a></p> 
<p id="以新的进程进入正在启动的容器内部-docker-exec--it-[容器ID]-/bin/bash-toc" style="margin-left:0px;"><a href="#%E4%BB%A5%E6%96%B0%E7%9A%84%E8%BF%9B%E7%A8%8B%E8%BF%9B%E5%85%A5%E6%AD%A3%E5%9C%A8%E5%90%AF%E5%8A%A8%E7%9A%84%E5%AE%B9%E5%99%A8%E5%86%85%E9%83%A8-docker-exec--it-%5B%E5%AE%B9%E5%99%A8ID%5D-/bin/bash" rel="nofollow">3  以新的进程进入正在启动的容器内部 docker exec -it [容器ID] /bin/bash</a></p> 
<p id="删除容器-docker-rm-toc" style="margin-left:0px;"><a href="#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8-docker-rm" rel="nofollow">4  删除容器 docker rm</a></p> 
<p id="以当前的进程进入正在启动的容器内部-docker-attach-toc" style="margin-left:0px;"><a href="#%E4%BB%A5%E5%BD%93%E5%89%8D%E7%9A%84%E8%BF%9B%E7%A8%8B%E8%BF%9B%E5%85%A5%E6%AD%A3%E5%9C%A8%E5%90%AF%E5%8A%A8%E7%9A%84%E5%AE%B9%E5%99%A8%E5%86%85%E9%83%A8-docker-attach" rel="nofollow">5  以当前的进程进入正在启动的容器内部 docker attach</a></p> 
<p id="启动容器-docker-restart-toc" style="margin-left:0px;"><a href="#%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8-docker-restart" rel="nofollow">6  启动容器 docker restart</a></p> 
<p id="停止容器-docker-stop-toc" style="margin-left:0px;"><a href="#%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8-docker-stop" rel="nofollow">7  停止容器 docker stop</a></p> 
<p id="显示容器在宿主机的运行情况-docker-top-toc" style="margin-left:0px;"><a href="#%E6%98%BE%E7%A4%BA%E5%AE%B9%E5%99%A8%E5%9C%A8%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%9A%84%E8%BF%90%E8%A1%8C%E6%83%85%E5%86%B5-docker-top" rel="nofollow">8  显示容器在宿主机的运行情况 docker top</a></p> 
<p id="查看日志docker-logs-toc" style="margin-left:0px;"><a href="#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97docker-logs" rel="nofollow">9  查看日志docker logs</a></p> 
<p id="从指定时间到现在的日志---since-toc" style="margin-left:40px;"><a href="#%E4%BB%8E%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E5%88%B0%E7%8E%B0%E5%9C%A8%E7%9A%84%E6%97%A5%E5%BF%97---since" rel="nofollow">9.1  从指定时间到现在的日志 --since</a></p> 
<p id="最后n行---tail-toc" style="margin-left:40px;"><a href="#%E6%9C%80%E5%90%8En%E8%A1%8C---tail" rel="nofollow">9.2  最后n行 --tail</a></p> 
<p id="从日志的开头到指定的时间---until-toc" style="margin-left:40px;"><a href="#%E4%BB%8E%E6%97%A5%E5%BF%97%E7%9A%84%E5%BC%80%E5%A4%B4%E5%88%B0%E6%8C%87%E5%AE%9A%E7%9A%84%E6%97%B6%E9%97%B4---until" rel="nofollow">9.3  从日志的开头到指定的时间 --until</a></p> 
<p id="添加日志的时间戳--t-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%E6%97%A5%E5%BF%97%E7%9A%84%E6%97%B6%E9%97%B4%E6%88%B3--t" rel="nofollow">9.4  添加日志的时间戳 -t</a></p> 
<p id="获得动态日志--f-toc" style="margin-left:40px;"><a href="#%E8%8E%B7%E5%BE%97%E5%8A%A8%E6%80%81%E6%97%A5%E5%BF%97--f" rel="nofollow">9.5  获得动态日志 -f</a></p> 
<p id="其他参数-toc" style="margin-left:40px;"><a href="#%E5%85%B6%E4%BB%96%E5%8F%82%E6%95%B0" rel="nofollow">9.6  其他参数</a></p> 
<p id="宿主机与容器复制文件-docker-cp-toc" style="margin-left:0px;"><a href="#%E5%AE%BF%E4%B8%BB%E6%9C%BA%E4%B8%8E%E5%AE%B9%E5%99%A8%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6-docker-cp" rel="nofollow">10  宿主机与容器复制文件 docker cp</a></p> 
<p id="从宿主机复制文件到容器中-toc" style="margin-left:40px;"><a href="#%E4%BB%8E%E5%AE%BF%E4%B8%BB%E6%9C%BA%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6%E5%88%B0%E5%AE%B9%E5%99%A8%E4%B8%AD" rel="nofollow">10.1  从宿主机复制文件到容器中</a></p> 
<p id="从容器复制文件到宿主机-toc" style="margin-left:40px;"><a href="#%E4%BB%8E%E5%AE%B9%E5%99%A8%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6%E5%88%B0%E5%AE%BF%E4%B8%BB%E6%9C%BA" rel="nofollow">10.2  从容器复制文件到宿主机</a></p> 
<p id="将容器保存为镜像-docker-commit-toc" style="margin-left:0px;"><a href="#%E5%B0%86%E5%AE%B9%E5%99%A8%E4%BF%9D%E5%AD%98%E4%B8%BA%E9%95%9C%E5%83%8F-docker-commit" rel="nofollow">11  将容器保存为镜像 docker commit</a></p> 
<p id="将容器保存为tar文件-docker-export-toc" style="margin-left:0px;"><a href="#%E5%B0%86%E5%AE%B9%E5%99%A8%E4%BF%9D%E5%AD%98%E4%B8%BAtar%E6%96%87%E4%BB%B6-docker-export" rel="nofollow">12  将容器保存为tar文件 docker export</a></p> 
<p id="将docker-export生成的tar文件加载为镜像-docker-import-toc" style="margin-left:0px;"><a href="#%E5%B0%86docker-export%E7%94%9F%E6%88%90%E7%9A%84tar%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E4%B8%BA%E9%95%9C%E5%83%8F-docker-import" rel="nofollow">13  将docker export生成的tar文件加载为镜像 docker import</a></p> 
<p id="暂停容器对外的服务-docker-pause-toc" style="margin-left:0px;"><a href="#%E6%9A%82%E5%81%9C%E5%AE%B9%E5%99%A8%E5%AF%B9%E5%A4%96%E7%9A%84%E6%9C%8D%E5%8A%A1-docker-pause" rel="nofollow">14  暂停容器对外的服务 docker pause</a></p> 
<p id="停止暂停容器对外的服务-docker-unpause-toc" style="margin-left:0px;"><a href="#%E5%81%9C%E6%AD%A2%E6%9A%82%E5%81%9C%E5%AE%B9%E5%99%A8%E5%AF%B9%E5%A4%96%E7%9A%84%E6%9C%8D%E5%8A%A1-docker-unpause" rel="nofollow">15  停止暂停容器对外的服务 docker unpause</a></p> 
<p id="强制停止容器-docker-kill-toc" style="margin-left:0px;"><a href="#%E5%BC%BA%E5%88%B6%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8-docker-kill" rel="nofollow">16  强制停止容器 docker kill</a></p> 
<p id="仅创建容器-docker-create-toc" style="margin-left:0px;"><a href="#%E4%BB%85%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8-docker-create" rel="nofollow">17  仅创建容器 docker create</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="创建并启动容器-docker-run"><a id="创建并启动容器-docker-run-1"></a>1  创建并启动容器 docker run</h2> 
<h3 id="如果没有指定的镜像的话，docker会尝试从源拉取"><a id="如果没有指定的镜像的话，docker会尝试从源拉取-1.1"></a>1.1  如果没有指定的镜像的话，docker会尝试从源拉取</h3> 
<p class="img-center"><img alt="" height="527" src="https://images2.imgbox.com/37/84/JVAyrDsJ_o.png" width="718"></p> 
<p>如果源里面没有就会报错</p> 
<h3 id="给容器起名字---name"><a id="给容器起名字---name-1.2"></a>1.2  给容器起名字 --name</h3> 
<p>比如我像给hello-world这个镜像启动的容器命名为something</p> 
<ul><li>如果你不手动起名字，那么docker会帮你起一个，比如我之前运行的recursing_lumiere</li></ul> 
<p class="img-center"><img alt="" height="508" src="https://images2.imgbox.com/ac/b8/s5lvD8Aw_o.png" width="1006"></p> 
<h3 id="交互方式启动(-i)与弹出客户端(-t)">1.3  交互方式启动(-i)与弹出客户端(-t)</h3> 
<p>我们以ubuntu的镜像为例，如果你直接运行ubuntu的镜像就会退出，因为镜像中没有需要执行的应用</p> 
<p class="img-center"><img alt="" height="114" src="https://images2.imgbox.com/73/6a/sjjRj4xM_o.png" width="568"></p> 
<p>运行后我们发现路径就变了，此时我们已经进入到了ubuntu这个镜像的系统中</p> 
<ul><li>-i -t 可以简写成-it</li></ul> 
<p class="img-center"><img alt="" height="79" src="https://images2.imgbox.com/07/37/xPeG5yn2_o.png" width="1062"></p> 
<p>可以输入 exit 然后按回车退出</p> 
<p class="img-center"><img alt="" height="59" src="https://images2.imgbox.com/c7/50/AQ9OMcJU_o.png" width="337"></p> 
<p>/bin/bash是在容器中运行bash shell(可以理解为打开一个终端)，有时候需要加，有时候不用加。比如ubuntu你不用加也能打开，不过你加上之后也没有什么问题。加与不加主要是看dockerfile，有的dockerfile中的最后一句人家有写你就不用加，他要是没写且你想进终端你就得加</p> 
<p class="img-center"><img alt="" height="311" src="https://images2.imgbox.com/90/37/7XzHFkMu_o.png" width="247"></p> 
<p>/bin/bash对应的是这里的command</p> 
<p class="img-center"><img alt="" height="57" src="https://images2.imgbox.com/6c/64/nsuGAYir_o.png" width="1115"></p> 
<h3 id="指定端口--p">1.4  指定端口 -p</h3> 
<p>我们以tomcat:8.5.49为例，tomcat是一种java web服务器解决方案。对标python的话可以理解为uwsgi，uwsgi是一种python web服务器解决方案</p> 
<ul><li>tomcat8.5.49以后的启动方式略有不同</li></ul> 
<p>输入 docker run -p 8888:8080 tomcat:8.5.49</p> 
<ul><li>冒号前的8888是指你要映射出来的端口，因为你只放docker中你访问不到，只能映射到宿主机上访问</li><li>冒号后的8080是指docker里面的端口，tomcat默认的端口是8080</li></ul> 
<p class="img-center"><img alt="" height="923" src="https://images2.imgbox.com/40/50/UbxRAlCI_o.png" width="1200"></p> 
<ul><li>由于是前台运行，所以该终端一直会是阻塞状态。你如果按ctrl+c，那么tomcat这个服务就断了</li></ul> 
<p>使用宿主机访问 127.0.0.1:8888 可以看到tomcat</p> 
<p class="img-center"><img alt="" height="932" src="https://images2.imgbox.com/4d/28/FXFBiTt9_o.png" width="1200"></p> 
<p>如果你在启动的时加入了-it，那么运行后按ctrl+p+q，那么就会将docker的服务放到后台运行，并且你也能退到docker中干点儿别的</p> 
<ul><li>-it少一个都不行</li></ul> 
<p class="img-center"><img alt="" height="973" src="https://images2.imgbox.com/5b/7c/NRVRh3o5_o.png" width="1200"></p> 
<p>按下ctrl+p+q后，可以看一下该容器的状态，发现它并不是Exit，而是正在执行的状态。并且在PORTS的位置可以看到端口状况，8888是宿主机的端口，8080是docker内部的端口。前面0.0.0.0是IPV4的写法，后面连续三个冒号是IPV6的写法</p> 
<p class="img-center"><img alt="" height="71" src="https://images2.imgbox.com/a9/6b/BsnJQft0_o.png" width="1200"></p> 
<ul><li>COMMAND是tomcat在dockerfile中就写了的，我没有对COMMAND做任何操作</li></ul> 
<p>按下ctrl+p+q后，使用宿主机访问127.0.0.1:8888依然可以访问到tomcat</p> 
<p class="img-center"><img alt="" height="932" src="https://images2.imgbox.com/8d/8d/nxixPKit_o.png" width="1200"></p> 
<h3 id="自动分配端口--P">1.5  自动分配端口 -P</h3> 
<p>输入docker run -it -P tomcat:8.5.49</p> 
<p class="img-center"><img alt="" height="41" src="https://images2.imgbox.com/9f/69/Y4Ik0L1A_o.png" width="1200"></p> 
<p>按ctrl+p+q退出来，之后查看docker ps -a，之后发现系统自动分配了一个端口32769</p> 
<p class="img-center"><img alt="" height="73" src="https://images2.imgbox.com/4f/89/TXtyFdWL_o.png" width="1200"></p> 
<p>之后使用宿主机访问127.0.0.1:32769可以访问tomcat</p> 
<p class="img-center"><img alt="" height="940" src="https://images2.imgbox.com/13/30/wL7cyXFw_o.png" width="1200"></p> 
<h3 id="后台运行(以守护进程方式运行)--d">1.6  后台运行(以守护进程方式运行) -d</h3> 
<ul><li>后台运行也需要有交互的东西，如果你后台运行一个ubuntu然后ubuntu中什么都没开，那么ubuntu的容器也会被关闭</li></ul> 
<p>docker run -d -p 8888:8080 tomcat:8.5.49</p> 
<p class="img-center"><img alt="" height="59" src="https://images2.imgbox.com/cf/1f/kYUFlZp5_o.png" width="707"></p> 
<p class="img-center"><img alt="" height="76" src="https://images2.imgbox.com/e9/a8/SdxdMPNg_o.png" width="1200"></p> 
<p>访问 127.0.0.1:8888 可以正常访问</p> 
<p class="img-center"><img alt="" height="934" src="https://images2.imgbox.com/ac/8e/gmKGOleW_o.png" width="1200"></p> 
<h2 id="查看运行中的容器-docker-ps">2  查看运行中的容器 docker ps</h2> 
<p class="img-center"><img alt="" height="56" src="https://images2.imgbox.com/64/3c/WN6jcyiJ_o.png" width="634"></p> 
<ul><li>容器在运行完容器内的应用会后自动终止，如果是终止状态的 STATUS 就会显示为 Exited。如果不想在运行后终止，那么容器应用不能立即结束（比如搞个服务，它一直在那里运行）</li></ul> 
<p>可以加入参数-a查看所有容器</p> 
<p class="img-center"><img alt="" height="73" src="https://images2.imgbox.com/a0/ad/mBWvDYOn_o.png" width="1010"></p> 
<p>可以加入参数-s查看容器大小。实际73.6kB，虚拟出来507MB</p> 
<p class="img-center"><img alt="" height="76" src="https://images2.imgbox.com/8f/4c/gxHrs3wg_o.png" width="1200"></p> 
<p>除-a，-s之外，还有其他参数，比如</p> 
<ul><li>-filter 过滤</li><li>-n 显示最新创建的若干个（是创建不是运行），比如我要看最新创建的6个，那么就写 docker ps -n 6</li><li>-l 显示最新创建的1个（是创建不是运行），docker ps -l</li><li>--no-trunc 不省略输出</li><li>-q 只显示容器ID</li></ul> 
<h2 id="以新的进程进入正在启动的容器内部-docker-exec--it-[容器ID]-/bin/bash"><a id="以新的进程进入正在启动的容器内部-docker-exec--it-[容器ID]-/bin/bash-3"></a>3  以新的进程进入正在启动的容器内部 docker exec -it [容器ID] /bin/bash</h2> 
<p>我们以tomcat:8.5.50为例，以tomcat:8.4.49的方式启动tomcat:8.5.50后访问127.0.0.1:8888会显示404</p> 
<p class="img-center"><img alt="" height="58" src="https://images2.imgbox.com/50/aa/sWJsBT6E_o.png" width="708"></p> 
<p class="img-center"><img alt="" height="264" src="https://images2.imgbox.com/0a/1a/P8w91sfh_o.png" width="706"></p> 
<p>能显示404代表容器已经启动成功了</p> 
<p class="img-center"><img alt="" height="75" src="https://images2.imgbox.com/55/36/7rP8vsKG_o.png" width="1200"></p> 
<p>我们可以进入该容器</p> 
<p class="img-center"><img alt="" height="130" src="https://images2.imgbox.com/cc/77/HAU5x859_o.png" width="1200"></p> 
<p>出现404的原因是webapps这个文件夹没有东西</p> 
<p class="img-center"><img alt="" height="94" src="https://images2.imgbox.com/67/d5/nISiRD2f_o.png" width="1200"></p> 
<p>我们现在讲webapps.dist覆盖掉webapps。首先删除webapps这个文件夹，然后给webapps.dist改名为webapps</p> 
<p class="img-center"><img alt="" height="94" src="https://images2.imgbox.com/13/6d/ZwjTcKAd_o.png" width="1200"></p> 
<p>替换后等待一会儿可以访问到tomcat的主页</p> 
<p class="img-center"><img alt="" height="943" src="https://images2.imgbox.com/62/3d/iLxfcgVV_o.png" width="1200"></p> 
<p>在终端中输入 exit 然后按回车可以退出容器内部</p> 
<p class="img-center"><img alt="" height="57" src="https://images2.imgbox.com/a5/d7/9WaPndph_o.png" width="374"></p> 
<p>除了-it以外常用的参数还有-u、-w</p> 
<p>-u是选择用户的，-w可以选择进入后的工作目录</p> 
<p>最后的 /bin/bash 是进入容器，如果你不希望进入容器但又希望查询容器内部的某些信息，那么你可以将命令替换掉/bin/bash，比如我现在想看看进入工作目录后有哪些文件，那么我就用ls替换掉/bin/bash</p> 
<p class="img-center"><img alt="" height="95" src="https://images2.imgbox.com/a8/22/vmUVLFYT_o.png" width="1200"></p> 
<h2 id="删除容器-docker-rm">4  删除容器 docker rm</h2> 
<p>一般我们会直接使用 docker rm -f [容器ID]</p> 
<p>比如我现在想删除 98f8 这个容器</p> 
<p class="img-center"><img alt="" height="363" src="https://images2.imgbox.com/0f/0d/ZjDTM5V3_o.png" width="1200"></p> 
<p>删除后98f8这个容器就没了</p> 
<p class="img-center"><img alt="" height="309" src="https://images2.imgbox.com/86/db/tEFH3zEo_o.png" width="1200"></p> 
<p>当容器正在运行状态的时候仅使用rm不能删除</p> 
<p class="img-center"><img alt="" height="116" src="https://images2.imgbox.com/b3/12/olmLQBXM_o.png" width="1200"></p> 
<p>docker rm -f 可以强制删除</p> 
<p class="img-center"><img alt="" height="113" src="https://images2.imgbox.com/28/ea/gTKXxpLs_o.png" width="1078"></p> 
<h2 id="以当前的进程进入正在启动的容器内部-docker-attach">5  以当前的进程进入正在启动的容器内部 docker attach</h2> 
<p>我们现在后台运行一个ubuntu，进入ubuntu，按ctrl+p+q让其后台运行。此时的容器是开着的</p> 
<p class="img-center"><img alt="" height="115" src="https://images2.imgbox.com/8e/3a/BrhRDMpW_o.png" width="1200"></p> 
<p>docker exec是以一个新的进程进去容器内部，我们退出exec并不会关闭容器</p> 
<p class="img-center"><img alt="" height="225" src="https://images2.imgbox.com/7b/1a/S1eKTKwR_o.png" width="1200"></p> 
<p>docker attach是以当前的进程进入正在启动的容器内部，退出attach就会关闭容器</p> 
<p class="img-center"><img alt="" height="219" src="https://images2.imgbox.com/23/86/b6vdpFzl_o.png" width="1200"></p> 
<p>如果容器和tomcat一样是一直交互的那种，attach之后就不会给你打字的地方，因为这个容器现在正在阻塞的状态</p> 
<p class="img-center"><img alt="" height="95" src="https://images2.imgbox.com/87/dd/MPqFyK0S_o.png" width="1200"></p> 
<p>你按ctrl+c可以终止阻塞的状态，然后再查看容器的状态就发现容器已经关闭了</p> 
<p class="img-center"><img alt="" height="239" src="https://images2.imgbox.com/79/d2/RGSEic91_o.png" width="1160"></p> 
<p>有三个参数分别是</p> 
<ul><li>--detach-keys 分离会话，用attach分离会话不如直接用exec</li><li>--no-stdin 禁用输入，这个是防误触用的。默认为有输入。</li><li>--sig-proxy 这个是多个客户端使用attach时，显示相同的输入与输出。默认显示的就是相同的输入与输出</li></ul> 
<h2 id="启动容器-docker-restart"><a id="启动容器-docker-restart-6"></a>6  启动容器 docker restart</h2> 
<p>使用start也行，一般我们都使用restart，因为restart可以替代start的功能</p> 
<p class="img-center"><img alt="" height="186" src="https://images2.imgbox.com/93/a0/WGa5r6qR_o.png" width="1200"></p> 
<h2 id="停止容器-docker-stop">7  停止容器 docker stop</h2> 
<p class="img-center"><img alt="" height="182" src="https://images2.imgbox.com/7f/b4/8xoIx7jH_o.png" width="1200"></p> 
<h2 id="显示容器在宿主机的运行情况-docker-top">8  显示容器在宿主机的运行情况 docker top</h2> 
<p class="img-center"><img alt="" height="185" src="https://images2.imgbox.com/a8/79/ch0QO1Bg_o.png" width="1200"></p> 
<p>我们在宿主机中查看进程对比一下，发现信息是一致的</p> 
<p class="img-center"><img alt="" height="151" src="https://images2.imgbox.com/48/e4/nEbJi8n1_o.png" width="1200"></p> 
<p>我们简单说一下top中的内容</p> 
<ul><li>UID 哪个运行运行的，我此时用的是sudo su，所以是root用户</li><li>PID 当前进程ID</li><li>PPID 当前进程的父进程ID</li><li>C CPU占用率</li><li>STIME 进程开始时间，我当前是11：11分启动的容器</li><li>TTY 启动此进程的中断设备，这个没用到过，也不太懂</li><li>CMD 启动进程的命令</li></ul> 
<p>我们查看help发现没有和其他的指令一样，写着有什么参数。这里我们可以看到[ps OPTIONS]，[ps OPTIONS]表明和linux命令中ps的参数一致</p> 
<p class="img-center"><img alt="" height="166" src="https://images2.imgbox.com/ed/2b/XerFe1bz_o.png" width="501"></p> 
<p>比如我们使用ps -ef ，在这里也可以使用 docker top [容器ID] -ef</p> 
<p class="img-center"><img alt="" height="129" src="https://images2.imgbox.com/08/4c/vdbztkQO_o.png" width="1200"></p> 
<h2 id="查看日志docker-logs">9  查看日志docker logs</h2> 
<p>可以查看启动容器的日志，也可以查看未启动容器的日志，比如查看未启动的ubuntu</p> 
<p class="img-center"><img alt="" height="148" src="https://images2.imgbox.com/1b/b5/9V0i2Pj6_o.png" width="1200"></p> 
<p>下面是查看启动的tomcat</p> 
<p class="img-center"><img alt="" height="253" src="https://images2.imgbox.com/00/7e/IOiYElLY_o.png" width="1200"></p> 
<h3 id="从指定时间到现在的日志---since">9.1  从指定时间到现在的日志 --since</h3> 
<p>--since 显示从什么时候开始的日志，比如我只想看2小时前到现在的日志，那么我就写 docker logs e025 --since '120m'</p> 
<p class="img-center"><img alt="" height="922" src="https://images2.imgbox.com/b9/dc/gjiCJzHX_o.png" width="1200"></p> 
<p>也可以给时间戳，时间戳的格式可以照着help文档中的内容来写</p> 
<p class="img-center"><img alt="" height="312" src="https://images2.imgbox.com/be/7a/8cpdEteF_o.png" width="1098"></p> 
<p>比如 docker logs e025 --since '2023-12-13T9:20:00Z'</p> 
<ul><li>时间要写0时区的时间，我现在在17点多开启了容器，那我就要写9点</li></ul> 
<p class="img-center"><img alt="" height="923" src="https://images2.imgbox.com/6a/de/KbkyKQBm_o.png" width="1200"></p> 
<h3 id="最后n行---tail">9.2  最后n行 --tail</h3> 
<p>比如我现在只想看最后3行的内容，那么就写 docker logs [容器ID] --tail 3</p> 
<ul><li>一般来讲新的日志总是在最后，所以我们看最后3行，一般也是最新的3行</li></ul> 
<p class="img-center"><img alt="" height="94" src="https://images2.imgbox.com/cf/c1/YWYwAV91_o.png" width="1083"></p> 
<h3 id="从日志的开头到指定的时间---until">9.3  从日志的开头到指定的时间 --until</h3> 
<p>比如 docker logs e025 --until '2023-12-13T9:26:00z'</p> 
<p class="img-center"><img alt="" height="562" src="https://images2.imgbox.com/3a/58/r7o065kG_o.png" width="1200"></p> 
<h3 id="添加日志的时间戳--t">9.4  添加日志的时间戳 -t</h3> 
<p>我们做个对比</p> 
<p class="img-center"><img alt="" height="204" src="https://images2.imgbox.com/ce/c2/l8KOeYOb_o.png" width="533"></p> 
<h3 id="获得动态日志--f">9.5  获得动态日志 -f</h3> 
<p>-f只能查看运行中的容器，通过-f查看日志后，终端会一直监听该容器</p> 
<p class="img-center"><img alt="" height="223" src="https://images2.imgbox.com/18/60/DFkurpG0_o.png" width="864"></p> 
<p>此时我们可以通过 docker attach 该容器，然后进行一些操作，比如输入 ps -ef 然后按回车</p> 
<p class="img-center"><img alt="" height="220" src="https://images2.imgbox.com/18/fd/V15kBbDX_o.png" width="572"></p> 
<p>之后我们发现logs也会显示相同的内容</p> 
<p class="img-center"><img alt="" height="248" src="https://images2.imgbox.com/5f/ea/tvI3iTaK_o.png" width="578"></p> 
<h3 id="其他参数">9.6  其他参数</h3> 
<ul><li>--details 显示额外的细节，作用不大</li></ul> 
<h2 id="宿主机与容器复制文件-docker-cp"><a id="宿主机与容器复制文件-docker-cp-10"></a>10  宿主机与容器复制文件 docker cp</h2> 
<p>使用cp命令不能在容器与容器间复制文件</p> 
<h3 id="从宿主机复制文件到容器中"><a id="从宿主机复制文件到容器中-10.1"></a>10.1  从宿主机复制文件到容器中</h3> 
<ul><li>可以复制到关闭的容器中，也可以复制到未关闭的容器中</li></ul> 
<p>我现在宿主机的home下有一个test.txt</p> 
<p class="img-center"><img alt="" height="200" src="https://images2.imgbox.com/92/99/pZDiTblD_o.png" width="579"></p> 
<p>里面的内容的hello world</p> 
<p class="img-center"><img alt="" height="68" src="https://images2.imgbox.com/ae/cf/o4TYMQwY_o.png" width="248"></p> 
<p>我现在复制到 3c57 这个容器的/home下</p> 
<p class="img-center"><img alt="" height="58" src="https://images2.imgbox.com/d5/35/yNFDXPd7_o.png" width="784"></p> 
<p>发现可以成功复制进去</p> 
<p class="img-center"><img alt="" height="166" src="https://images2.imgbox.com/da/5b/NLUlYtBW_o.png" width="517"></p> 
<h3 id="从容器复制文件到宿主机">10.2  从容器复制文件到宿主机</h3> 
<ul><li>可以从关闭的容器中复制，也可以从开启的容器中复制</li></ul> 
<p>我现在在容器中创建 do_something.txt 内容为 do something</p> 
<p class="img-center"><img alt="" height="115" src="https://images2.imgbox.com/37/71/eBFpTyxe_o.png" width="572"></p> 
<p>将do_something.txt复制到宿主机上</p> 
<p class="img-center"><img alt="" height="60" src="https://images2.imgbox.com/05/0d/XLEWFTuf_o.png" width="934"></p> 
<p>发现可以成功复制</p> 
<p class="img-center"><img alt="" height="235" src="https://images2.imgbox.com/5a/d6/qqTAed8A_o.png" width="498"></p> 
<p class="img-center"><img alt="" height="70" src="https://images2.imgbox.com/16/53/oVWwPiHs_o.png" width="395"></p> 
<h2 id="将容器保存为镜像-docker-commit">11  将容器保存为镜像 docker commit</h2> 
<ul><li>docker commit生成的镜像会保留镜像的全部信息。可以理解为与docker save -&gt;docker load 的结果一样。与docker export -&gt; docker import 的结果不同</li></ul> 
<p>我们首先准备一个容器，这个容器的/home下有一个test.txt，内容为 hello world</p> 
<p class="img-center"><img alt="" height="190" src="https://images2.imgbox.com/a5/2d/IeLK9Rf0_o.png" width="968"></p> 
<p>我们目前有如下镜像</p> 
<p class="img-center"><img alt="" height="114" src="https://images2.imgbox.com/6d/49/bgnNeq8P_o.png" width="530"></p> 
<p>在使用docker commit之前，我们先看一下参数</p> 
<ul><li>-a 作者字符串</li><li>-c 后面写dockerfile指令，也就是说在该容器下你可以使用dockerfile指令再对容器进行修改，之后保存到镜像</li><li>-m 提交信息，比如说是这一次提交修改了什么东西</li><li>-p 提交时暂停容器</li></ul> 
<p class="img-center"><img alt="" height="279" src="https://images2.imgbox.com/01/6f/yIIKSE5A_o.png" width="755"></p> 
<p>我们下面简单用一下。docker commit -a "[作者名称与邮箱]" -m "[提交信息]" [容器ID] [镜像的名称与tag]</p> 
<ul><li>如果不写镜像名与tag，生成镜像的时候REPOSITORY与TAG就会为none</li></ul> 
<p class="img-center"><img alt="" height="224" src="https://images2.imgbox.com/22/37/kQLh0Cnk_o.png" width="1054"></p> 
<p>发现可以成功添加，之后我们运行一下，运行后发现可以找到 /home/test.txt 并且内容正确</p> 
<p class="img-center"><img alt="" height="83" src="https://images2.imgbox.com/0a/a0/nIJLFxhU_o.png" width="764"></p> 
<p>镜像的作者与提交的信息可以通过查看镜像元信息找到</p> 
<p class="img-center"><img alt="" height="802" src="https://images2.imgbox.com/2f/c8/NFQXGcbO_o.png" width="837"></p> 
<h2 id="将容器保存为tar文件-docker-export">12  将容器保存为tar文件 docker export</h2> 
<p>比如现在我想把 3805 这个容器转换为 tar 文件</p> 
<p class="img-center"><img alt="" height="112" src="https://images2.imgbox.com/c1/70/cJUETOed_o.png" width="1178"></p> 
<p>执行 docker export -o [tar文件名称] [容器ID]</p> 
<p class="img-center"><img alt="" height="40" src="https://images2.imgbox.com/3b/fc/tGuos6CL_o.png" width="682"></p> 
<p>执行过后发现产生了suyu_ubuntu.tar这个文件</p> 
<p class="img-center"><img alt="" height="259" src="https://images2.imgbox.com/eb/c7/f2dmrYdQ_o.png" width="1150"></p> 
<p>使用export导出的tar文件是不能通过docker load 读取的</p> 
<p class="img-center"><img alt="" height="59" src="https://images2.imgbox.com/d0/0b/Nfrb8mXY_o.png" width="781"></p> 
<ul><li>有时通过docker export导出的镜像会比原本的镜像体积(docker save镜像的体积)小，原因是通过export的镜像删除了之前的历史记录（docker export导出的镜像只有一层）与一些注释。</li></ul> 
<p>通过export导出的tar文件可以通过docker import 生成镜像</p> 
<h2 id="将docker-export生成的tar文件加载为镜像-docker-import"><a id="将docker-export生成的tar文件加载为镜像-docker-import-13"></a>13  将docker export生成的tar文件加载为镜像 docker import</h2> 
<p>docker import参数如下</p> 
<ul><li>-c 在tar文件的基础上添加dockerfile语句修改镜像</li><li>-m 提交镜像时的信息，可以在镜像的元信息中查到</li><li>--platform 支持的平台，如果镜像可以支持多架构可以写，不支持多架构不用写</li></ul> 
<p class="img-center"><img alt="" height="254" src="https://images2.imgbox.com/c0/41/lEnFd42y_o.png" width="679"></p> 
<p>我们下面用上面export出来的tar文件做个例子，导入之前的镜像列表是这样的</p> 
<p class="img-center"><img alt="" height="132" src="https://images2.imgbox.com/56/b0/ZAbw2ySg_o.png" width="566"></p> 
<p>执行 docker import [export导出的tar文件] [镜像名:标签]</p> 
<ul><li>如果不写[镜像名:标签]会生成虚悬镜像</li></ul> 
<p class="img-center"><img alt="" height="187" src="https://images2.imgbox.com/bc/40/cdaddwt6_o.png" width="804"></p> 
<h2 id="暂停容器对外的服务-docker-pause">14  暂停容器对外的服务 docker pause</h2> 
<p>docker的暂停状态是 容器依然在运行，但里面的服务就停止了，比如你访问tomcat的首页，此时会一直转，不报错，但也没有响应结果</p> 
<p class="img-center"><img alt="" height="166" src="https://images2.imgbox.com/13/00/hdOvpFSp_o.png" width="1200"></p> 
<h2 id="停止暂停容器对外的服务-docker-unpause">15  停止暂停容器对外的服务 docker unpause</h2> 
<p class="img-center"><img alt="" height="172" src="https://images2.imgbox.com/8a/b5/I5b9Tg4C_o.png" width="1200"></p> 
<h2 id="强制停止容器-docker-kill">16  强制停止容器 docker kill</h2> 
<p class="img-center"><img alt="" height="173" src="https://images2.imgbox.com/c5/c3/JAxhW7IL_o.png" width="1200"></p> 
<h2 id="仅创建容器-docker-create">17  仅创建容器 docker create</h2> 
<ul><li>docker create基本上不用，如果想深入了解可以看一下这个 <a href="https://www.bilibili.com/video/BV1sb411X7oe/?p=61" rel="nofollow" title="061-docker create命令详解_哔哩哔哩_bilibili">061-docker create命令详解_哔哩哔哩_bilibili</a></li></ul> 
<p>参数与docker run 相似，我们简单用一下</p> 
<ul><li>默认后台运行，所以不用写-d，写了会报错，因为docker create没有-d这个参数</li></ul> 
<p class="img-center"><img alt="" height="149" src="https://images2.imgbox.com/56/d2/dl2QPwgg_o.png" width="890"></p> 
<p>启动的时候就当关闭的容器启动就行了</p> 
<p class="img-center"><img alt="" height="130" src="https://images2.imgbox.com/aa/1d/N2yeI5jv_o.png" width="1200"></p> 
<p>启动后可以访问到tomcat的主页</p> 
<p class="img-center"><img alt="" height="630" src="https://images2.imgbox.com/c9/53/iIXBWSkX_o.png" width="1148"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e169f9b203a24d78cf6f1431e74c4709/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">转移mysql中的数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/399638ad1b0a2643749d06475ff843e4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Node】npm使用手册</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>