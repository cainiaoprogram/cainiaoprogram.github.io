<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于Hadoop的数据仓库Hive安装 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于Hadoop的数据仓库Hive安装" />
<meta property="og:description" content="文章目录 基于Hadoop的数据仓库Hive安装1、安装Hive1.1 下载Hive源程序1.2 解压并重命名1.3 修改文件权限1.4 配置环境变量1.5 配置hive-site.xml 2、安装并配置MySQL2.1 下载mysql jdbc包2.2 解压并拷贝2.3 启动并登陆mysql shell2.4 新建hive数据库2.5 配置mysql允许hive接入2.6 启动hadoop2.7 启动hive2.8 退出hive 3、Bug1（已解决）4、Bug2（待解决）5、Bug3（待解决） 基于Hadoop的数据仓库Hive安装 1、安装Hive 1.1 下载Hive源程序 Apache官方：https://www.apache.org/dyn/closer.cgi/hive/
清华大学镜像：https://mirrors.tuna.tsinghua.edu.cn/apache/hive/
在Ubuntu中，使用wget命令下载：
wget https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz 好像失败了（网速问题），算了，还是用Xshell传过来吧！！
1.2 解压并重命名 sudo tar -zxvf ./apache-hive-3.1.3-bin.tar.gz -C /usr/local # 解压到 /usr/local 中 sudo mv apache-hive-3.1.3-bin hive # 重命名为hive 1.3 修改文件权限 sudo chown -R hadoop:hadoop hive 注意：上面的hadoop:hadoop是用户组和用户名，如果你当前使用用户名user_name登录了Linux系统，则把hadoop替换成user_name。
1.4 配置环境变量 为了方便使用，我们把hive命令加入到环境变量中去，使用vim编辑器打开.bashrc文件，命令如下：
sudo vi ~/.bashrc 添加如下内容：
export HIVE_HOME=/usr/local/hive export PATH=$PATH:$HIVE_HOME/bin export HADOOP_HOME=/usr/local/hadoop HADOOP_HOME需要被配置成你系统上Hadoop的安装路径，比如这里是安装在/usr/local/hadoop目录。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/d3297788c8d3c40ca41bd05fdeb3118f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-21T10:37:13+08:00" />
<meta property="article:modified_time" content="2022-10-21T10:37:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于Hadoop的数据仓库Hive安装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#HadoopHive_1" rel="nofollow">基于Hadoop的数据仓库Hive安装</a></li><li><ul><li><a href="#1Hive_3" rel="nofollow">1、安装Hive</a></li><li><ul><li><a href="#11_Hive_5" rel="nofollow">1.1 下载Hive源程序</a></li><li><a href="#12__28" rel="nofollow">1.2 解压并重命名</a></li><li><a href="#13__38" rel="nofollow">1.3 修改文件权限</a></li><li><a href="#14__46" rel="nofollow">1.4 配置环境变量</a></li><li><a href="#15_hivesitexml_75" rel="nofollow">1.5 配置hive-site.xml</a></li></ul> 
   </li><li><a href="#2MySQL_131" rel="nofollow">2、安装并配置MySQL</a></li><li><ul><li><a href="#21_mysql_jdbc_137" rel="nofollow">2.1 下载mysql jdbc包</a></li><li><a href="#22__152" rel="nofollow">2.2 解压并拷贝</a></li><li><a href="#23_mysql_shell_173" rel="nofollow">2.3 启动并登陆mysql shell</a></li><li><a href="#24_hive_183" rel="nofollow">2.4 新建hive数据库</a></li><li><a href="#25_mysqlhive_194" rel="nofollow">2.5 配置mysql允许hive接入</a></li><li><a href="#26_hadoop_214" rel="nofollow">2.6 启动hadoop</a></li><li><a href="#27_hive_226" rel="nofollow">2.7 启动hive</a></li><li><a href="#28_hive_247" rel="nofollow">2.8 退出hive</a></li></ul> 
   </li><li><a href="#3Bug1_256" rel="nofollow">3、Bug1（已解决）</a></li><li><a href="#4Bug2_313" rel="nofollow">4、Bug2（待解决）</a></li><li><a href="#5Bug3_326" rel="nofollow">5、Bug3（待解决）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="HadoopHive_1"></a>基于Hadoop的数据仓库Hive安装</h2> 
<h3><a id="1Hive_3"></a>1、安装Hive</h3> 
<h4><a id="11_Hive_5"></a>1.1 下载Hive源程序</h4> 
<p>Apache官方：<a href="https://www.apache.org/dyn/closer.cgi/hive/" rel="nofollow">https://www.apache.org/dyn/closer.cgi/hive/</a></p> 
<p>清华大学镜像：<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/" rel="nofollow">https://mirrors.tuna.tsinghua.edu.cn/apache/hive/</a></p> 
<p><img src="https://images2.imgbox.com/0c/42/zYGsIL9C_o.png" alt=""></p> 
<p>在Ubuntu中，使用wget命令下载：</p> 
<pre><code class="prism language-shell"><span class="token function">wget</span> https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz
</code></pre> 
<blockquote> 
 <p>好像失败了（网速问题），算了，还是用Xshell传过来吧！！</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/04/61/AfFMsJDl_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/a0/85/xMQ4YEA5_o.png" alt=""></p> 
<h4><a id="12__28"></a>1.2 解压并重命名</h4> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">tar</span> -zxvf ./apache-hive-3.1.3-bin.tar.gz -C /usr/local <span class="token comment"># 解压到 /usr/local 中</span>
<span class="token function">sudo</span> <span class="token function">mv</span> apache-hive-3.1.3-bin hive <span class="token comment"># 重命名为hive</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5f/e7/2wtre8AA_o.png" alt=""></p> 
<h4><a id="13__38"></a>1.3 修改文件权限</h4> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">chown</span> -R hadoop:hadoop hive
</code></pre> 
<blockquote> 
 <p>注意：上面的hadoop:hadoop是用户组和用户名，如果你当前使用用户名user_name登录了Linux系统，则把hadoop替换成user_name。</p> 
</blockquote> 
<h4><a id="14__46"></a>1.4 配置环境变量</h4> 
<p>为了方便使用，我们把hive命令加入到环境变量中去，使用vim编辑器打开<code>.bashrc</code>文件，命令如下：</p> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">vi</span> ~/.bashrc
</code></pre> 
<p><img src="https://images2.imgbox.com/80/97/glXh3yCd_o.png" alt=""></p> 
<p>添加如下内容：</p> 
<pre><code>export HIVE_HOME=/usr/local/hive
export PATH=$PATH:$HIVE_HOME/bin
export HADOOP_HOME=/usr/local/hadoop
</code></pre> 
<blockquote> 
 <p>HADOOP_HOME需要被配置成你系统上Hadoop的安装路径，比如这里是安装在<code>/usr/local/hadoop</code>目录。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/56/ca/7mdC45Zu_o.png" alt=""></p> 
<p>保存退出后，运行如下命令使配置立即生效：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">source</span> ~/.bashrc
</code></pre> 
<h4><a id="15_hivesitexml_75"></a>1.5 配置hive-site.xml</h4> 
<p>修改<code>/usr/local/hive/conf</code>下的<code>hive-site.xml</code>，执行如下命令：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hive/conf
<span class="token function">sudo</span> <span class="token function">mv</span> hive-default.xml.template hive-default.xml
</code></pre> 
<p><img src="https://images2.imgbox.com/05/45/gIvXD37o_o.png" alt=""></p> 
<p>上面命令是将<code>hive-default.xml.template</code>重命名为<code>hive-default.xml</code>。</p> 
<p>然后，使用vim编辑器新建一个配置文件<code>hive-site.xml</code>，命令如下：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hive/conf
<span class="token function">sudo</span> <span class="token function">vi</span> hive-site.xml
</code></pre> 
<p><img src="https://images2.imgbox.com/9e/07/JYxcYYY2_o.png" alt=""></p> 
<p>在<code>hive-site.xml</code>中添加如下配置信息：</p> 
<pre><code>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;
&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
    &lt;value&gt;jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt;
    &lt;description&gt;JDBC connect string for a JDBC metastore&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
    &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
    &lt;description&gt;Driver class name for a JDBC metastore&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
    &lt;value&gt;hive&lt;/value&gt;
    &lt;description&gt;username to use against metastore database&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
    &lt;value&gt;hive&lt;/value&gt;
    &lt;description&gt;password to use against metastore database&lt;/description&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/13/14/6GsF021A_o.png" alt=""></p> 
<h3><a id="2MySQL_131"></a>2、安装并配置MySQL</h3> 
<p>这里我们采用MySQL数据库保存Hive的元数据，而不是采用Hive自带的derby来存储元数据。</p> 
<p><strong>Ubuntu下MySQL的安装参考：<a href="https://blog.csdn.net/m0_70885101/article/details/127414296">Ubuntu安装MySQL及常用操作</a></strong></p> 
<h4><a id="21_mysql_jdbc_137"></a>2.1 下载mysql jdbc包</h4> 
<p>下载地址：<a href="https://dev.mysql.com/downloads/connector/j/" rel="nofollow">https://dev.mysql.com/downloads/connector/j/</a></p> 
<p><img src="https://images2.imgbox.com/92/37/zcPqdz5U_o.png" alt=""></p> 
<p>在Xshell中上传：</p> 
<p><img src="https://images2.imgbox.com/31/73/LuHkw6ce_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/4f/b1/t7A6Ndx5_o.png" alt=""></p> 
<h4><a id="22__152"></a>2.2 解压并拷贝</h4> 
<pre><code class="prism language-shell"><span class="token function">tar</span> -zxvf mysql-connector-j-8.0.31.tar.gz
</code></pre> 
<p><img src="https://images2.imgbox.com/f1/8f/TUHbDQtl_o.png" alt=""></p> 
<p>将<code>mysql-connector-j-8.0.31.jar</code>拷贝到<code>/usr/local/hive/lib</code>目录下：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> 下载
<span class="token builtin class-name">cd</span> mysql-connector-j-8.0.31
<span class="token function">sudo</span> <span class="token function">cp</span> mysql-connector-j-8.0.31.jar /usr/local/hive/lib
</code></pre> 
<p><img src="https://images2.imgbox.com/75/e0/Vy24mcBR_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/33/81/jrCHkZqY_o.png" alt=""></p> 
<h4><a id="23_mysql_shell_173"></a>2.3 启动并登陆mysql shell</h4> 
<pre><code class="prism language-shell"><span class="token function">service</span> mysql start <span class="token comment"># 启动mysql服务</span>
mysql -u root -p  <span class="token comment"># 登陆shell界面</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8c/80/ADXEKYQn_o.png" alt=""></p> 
<h4><a id="24_hive_183"></a>2.4 新建hive数据库</h4> 
<pre><code class="prism language-mysql">create database hive;
</code></pre> 
<blockquote> 
 <p>这个hive数据库与hive-site.xml中<code>localhost:3306/hive</code>的hive对应，用来保存hive元数据。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/88/6b/nnitct5S_o.png" alt=""></p> 
<h4><a id="25_mysqlhive_194"></a>2.5 配置mysql允许hive接入</h4> 
<pre><code class="prism language-mysql">grant all on *.* to hive@localhost identified by 'hive'; # 将所有数据库的所有表的所有权限赋给hive用户，后面的hive是配置hive-site.xml中配置的连接密码
flush privileges; # 刷新mysql系统权限关系表
</code></pre> 
<blockquote> 
 <p>会报错！参考博客：<a href="https://blog.csdn.net/weixin_42534009/article/details/105913449">grant all on <em>.</em> to hive@localhost identified by ‘hive’; ERROR 1064 (42000): You have an error in yo</a></p> 
</blockquote> 
<p>改为如下代码：</p> 
<pre><code class="prism language-mysql">create user 'hive'@'localhost' identified by 'hive';
grant all on *.* to 'hive'@'localhost';
flush privileges;
</code></pre> 
<p><img src="https://images2.imgbox.com/84/61/VXmLQSwN_o.png" alt=""></p> 
<h4><a id="26_hadoop_214"></a>2.6 启动hadoop</h4> 
<p>启动hive之前，请先启动hadoop集群：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hadoop
./sbin/start-all.sh
jps <span class="token comment"># 查看进程（6个为正常）</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e9/ad/cri8Bw3r_o.png" alt=""></p> 
<h4><a id="27_hive_226"></a>2.7 启动hive</h4> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hive
./bin/hive
</code></pre> 
<p><img src="https://images2.imgbox.com/48/d9/hk8Devq0_o.png" alt=""></p> 
<p>尝试一下以下方法：</p> 
<pre><code class="prism language-shell">./bin/schematool -dbType mysql -initSchema
</code></pre> 
<p><img src="https://images2.imgbox.com/d7/70/zY2DXZF4_o.png" alt=""></p> 
<blockquote> 
 <p>还是不可以啊！！！【见Bug1】</p> 
</blockquote> 
<h4><a id="28_hive_247"></a>2.8 退出hive</h4> 
<pre><code class="prism language-hive">exit;
</code></pre> 
<p><img src="https://images2.imgbox.com/58/0b/77cnHMzm_o.png" alt=""></p> 
<h3><a id="3Bug1_256"></a>3、Bug1（已解决）</h3> 
<p>参考博客：<a href="https://blog.csdn.net/weixin_44625028/article/details/122313632?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-122313632-blog-106380077.pc_relevant_aa_2&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-122313632-blog-106380077.pc_relevant_aa_2&amp;utm_relevant_index=1">Hive初始化报错Exception in thread “main“ java.lang.NoSuchMethodError: com.google.common.base.</a></p> 
<p><img src="https://images2.imgbox.com/36/4d/Nqv7QEGQ_o.png" alt=""></p> 
<p><strong>报错原因：</strong> 因为hadoop和hive的两个<code>guava.jar</code>版本不一致</p> 
<p><strong>解决方案：</strong></p> 
<p>（1）删除hive里的guava.jar：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hive/lib
<span class="token function">sudo</span> <span class="token function">rm</span> guava-19.0.jar 
</code></pre> 
<p><img src="https://images2.imgbox.com/68/50/3DSkbncM_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/64/c7/ND318Vtv_o.png" alt=""></p> 
<p>（2）把hadoop里的guava.jar复制到hive里：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hadoop/share/hadoop/common/lib <span class="token comment"># 进入hadoop</span>
<span class="token function">cp</span> -r guava-27.0-jre.jar /usr/local/hive/lib <span class="token comment"># 复制到hive中</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/79/b1/9Yihg37H_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/4b/49/Rhe77dO5_o.png" alt=""></p> 
<p>（3）初始化hive：</p> 
<pre><code class="prism language-shell">./bin/schematool -dbType mysql -initSchema
</code></pre> 
<p><img src="https://images2.imgbox.com/5f/b6/M4bQ65oK_o.png" alt=""><br> <img src="https://images2.imgbox.com/43/ae/EE5YVM0P_o.png" alt=""></p> 
<p>（4）再次启动hive：</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /usr/local/hive
./bin/hive
</code></pre> 
<p><img src="https://images2.imgbox.com/10/b6/J41Hrdjr_o.png" alt=""></p> 
<h3><a id="4Bug2_313"></a>4、Bug2（待解决）</h3> 
<p>当启动<strong>hadoop</strong>或<strong>hive</strong>时，都会报出如下错误：</p> 
<pre><code class="prism language-shell">SLF4J: Failed to load class <span class="token string">"org.slf4j.impl.StaticLoggerBinder"</span><span class="token builtin class-name">.</span>
SLF4J: Defaulting to no-operation <span class="token punctuation">(</span>NOP<span class="token punctuation">)</span> logger implementation
SLF4J: See http://www.slf4j.org/codes.html<span class="token comment">#StaticLoggerBinder for further details.</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/05/bXkhQJtE_o.png" alt=""></p> 
<h3><a id="5Bug3_326"></a>5、Bug3（待解决）</h3> 
<p>当启动<strong>hive</strong>时，会报出如下错误：</p> 
<pre><code class="prism language-shell">WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
WARN DataNucleus.MetaData: Metadata has jdbc-type of null yet this is not valid. Ignored
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/c0/kEyI7uY3_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6468f43d03958fc2f2a0dae3cb60d369/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java 可变参数及集合工具类（Collections）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d5e3ee6ff586b41dbf342b63cfd6a181/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">uniapp手机推送（在线）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>