<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>fiddler手机抓包/模拟器抓包配置代理没有网络问题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="fiddler手机抓包/模拟器抓包配置代理没有网络问题" />
<meta property="og:description" content="最近工作需要对app进行网络抓包，安装了fiddler工具，使用夜神模拟器模拟手机抓包，各种配置都配置完了，但是app还是不能联网，现将解决方法记录如下：
【问题原因】
当我们在手机或者模拟器安装fiddler证书时，证书都是安装在用户证书目录下的，Android7.0版本之后的应用是默认只信任系统证书，不信任用户证书的，所以我们有两种方法去解决这个问题。1、将Fiddler证书装到系统证书目录下，伪装成系统证书，2、使用Android5.0版本的手机或者模拟器，下面使用第一种方法。
1、导出fiddler证书 1、在此之前请确保你的fiddler已经安装配置完成！
2、首先关闭fiddler，然后下载fiddlercertmaker.exe工具，双击下载好的fiddlercertmaker.exe（确保已关闭Fiddler），会弹出提示导入证书成功这个对话框，点击确定
3、导出fiddler证书到电脑桌面，Tools -&gt; Options -&gt; HTTPS -&gt; Actions -&gt; Export Root Certificate to Desktop
完成之后在电脑桌面会出现一个FiddlerRoot.cer证书
2、安装openssl 1、到openssl下载地址下载好windows版的openssl
2、点击安装，一路点击下一步
3、安装完成后需要配置环境变量，将安装目录的bin目录配置到环境变量
4、打开终端输入openssl version 或者输入openssl出现下图信息表示安装成功
3、证书格式转换 1、将Fiddler cer证书转pem证书，在cmd输入如下命令：openssl x509 -inform DER -in 电脑桌面证书路径.cer -out 电脑桌面证书路径.pem
openssl x509 -inform DER -in C:\Users\Administrator\Desktop\FiddlerRoot.cer -out C:\Users\Administrator\Desktop\FiddlerRoot.pem 2、计算pem证书的hash值，输入如下命令：openssl x509 -inform PEM -subject_hash_old -in 电脑桌面证书路径
openssl x509 -inform PEM -subject_hash_old -in C:\Users\Administrator\Desktop\FiddlerRoot.pem 上图的e5c3944b就是pem证书的hash值。
3、使用e5c3944b对pem证书重命名，命令如下：ren 电脑桌面证书路径 证书hash值.0
ren C:\Users\Administrator\Desktop\FiddlerRoot.pem e5c3944b.0 4、安装证书到系统目录 这里我使用的是夜神模拟器
1、打开终端输入adb connect 127." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/50ffe15edc1c1a2c931cdf78424f0388/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-17T12:23:34+08:00" />
<meta property="article:modified_time" content="2022-12-17T12:23:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">fiddler手机抓包/模拟器抓包配置代理没有网络问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>最近工作需要对app进行网络抓包，安装了fiddler工具，使用夜神模拟器模拟手机抓包，各种配置都配置完了，但是app还是不能联网，现将解决方法记录如下：</p> 
<hr> 
<p><strong>【问题原因】</strong></p> 
<blockquote> 
 <p>当我们在手机或者模拟器安装fiddler证书时，证书都是安装在用户证书目录下的，Android7.0版本之后的应用是默认只信任系统证书，不信任用户证书的，所以我们有两种方法去解决这个问题。1、将Fiddler证书装到系统证书目录下，伪装成系统证书，2、使用Android5.0版本的手机或者模拟器，下面使用第一种方法。</p> 
</blockquote> 
<h4><a id="1fiddler_9"></a>1、导出fiddler证书</h4> 
<p>1、在此之前请确保你的fiddler已经安装配置完成！<br> 2、首先关闭fiddler，然后下载<a href="http://telerik-fiddler.s3.amazonaws.com/fiddler/addons/fiddlercertmaker.exe" rel="nofollow">fiddlercertmaker.exe</a>工具，双击下载好的fiddlercertmaker.exe（确保已关闭Fiddler），会弹出提示导入证书成功这个对话框，点击确定<br> <img src="https://images2.imgbox.com/92/5c/7XAdUDoF_o.png" alt="在这里插入图片描述"></p> 
<p>3、导出fiddler证书到电脑桌面，Tools -&gt; Options -&gt; HTTPS -&gt; Actions -&gt; Export Root Certificate to Desktop</p> 
<p><img src="https://images2.imgbox.com/cf/81/712VqGit_o.png" alt="在这里插入图片描述"></p> 
<p>完成之后在电脑桌面会出现一个FiddlerRoot.cer证书<br> <img src="https://images2.imgbox.com/54/11/d3xe0qPC_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2openssl_20"></a>2、安装openssl</h4> 
<p>1、到<a href="http://slproweb.com/products/Win32OpenSSL.html" rel="nofollow">openssl下载地址</a>下载好windows版的openssl</p> 
<p><img src="https://images2.imgbox.com/e8/32/1hy4O5Wo_o.png" alt="在这里插入图片描述"><br> 2、点击安装，一路点击下一步<br> 3、安装完成后需要<strong>配置环境变量</strong>，将安装目录的bin目录配置到环境变量<br> <img src="https://images2.imgbox.com/6c/27/0OAeUZ9v_o.png" alt="在这里插入图片描述"></p> 
<p>4、打开终端输入<code>openssl version</code> 或者输入<code>openssl</code>出现下图信息表示安装成功</p> 
<p><img src="https://images2.imgbox.com/4b/21/3rdeQy48_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0b/42/vFIRDyYP_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_32"></a>3、证书格式转换</h4> 
<p>1、将Fiddler <code>cer</code>证书转<code>pem</code>证书，在cmd输入如下命令：<code>openssl x509 -inform DER -in 电脑桌面证书路径.cer -out 电脑桌面证书路径.pem</code></p> 
<pre><code>openssl x509 -inform DER -in C:\Users\Administrator\Desktop\FiddlerRoot.cer -out C:\Users\Administrator\Desktop\FiddlerRoot.pem
</code></pre> 
<p>2、计算<code>pem</code>证书的<code>hash</code>值，输入如下命令：<code>openssl x509 -inform PEM -subject_hash_old -in 电脑桌面证书路径</code></p> 
<pre><code>openssl x509 -inform PEM -subject_hash_old -in C:\Users\Administrator\Desktop\FiddlerRoot.pem
</code></pre> 
<p><img src="https://images2.imgbox.com/9e/49/vPvbdX40_o.png" alt="在这里插入图片描述"><br> 上图的<code>e5c3944b</code>就是<code>pem</code>证书的hash值。</p> 
<p>3、使用<code>e5c3944b</code>对<code>pem</code>证书重命名，命令如下：<code>ren 电脑桌面证书路径 证书hash值.0</code></p> 
<pre><code>ren C:\Users\Administrator\Desktop\FiddlerRoot.pem e5c3944b.0
</code></pre> 
<h4><a id="4_52"></a>4、安装证书到系统目录</h4> 
<p><strong>这里我使用的是夜神模拟器</strong></p> 
<p>1、打开终端输入<code>adb connect 127.0.0.1:62001</code> 连接夜神模拟器（如果出现<code>'adb' 不是内部或外部命令，也不是可运行的程序 或批处理文件。</code>那么需要找到SDK安装路径下的platform-tools路径，输入cmd打开终端即可）<br> 2、cmd 输入<code>adb shell</code><br> 3 、cmd 输入 <code>cd /system/etc/security</code>,<br> 4、cmd 输入 <code>ls -l</code> 查看权限，此时没有写入的权限</p> 
<p><img src="https://images2.imgbox.com/e2/67/t5bz3tdy_o.png" alt="在这里插入图片描述"><br> 5、cmd 输入<code>chmod 777 cacerts</code> 此时对目录拥有写入权限，可以再次输入老<code>ls -l</code>查看目录权限<br> <img src="https://images2.imgbox.com/ca/6e/NgVPSTqd_o.png" alt="在这里插入图片描述"><br> 现在已经拥有写入权限。</p> 
<p>如果输入<code>chmod 777 cacerts</code> 出现 Read-only file system<br> <img src="https://images2.imgbox.com/64/35/fobCPBBX_o.png" alt="在这里插入图片描述"><br> 需要重新挂载一下系统，输入<code>mount -o remount,rw /system</code>再次输入<code>chmod 777 cacerts</code>就成功了。</p> 
<p>6、cmd输入<code>exit</code>退出shell终端，然后输入adb push C:\Users\Administrator\Desktop\e5c3944b.0 /system/etc/security/cacerts，将事先转换好的Fiddler证书推送到夜神模拟器的/system/etc/security/cacerts目录下<br> <img src="https://images2.imgbox.com/04/7f/iqNLSut8_o.png" alt="在这里插入图片描述"><br> 此时已经将fiddler证书安装到了模拟器的系统证书目录里了，打开夜神模拟器</p> 
<p><img src="https://images2.imgbox.com/ea/d8/wO9AQBxN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/90/9c/xXiNulMw_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/eb/b5/TjWimbPz_o.png" alt="在这里插入图片描述"></p> 
<p>大功告成！可以看到fiddler证书已经安装到系统目录了。<br> 确保模拟器设置好了代理IP和端口，此时打开fiddler抓取模拟器的包就不会出现没有网络的问题了。</p> 
<p><strong>最后，特别感谢！</strong><a href="https://blog.csdn.net/qq_43278826/article/details/124291040?spm=1001.2014.3001.5506">Android 7.0+模拟器Fiddler抓包详细教程</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b67f357c88c64fca11d88cbf1b7b7e7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">四轮两驱小车（一）：STM32驱动AS4950</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cadb22f9e8cf630cf0457082c43f907e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【python】详解使用numpy模块来拼接矩阵，二维矩阵和三维矩阵</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>