<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Spring Boot项目中使用https（jks） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在Spring Boot项目中使用https（jks）" />
<meta property="og:description" content="目录
一 SpringBoot配置HTTPS
二 自己生成CSR
1 解压已下载的证书压缩包，获得“xxx.pem”文件和xxx.key文件
2 使用OpenSSL工具，将pem格式证书转换为PFX格式证书，得到“server.pfx”文件
3 使用Keytool工具，将PFX格式证书文件转换成JKS格式，得到“xxx.jks”文件
三 在SpringBoot中配置
1 将xxx.jks放入resources文件夹下
2 启动测试
四 同时配置http和https都能访问
1 新加配置
2 在SpringBoot启动类中添加
五 参考资料
一 SpringBoot配置HTTPS 在工作中时长会遇到配置https，SpringBoot自带的是tomcat服务器一般使用的.jks文件配置SSL加密。
过程中会用到两个工具：OpenSSL，Keytool工具。
OpenSSL：下载地址：http://slproweb.com/products/Win32OpenSSL.html
keytool工具，这是jdk自带的工具，在jdk的/bin目录下可以找到。
二 自己生成CSR https供应商不会直接提供.jks文件。所以，我们就需要将加密文件转换成所需要的jks文件。
1 解压已下载的证书压缩包，获得“xxx.pem”文件和xxx.key文件 “server.pem”文件包括两段证书代码“-----BEGIN CERTIFICATE-----”和“-----END CERTIFICATE-----”，分别为服务器证书和中级CA证书。
2 使用OpenSSL工具，将pem格式证书转换为PFX格式证书，得到“server.pfx”文件 找到openssl的bin目录，找到openssl.exe文件，单击右键以管理员身份运行，打开命令行，输入命令：
pkcs12 -export -out D:\xxx.pfx -in D:\xxx.pem -inkey D:\xxx.key 按照要求输入两次密码，这时在d盘生成了xxx.pfx文件 请牢记此处输入的PFX证书密码。后续设置JKS密码需要与此处设置的PFX密码保持一致，否则可能会导致Tomcat启动失败。
3 使用Keytool工具，将PFX格式证书文件转换成JKS格式，得到“xxx.jks”文件 keytool -importkeystore -srckeystore D:\xxx.pfx -destkeystore D:\xxx.jks -srcstoretype PKCS12 -deststoretype JKS 按照提示输入2次JKS证书密码
第三次提示输入源密钥库口令： 输入生成xxx.pfx中设置PFX证书密码
查看D盘下是否生成 xxx.jks" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c7e186f935de1c0ce41b1d8beb513328/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-30T14:28:26+08:00" />
<meta property="article:modified_time" content="2021-04-30T14:28:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Spring Boot项目中使用https（jks）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%20SpringBoot%E9%85%8D%E7%BD%AEHTTPS-toc" style="margin-left:0px;"><a href="#%E4%B8%80%20SpringBoot%E9%85%8D%E7%BD%AEHTTPS" rel="nofollow">一 SpringBoot配置HTTPS</a></p> 
<p id="%E4%BA%8C%20%E8%87%AA%E5%B7%B1%E7%94%9F%E6%88%90CSR-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%20%E8%87%AA%E5%B7%B1%E7%94%9F%E6%88%90CSR" rel="nofollow">二 自己生成CSR</a></p> 
<p id="1%20%E8%A7%A3%E5%8E%8B%E5%B7%B2%E4%B8%8B%E8%BD%BD%E7%9A%84%E8%AF%81%E4%B9%A6%E5%8E%8B%E7%BC%A9%E5%8C%85%EF%BC%8C%E8%8E%B7%E5%BE%97%E2%80%9Cxxx.pem%E2%80%9D%E6%96%87%E4%BB%B6%E5%92%8Cxxx.key%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#1%20%E8%A7%A3%E5%8E%8B%E5%B7%B2%E4%B8%8B%E8%BD%BD%E7%9A%84%E8%AF%81%E4%B9%A6%E5%8E%8B%E7%BC%A9%E5%8C%85%EF%BC%8C%E8%8E%B7%E5%BE%97%E2%80%9Cxxx.pem%E2%80%9D%E6%96%87%E4%BB%B6%E5%92%8Cxxx.key%E6%96%87%E4%BB%B6" rel="nofollow">1 解压已下载的证书压缩包，获得“xxx.pem”文件和xxx.key文件</a></p> 
<p id="2%20%E4%BD%BF%E7%94%A8OpenSSL%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%86pem%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%E8%BD%AC%E6%8D%A2%E4%B8%BAPFX%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9Cserver.pfx%E2%80%9D%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#2%20%E4%BD%BF%E7%94%A8OpenSSL%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%86pem%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%E8%BD%AC%E6%8D%A2%E4%B8%BAPFX%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9Cserver.pfx%E2%80%9D%E6%96%87%E4%BB%B6" rel="nofollow">2 使用OpenSSL工具，将pem格式证书转换为PFX格式证书，得到“server.pfx”文件</a></p> 
<p id="3%20%E4%BD%BF%E7%94%A8Keytool%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%86PFX%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E6%88%90JKS%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9Cxxx.jks%E2%80%9D%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#3%20%E4%BD%BF%E7%94%A8Keytool%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%86PFX%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E6%88%90JKS%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9Cxxx.jks%E2%80%9D%E6%96%87%E4%BB%B6" rel="nofollow">3 使用Keytool工具，将PFX格式证书文件转换成JKS格式，得到“xxx.jks”文件</a></p> 
<p id="%E4%B8%89%20%E5%9C%A8SpringBoot%E4%B8%AD%E9%85%8D%E7%BD%AE-toc" style="margin-left:0px;"><a href="#%E4%B8%89%20%E5%9C%A8SpringBoot%E4%B8%AD%E9%85%8D%E7%BD%AE" rel="nofollow">三 在SpringBoot中配置</a></p> 
<p id="1%20%E5%B0%86xxx.jks%E6%94%BE%E5%85%A5resources%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B-toc" style="margin-left:80px;"><a href="#1%20%E5%B0%86xxx.jks%E6%94%BE%E5%85%A5resources%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B" rel="nofollow">1 将xxx.jks放入resources文件夹下</a></p> 
<p id="2%20%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#2%20%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95" rel="nofollow">2 启动测试</a></p> 
<p id="%E5%9B%9B%20%E5%90%8C%E6%97%B6%E9%85%8D%E7%BD%AEhttp%E5%92%8Chttps%E9%83%BD%E8%83%BD%E8%AE%BF%E9%97%AE-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%20%E5%90%8C%E6%97%B6%E9%85%8D%E7%BD%AEhttp%E5%92%8Chttps%E9%83%BD%E8%83%BD%E8%AE%BF%E9%97%AE" rel="nofollow">四 同时配置http和https都能访问</a></p> 
<p id="1%20%E6%96%B0%E5%8A%A0%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#1%20%E6%96%B0%E5%8A%A0%E9%85%8D%E7%BD%AE" rel="nofollow">1 新加配置</a></p> 
<p id="2%20%E5%9C%A8SpringBoot%E5%90%AF%E5%8A%A8%E7%B1%BB%E4%B8%AD%E6%B7%BB%E5%8A%A0-toc" style="margin-left:80px;"><a href="#2%20%E5%9C%A8SpringBoot%E5%90%AF%E5%8A%A8%E7%B1%BB%E4%B8%AD%E6%B7%BB%E5%8A%A0" rel="nofollow">2 在SpringBoot启动类中添加</a></p> 
<p id="%E4%BA%94%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99-toc" style="margin-left:0px;"><a href="#%E4%BA%94%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" rel="nofollow">五 参考资料</a></p> 
<hr id="hr-toc"> 
<h2 id="%E4%B8%80%20SpringBoot%E9%85%8D%E7%BD%AEHTTPS">一 SpringBoot配置HTTPS</h2> 
<p>在工作中时长会遇到配置https，SpringBoot自带的是tomcat服务器一般使用的.jks文件配置SSL加密。</p> 
<p>过程中会用到两个工具：OpenSSL，Keytool工具。</p> 
<p>OpenSSL：下载地址：http://slproweb.com/products/Win32OpenSSL.html</p> 
<p>keytool工具，这是jdk自带的工具，在jdk的/bin目录下可以找到。</p> 
<h2 id="%E4%BA%8C%20%E8%87%AA%E5%B7%B1%E7%94%9F%E6%88%90CSR">二 自己生成CSR</h2> 
<p>https供应商不会直接提供.jks文件。所以，我们就需要将加密文件转换成所需要的jks文件。</p> 
<h4 id="1%20%E8%A7%A3%E5%8E%8B%E5%B7%B2%E4%B8%8B%E8%BD%BD%E7%9A%84%E8%AF%81%E4%B9%A6%E5%8E%8B%E7%BC%A9%E5%8C%85%EF%BC%8C%E8%8E%B7%E5%BE%97%E2%80%9Cxxx.pem%E2%80%9D%E6%96%87%E4%BB%B6%E5%92%8Cxxx.key%E6%96%87%E4%BB%B6">1 解压已下载的证书压缩包，获得“xxx.pem”文件和xxx.key文件</h4> 
<p>“server.pem”文件包括两段证书代码“-----BEGIN CERTIFICATE-----”和“-----END CERTIFICATE-----”，分别为服务器证书和中级CA证书。</p> 
<h4 id="2%20%E4%BD%BF%E7%94%A8OpenSSL%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%86pem%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%E8%BD%AC%E6%8D%A2%E4%B8%BAPFX%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9Cserver.pfx%E2%80%9D%E6%96%87%E4%BB%B6">2 使用OpenSSL工具，将pem格式证书转换为PFX格式证书，得到“server.pfx”文件</h4> 
<p>找到openssl的bin目录，找到openssl.exe文件，单击右键以管理员身份运行，打开命令行，输入命令：</p> 
<pre><code>pkcs12 -export -out D:\xxx.pfx -in D:\xxx.pem -inkey D:\xxx.key
</code></pre> 
<p>按照要求输入两次密码，这时在d盘生成了xxx.pfx文件 请牢记此处输入的PFX证书密码。后续设置JKS密码需要与此处设置的PFX密码保持一致，否则可能会导致Tomcat启动失败。</p> 
<h4 id="3%20%E4%BD%BF%E7%94%A8Keytool%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B0%86PFX%E6%A0%BC%E5%BC%8F%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E6%88%90JKS%E6%A0%BC%E5%BC%8F%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9Cxxx.jks%E2%80%9D%E6%96%87%E4%BB%B6">3 使用Keytool工具，将PFX格式证书文件转换成JKS格式，得到“xxx.jks”文件</h4> 
<pre><code>keytool -importkeystore -srckeystore D:\xxx.pfx -destkeystore D:\xxx.jks -srcstoretype PKCS12 -deststoretype JKS
</code></pre> 
<p>按照提示输入2次JKS证书密码</p> 
<p>第三次提示输入源密钥库口令： 输入生成xxx.pfx中设置PFX证书密码</p> 
<p>查看D盘下是否生成 xxx.jks</p> 
<p>生成完成后，新建一个“keystorePass.txt”文件，将JKS的密码保存在该文件中。</p> 
<h2 id="%E4%B8%89%20%E5%9C%A8SpringBoot%E4%B8%AD%E9%85%8D%E7%BD%AE">三 在SpringBoot中配置</h2> 
<h4 id="1%20%E5%B0%86xxx.jks%E6%94%BE%E5%85%A5resources%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B">1 将xxx.jks放入resources文件夹下</h4> 
<pre><code>#配置jks存放位置
server.ssl.key-store=classpath:xxx.jks
#https端口号
server.port=8090
#是否启用SSL证书
server.ssl.enabled=true
#密钥库密码
server.ssl.key-store-password=jks密码
#密钥库类型(JKS类型)
server.ssl.key-store-type=JKS
</code></pre> 
<h4 id="2%20%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95">2 启动测试</h4> 
<h2 id="%E5%9B%9B%20%E5%90%8C%E6%97%B6%E9%85%8D%E7%BD%AEhttp%E5%92%8Chttps%E9%83%BD%E8%83%BD%E8%AE%BF%E9%97%AE">四 同时配置http和https都能访问</h2> 
<h4 id="1%20%E6%96%B0%E5%8A%A0%E9%85%8D%E7%BD%AE">1 新加配置</h4> 
<pre><code>#http端口号
http.port=18092
</code></pre> 
<h4 id="2%20%E5%9C%A8SpringBoot%E5%90%AF%E5%8A%A8%E7%B1%BB%E4%B8%AD%E6%B7%BB%E5%8A%A0">2 在SpringBoot启动类中添加</h4> 
<pre><code>// 获取配置端口
@Value("${http.port}")
    private Integer httpPort;

@Bean
    public ServletWebServerFactory servletContainer() {
        TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory();
        // 添加http
        tomcat.addAdditionalTomcatConnectors(createStandardConnector());
        return tomcat;
    }

/**
     * 配置http
     *
     * @return connector
     */
    private Connector createStandardConnector() {
        Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
        connector.setPort(httpPort);
        return connector;
    }</code></pre> 
<p> </p> 
<h2 id="%E4%BA%94%20%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">五 参考资料</h2> 
<p><a href="https://www.caojingbin.com/post/40" rel="nofollow">https://www.caojingbin.com/post/40</a></p> 
<p><a href="https://www.cnblogs.com/yangchongxing/p/13834467.html" rel="nofollow">https://www.cnblogs.com/yangchongxing/p/13834467.html</a></p> 
<p> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/405910905c7fc15bcf7fc4d1d455f246/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux内核 helloworld,Linux内核模块编程helloworld小程序问题解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b48edcdfa9dd57cfbb714e0653f9d9ee/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">DeepStream 快速入门</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>