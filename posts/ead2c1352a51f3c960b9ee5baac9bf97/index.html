<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Oracle透明数据加密 (TDE)常见问题解答 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Oracle透明数据加密 (TDE)常见问题解答" />
<meta property="og:description" content="任何人只要有权访问加密数据就能对其进行解密吗？ 是的，TDE 旨在让客户能够透明地在数据库中进行加密，而不会影响现有应用。以加密格式返回数据会破坏大多数现有应用。TDE 的优势在于，加密不会产生传统数据库加密解决方案所产生的开销，传统的方案通常需要对应用进行更改，包括使用数据库触发器和视图，因而费时费力，成本高昂。不过，客户可以使用 Oracle Database Vault 保护应用数据，防止 DBA 及其他超级用户的不当使用，还可以对数据库和应用实施强大的访问权限控制。
TDE 会带来哪些开销？ 表 A：TDE 会带来哪些开销？ TDE 表空间加密
(Oracle Database 11g)TDE 列加密
（Oracle Database 10gR2、
Oracle Database 11g）存储没有额外的存储开销。TDE 列加密带来的存储开销为每个加密值 1 到 52 个字节。 必需：对于 AES，填充到下一个 16 字节；对于 3DES168，填充到下一个 8 字节。所以，如果一个值需要 9 个字节的存储空间，加密该值将需要额外 7 个字节的存储空间（对于 AES）。可选：额外 20 个字节的完整性检查可选：如果为加密列指定了“SALT”，每个值将需要额外 16 个字节的存储空间。了解这些数字有助于进行存储规划，但 DBA 和开发人员不用手动为 TDE 列加密扩大列存储空间，因为在将某列标记为“encrypted”时，TDE 会透明地完成这项任务。
用户可以选择 &#39;no salt&#39; 选项来减少所需额外存储空间（可节省 16 个字节），还可以选择 &#39;nomac&#39; 选项（10.2.0.4、11.1.0.7 和 Oracle Database 11g 第 2 版中提供该选项）来消除为每个加密字段计算和存储 20 字节散列值而需要的额外的 CPU 周期和磁盘空间。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ead2c1352a51f3c960b9ee5baac9bf97/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-27T18:21:56+08:00" />
<meta property="article:modified_time" content="2023-11-27T18:21:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Oracle透明数据加密 (TDE)常见问题解答</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0;"></h3> 
<p><a name="A15037"></a></p> 
<ol style="margin-left:0;"><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>任何人只要有权访问加密数据就能对其进行解密吗？</strong></span></h5> <p style="margin-left:0;">是的，TDE 旨在让客户能够透明地在数据库中进行加密，而不会影响现有应用。以加密格式返回数据会破坏大多数现有应用。TDE 的优势在于，加密不会产生传统数据库加密解决方案所产生的开销，传统的方案通常需要对应用进行更改，包括使用数据库触发器和视图，因而费时费力，成本高昂。不过，客户可以使用 Oracle Database Vault 保护应用数据，防止 DBA 及其他超级用户的不当使用，还可以对数据库和应用实施强大的访问权限控制。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>TDE 会带来哪些开销？</strong></span></h5> 
  <table><caption>
     表 A：TDE 会带来哪些开销？ 
   </caption><tbody><tr><th></th><th><span style="color:#0d0016;">TDE 表空间加密<br> (Oracle Database 11g)</span></th><th><span style="color:#0d0016;">TDE 列加密<br> （Oracle Database 10gR2、<br> Oracle Database 11g）</span></th></tr><tr><th><span style="color:#0d0016;">存储</span></th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">没有额外的存储开销。</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">TDE 列加密带来的存储开销为每个加密值 1 到 52 个字节。</span> 
      <ol style="margin-left:0;"><li><span style="color:#000000;">必需：对于 AES，填充到下一个 16 字节；对于 3DES168，填充到下一个 8 字节。所以，如果一个值需要 9 个字节的存储空间，加密该值将需要额外 7 个字节的存储空间（对于 AES）。</span></li><li><span style="color:#000000;">可选：额外 20 个字节的完整性检查</span></li><li><span style="color:#000000;">可选：如果为加密列指定了“SALT”，每个值将需要额外 16 个字节的存储空间。</span></li></ol><p style="margin-left:0;"><span style="color:#000000;">了解这些数字有助于进行存储规划，但 DBA 和开发人员不用手动为 TDE 列加密扩大列存储空间，因为在将某列标记为“encrypted”时，TDE 会透明地完成这项任务。</span></p> <p style="margin-left:0;"><span style="color:#000000;">用户可以选择 <strong>'no salt'</strong> 选项来减少所需额外存储空间（可节省 16 个字节），还可以选择 <strong>'nomac'</strong> 选项（10.2.0.4、11.1.0.7 和 Oracle Database 11g 第 2 版中提供该选项）来消除为每个加密字段计算和存储 20 字节散列值而需要的额外的 CPU 周期和磁盘空间。</span></p> </td></tr><tr><th><span style="color:#0d0016;">性能</span></th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">内部基准测试结果和来自成功生产实施的反馈结果表明，性能开销只是个位数。对于 Oracle Database 11g 第 2 版补丁集 1 (11.2.0.2)，TDE 表空间加密可自动利用基于 AES-NI 的硬件密码加速（可用于大多数 Intel? XEON? 5600 CPU），TDE 表空间加密因而成为了“几乎没有影响”的加密解决方案，特别是在数据仓库环境中。</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">加密或解密通用属性（如信用卡号码）带来的性能开销估计为 5% 左右。基于加密列构建索引时，将使用密文构建索引。如果 TDE 加密列建立了索引并为 SQL 语句所引用，Oracle 将用表密钥对 SQL 语句中用到的值进行透明加密并使用密文进行索引查询；如果所有索引都按照在应用 TDE 列加密之前最初设计的方式重新构建，客户报告的性能影响可以忽略不计。建议打算使用 TDE 列加密的客户升级到 Oracle Database 10gR2 10.2.0.4/5（并应用<a href="http://updates.oracle.com/download/7639262.html" rel="nofollow" title="补丁 7639262">补丁 7639262</a>）或 Oracle Database 11gR1 11.1.0.7（并应用<a href="http://updates.oracle.com/download/8421211.html" rel="nofollow" title="补丁 8421211">补丁 8421211</a>），因为这两个版本包含可减少性能开销的更改。两个相应的补丁已集成到 Oracle Database 11g 第 2 版中。</span></td></tr></tbody></table></li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>哪些加密算法可与 TDE 一同使用？</strong></span></h5> <p style="margin-left:0;">TDE 支持 AES256、AES192（列加密默认算法）、AES128（表空间加密默认算法）和 3DES168。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可以使用第三方加密算法代替 TDE 提供的算法吗？</strong></span></h5> <p style="margin-left:0;">不可以，不能插入其他加密算法。Oracle 提供人们广泛接受的加密算法，并且将会引入新的可用标准算法。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可以对外键约束中使用的列采用<strong> TDE 列加密</strong>吗？</strong></span></h5> <p style="margin-left:0;">TDE 不支持对外键约束中使用的列进行加密。这是因为各个表有自己独有的加密密钥。以下查询可以列出数据库中存在的所有 RI（引用完整性）约束：</p> <pre><code class="language-sql">  SQL&gt; select A.owner, A.table_name, A.column_name, A.constraint_name 
       from dba_cons_columns A, dba_constraints B 
       where A.table_name = B.table_name and B.constraint_type = 'R';</code></pre> <p></p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可以对联接中使用的列进行 <strong>TDE 列加密</strong>吗？</strong></span></h5> <p style="margin-left:0;">可以。即使联接条件的列已加密，联接表对于应用和用户也是透明的。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可以对已建索引的列进行加密吗？</strong></span></h5> <p style="margin-left:0;"><strong>TDE 表空间加密</strong>透明地支持所有索引。</p> <p style="margin-left:0;">而对于 <strong>TDE 列加密</strong>，索引必须是用于等式搜索的普通 B 树索引。如果是基于函数的复合索引，则不能对相应函数使用的列进行加密。当对已有索引的列进行加密时，建议首先利用 dbms_metadata.get_ddl 获取索引定义，然后丢弃该索引，使用“no salt”选项对该列进行加密，最后重建索引。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>TDE 列加密支持哪些数据类型和数据长度？</strong></span></h5> <p style="margin-left:0;"><strong>TDE 表空间加密</strong>对于支持的数据类型没有限制；以下数据类型可使用 <strong>TDE 列加密</strong>进行加密：</p> <pre><code class="language-sql">varchar2 (&lt; 3933 characters)		nvarchar2 (&lt; 1967 characters)
char (&lt; 1933 characters)		    nchar (&lt; 967 characters)
number					            raw
binary_float				        binary_double
timestamp				            date
SecureFile (11gR1 and later)</code></pre> <p></p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>数据在网络上传输时仍处于加密状态吗？</strong></span></h5> <p style="margin-left:0;"><span style="color:#fe2c24;">使用 TDE 加密后的数据在从数据库文件中读回时会被解密</span>。因此，如果在网络上传输该数据，它将处于明文状态。不过，客户可以使用 Oracle 的网络加密解决方案（<a href="http://apex.oracle.com/pls/apex/f?p=44785:24:3597841083341353::NO:24:P24_CONTENT_ID,P24_PREV_PAGE:4267,2" rel="nofollow" title="示例">示例</a>）对这些数据进行加密，该方案和 TDE 一同包含在 Oracle Advanced Security 选件中。Oracle 的网络加密解决方案可以对通过 SQL*Net 与数据库往来传输的所有数据进行加密。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>数据库内存 (SGA) 中包含的是明文数据还是加密数据？</strong></span></h5> <p style="margin-left:0;">对于 <strong>TDE 列加密</strong>，加密数据在 SGA 中仍保持加密状态，但是对于 <strong>TDE 表空间加密</strong>，数据在 SGA 中已被解密，从而提供 100% 的透明性。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>对于 Oracle Database 11g，何时使用 TDE 列加密或 TDE 表空间加密？</strong></span></h5> <p style="margin-left:0;">如果下列任何一项是正确的，请使用 <strong>TDE 表空间加密</strong>：</p> 
  <ol style="margin-left:0;"><li>您希望加密解决方案具有极佳的性能。TDE 表空间加密在大多数情况下具有更好、更稳定的性能特点。此外，表空间加密还在允许的情况下特别利用了硬件密码加速，从而进一步将性能影响减少至近乎为零。对于支持 AES-NI 的 Intel? XEON? 5600 CPU，Oracle Database 11g 第 2 版补丁集 1 (11.2.0.2) 提供硬件密码加速支持。</li><li>您无法一一找出包含敏感内容的所有列。</li><li>TDE 列加密不支持敏感列的数据类型和/或数据长度。</li><li>敏感列用作外键。</li><li>应用对已建索引的加密列执行范围扫描。</li><li>对于加密列，您需要不同于 B 树类型的索引。</li></ol></li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>TDE 与 Oracle 早前提供的加密工具包有何不同？</strong></span></h5> <p style="margin-left:0;">Oracle 在 Oracle8i 中引入了加密包“dbms_obfuscation_toolkit”，后来在 Oracle 10g 第 1 版中引入了“dbms_crypto”加密包。这些 API 可用于对数据库中数据手动加密，但应用必须对加密密钥进行管理并通过调用 API 执行所需加解密操作。</p> <p style="margin-left:0;">与 dbms_obfuscation_toolkit 和 dbms_crypto 加密包不同的是，TDE 列加密（从 10gR2 起引入）和 TDE 表空间加密（从 11gR1 起引入）无需更改应用，对于最终用户来说是透明的，并且提供内置的自动化密钥管理。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>如何获得 TDE 许可？</strong></span></h5> <p style="margin-left:0;">TDE 是 Oracle Advanced Security 选件的一部分，该选件还包含网络加密和强身份验证。<span style="color:#fe2c24;">Oracle 企业版</span>客户可以使用该选件。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>什么是 Oracle 钱夹？</strong></span></h5> <p style="margin-left:0;">钱夹是一个加密的容器，用于存储身份验证和签名凭证，包括 SSL 所需的密码、TDE 主密钥、PKI 私钥、证书和可信证书。借助 TDE，可以在服务器上使用钱夹保护 TDE 主密钥。除非使用 Diffie-Hellman，否则 Oracle 要求在 SSL 上通信的实体包含一个钱夹，该钱夹应当含有 X.509 版本 3 证书、私钥、可信证书列表。</p> <p style="margin-left:0;">Oracle 提供两种类型的钱夹：加密钱夹和（本地）自动打开的钱夹。我们建议对 TDE 使用加密钱夹（文件名为 ewallet.p12）。数据库启动后和访问 TDE 加密数据前，需手动打开该钱夹。由于数据在 REDO 日志、UNDO 和 TEMP 表空间中处于加密状态，因此在打开数据库前需要为其提供 TDE 主加密密钥：</p> <pre><code class="language-sql">  $ sqlplus / as sysoper
  PUBLIC&gt; startup mount;
  ORACLE instance started.
  Database mounted.
  PUBLIC&gt; alter system set encryption wallet open identified by "wallet_password";
  System altered.
  PUBLIC&gt; alter database open;
  Database altered.</code></pre> 如果未打开该钱夹，查询受 TDE 保护的数据时数据库将返回错误。（本地）自动打开的钱夹（文件名是 cwallet.sso）在访问加密数据时会自动打开，因此它适用于无人值守的 Data Guard 环境（Oracle 10gR2：仅物理备用数据库；Oracle 11g：物理和逻辑备用数据库），在这类环境中加密后的数据会传送到辅助站点。在创建自动打开的钱夹后，<strong>永远</strong>不要删除加密钱夹，否则，主加密密钥更新操作将会失败。<br><strong>本地</strong>自动打开的钱夹是在 Oracle Database 11g 第 2 版中引入的，该钱夹只能在创建它的服务器上自动打开。</li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>如何保护 TDE 钱夹？</strong></span></h5> <p style="margin-left:0;">在 Unix 上，应当使用适当的目录 (700) 和文件权限 (600) 只允许“oracle:oinstall”用户:组访问该钱夹。不过，即使 root 用户有权访问钱夹文件，但如果该用户不知道钱夹密码，仍然无法访问主加密密钥。在所有平台上，钱夹密码（用于加密该钱夹的密码）应至少包含 8 个字母和数字字符。钱夹密码可通过 Oracle Wallet Manager 或 orapki 实用程序来更改。强烈建议在更改钱夹密码<strong>之前</strong>对 Oracle 钱夹进行备份。更改钱夹密码不会更改 TDE 主密钥（它们彼此独立）。<br> 在 Linux 平台上，从 Oracle Database 11g 第 2 版 (11.2.0.2) 起，我们建议将 Oracle 钱夹存储在 ACFS（基于 ASM 的集群文件系统，适用于单实例、单节点 RAC、多节点 RAC，但不适用于 Exadata X2）中，因为该文件系统新的安全特性提供出色的钱夹保护和职责分离。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可否使用 Oracle Wallet Manager (OWM) 为 TDE 创建加密钱夹和主密钥？</strong></span></h5> <p style="margin-left:0;">不能。如果您使用 Oracle Wallet Manager 创建钱夹，该钱夹不包含 TDE 所需的主密钥。只有以下 SQL 命令：</p> <pre><code class="language-sql"> SQL&gt; alter system set encryption key identified by "wallet_password";</code></pre> <p style="margin-left:0;">能够创建加密钱夹（若其在 sqlnet.ora 文件中指定的位置不存在）并为其添加 TDE 主密钥。</p> <p style="margin-left:0;">在 Oracle 11gR1 中，TDE 及其他安全特性已迁移到 Enterprise Manager Database Control 中，因此可以使用 Enterprise Manager 基于 Web 的 GUI 来生成钱夹和主密钥。</p> <p style="margin-left:0;">Oracle 11g 第 2 版中引入了新的<strong>统一</strong>主加密密钥，该密钥可同时用于 TDE 列加密和表空间加密；您可以在 Oracle 钱夹中创建、存储和更新（轮换）此密钥。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可以更改钱夹密码吗？</strong></span></h5> <p style="margin-left:0;">可以，您可以通过 Oracle Wallet Manager (OWM) 更改钱夹密码。在尝试更改钱夹密码前，请创建备份。更改钱夹密码不会更改主密钥（它们彼此独立）。在 Oracle 11gR1 11.1.0.7 中，orapki 已得到增强，允许通过命令行更改钱夹密码：</p> <pre><code class="language-bash"> $ orapki wallet change_pwd -wallet &lt;wallet_location&gt;</code></pre> <p></p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>如何创建（本地）自动打开的钱夹？</strong></span></h5> <p style="margin-left:0;">当需要在无人干预的情况下保持数据库可用性时（无人值守的运营），对 TDE 主密钥使用密码保护的加密钱夹可能并非合适的解决方案；而（本地）自动打开的钱夹在数据库启动后无需钱夹密码，让授权用户和应用可以访问加密数据。</p> <p style="margin-left:0;">（本地）自动打开的钱夹 (cwallet.sso) 需要用现有的加密钱夹 (ewallet.p12) 创建，以便将主密钥传给新建的自动打开钱夹。</p> <p style="margin-left:0;">您可以在 Oracle Wallet Manager (OWM) 中打开加密钱夹，选中 Auto Login 复选框，然后选择 Save 将自动打开的钱夹写入磁盘，也可以使用命令行工具 orapki：</p> <pre><code class="language-bash"> $ orapki wallet create -wallet &lt;wallet_location&gt; -auto_login</code></pre> <p style="margin-left:0;">创建本地自动打开钱夹的命令语法如下所示：</p> <pre><code class="language-bash"> $ orapki wallet create -wallet &lt;wallet_location&gt; -auto_login_local</code></pre> <p style="margin-left:0;">两种情况（Oracle Wallet Manager 和 orapki）都要求提供钱夹密码。<strong>请保留加密钱夹</strong>，因为主密钥更新操作需要使用该钱夹，并且该钱夹可能包含弃用主密钥列表。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>使用 Oracle Secure Backup 时，如何避免将 Oracle TDE 钱夹备份到 RMAN 数据库备份所在的磁带上？</strong></span></h5> <p style="margin-left:0;"><span style="color:#fe2c24;">RMAN 只会将数据库文件、重做日志等添加到备份文件中，因此加密钱夹或自动打开的钱夹不会成为数据库备份的一部分</span>。Oracle Secure Backup (OSB) 使用数据集定义待备份的操作系统文件。OSB 自动排除自动打开的钱夹 (cwallet.sso)，但不会自动排除加密钱夹 (ewallet.p12)，您需要使用排除数据集语句来指定备份过程中需要跳过的文件：</p> <pre style="margin-left:0;">  exclude name *.p12</pre> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>钱夹备份</strong></span></h5> <p style="margin-left:0;">请在发生以下情况时立即备份 Oracle 钱夹：创建钱夹后、每次钱夹内容发生更改时（例如由于主密钥更新操作），以及每次更改钱夹密码后。始终将钱夹（加密钱夹或本地自动打开的钱夹）存储到远离数据库备份的位置。<a name="A15035"></a></p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可否对 Exadata 中存储的数据进行加密？</strong></span></h5> <p style="margin-left:0;">可以。透明数据加密是在大规模 Exadata 环境中保护敏感数据的一种好办法。Exadata 让大幅提高加密性能成为可能。Exadata 提供的超强加密性能归功于以下独到之处：</p> 
  <ol style="margin-left:0;"><li>Exadata 系统中优化的 Oracle 硬件和软件</li><li>各个存储和计算节点间的分布式加密处理</li><li>智能扫描和混合列压缩 (EHCC) 等 Exadata 原生特性</li><li>提供硬件密码加速</li></ol><p style="margin-left:0;">例如，光是 Exadata 中的硬件密码加速就可将性能提高多达 10 倍（相对于没有硬件加速的情况）</p> <p style="margin-left:0;">下表总结了 Exadata X2 系统计算和存储节点上的性能特点。该表重点介绍了可以启用硬件密码加速的情况。</p> 
  <table><caption>
     增速比较根据使用和不使用硬件加速情况下测量的加密/解密吞吐量得出 
   </caption><tbody><tr><th>Exadata 型号</th><th colspan="2">X2-2</th><th colspan="2">X2-8</th></tr><tr><th>节点</th><th>加密</th><th>解密</th><th>加密</th><th>解密</th></tr><tr><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">计算</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">在 Intel Xeon X5670（含补丁 <a href="https://updates.oracle.com/download/10080579.html" rel="nofollow" title="10080579">10080579</a>）中启用硬件加速</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">在 Intel Xeon X5670 中默认启用硬件加速</span></td><td colspan="2" style="text-align:left;vertical-align:top;"><span style="color:#000000;">在 Intel? X7560 中通过 Nehalem 技术实现硬件加速</span></td></tr><tr><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">存储</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">不适用</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">在 Intel Xeon L5640 中默认启用硬件加速</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">不适用</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">在 Intel Xeon L5640 中默认启用硬件加速</span></td></tr></tbody></table><p style="margin-left:0;"><u>注：</u>在 Oracle Exadata V2 和 X2 中，表密钥（用于TDE 列加密）或表空间密钥（用于 TDE 表空间加密）被发送到存储单元，以便首先解密内容，然后应用智能扫描。内容加密在计算节点中进行。解密通常在计算节点中进行，但是当查询被推送到存储节点时，解密会在存储节点中进行，以便启用智能扫描。</p> 
  <hr><a name="A14024"></a></li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>什么是 Oracle Secure Backup (OSB)？</strong></span></h5> <p style="margin-left:0;"><a href="https://www.oracle.com/technetwork/cn/database/database-technologies/secure-backup/overview/index.html?ssSourceSiteId=otnen" rel="nofollow" title="Oracle Secure Backup">Oracle Secure Backup</a> 为 Oracle 数据库提供了一种优化、高效的磁带备份解决方案。OSB 能够以加密的格式在磁带上存储数据，从而防范备份磁带被盗窃。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>Oracle RMAN 如何处理加密数据？</strong></span></h5> <p style="margin-left:0;"></p> 
  <table><caption>
     表 B：Oracle 透明数据加密和 Oracle RMAN 
   </caption><tbody><tr><th><span style="color:#0d0016;">应用数据</span></th><th><span style="color:#0d0016;">RMAN 压缩备份</span></th><th><span style="color:#0d0016;">RMAN 加密备份</span></th><th><span style="color:#0d0016;">RMAN 压缩和加密备份</span></th></tr><tr><th>未加密</th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">压缩数据</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">加密数据</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">数据先压缩再加密</span></td></tr><tr><th>使用 TDE 列进行加密</th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">压缩数据；将加密列视为未加密</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">加密数据；对加密列双重加密</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">数据先压缩再加密；将加密数据视为未加密；对加密列双重加密</span></td></tr><tr><th>使用 TDE 表空间加密进行加密</th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">对加密的表空间进行解密、压缩和重新加密</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">加密的表空间原样传送给备份</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">对加密的表空间进行解密、压缩和重新加密</span></td></tr></tbody></table><p style="margin-left:0;"></p> <p style="margin-left:0;">当存在本地 TDE 主加密密钥时“透明”加密[和压缩]的示例：</p> <pre style="margin-left:0;">   RMAN&gt; connect target &lt;ORACLE_SID&gt;/&lt;SYS pwd&gt;
   RMAN&gt; set encryption on;
   RMAN&gt; backup [as compressed backupset] database;</pre> <p style="margin-left:0;">无论使用 TDE 主加密密钥还是密码短语对文件进行加密，对发送到磁盘的 RMAN 备份进行加密都需要 Advanced Security 选件的许可。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可否使用 Oracle Secure Backup 对发送至磁盘的备份进行加密？</strong></span></h5> <p style="margin-left:0;">不能。不过，Oracle RMAN 可与 Oracle Advanced Security 一起使用，对发送至磁盘的数据库备份进行加密。这需要 Oracle Advanced Security 选件的许可。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可传输表空间可否与 TDE 表空间加密协同工作？</strong></span></h5> <p style="margin-left:0;">可以，不过这需要将包含主密钥的钱夹复制到辅助数据库。如果移动表空间但不提供主密钥，在访问表空间数据时，辅助数据库将返回错误。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>压缩可否与 TDE 协同工作？</strong></span></h5> <p style="margin-left:0;">可以。数据块在压缩后进行加密，因此使用 <strong>TDE 表空间加密</strong>的客户可获得压缩（标准压缩、高级压缩以及 Exadata 混合列压缩 (EHCC)）的全部好处。使用 <strong>TDE 列加密</strong>的客户只能在不加密的表列上获得压缩的全部好处。使用 TDE 列加密的各个表列只能获得很低的压缩水平，因为它们是在 SQL 层进行加密之后再进行高级压缩处理。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>TDE 可否与 Data Guard、Streams 和 Oracle Golden Gate 协同工作？</strong></span></h5> <p style="margin-left:0;">可以。当 TDE 用于 Data Guard <strong>物理备用数据库（10gR2 及更高版本）</strong>时，在向辅助数据库传输数据的过程中加密数据在日志文件中仍保持加密状态，此时可以选择使用 ASO 网络加密在传输过程中对磁盘上未加密的数据进行加密。请参阅 Metalink 说明 <a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=749947.1" rel="nofollow" title="749947.1">749947.1</a> 了解如何配置 ASO 自带的网络加密，并参阅 Metalink 说明 <a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1143443.1" rel="nofollow" title="1143443.1">1143443.1</a> 了解如何配置基于 SSL 的加密。对此，必须将包含主密钥的钱夹复制到全部物理备用数据库站点并打开该钱夹，不管是仅应用重做日志、以只读方式打开、在 Active Data Guard 中打开（只读和应用重做日志），还是进行角色转换（切换或故障切换）都是如此。</p> <p style="margin-left:0;">当 TDE 用于 Data Guard <strong>逻辑备用数据库 (11gR1)</strong> 时，必须将包含主密钥的钱夹复制到辅助站点并打开该钱夹，以便 SQL Apply 可以对从日志文件中读取的数据进行解密。在将传入数据写入逻辑备用数据库时，可以使用同样的主加密密钥对数据进行加密。加密数据在日志文件中保持加密状态，并且在日志文件被传送到辅助数据库的传输过程中仍保持加密状态；Oracle 网络加密是可选的。请参阅 Metalink 说明 <a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=749947.1" rel="nofollow" title="749947.1">749947.1</a> 了解如何配置 ASO 自带的网络加密，并参阅 Metalink 说明 <a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1143443.1" rel="nofollow" title="1143443.1">1143443.1</a> 了解如何配置基于 SSL 的加密。</p> <p style="margin-left:0;">当 TDE 与 11gR1 中的 Streams 一起使用时，在活动数据库之间以明文传输数据，以允许数据转换（字符集、数据库版本、平台等）。当无法到达接收端且需要临时存储数据时，加密列以加密形式存储在磁盘上。在 11gR1 之前的数据库版本中，Streams 将加密列视为“不受支持的数据类型”，因此跳过这些表。</p> <p style="margin-left:0;"></p> 
  <table><tbody><tr><th><span style="color:#0d0016;">Oracle Golden Gate 版本</span></th><th><span style="color:#0d0016;">TDE 列加密</span></th><th><span style="color:#0d0016;">TDE 表空间加密</span></th></tr><tr><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">11.1.1.1 之前的版本</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">对所有 Oracle 数据库版本提供部分支持，支持两者同用的前提是相应表具有主键或唯一索引，并且加密列为：</span> 
      <ul style="margin-left:0;"><li><span style="color:#000000;">CHAR 或 VARCHAR2 数据类型</span></li><li><span style="color:#000000;">不是表的主键</span></li></ul></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">不支持</span></td></tr><tr><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">11.1.1.1</span></td><td colspan="2" style="text-align:left;vertical-align:top;"><span style="color:#000000;">Oracle Database 10.2.0.5 和 11.2.0.2 中内置的 Golden Gate 11.1.1.1 支持 TDE 加密；在 11.1.0.7 中则需要补丁 <a href="https://updates.oracle.com/download/9409423.html" rel="nofollow" title="9409423">9409423</a>。</span></td></tr></tbody></table><p style="margin-left:0;"></p> <p style="margin-left:0;">可以使用 blowfish 或 SSH 端口转发来加密流量。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>是否有数据库特性不能与 TDE 列加密协同工作？</strong></span></h5> <p style="margin-left:0;"><strong>TDE 表空间加密</strong>对表空间中存储的所有内容进行加密，不会与任何其他数据库特性冲突。<strong>TDE 列加密</strong>是在数据经过 SQL 层时对数据进行透明的加密和解密。Oracle 的某些特性会绕过 SQL 层，因此不能利用 <strong>TDE 列加密</strong>，比如以下特性：</p> 
  <ul style="margin-left:0;"><li>物化视图日志（Oracle 11g 第 2 版本支持该特性）</li><li>数据仓库的同步和异步更改数据捕获 (CDC)</li><li>可传输表空间</li><li>LOB（从 11gR1 起<strong>支持</strong> SecureFiles）</li><li>Streams（从 11gR1 起支持该特性）</li></ul></li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>可否使用带有直接路径的 SQL*Loader 将数据加载到包含加密列的表中？</strong></span></h5> <p style="margin-left:0;">可以。如果目标表包含加密列，数据将在加载时进行加密。<a href="http://download.oracle.com/docs/cd/B28359_01/server.111/b28319/ldr_concepts.htm#sthref758" rel="nofollow" title="以下简单示例说明了如何使用带有直接路径的 SQL*Loader">以下简单示例说明了如何使用带有直接路径的 SQL*Loader</a>。只需将 ulcase6.sql 中的一行从</p> <pre style="margin-left:0;">  sal number(7,2),</pre> <p style="margin-left:0;">更改为</p> <pre style="margin-left:0;">  sal number(7,2) encrypt,</pre> <p style="margin-left:0;">并使用 SQL*Loader 的正确语法：</p> <pre style="margin-left:0;">  $ sqlldr USERID=scott/tiger CONTROL=ulcase6.ctl LOG=ulcase6.log <strong>DIRECT=TRUE</strong></pre> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>使用 <strong>TDE 列加密</strong>对敏感信息进行加密后，为什么有时仍能看到明文数据？</strong></span></h5> <p style="margin-left:0;">这种情况与即使已删除表或文件、但仍然会在磁盘上看到数据的情况相同。在一个表的生命周期内，数据可能会在表空间内分段、重新整理、排序、复制和移动，这会在数据库文件中留下数据的“幽灵副本”。加密现有列时，仅对新的“有效”副本加密，而在“幽灵副本”中留下较旧的明文版本。如果绕过数据库的访问控制而直接访问包含表空间的数据文件（例如，使用十六进制编辑器），那么在这些块被数据库覆盖之前，有时就会看到旧的明文值。为了尽可能降低此等风险，请遵循下面的建议：</p> 
  <ol style="margin-left:0;"><li>在新的数据文件中创建一个新的表空间 (CREATE TABLESPACE ... )</li><li>对原始表空间和数据文件中的明文值进行加密 (ALTER TABLE ...ENCRYPT )</li><li>对包含加密列的所有表执行第 2 步</li><li>将原始表空间中的所有表移到新的数据文件中 (ALTER TABLE ....MOVE... )</li><li>删除原始表空间 (DROP TABLESPACE )，不要使用 “and datafiles” 参数，Oracle 推荐对操作系统级操作使用更有力的方法，参见第 6 步</li><li>针对您的平台使用 “shred” 或其他 OS 命令，以便在 OS 级别上删除旧数据文件</li></ol><p style="margin-left:0;">建议您使用第 6 步操作来降低数据库文件出现幽灵副本的概率，不论这些副本是由操作系统生成还是由存储固件生成。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>如何更改（轮换、更新）加密密钥？</strong></span></h5> <p style="margin-left:0;"></p> 
  <table><caption>
     表 C：密钥更新功能（Oracle 钱夹） 
   </caption><tbody><tr><th rowspan="2"><span style="color:#0d0016;">数据库版本</span></th><th colspan="2"><span style="color:#0d0016;">TDE 列加密</span></th><th colspan="2"><span style="color:#0d0016;">TDE 表空间加密</span></th></tr><tr><th><span style="color:#0d0016;">主加密密钥</span></th><th><span style="color:#0d0016;">各个表密钥</span></th><th><span style="color:#0d0016;">主加密密钥</span></th><th><span style="color:#0d0016;">各个表空间密钥</span></th></tr><tr><th>10gR2</th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">不适用</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">不适用</span></td></tr><tr><th>11gR1</th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">否(*)</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">否(*)</span></td></tr><tr><th>11gR2</th><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">是</span></td><td style="text-align:left;vertical-align:top;"><span style="color:#000000;">否(*)</span></td></tr></tbody></table><p style="margin-left:0;"></p> <p style="margin-left:0;">(*)：可以将内容从一个加密表空间移到一个新的加密表空间，在新的表空间中使用新的表空间密钥进行加密。</p> <p style="margin-left:0;">TDE 采用两层密钥机制。在对某个现有应用表列进行 TDE 列加密时，系统会创建一个新的表密钥并将该密钥存储在 Oracle 数据字典中。在使用 TDE 表空间加密时，系统会将各个表空间密钥存储在底层 OS 文件头部。表密钥和表空间密钥使用 TDE 主加密密钥进行加密。主加密密钥在 TDE 初始化时生成并且存储在数据库之外的 Oracle 钱夹中。主密钥和表密钥都可以依据公司安全策略单独进行更改（轮换、更新）。表空间密钥不能更新（轮换），对此的变通方法是将数据移动到新的加密表空间。Oracle 建议在每次主密钥更改前后对钱夹进行备份。</p> <p style="margin-left:0;">更改钱夹密码不会更新 TDE 主加密密钥。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>如何快速加密超大型表（包含数十亿行）中的列？</strong></span></h5> <p style="margin-left:0;">对现有表中的列进行加密是一种“更新”操作，允许对该表进行读取访问，而不允许进行其他 DML 操作。由于有数十亿行，这一可用性有限的窗口会持续很长时间。不过 Oracle 数据库提供了一个成熟的高可用性特性 — <a href="http://download.oracle.com/docs/cd/E11882_01/server.112/e10804/planned.htm#i1007178" rel="nofollow" title="联机表重定义">联机表重定义</a>，利用该特性，仅需要一个持续时间非常短的窗口对表进行独占式锁定。该时间长度与表的大小及重定义的复杂性无关，并且对用户和应用是完全透明的，不会导致任何数据损失。</p> </li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>如何将明文应用表空间的内容迁移到加密表空间中？</strong></span></h5> 
  <ul style="margin-left:0;"><li>使用“dbms_metadata.get_ddl”提取用于创建原始应用表空间的 DDL 并将输出另存为一个 SQL 脚本。</li><li>在每个“create tablespace”语句中添加“ENCRYPTION DEFAULT STORAGE(ENCRYPT)”（无需更改 SIZE 参数，因为 TDE 表空间加密不会增加存储需求）</li><li>用 Data Pump (expdp) 导出整个数据库，或拥有应用表空间的模式</li><li>用“with contents and datafiles”删除应用表空间。</li><li>运行 SQL 脚本创建加密应用表空间，其他特性保持不变。</li><li>用 Data Pump (impdp) 导入转储文件。</li></ul></li><li> <h5 style="margin-left:0;"><span style="color:#fe2c24;"><strong>TDE 可否将其主加密密钥存储到使用 PKSC11 接口的外部设备中？</strong></span></h5> <p style="margin-left:0;">从 Oracle Database 11g 第 2 版起，Oracle Advanced Security 透明数据加密 (TDE) 客户可以选择将 TDE 主加密密钥存储到使用 PKCS11 接口的外部设备中。在此配置下，主密钥直接存储在第三方设备中，而非所含 Oracle 钱夹中（注意：Oracle 钱夹是大多数 TDE 客户使用的基于 PKCS12 文件的密钥库）。<br><br> 使用 PKCS11 时，由第三方供应商提供存储设备、PKCS11 软件客户端库、设备与 PKCS11 客户端（在数据库服务器上运行）之间的安全通信、身份验证、审计及其他相关功能。并且由供应商负责测试和确保 TDE 主加密密钥在各种数据库服务器环境和配置下的高可用性。客户应与设备供应商联系，获得帮助以解决任何相关问题。</p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/933b472728bbfff0735a7ae4cbd9672b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AIGC系列之：DDPM原理解读（简单易懂版）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/441ed86ab13f6e94985b9bf1ce062450/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">不让IE浏览器打开后跳转到edge【2023.11.27新】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>