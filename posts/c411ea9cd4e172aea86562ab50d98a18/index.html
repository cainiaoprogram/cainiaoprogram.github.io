<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>图书管理数据库 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="图书管理数据库" />
<meta property="og:description" content="目 录
1、开发背景... 4
2、功能描述... 4
3、业务流程分析... 4
4、数据流程分析... 4
4.1、数据流程图... 4
4.2、数据字典... 5
5、概念模型设计... 7
6. 逻辑模型设计和优化... 7
7. 物理设计和实施... 8
8、应用程序设计（前台）... 10
9、课程设计心得体会... 10
参考文献... 10
一 概述
1.1目的与要求
功能要求：
l 实现图书信息、类别、出版社等信息的管理；
l 实现读者信息、借阅证信息的管理；
l 实现图书的借阅、续借、归还管理；
l 实现超期罚款管理、收款管理；
l 创建触发器，分别实现借书和还书时自动更新图书信息的在册数量；
l 创建视图查询各种图书的书号、书名、总数和在册数；
l 创建存储过程查询指定读者借阅图书的情况；
l 建立数据库相关表之间的参照完整性约束。
90年代中期，由于Internet的迅速普及，使Intranet成为Internet技术在企业管理信息系统中的应用和延伸，形成了集计算机，计算机网络、数据库、分布式计算等于一体的信息技术综合体，它打破了时间和地域的界限，使信息交流变得快捷、准确，为建立现代企业管理信息系统提供了充足的条件。企业信息管理系统在此基础上延伸、扩展，使之上下、内外全面贯通。引入Internet后，形成了新型的浏览器/服务器（Browser/Server）结构,而传统的客户机/服务器（Client/Server）结构在这方面就远不及B/S结构。图书馆管理信息系统是在适应市场需求的客观前提下，为了满足中小型公司或事业单位管理自己的公共图书馆而开发的。该系统的是终目的是要将自己的图书馆放到网络上，以方便员工查阅。
1.2设计环境 ① Microsoft SQL Server2000
② MicrosoftVisual C&#43;&#43; 6.0
二 需求分析
2.1 系统功能要求设计
2、功能描述 （描述该系统所需要完成的功能）
经过调研及分析，图书馆管理信息系统主要完成以下功能：
（1）图书信息维护：主要完成图书馆新进图书的编号、登记、入馆等操作。
（2）读者信息维护：主要是完成读者信息的添加、修改和删除等操作，只有是系统中的合法读者才有资格进行图书的借阅活动。
（3）借书/还书处理：主要完成读者的借书和还书活动，记录读者借还书情况并及时反映图书的在库情况。
（4）读者借阅记录：让每位读者能及时了解自己的借书情况，包括曾经借阅记录以及未还书记录。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c411ea9cd4e172aea86562ab50d98a18/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-12-27T11:17:06+08:00" />
<meta property="article:modified_time" content="2014-12-27T11:17:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">图书管理数据库</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <p align="center"><strong>目  录</strong></p> 
 <p><a target="_blank" rel="nofollow">1、开发背景<span style="color:windowtext">... </span><span style="color:windowtext">4</span></a></p> 
 <p><a target="_blank" rel="nofollow">2、功能描述<span style="color:windowtext">... </span><span style="color:windowtext">4</span></a></p> 
 <p><a target="_blank" rel="nofollow">3、业务流程分析<span style="color:windowtext">... </span><span style="color:windowtext">4</span></a></p> 
 <p><a target="_blank" rel="nofollow">4、数据流程分析<span style="color:windowtext">... </span><span style="color:windowtext">4</span></a></p> 
 <p><a target="_blank" rel="nofollow">4.1、数据流程图<span style="color:black">... </span><span style="color:black">4</span></a></p> 
 <p><a target="_blank" rel="nofollow">4.2、数据字典<span style="color:black">... </span><span style="color:black">5</span></a></p> 
 <p><a target="_blank" rel="nofollow">5、概念模型设计<span style="color:windowtext">... </span><span style="color:windowtext">7</span></a></p> 
 <p><a target="_blank" rel="nofollow">6. 逻辑模型设计和优化<span style="color:windowtext">... </span><span style="color:windowtext">7</span></a></p> 
 <p><a target="_blank" rel="nofollow">7. 物理设计和实施<span style="color:windowtext">... </span><span style="color:windowtext">8</span></a></p> 
 <p><a target="_blank" rel="nofollow">8、应用程序设计（前台）<span style="color:windowtext">... </span><span style="color:windowtext">10</span></a></p> 
 <p><a target="_blank" rel="nofollow">9、课程设计心得体会<span style="color:windowtext">... </span><span style="color:windowtext">10</span></a></p> 
 <p><a target="_blank" rel="nofollow">参考文献<span style="color:windowtext">... </span><span style="color:windowtext">10</span></a></p> 
 <p><strong> </strong></p> 
 <p><strong> </strong></p> 
 <p><strong>一 概述</strong></p> 
 <p>1.1目的与要求</p> 
 <p align="left">功能要求：</p> 
 <p align="left">l  实现图书信息、类别、出版社等信息的管理；</p> 
 <p align="left">l  实现读者信息、借阅证信息的管理；</p> 
 <p align="left">l  实现图书的借阅、续借、归还管理；</p> 
 <p align="left">l  实现超期罚款管理、收款管理；</p> 
 <p align="left">l  创建触发器，分别实现借书和还书时自动更新图书信息的在册数量；</p> 
 <p align="left">l  创建视图查询各种图书的书号、书名、总数和在册数；</p> 
 <p align="left">l  创建存储过程查询指定读者借阅图书的情况；</p> 
 <p align="left">l  建立数据库相关表之间的参照完整性约束。</p> 
 <p> </p> 
 <p>90年代中期，由于Internet的迅速普及，使Intranet成为Internet技术在企业管理信息系统中的应用和延伸，形成了集计算机，计算机网络、数据库、分布式计算等于一体的信息技术综合体，它打破了时间和地域的界限，使信息交流变得快捷、准确，为建立现代企业管理信息系统提供了充足的条件。企业信息管理系统在此基础上延伸、扩展，使之上下、内外全面贯通。引入Internet后，形成了新型的浏览器/服务器（Browser/Server）结构,而传统的客户机/服务器（Client/Server）结构在这方面就远不及B/S结构。图书馆管理信息系统是在适应市场需求的客观前提下，为了满足中小型公司或事业单位管理自己的公共图书馆而开发的。该系统的是终目的是要将自己的图书馆放到网络上，以方便员工查阅。</p> 
 <p>1.2设计环境 </p> 
 <p><a target="_blank" name="_Toc208033759" class=" "></a><a target="_blank" name="_Toc208033101" class=" ">①  Microsoft SQL Server2000</a></p> 
 <p>②    MicrosoftVisual C++ 6.0</p> 
 <p><a target="_blank" name="_Toc208033760" class=" "><strong>二</strong></a><strong> 需求分析</strong></p> 
 <p>2.1 系统功能要求设计</p> 
 <h2><a target="_blank" name="_Toc177016457" class=" "></a><a target="_blank" name="_Toc135635380" class=" "></a><a target="_blank" name="_Toc135124862" class=" "></a><a target="_blank" name="_Toc135116758" class=" "></a><a target="_blank" name="_Toc135116371" class=" "></a><a target="_blank" name="_Toc135111827" class=" "></a><a target="_blank" name="_Toc135110474" class=" "></a><a target="_blank" name="_Toc135109840" class=" "></a><a target="_blank" name="_Toc134959932" class=" ">2</a>、功能描述</h2> 
 <p><span style="color:red">（描述该系统所需要完成的功能）</span></p> 
 <p>经过调研及分析，图书馆管理信息系统主要完成以下功能：</p> 
 <p>（1）图书信息维护：主要完成图书馆新进图书的编号、登记、入馆等操作。</p> 
 <p>（2）读者信息维护：主要是完成读者信息的添加、修改和删除等操作，只有是系统中的合法读者才有资格进行图书的借阅活动。</p> 
 <p>（3）借书/还书处理：主要完成读者的借书和还书活动，记录读者借还书情况并及时反映图书的在库情况。</p> 
 <p>（4）读者借阅记录：让每位读者能及时了解自己的借书情况，包括曾经借阅记录以及未还书记录。</p> 
 <p>（5）图书书目检索：读者能够根据不同的信息（如书名、作者、关键词等）对图书馆的存书情况进行查找，以便快速的找到自己希望的图书。</p> 
 <p>（6）图书超期通知：为图书管理员提供一个统计信息，能够统计出到目前为止逾期未归还的图书及相应的读者信息。</p> 
 <p>2.2 系统模块设计</p> 
 <p>成绩管理系统大体可以分成二大模块如， 一是学生的基本信息模块，里面应该包含学生的各方面的基本信息；再者便是课程管理模块，在该模块中应该包含有对学生成绩信息的查询和处理，如平均成绩、最好成绩、最差成绩以及不及格学生的统计等功能模块；再其次还有教师、课程等相关信息的模块；可以得到系统流程图：</p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p>2.3 数据字典</p> 
 <p>     数据项是数据库的关系中不可再分的数据单位，下表分别列出了数据的名称、数据类型、长度、取值能否为空。利用SQL Server 2000建立“学生选课”数据库，其基本表清单及表结构描述如下：</p> 
 <p>数据库中用到的表：</p> 
 <table border="0" cellspacing="0" cellpadding="0" class=" "><tbody><tr><td> <p>数据库表名</p> </td><td> <p>关系模式名称</p> </td><td> <p>备注</p> </td></tr><tr><td> <p>Student</p> </td><td> <p>学生</p> </td><td> <p>学生学籍信息表</p> </td></tr><tr><td> <p>Course</p> </td><td> <p>课程</p> </td><td> <p>课程基本信息表</p> </td></tr><tr><td> <p>Score</p> </td><td> <p>成绩</p> </td><td> <p>选课成绩信息表</p> </td></tr></tbody></table> 
 <p> </p> 
 <p>Student基本情况数据表，结构如下：</p> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>字段名</p> </td><td> <p>字段类型</p> </td><td> <p>Not Null</p> </td><td> <p>说明</p> </td></tr><tr><td> <p>Student _sno</p> </td><td> <p>Char</p> </td><td> <p>Primary key</p> </td><td> <p>学号</p> </td></tr><tr><td> <p>Student _sn</p> </td><td> <p>char</p> </td><td> <p>Not Null</p> </td><td> <p>学生姓名</p> </td></tr><tr><td> <p>Student _sex</p> </td><td> <p>char</p> </td><td> <p>‘男’或‘女’</p> </td><td> <p>性别</p> </td></tr><tr><td> <p>Student _dept</p> </td><td> <p>char</p> </td><td> <p> </p> </td><td> <p>系别</p> </td></tr><tr><td> <p>Student_age</p> </td><td> <p>char</p> </td><td> <p> </p> </td><td> <p>年龄</p> </td></tr><tr><td> <p>Student_address</p> </td><td> <p>char</p> </td><td> <p> </p> </td><td> <p>地址</p> </td></tr></tbody></table> 
 <p> </p> 
 <p>course数据表，结构如下：</p> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>字段名</p> </td><td> <p>字段类型</p> </td><td> <p>约束控制</p> </td><td> <p>说明</p> </td></tr><tr><td> <p>course_cno</p> </td><td> <p>char</p> </td><td> <p>主键（primary key）</p> </td><td> <p>课程号</p> </td></tr><tr><td> <p>course_cname</p> </td><td> <p>char</p> </td><td> <p>not null</p> </td><td> <p>课程名称</p> </td></tr><tr><td> <p>course_hour</p> </td><td> <p>int</p> </td><td> <p>not null</p> </td><td> <p>课时</p> </td></tr><tr><td> <p>course_score</p> </td><td> <p>numeric(2,1)</p> </td><td> <p>not null</p> </td><td> <p>学分</p> </td></tr></tbody></table> 
 <p> </p> 
 <p>score情况数据表，结构如下：</p> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>字段名</p> </td><td> <p>字段类型</p> </td><td> <p>约束控制</p> </td><td> <p>说明</p> </td></tr><tr><td> <p>score_id</p> </td><td> <p>int</p> </td><td> <p>not null</p> </td><td> <p>成绩记录号</p> </td></tr><tr><td> <p>course_cno</p> </td><td> <p>char</p> </td><td> <p>外部键</p> </td><td> <p>课程号</p> </td></tr><tr><td> <p>student_sno</p> </td><td> <p>char</p> </td><td> <p>外部键</p> </td><td> <p>学号</p> </td></tr><tr><td> <p>score</p> </td><td> <p>int</p> </td><td> <p> </p> </td><td> <p>成绩</p> </td></tr></tbody></table> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p>三 概念模型设计</p> 
 <p>由需求分析的结果可知，本系统设计的实体包括：</p> 
 <p>（1）学生基本信息：学号，姓名，性别，地址，年龄，专业。</p> 
 <p>（2）课程基本信息：课程名，课程号，分数，学时，学分。</p> 
 <p>这些实体间的联系包括：</p> 
 <p>（1）每位学生可以学习多门课程，每门课程可供多位学生学习。</p> 
 <p>由上述分析可得到系统的E—R图：</p> 
 <p> </p> 
 <table cellpadding="0" cellspacing="0" align="left" class=" "></table> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <br> 
 <p>四 逻辑和物理结构设计</p> 
 <p>4.1由系统E—R图转化而得到的关系模式如下：</p> 
 <p>（1）学生（学号，姓名，性别，年龄，地址，系别），其主关键字为学号;</p> 
 <p>（2）课程（课程名，课程号，学时，学分），其中主关键字为课程号；</p> 
 <p>（3）成绩（课程号，学号，分数）其中主关键字为学号和课程号。可以与学生关系模式合并为：学生（学号，姓名，性别，年龄，地址，系别，成绩，课程号）。</p> 
 <p>4.2 确定关系模型的存取方法</p> 
 <p>在将概念模型转换成物理模型之后，我们可以对物理模型进行设计，双击物理模型的关系，可以对该关系的名称、注释等信息进行查询。可对该关系的属性列进行设计，可分别设置其名称、码、数据类型以及主码、是否为空等。在实际设计中最常用的存取方法是索引发，使用索引可以大大减少数据的查询时间，在建立索引时应遵循：在经常需要搜索的列上建立索引；  在主关键字上建立索引；在经常用于连接的列上建立索引，即在外键上建立索引；在经常需要根据范围进行搜索的列上创建索引，因为索引已经排序，其指定的范围是连续的等规则。才能充分利用索引的作用避免因索引引起的负面作用。</p> 
 <p>4.3 确定数据库的存储结构</p> 
 <p>确定数据库的存储结构主要指确定数据的存放位置和存储结构，包括确定关系、索引、日志、备份等的存储安排及存储结构，以及确定系统存储参数的配置。因为该成绩管理系统的数据量小，，所以我们只用把数据存储在使用的电脑硬盘上，不用作更多的安排。</p> 
 <p>(1)创建学生基本信息表:</p> 
 <p>create table Student (</p> 
 <p>   学号                   varchar(11)            not null,</p> 
 <p>   系别                   varchar(5)        not null,</p> 
 <p>   姓名                   varchar(6)        not null,</p> 
 <p>   性别                   varchar(2)        not null,</p> 
 <p>   年龄                   char(2)          not null,</p> 
 <p>   地址                   varchar(20)       not null,</p> 
 <p>   constraint PK_STUDENT primary key  (学号)</p> 
 <p>)</p> 
 <p>go</p> 
 <p>executesp_addextendedproperty 'MS_Description',</p> 
 <p>   '学生基本信息描述',</p> 
 <p>   'user', '', 'table', 'StudentsInfo'</p> 
 <p>go</p> 
 <p>(2)创建课程表:</p> 
 <p>create table Course (</p> 
 <p>   cno                  varchar(5)           not null,</p> 
 <p>   cname                  varchar(10)          null,</p> 
 <p>   xueshi                  smallint             null,</p> 
 <p>   xuefen                   int                  null,</p> 
 <p>   constraint PK_COURSE primary key  (课程号))</p> 
 <p>go</p> 
 <p>executesp_addextendedproperty 'MS_Description',</p> 
 <p> </p> 
 <p> </p> 
 <p>(3)创建学生与课程的成绩表</p> 
 <p>create table SC ( sno                  varchar(11)          not null,</p> 
 <p>cno                 varchar(5)           not null,</p> 
 <p>chengji              varchar(4)            not null</p> 
 <p>   constraint PK_SC primary key  (学号, 课程号)</p> 
 <p>)</p> 
 <p>go</p> 
 <p>在SC表上创建索引SC_FK与SC2_FK</p> 
 <p>create   index SC_FK on SC (学号 ASC)</p> 
 <p>Go</p> 
 <p>create   index SC2_FK on SC (课程号 ASC)</p> 
 <p>go</p> 
 <p> </p> 
 <p>建立课程号索引</p> 
 <p>create   index TC_FK on TC (</p> 
 <p>课程号 ASC</p> 
 <p>)</p> 
 <p>go</p> 
 <p>下图显示了学生，课程和成绩三个关系的物理设计其中课程号与学号号分别为关系的主码。</p> 
 <p></p> 
 <p align="center">   </p> 
 <p>五 数据库的实施与维护</p> 
 <p>5.1 数据库的实施：</p> 
 <p>此阶段主要任务包括创建数据库，加载初始数据，数据库试运行，数据库的安全性和完整性控制数据库的备份与恢复，数据库性能的监督分析和改仅，数据库的重组和重构等。首先在数据库中建立一个学生成绩管理系统数据库，然后新建一个数据源。主要代码如下：</p> 
 <p>#include "stdafx.h"</p> 
 <p>#include"StudentScore.h"</p> 
 <p>#include "Course.h"</p> 
 <p>#ifdef _DEBUG</p> 
 <p>#define new DEBUG_NEW</p> 
 <p>#undef THIS_FILE</p> 
 <p>static char THIS_FILE[] =__FILE__;</p> 
 <p>// CCourse</p> 
 <p>IMPLEMENT_DYNAMIC(CCourse,CRecordset)</p> 
 <p>CCourse::CCourse(CDatabase*pdb)</p> 
 <p>         : CRecordset(pdb)</p> 
 <p>{       //{<!-- -->{AFX_FIELD_INIT(CCourse)</p> 
 <p>         //}}AFX_FIELD_INIT</p> 
 <p>         m_nDefaultType = snapshot;</p> 
 <p>CString CCourse::GetDefaultConnect()</p> 
 <p>{       return _T("ODBC;DSN=");</p> 
 <p>}</p> 
 <p>CStringCCourse::GetDefaultSQL()</p> 
 <p>{       return _T("");}</p> 
 <p>voidCCourse::DoFieldExchange(CFieldExchange* pFX)</p> 
 <p>{<!-- --></p> 
 <p>         //{<!-- -->{AFX_FIELD_MAP(CCourse)</p> 
 <p>         pFX-&gt;SetFieldType(CFieldExchange::outputColumn);</p> 
 <p>         //}}AFX_FIELD_MAP</p> 
 <p>}</p> 
 <p>// CCourse diagnostics</p> 
 <p>void CCourse::AssertValid()const</p> 
 <p>{       CRecordset::AssertValid();}</p> 
 <p>voidCCourse::Dump(CDumpContext&amp; dc) const</p> 
 <p>{       CRecordset::Dump(dc);}</p> 
 <p>// MainFrm.h : interface ofthe CMainFrame class</p> 
 <p>class CMainFrame : publicCFrameWnd</p> 
 <p>{protected: // create fromserialization only</p> 
 <p>         CMainFrame();</p> 
 <p>         DECLARE_DYNCREATE(CMainFrame)</p> 
 <p>// Attributes</p> 
 <p>public:</p> 
 <p>// Operations</p> 
 <p>public:</p> 
 <p>// Overrides</p> 
 <p>         // ClassWizard generated virtual function overrides</p> 
 <p>         //{<!-- -->{AFX_VIRTUAL(CMainFrame)</p> 
 <p>         virtual BOOL PreCreateWindow(CREATESTRUCT&amp; cs);</p> 
 <p>         //}}AFX_VIRTUAL</p> 
 <p>// Implementation</p> 
 <p>public:</p> 
 <p>         virtual ~CMainFrame();</p> 
 <p>protected:  // control bar embedded members</p> 
 <p>         //CStatusBar m_wndStatusBar;</p> 
 <p>         //CToolBar   m_wndToolBar;</p> 
 <p>// Generated message mapfunctions</p> 
 <p>protected:</p> 
 <p>         //{<!-- -->{AFX_MSG(CMainFrame)</p> 
 <p>         afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);</p> 
 <p>         afx_msg void OnPassword();</p> 
 <p>         afx_msg void OnUser();</p> 
 <p>         afx_msg void OnStudent();</p> 
 <p>         afx_msg void OnTeach();</p> 
 <p>         afx_msg void OnTeacher();</p> 
 <p>         afx_msg void OnScore();</p> 
 <p>         afx_msg void OnQueryTeach();</p> 
 <p>         afx_msg void OnQueryScore();</p> 
 <p>         afx_msg void OnCourse();</p> 
 <p>         //}}AFX_MSG</p> 
 <p>         DECLARE_MESSAGE_MAP()</p> 
 <p>};</p> 
 <p>//{<!-- -->{AFX_INSERT_LOCATION}}</p> 
 <p>// Microsoft Visual C++ willinsert additional declarations immediately before the previous line.</p> 
 <p>// CScoreAddDlg dialog</p> 
 <p>CScoreAddDlg::CScoreAddDlg(CWnd*pParent /*=NULL*/)</p> 
 <p>         : CDialog(CScoreAddDlg::IDD, pParent)</p> 
 <p>{/{<!-- -->{AFX_DATA_INIT(CScoreAddDlg)</p> 
 <p>         //}}AFX_DATA_INIT</p> 
 <p>}</p> 
 <p>voidCScoreAddDlg::DoDataExchange(CDataExchange* pDX)</p> 
 <p>{<!-- --></p> 
 <p>         CDialog::DoDataExchange(pDX);</p> 
 <p>         //{<!-- -->{AFX_DATA_MAP(CScoreAddDlg)</p> 
 <p>         DDX_Control(pDX, IDC_SCORE_STUDENT, m_cStudent);</p> 
 <p>         DDX_Control(pDX, IDC_SCORE_SCORE, m_cScore);</p> 
 <p>         DDX_Control(pDX, IDC_SCORE_COURSE, m_cCourse);</p> 
 <p>         //}}AFX_DATA_MAP</p> 
 <p>}</p> 
 <p>BEGIN_MESSAGE_MAP(CScoreAddDlg,CDialog)</p> 
 <p>         //{<!-- -->{AFX_MSG_MAP(CScoreAddDlg)</p> 
 <p>         //}}AFX_MSG_MAP</p> 
 <p>END_MESSAGE_MAP()</p> 
 <p>void CScoreAddDlg::OnOK()</p> 
 <p>{<!-- --></p> 
 <p>         CString student,course,score,student_no,course_no;</p> 
 <p>         m_cStudent.GetWindowText(student);</p> 
 <p>         m_cCourse.GetWindowText(course);</p> 
 <p>    m_cScore.GetWindowText(score);</p> 
 <p>         else//成绩不为空</p> 
 <p>         {<!-- --></p> 
 <p>                   CString strSQL;</p> 
 <p>                   //查出该学生的学号</p> 
 <p>                   strSQL.Format("select * from student whereactive_status='Y' and student_name='%s'",student);</p> 
 <p>                   CRecordset m_recordSet=&amp;m_database;</p> 
 <p>                   m_recordSet.Open(CRecordset::forwardOnly,strSQL);</p> 
 <p>       m_recordSet.GetFieldValue("student_no",student_no);</p> 
 <p>                   m_recordSet.Close();</p> 
 <p>                   //查出该课程的课程号</p> 
 <p>        strSQL.Format("select * fromcourse where active_status='Y' and course_name='%s'",course);</p> 
 <p>                   m_recordSet.Open(CRecordset::forwardOnly,strSQL);</p> 
 <p>       m_recordSet.GetFieldValue("course_no",course_no);;</p> 
 <p>                   m_recordSet.Close();</p> 
 <p>BOOLCScoreAddDlg::OnInitDialog()</p> 
 <p>{<!-- --></p> 
 <p>         CDialog::OnInitDialog();</p> 
 <p>         CRecordset m_recordSet;</p> 
 <p>         if(!m_database.IsOpen())</p> 
 <p>         {<!-- --></p> 
 <p>                   m_database.Open(_T("student"));</p> 
 <p>            m_recordSet.m_pDatabase=&amp;m_database;</p> 
 <p>         }</p> 
 <p>         CString strSQL;</p> 
 <p>         strSQL.Format("select course_name from course whereactive_status='Y'");</p> 
 <p>    m_recordSet.Open(CRecordset::forwardOnly,strSQL);</p> 
 <p>         for(int i=0;i&lt;m_recordSet.GetRecordCount();i++){<!-- --></p> 
 <p>                   CString temp;</p> 
 <p>                   m_recordSet.GetFieldValue("course_name",temp);</p> 
 <p>                   m_cCourse.AddString(temp);</p> 
 <p>        m_recordSet.MoveNext();</p> 
 <p>         }</p> 
 <p>         m_recordSet.Close();</p> 
 <p>    m_cCourse.SetCurSel(1);</p> 
 <p>         strSQL.Format("select student_name from student whereactive_status='Y'");</p> 
 <p>   m_recordSet.Open(CRecordset::forwardOnly,strSQL);</p> 
 <p>         for(int j=0;j&lt;m_recordSet.GetRecordCount();j++){<!-- --></p> 
 <p>                   CString temp;</p> 
 <p>                   m_recordSet.GetFieldValue("student_name",temp);</p> 
 <p>                   m_cStudent.AddString(temp);</p> 
 <p>        m_recordSet.MoveNext();</p> 
 <p>         }</p> 
 <p>         m_recordSet.Close();</p> 
 <p>    m_cStudent.SetCurSel(1);</p> 
 <p>         {<!-- --></p> 
 <p>                   this-&gt;SetWindowText("成绩窗口");</p> 
 <p>         }</p> 
 <p>         return true;</p> 
 <p>}</p> 
 <p>void CScoreAddDlg::OnCancel()</p> 
 <p>{<!-- --></p> 
 <p>         // TODO: Add extra cleanup here</p> 
 <p>        </p> 
 <p>         CDialog::OnCancel();</p> 
 <p>}</p> 
</div> 
<br> 
<div> 
 <p>5.2部分操作截图：</p> 
</div> 
<strong><br> </strong> 
<div> 
 <p>下图显示了学生登陆系统进行查询时界面：</p> 
 <p></p> 
 <p> </p> 
 <p>下图显示了进行课程查询时界面：</p> 
 <p align="center"></p> 
 <p align="center"><strong> </strong></p> 
 <p>成绩查询功能：</p> 
 <p align="center"> </p> 
 <p align="center"> </p> 
 <p align="center"></p> 
</div> 
<br> 
<p>5.3<strong>数据库的维护</strong></p> 
<p>当试运行数据库合格后，数据库开发设计的工作就基本完成了，接下来就是正式运行中的调试，应为该系统比较简单，数据量小，数据库中几乎不会发生什么大的变化，但是还是需要做好数据的备份，在sqlserver中我们可以利用备份数据库的功能对已经设计好的数据做备份，如果数据库受到破坏或系统故障，我们便可轻松的利用备份文件恢复数据库的数据。当然也可以利用其他各种方法进行数据维护。</p> 
<p><a target="_blank" name="_Toc208033772" class=" "><strong>六</strong></a><strong> 总结</strong></p> 
<p>进一步深入理解数据库设计的整个过程，该学生选课系统的需求分析、数据库概念结构设计有关内容等。掌握使用前台程序设计技术VC和SQL Server结合设计</p> 
<p>C /S结构的管理信息系统。综合练习了SQL Server的使用和数据库得管理技术。综合熟悉并练习了SQL语言在编程中的使用。 综合训练编程能力。认识系统，取得系统需求分析，更重要得是在编程方面提高了实现目标代码得能力及调试代码得能力</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d52fcbaec04371f1c74cbb89da57845e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OpenWrt安装tcpdump抓包</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/369ba3fe3d5fad7c7395ea957c3d4543/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">区分VS中解决方案（solution）和工程（project）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>