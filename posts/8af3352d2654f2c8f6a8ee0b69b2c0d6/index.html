<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PaddleOCR加载chinese_ocr_db_crnn_server/chinese_ocr_db_crnn_modile模型进行中英文混合预测（代码）实践 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PaddleOCR加载chinese_ocr_db_crnn_server/chinese_ocr_db_crnn_modile模型进行中英文混合预测（代码）实践" />
<meta property="og:description" content="1. 环境搭建 参考：《PaddleOCR加载chinese_ocr_db_crnn_server模型进行中英文混合预测（命令行）实践》
2. 代码 import paddlehub as hub import cv2 # 待预测图片 test_img_path = [&#34;./pic/0-1.jpg&#34;] def predict(): # 选择chinese_ocr_db_crnn_server模型 ocr = hub.Module(name=&#34;chinese_ocr_db_crnn_server&#34;) # 选择chinese_ocr_db_crnn_mobile模型 # ocr = hub.Module(name=&#34;chinese_ocr_db_crnn_mobile&#34;) np_images = [cv2.imread(image_path) for image_path in test_img_path] results = ocr.recognize_text( images=np_images, # 图片数据，ndarray.shape 为 [H, W, C]，BGR格式； use_gpu=False, # 是否使用 GPU；若使用GPU，请先设置CUDA_VISIBLE_DEVICES环境变量 output_dir=&#39;ocr_result&#39;, # 图片的保存路径，默认设为 ocr_result； visualization=True, # 是否将识别结果保存为图片文件； box_thresh=0.5, # 检测文本框置信度的阈值； text_thresh=0.5) # 识别中文文本置信度的阈值； for result in results: data = result[&#39;data&#39;] save_path = result[&#39;save_path&#39;] for infomation in data: print(&#39;text: &#39;, infomation[&#39;text&#39;], &#39;\nconfidence: &#39;, infomation[&#39;confidence&#39;], &#39;\ntext_box_position: &#39;, infomation[&#39;text_box_position&#39;]) if __name__ == &#39;__main__&#39;: # show_img() predict() 关于模型的几点说明：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8af3352d2654f2c8f6a8ee0b69b2c0d6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-16T09:28:23+08:00" />
<meta property="article:modified_time" content="2021-03-16T09:28:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PaddleOCR加载chinese_ocr_db_crnn_server/chinese_ocr_db_crnn_modile模型进行中英文混合预测（代码）实践</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h6><a id="1__0"></a>1. 环境搭建</h6> 
<p>参考：《<a href="https://blog.csdn.net/fm0517/article/details/114867135">PaddleOCR加载chinese_ocr_db_crnn_server模型进行中英文混合预测（命令行）实践</a>》</p> 
<h6><a id="2__4"></a>2. 代码</h6> 
<pre><code class="prism language-python"><span class="token keyword">import</span> paddlehub <span class="token keyword">as</span> hub
<span class="token keyword">import</span> cv2


<span class="token comment"># 待预测图片</span>
test_img_path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"./pic/0-1.jpg"</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 选择chinese_ocr_db_crnn_server模型</span>
    ocr <span class="token operator">=</span> hub<span class="token punctuation">.</span>Module<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"chinese_ocr_db_crnn_server"</span><span class="token punctuation">)</span>
    <span class="token comment"># 选择chinese_ocr_db_crnn_mobile模型</span>
    <span class="token comment"># ocr = hub.Module(name="chinese_ocr_db_crnn_mobile")</span>
    np_images <span class="token operator">=</span> <span class="token punctuation">[</span>cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path<span class="token punctuation">)</span> <span class="token keyword">for</span> image_path <span class="token keyword">in</span> test_img_path<span class="token punctuation">]</span>
    results <span class="token operator">=</span> ocr<span class="token punctuation">.</span>recognize_text<span class="token punctuation">(</span>
        images<span class="token operator">=</span>np_images<span class="token punctuation">,</span>  <span class="token comment"># 图片数据，ndarray.shape 为 [H, W, C]，BGR格式；</span>
        use_gpu<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否使用 GPU；若使用GPU，请先设置CUDA_VISIBLE_DEVICES环境变量</span>
        output_dir<span class="token operator">=</span><span class="token string">'ocr_result'</span><span class="token punctuation">,</span>  <span class="token comment"># 图片的保存路径，默认设为 ocr_result；</span>
        visualization<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否将识别结果保存为图片文件；</span>
        box_thresh<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>  <span class="token comment"># 检测文本框置信度的阈值；</span>
        text_thresh<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>  <span class="token comment"># 识别中文文本置信度的阈值；</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        data <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
        save_path <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">'save_path'</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> infomation <span class="token keyword">in</span> data<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'text: '</span><span class="token punctuation">,</span> infomation<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'\nconfidence: '</span><span class="token punctuation">,</span> infomation<span class="token punctuation">[</span><span class="token string">'confidence'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'\ntext_box_position: '</span><span class="token punctuation">,</span>
                  infomation<span class="token punctuation">[</span><span class="token string">'text_box_position'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># show_img()</span>
    predict<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre> 
<p>关于模型的几点说明：<br> OCR根据应用场景可以大致分成“特定场景下的专用OCR”以及“多种场景下的通用OCR”。<br> 专用OCR - 可以针对特定场景进行设计、优化以达到最好的特定场景下的效果展示，证件识别以及车牌识别就是专用OCR的典型案例。<br> 通用OCR - 就是使用在更多、更复杂的场景下，拥有比较好的泛性。在这个过程中由于场景的不确定性，比如：图片背景极其丰富、亮度不均衡、光照不均衡、残缺遮挡、文字扭曲、字体多样等等问题，会带来极大的挑战。</p> 
<p>这一套模型属于专用OCR，又分为：<br> （1）精简版，即chinese_ocr_db_crnn_mobile（inference模型大小约5.4MB）；<br> （2）高精度版，即chinese_ocr_db_crnn_server（inference模型大小约105MB）。<br> 该模型支持（1）中英文数字组合识别、（2）竖排文字识别、（3）长文本识别。且只支持“一键识别”，我的理解就是像全自动傻瓜相机一样：不需要也不支持参数调节。<br> <mark>实测结果显示，精简版能达到和高精度版几乎相同的预测准确性，运算耗时大约为后者的一半。</mark></p> 
<h6><a id="3__53"></a>3. 预测结果</h6> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/42/f9/87GtFp5x_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a6/5f/Swl2vYio_o.jpg" alt="在这里插入图片描述"><br> E:\test\PycharmProjects\PaddleStudy2\venv\Scripts\python.exe E:/test/PycharmProjects/PaddleStudy2/main.py<br> E:\test\PycharmProjects\PaddleStudy2\venv\lib\site-packages\pip_vendor\packaging\version.py:127: DeprecationWarning: Creating a LegacyVersion has been deprecated and will be removed in the next major release<br> warnings.warn(<br> E:\test\PycharmProjects\PaddleStudy2\venv\lib\site-packages\pip_vendor\packaging\version.py:127: DeprecationWarning: Creating a LegacyVersion has been deprecated and will be removed in the next major release<br> warnings.warn(<br> [2021-03-16 09:24:40,232] [ WARNING] - The _initialize method in HubModule will soon be deprecated, you can use the __init__() to handle the initialization of the object<br> [2021-03-16 09:24:41,158] [ WARNING] - The _initialize method in HubModule will soon be deprecated, you can use the __init__() to handle the initialization of the object<br> text: 双耳机配对<br> confidence: 0.9995235204696655<br> text_box_position: [[64, 63], [301, 69], [299, 119], [63, 113]]<br> text: 首次配对方法：<br> confidence: 0.9997860193252563<br> text_box_position: [[71, 186], [336, 194], [334, 232], [70, 225]]<br> text: 1、取出两只耳机，再将两只耳机放回充电盒中<br> confidence: 0.9993939399719238<br> text_box_position: [[67, 245], [767, 258], [767, 297], [67, 283]]<br> text: （此步骤为新机激活）<br> confidence: 0.9379152655601501<br> text_box_position: [[116, 293], [411, 300], [410, 335], [115, 328]]<br> text: 2、再次取出两只耳机<br> confidence: 0.999390721321106<br> text_box_position: [[67, 339], [401, 349], [399, 384], [66, 374]]<br> text: 3、刷新手机蓝牙设备列表，点击配对QCY-T1C，完成配对<br> confidence: 0.9993934035301208<br> text_box_position: [[67, 388], [937, 402], [937, 437], [67, 422]]<br> text: 耳机取出会自动开机，若未自动开机，请充电后重新尝试<br> confidence: 0.990841269493103<br> text_box_position: [[80, 436], [938, 451], [938, 483], [80, 468]]<br> text: 切换设备配对方法：<br> confidence: 0.9996602535247803<br> text_box_position: [[71, 536], [421, 536], [421, 573], [71, 573]]<br> text: 1、关闭A手机蓝牙，耳机自动断开进入配对模式<br> confidence: 0.9853517413139343<br> text_box_position: [[67, 590], [791, 598], [791, 636], [67, 629]]<br> text: 2、刷新B手机蓝牙设备列表，点击配对QCY-T1C，完成配对<br> confidence: 0.9961883425712585<br> text_box_position: [[63, 638], [964, 649], [964, 695], [63, 684]]<br> text: *不支持同时连接两台手机，下次开机默认回连上次配对的手机<br> confidence: 0.9984445571899414<br> text_box_position: [[73, 686], [989, 698], [989, 748], [73, 736]]<br> text: 双耳机配对<br> confidence: 0.9994222521781921<br> text_box_position: [[68, 61], [310, 74], [306, 124], [65, 112]]<br> text: 首次配对方法：<br> confidence: 0.9997161030769348<br> text_box_position: [[76, 187], [342, 194], [341, 233], [75, 226]]<br> text: 1、取出两只耳机，再将两只耳机放回充电盒中<br> confidence: 0.9952978491783142<br> text_box_position: [[71, 245], [772, 257], [772, 297], [71, 285]]<br> text: （此步骤为新机激活）<br> confidence: 0.9479562640190125<br> text_box_position: [[121, 294], [417, 300], [417, 337], [121, 331]]<br> text: 2、再次取出两只耳机<br> confidence: 0.958042323589325<br> text_box_position: [[72, 343], [407, 350], [407, 382], [72, 374]]<br> text: 3、刷新手机蓝牙设备列表，点击配对QCY-T1C，完成配对<br> confidence: 0.9990030527114868<br> text_box_position: [[71, 389], [941, 398], [941, 435], [71, 425]]<br> text: 耳机取出会自动开机，若未自动开机，请充电后重新尝试<br> confidence: 0.9989553689956665<br> text_box_position: [[85, 438], [942, 446], [942, 479], [85, 471]]<br> text: 切换设备配对方法：<br> confidence: 0.9995059967041016<br> text_box_position: [[75, 536], [428, 536], [428, 575], [75, 575]]<br> text: 1、关闭A手机蓝牙，耳机自动断开进入配对模式<br> confidence: 0.9949502944946289<br> text_box_position: [[75, 595], [800, 595], [800, 630], [75, 630]]<br> text: 2、、刷新B手机蓝牙设备列表，点击配对QCY-T1C，完成配对<br> confidence: 0.988647997379303<br> text_box_position: [[68, 641], [966, 643], [966, 687], [68, 685]]<br> text: *不支持同时连接两台手机，下次开机默认回连上次配对的手机<br> confidence: 0.9987525343894958<br> text_box_position: [[76, 689], [990, 692], [990, 739], [76, 736]]<br> text: 不支持同时连接两台手机<br> confidence: 0.9991649389266968<br> text_box_position: [[7, 4], [369, 4], [369, 28], [7, 28]]<br> text: 不支持同时连接两台手机<br> confidence: 0.9984502196311951<br> text_box_position: [[7, 5], [371, 3], [371, 27], [7, 30]]<br> text: then<br> confidence: 0.9547896385192871<br> text_box_position: [[9, 7], [142, 7], [142, 63], [9, 63]]<br> text: tr<br> confidence: 0.7379519939422607<br> text_box_position: [[331, 13], [391, 23], [389, 65], [329, 52]]<br> text: agair<br> confidence: 0.988548755645752<br> text_box_position: [[423, 7], [586, 2], [586, 76], [423, 81]]<br> W0316 09:24:40.241915 16684 analysis_predictor.cc:1145] Deprecated. Please use CreatePredictor instead.<br> Process finished with exit code 0</p> 
</blockquote> 
<h6><a id="4__147"></a>4. 更多效果展示</h6> 
<blockquote> 
 <p>图1：<img src="https://images2.imgbox.com/38/25/rg9M1RWB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/20/ec/OSqX2R6q_o.jpg" alt="在这里插入图片描述"><br> text: 宁波高尔节能科技有限公司<br> text: GAOER<br> text: 冷冻式干燥机<br> text: 型号GEAD-6F<br> text: 环境温度≤38℃入口温度&lt;80℃空气处理量6.5m3<br> text: 压力露点2°C~10℃电流5.5A<br> text: 额定工作压力&lt;1MPa<br> text: 冷媒R22<br> text: 功率1.228kw<br> text: 电源220V/50Hz<br> text: 重量<br> text: 外形尺寸880X550X1025<br> text: 出厂编号<br> text: 出厂日期<br> text: 浙江宁波溪口工业区综研路30-1号</p> 
</blockquote> 
<blockquote> 
 <p>图2：<img src="https://images2.imgbox.com/ef/26/TpV9QmPk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3d/40/k5dCNUfw_o.jpg" alt="在这里插入图片描述"><br> text: 中国北汽银翔汽车有限公司制造<br> text: VIN:LNBMDBAANGU091086<br> text: 品牌北京牌<br> text: 整车型号BJ6450BLV1Z<br> text: 最大净功率70.5kW<br> text: 发动机型号BJ415A<br> text: 最大允许总质量1925kg<br> text: 发动机排量1500ml<br> text: 制造年月2<br> text: 2016年5月<br> text: 乘员数</p> 
</blockquote> 
<blockquote> 
 <p>图3：<img src="https://images2.imgbox.com/e0/f6/YyhXlFhA_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/74/c5/zstrF3AC_o.jpg" alt="在这里插入图片描述"><br> text: ZNO5A<br> text: 号：<br> text: 选线路数：<br> text: 型<br> text: kY<br> text: 外壳防护等级<br> text: 额定电压：<br> text: Hz<br> text: 50<br> text: 电抗器额定功率<br> text: 额定频率：<br> text: 年<br> text: 20<br> text: 期：<br> text: 制造日<br> text: 月<br> text: 出厂编号：<br> text: RH<br> text: 产品综合：Q/PY）ZNDL1-2006标准<br> text: 传真：020-34811741<br> text: 020-22883341.22883254.22883741<br> text: 网址：<br> text: 联系电话：<br> text: www.nzhdl.com<br> text: 邮编：<br> text: zaonet@126.com<br> text: 电子邮箱：<br> text: 511400<br> text: 地<br> text: 址：广州市番昌迎宾路730号天安科技园创新821</p> 
</blockquote> 
<blockquote> 
 <p>图4：<br> <img src="https://images2.imgbox.com/ca/e5/XIk7yeAQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/66/9d/mx2DsLUs_o.jpg" alt="在这里插入图片描述"><br> text: 厦门赛恩机电科技有限公司<br> text: 电话：0592-5784545 5774549<br> text: 13606903002<br> text: 制造日期：2010年</p> 
</blockquote> 
<p>【参考文档】<br> 《<a href="https://aistudio.baidu.com/aistudio/projectdetail/507159" rel="nofollow">PaddleHub一键OCR中文识别</a>》</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26f99c9e2f4abe8bc69bf721981b0094/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PaddleOCR加载chinese_ocr_db_crnn_server模型进行中英文混合预测（命令行）实践</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/24a2a61275a0b51e135446d68462f214/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">将注意力机制引入ResNet，视觉领域涨点技巧来了！附使用方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>