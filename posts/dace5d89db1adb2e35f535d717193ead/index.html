<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ES 常用查询命令汇总 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ES 常用查询命令汇总" />
<meta property="og:description" content="ES 常用查询命令汇总 ES 常用查询命令汇总
一、_cat操作
_cat系列提供了一系列查询elasticsearch集群状态的接口。你可以通过执行
curl -XGET localhost:9200/_cat 获取所有_cat系列的操作 /_cat/allocation /_cat/shards /_cat/shards/{index} /_cat/master /_cat/nodes /_cat/indices /_cat/indices/{index} /_cat/segments /_cat/segments/{index} /_cat/count /_cat/count/{index} /_cat/recovery /_cat/recovery/{index} /_cat/health /_cat/pending_tasks /_cat/aliases /_cat/aliases/{alias} /_cat/thread_pool /_cat/plugins /_cat/fielddata /_cat/fielddata/{fields} 以上的命令中，你也可以后面加一个v，让输出内容表格显示表头 二：_cluster系列
1、查询设置集群状态
curl -XGET localhost:9200/_cluster/health?pretty=true pretty=true表示格式化输出 level=indices 表示显示索引状态 level=shards 表示显示分片信息 2、curl -XGET localhost:9200/_cluster/stats?pretty=true 显示集群系统信息，包括CPU JVM等等 3、curl -XGET localhost:9200/_cluster/state?pretty=true 集群的详细信息。包括节点、分片等。 4、curl -XGET localhost:9200/_cluster/pending_tasks?pretty=true 获取集群堆积的任务 5、修改集群配置 举例： curl -XPUT localhost:9200/_cluster/settings -d ‘{ “persistent” : { “discovery.zen.minimum_master_nodes” : 2 } }’ transient 表示临时的，persistent表示永久的 6、curl -XPOST ‘localhost:9200/_cluster/reroute’ -d ‘xxxxxx’ 对shard的手动控制，参考http://zhaoyanblog." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/dace5d89db1adb2e35f535d717193ead/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-17T09:05:07+08:00" />
<meta property="article:modified_time" content="2023-08-17T09:05:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ES 常用查询命令汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>ES 常用查询命令汇总</h2> 
<p><img alt="" src="https://images2.imgbox.com/22/fb/mwn6pso0_o.png"></p> 
<p><a name="t0"></a><br><a id="ES__0"></a><br> ES 常用查询命令汇总</p> 
<p><a id="_cat_1"></a><br> 一、_cat操作</p> 
<p>_cat系列提供了一系列查询elasticsearch集群状态的接口。你可以通过执行</p> 
<pre><code>curl -XGET localhost:9200/_cat
获取所有_cat系列的操作
/_cat/allocation
/_cat/shards
/_cat/shards/{index}
/_cat/master
/_cat/nodes
/_cat/indices
/_cat/indices/{index}
/_cat/segments
/_cat/segments/{index}
/_cat/count
/_cat/count/{index}
/_cat/recovery
/_cat/recovery/{index}
/_cat/health
/_cat/pending_tasks
/_cat/aliases
/_cat/aliases/{alias}
/_cat/thread_pool
/_cat/plugins
/_cat/fielddata
/_cat/fielddata/{fields}
以上的命令中，你也可以后面加一个v，让输出内容表格显示表头
</code></pre> 
<p><a id="_cluster_31"></a><br> 二：_cluster系列</p> 
<p><a id="1_33"></a><br> 1、查询设置集群状态</p> 
<pre><code>curl -XGET localhost:9200/_cluster/health?pretty=true
pretty=true表示格式化输出
level=indices 表示显示索引状态
level=shards 表示显示分片信息
</code></pre> 
<pre><code>2、curl -XGET localhost:9200/_cluster/stats?pretty=true
显示集群系统信息，包括CPU JVM等等
3、curl -XGET localhost:9200/_cluster/state?pretty=true
集群的详细信息。包括节点、分片等。
4、curl -XGET localhost:9200/_cluster/pending_tasks?pretty=true
获取集群堆积的任务
5、修改集群配置
举例：

    curl -XPUT localhost:9200/_cluster/settings -d ‘{
    “persistent” : {
    “discovery.zen.minimum_master_nodes” : 2
    }
    }’
    transient 表示临时的，persistent表示永久的
6、curl -XPOST ‘localhost:9200/_cluster/reroute’ -d ‘xxxxxx’
对shard的手动控制，参考http://zhaoyanblog.com/archives/687.html
7、关闭节点
关闭指定192.168.1.1节点
curl -XPOST ‘http://192.168.1.1:9200/_cluster/nodes/_local/_shutdown’
curl -XPOST ‘http://localhost:9200/_cluster/nodes/192.168.1.1/_shutdown’
关闭主节点
curl -XPOST ‘http://localhost:9200/_cluster/nodes/_master/_shutdown’
关闭整个集群
$ curl -XPOST ‘http://localhost:9200/_shutdown?delay=10s’
$ curl -XPOST ‘http://localhost:9200/_cluster/nodes/_shutdown’
$ curl -XPOST ‘http://localhost:9200/_cluster/nodes/_all/_shutdown’
delay=10s表示延迟10秒关闭

8、删除索引,通配符形式
curl -XDELETE localhost:9200/索引*

9、索引起别名
curl -XPUT localhost:9200/索引/_alias/别名

10、查看别名
curl -XPUT localhost:9200/_cat/aliases?v


</code></pre> 
<p><a id="_nodes_74"></a><br> 三：_nodes系列</p> 
<p><a id="1_75"></a><br> 1、查询节点的状态</p> 
<pre><code>curl -XGET ‘http://localhost:9200/_nodes/stats?pretty=true’
curl -XGET ‘http://localhost:9200/_nodes/192.168.1.2/stats?pretty=true’
curl -XGET ‘http://localhost:9200/_nodes/process’
curl -XGET ‘http://localhost:9200/_nodes/_all/process’
curl -XGET ‘http://localhost:9200/_nodes/192.168.1.2,192.168.1.3/jvm,process’
curl -XGET ‘http://localhost:9200/_nodes/192.168.1.2,192.168.1.3/info/jvm,process’
curl -XGET ‘http://localhost:9200/_nodes/192.168.1.2,192.168.1.3/_all
curl -XGET ‘http://localhost:9200/_nodes/hot_threads
</code></pre> 
<p><a id="_88"></a><br> 四、索引操作</p> 
<pre><code>1、获取索引
curl -XGET ‘http://localhost:9200/{index}/{type}/{id}’
2、索引数据
curl -XPOST ‘http://localhost:9200/{index}/{type}/{id}’ -d’{“a”:”avalue”,”b”:”bvalue”}’
3、删除索引
curl -XDELETE ‘http://localhost:9200/{index}/{type}/{id}’
4、设置mapping
curl -XPUT http://localhost:9200/{index}/{type}/_mapping -d ‘{
“{type}” : {
“properties” : {
“date” : {
“type” : “long”
},
“name” : {
“type” : “string”,
“index” : “not_analyzed”
},
“status” : {
“type” : “integer”
},
“type” : {
“type” : “integer”
}
}
}
}’
5、获取mapping
curl -XGET http://localhost:9200/{index}/{type}/_mapping
6、搜索

curl -XGET ‘http://localhost:9200/{index}/{type}/_search’ -d '{
“query” : {
“term” : { “user” : “kimchy” } //查所有 “match_all”: {}
},
“sort” : [{ “age” : {“order” : “asc”}},{ “name” : “desc” } ],
“from”:0,
“size”:100
}
curl -XGET ‘http://localhost:9200/{index}/{type}/_search’ -d '{
“filter”: {“and”:{“filters”:[{“term”:{“age”:“123”}},{“term”:{“name”:“张三”}}]},
“sort” : [{ “age” : {“order” : “asc”}},{ “name” : “desc” } ],
“from”:0,
“size”:100
}

7、索引增加分词字段
curl -X PUT -H "Content-Type: application/json" -d '{"properties":{"OWNER_ACCOUNT_NAME":{"copy_to":["_gnt_all"],"analyzer": "ik_max_word","store":true,"type":"text"}}}' "http://192.168.3.203:9200/ceshi_0002/_mapping/ceshi_0002"

8、索引增加普通字段
curl -X PUT -H "Content-Type: application/json" -d '{"properties":{"OWNER_ACCOUNT_NAME":{"copy_to":["_gnt_all"],"store":true,"type":"keyword"}}}' "http://192.168.1.101:9200/ceshi_0002/_mapping/ceshi_0002"

9、ES索引添加别名
curl -k -XPOST "http://192.168.1.101:9200/_aliases " -H 'Content-Type: application/json'    -d  '{"actions": [{"add": {"index": "索引名","alias": "别名"}}]}'

10、ES索引移除别名
curl -k -XPOST "http://192.168.1.101:9200/_aliases " -H 'Content-Type: application/json'    -d  '{"actions": [{"remove": {"index": "索引名","alias": "别名"}}]}'
</code></pre> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4c8b2fde8d4a495440aad35a06f45a41/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Stable Diffusion入门修炼手册</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c19dfbb1f403051b24305b7c35532e1a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">几种数据标准化的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>