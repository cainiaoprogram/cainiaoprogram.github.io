<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NSIS 简单教程 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NSIS 简单教程" />
<meta property="og:description" content="NSIS Setup 如果这个页面是您第一次使用NSIS，那么您将需要NSIS编译器来将以下脚本和您创建的其他脚本转换为有效的安装程序。您可以使用NSIS菜单，并在编译器部分下单击编译NSI脚本启动MakeNSISW。
NSIS安装文件夹中的makensisw.exe是实际的编译器。它有一个图形化的前端，解释了三种加载脚本的方法，所以它非常容易使用。安装NSIS之后，要创建一个安装程序，需要将脚本复制到文本编辑器中，保存扩展名为.nsi的文件，并将该文件加载到makensisw编译器中。
最简代码 # name the installer OutFile &#34;Installer.exe&#34; # default section start; every NSIS script has at least one section. Section # default section end SectionEnd 简单的Hello World-弹出框 当安装程序运行时，这个hello world脚本将创建一个带有单词“hello world”和一个“OK”按钮的弹出框
# set the name of the installer Outfile &#34;hello world.exe&#34; # create a default section. Section # create a popup box, with an OK button and the text &#34;Hello world!&#34; MessageBox MB_OK &#34;Hello world!&#34; SectionEnd 简单的Hello World-写文本到文件 当安装程序运行时，这个hello world脚本将把“hello world”写入一个文本文件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/746e862c54e8af90c18c7bd8d6580720/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-19T11:36:03+08:00" />
<meta property="article:modified_time" content="2022-02-19T11:36:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NSIS 简单教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="NSIS_Setup_0"></a>NSIS Setup</h3> 
<p>如果这个页面是您第一次使用NSIS，那么您将需要<a href="https://nsis.sourceforge.io/Download" rel="nofollow">NSIS编译器</a>来将以下脚本和您创建的其他脚本转换为有效的安装程序。您可以使用NSIS菜单，并在编译器部分下单击编译NSI脚本启动MakeNSISW。</p> 
<p>NSIS安装文件夹中的makensisw.exe是实际的编译器。它有一个图形化的前端，解释了三种加载脚本的方法，所以它非常容易使用。安装NSIS之后，要创建一个安装程序，需要将脚本复制到文本编辑器中，保存扩展名为.nsi的文件，并将该文件加载到makensisw编译器中。</p> 
<h3><a id="_6"></a>最简代码</h3> 
<pre><code># name the installer
OutFile "Installer.exe"
 
# default section start; every NSIS script has at least one section.
Section
 
# default section end
SectionEnd
</code></pre> 
<h3><a id="Hello_World_18"></a>简单的Hello World-弹出框</h3> 
<p>当安装程序运行时，这个hello world脚本将创建一个带有单词“hello world”和一个“OK”按钮的弹出框</p> 
<pre><code># set the name of the installer
Outfile "hello world.exe"
 
# create a default section.
Section
 
# create a popup box, with an OK button and the text "Hello world!"
MessageBox MB_OK "Hello world!"
 
SectionEnd
</code></pre> 
<h3><a id="Hello_World_32"></a>简单的Hello World-写文本到文件</h3> 
<p>当安装程序运行时，这个hello world脚本将把“hello world”写入一个文本文件</p> 
<pre><code># declare name of installer file
Outfile "hello world.exe"
 
# open section
Section
 
# create a popup box, with an OK button and some text
MessageBox MB_OK "Now We are Creating Hello_world.txt at Desktop!"
 
/* open an output file called "Hello_world.txt", 
on the desktop in write mode. This file does not need to exist 
before script is compiled and run */
 
FileOpen $0 "$DESKTOP\Hello_world.txt" w
 
# write the string "hello world!" to the output file
FileWrite $0 "hello world!"
 
# close the file
FileClose $0
# Show Success message.
MessageBox MB_OK "Hello_world.txt has been created successfully at Desktop!"
 
 
# end the section
SectionEnd
</code></pre> 
<h3><a id="_63"></a>安装一个文件</h3> 
<p>这个安装程序脚本将复制文件"test.txt"到安装目录。首先，在与下面安装程序脚本相同的目录中创建test.txt文件，然后编译安装程序脚本。如果安装程序脚本在Desktop上，请在运行编译后的安装程序之前删除test.txt文件。运行简单安装程序将test.txt文件安装到桌面。</p> 
<pre><code># define the name of the installer
Outfile "simple installer.exe"
 
# define the directory to install to, the desktop in this case as specified  
# by the predefined $DESKTOP variable
InstallDir $DESKTOP
 
# default section
Section
 
# define the output path for this file
SetOutPath $INSTDIR
 
# define what to install and place it in the output path
File test.txt
 
SectionEnd
</code></pre> 
<h3><a id="_85"></a>安装一个文件并创建一个卸载程序来删除它</h3> 
<p>这个脚本将执行以下操作:</p> 
<ul><li>创建一个名为“installer.exe”的安装程序;</li><li>在桌面上安装一个名为“test.txt”的文件;</li><li>在桌面上创建一个名为“uninstall .exe”的卸载程序。</li><li>卸载程序将删除自己和已安装的文本文件。</li></ul> 
<pre><code># define installer name
OutFile "installer.exe"
 
# set desktop as install directory
InstallDir $DESKTOP
 
# default section start
Section
 
# define output path
SetOutPath $INSTDIR
 
# specify file to go in output path
File test.txt
 
# define uninstaller name
WriteUninstaller $INSTDIR\uninstaller.exe
 
 
#-------
# default section end
SectionEnd
 
# create a section to define what the uninstaller does.
# the section will always be named "Uninstall"
Section "Uninstall"
 
# Always delete uninstaller first
Delete $INSTDIR\uninstaller.exe
 
# now delete installed file
Delete $INSTDIR\test.txt
 
# Delete the directory
RMDir $INSTDIR
SectionEnd
</code></pre> 
<h3><a id="_130"></a>创建一个开始菜单项</h3> 
<p>这个安装程序创建了一个开始菜单项，仅此而已</p> 
<pre><code># Name the installer
OutFile "installer.exe"
 
# default section
Section
 
    # create a shortcut named "new shortcut" in the start menu programs directory
    # presently, the new shortcut doesn't call anything (the second field is blank)
    CreateShortcut "$SMPROGRAMS\new shortcut.lnk" ""
 
    # to delete shortcut, go to start menu directory and manually delete it
 
# default sec end
SectionEnd
</code></pre> 
<h3><a id="_148"></a>带有开始菜单项的安装程序和卸载程序</h3> 
<p>这个安装程序将执行以下操作:</p> 
<ul><li>创建一个名为“installer.exe”的安装程序;</li><li>将安装在桌面的卸载程序;</li><li>和开始菜单中指向卸载程序的快捷方式。</li></ul> 
<pre><code># define name of installer
OutFile "installer.exe"
 
# define installation directory
InstallDir $DESKTOP
 
# For removing Start Menu shortcut in Windows 7
RequestExecutionLevel user
 
# start default section
Section
 
    # set the installation directory as the destination for the following actions
    SetOutPath $INSTDIR
 
    # create the uninstaller
    WriteUninstaller "$INSTDIR\uninstall.exe"
 
    # create a shortcut named "new shortcut" in the start menu programs directory
    # point the new shortcut at the program uninstaller
    CreateShortcut "$SMPROGRAMS\new shortcut.lnk" "$INSTDIR\uninstall.exe"
SectionEnd
 
# uninstaller section start
Section "uninstall"
 
    # first, delete the uninstaller
    Delete "$INSTDIR\uninstall.exe"
 
    # second, remove the link from the start menu
    Delete "$SMPROGRAMS\new shortcut.lnk"
 
    RMDir $INSTDIR
# uninstaller section end
SectionEnd
</code></pre> 
<h3><a id="Java_192"></a>获取Java运行时环境的当前版本</h3> 
<p>这个安装程序只是使用<code>ReadRegStr</code>检查本地机器注册表中JRE的<code>CurrentVersion</code>字符串的值。如果结果为空，说明可能没有安装JRE。</p> 
<pre><code># name the installer
OutFile "installer.exe"
 
#default section start
Section
 
    # read the value from the registry into the $0 register
    ReadRegStr $0 HKLM "SOFTWARE\JavaSoft\Java Runtime Environment" CurrentVersion
 
    # print the results in a popup message box
    MessageBox MB_OK "version: $0"
 
# default section end
SectionEnd
</code></pre> 
<h3><a id="useradministrator_210"></a>检查user是否为administrator</h3> 
<p>有时，有必要检查安装程序的用户是否具有管理权限。这个简单的脚本使用“UserInfo”插件进行检查。在 <a href="http://forums.winamp.com/showthread.php?threadid=195020" rel="nofollow">这个网页</a> 有一个更复杂的替代方法，但这个方法似乎可以达到目的。UserInfo的另一个例子可以在NSIS的安装目录<code>\Examples\UserInfo\UserInfo.nsi</code>下找到。</p> 
<pre><code># name installer
OutFile "installer.exe"
 
# default section start
Section
 
    # call UserInfo plugin to get user info.  The plugin puts the result in the stack
    UserInfo::getAccountType
   
    # pop the result from the stack into $0
    Pop $0
 
    # compare the result with the string "Admin" to see if the user is admin.
    # If match, jump 3 lines down.
    StrCmp $0 "Admin" +3
 
    # if there is not a match, print message and return
    MessageBox MB_OK "not admin: $0"
    Return
 
    # otherwise, confirm and return
    MessageBox MB_OK "is admin"
 
# default section end
SectionEnd
</code></pre> 
<p><a href="https://nsis.sourceforge.io/Simple_tutorials" rel="nofollow">原文参考</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dc16de431b1a8beb95d18d7def14dd20/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">旋转向量（旋转矩阵）与欧拉角</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a4d7a1845927613c673240f99891382d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Java编程性能调优】常用的性能测试工具</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>