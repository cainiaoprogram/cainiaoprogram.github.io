<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JAVA SpringMVC老项目集成knife4j - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JAVA SpringMVC老项目集成knife4j" />
<meta property="og:description" content="需求: 原有一直使用showdoc工具对内或对外进行接口文档和功能的沟通，上层领导觉得人工进行手写
浪费很多人工维护时间可能会做到接口更改而面对静态文档而更新不及时showdoc的劣势是不能进行在线调试 需要辅助其他调试工具 但领导只需要类似swagger官方的页面即可。通过调研了解到knife4j是一个集Swagger2 和 OpenAPI3为一体的增强解决方案。
knife4j介绍:
Knife4j的前身是swagger-bootstrap-ui,前身swagger-bootstrap-ui是一个纯swagger-ui的ui皮肤项目
一开始项目初衷是为了写一个增强版本的swagger的前端ui,但是随着项目的发展,面对越来越多的个性化需求,不得不编写后端Java代码以满足新的需求,在swagger-bootstrap-ui的1.8.5~1.9.6版本之间,采用的是后端Java代码和Ui都混合在一个Jar包里面的方式提供给开发者使用.这种方式虽说对于集成swagger来说很方便,只需要引入jar包即可,但是在微服务架构下显得有些臃肿。
因此,项目正式更名为knife4j,取名knife4j是希望她能像一把匕首一样小巧,轻量,并且功能强悍,更名也是希望把她做成一个为Swagger接口文档服务的通用性解决方案,不仅仅只是专注于前端Ui前端.
swagger-bootstrap-ui的所有特性都会集中在knife4j-spring-ui包中,并且后续也会满足开发者更多的个性化需求.
主要的变化是,项目的相关类包路径更换为com.github.xiaoymin.knife4j前缀,开发者使用增强注解时需要替换包路径
后端Java代码和ui包分离为多个模块的jar包,以面对在目前微服务架构下,更加方便的使用增强文档注解(使用SpringCloud微服务项目,只需要在网关层集成UI的jar包即可,因此分离前后端)
此次集成的是SSM的老项目，故中途关于查阅相关资料与测试使用了一些时间，不同与springboot或微服务集成，官网提供了相对完善的资料，此次是基于springMVC进行老版本(2.0.4)的集成工作。
一、
老项目是使用的Gradle构建工具,首先通过仓库查询到knife4j的依赖包，将以下两个包引入
二、创建配置文件 SwaggerConfig
关键点说明:
.api是为了指定Controller扫描包路径@ComponentScan 目的是为了使用knife4j增强功能，在2.0.4版本之前必须使用该写法，在2.0.5之后可以使用@EnableKnife4j @EnableWebMvc @EnableSwagger2 @Configuration @ComponentScan( basePackages = { &#34;com.github.xiaoymin.knife4j.spring.plugin&#34;, &#34;com.github.xiaoymin.knife4j.spring.web&#34; } ) public class SwaggerConfig { @Bean public Docket defaultApi() { return new Docket(DocumentationType.SWAGGER_2) .apiInfo(groupApiInfo()) .groupName(&#34;平台接口&#34;) .select()	.apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class)) .paths(PathSelectors.any()) .build(); } private ApiInfo groupApiInfo() { return new ApiInfoBuilder() .title(&#34;调试接口文档&#34;) .description(&#34;对外关键接口文档说明&#34;) .termsOfServiceUrl(&#34;http://www.group.com/&#34;) .contact(&#34;group@qq.com&#34;) .version(&#34;1.0&#34;) .build(); } } **注意点: 区别于SpringBoot的注入,不使用@Configuration注解注入到Spring的IOC容器中,采用&lt;bean&gt;XML注入的方式注入到Spring的容器中" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/848b1ec916c2695a7445ee06668d0beb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-18T16:10:34+08:00" />
<meta property="article:modified_time" content="2022-11-18T16:10:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JAVA SpringMVC老项目集成knife4j</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>需求: 原有一直使用showdoc工具对内或对外进行接口文档和功能的沟通，上层领导觉得人工进行手写</p> 
<blockquote> 
 <ol><li>浪费很多人工维护时间</li><li>可能会做到接口更改而面对静态文档而更新不及时</li><li>showdoc的劣势是不能进行在线调试 需要辅助其他调试工具</li></ol> 
</blockquote> 
<p>但领导只需要类似swagger官方的页面即可。通过调研了解到knife4j是一个集Swagger2 和 OpenAPI3为一体的增强解决方案。</p> 
<p>knife4j介绍:</p> 
<blockquote> 
 <p><code>Knife4j</code>的前身是<code>swagger-bootstrap-ui</code>,前身<code>swagger-bootstrap-ui</code>是一个纯<code>swagger-ui</code>的<code>ui</code>皮肤项目</p> 
 <p>一开始项目初衷是为了写一个增强版本的swagger的前端ui,但是随着项目的发展,面对越来越多的个性化需求,不得不编写后端Java代码以满足新的需求,在<code>swagger-bootstrap-ui</code>的1.8.5~1.9.6版本之间,采用的是后端Java代码和Ui都混合在一个Jar包里面的方式提供给开发者使用.这种方式虽说对于集成swagger来说很方便,只需要引入jar包即可,但是在微服务架构下显得有些臃肿。</p> 
 <p>因此,项目正式更名为<strong>knife4j</strong>,取名knife4j是希望她能像一把匕首一样小巧,轻量,并且功能强悍,更名也是希望把她做成一个为Swagger接口文档服务的通用性解决方案,不仅仅只是专注于前端Ui前端.</p> 
 <p><code>swagger-bootstrap-ui</code>的所有特性都会集中在<code>knife4j-spring-ui</code>包中,并且后续也会满足开发者更多的个性化需求.</p> 
 <p>主要的变化是,项目的相关类包路径更换为<code>com.github.xiaoymin.knife4j</code>前缀,开发者使用增强注解时需要替换包路径</p> 
 <p>后端Java代码和ui包分离为多个模块的jar包,以面对在目前微服务架构下,更加方便的使用增强文档注解(使用SpringCloud微服务项目,只需要在网关层集成UI的jar包即可,因此分离前后端)</p> 
</blockquote> 
<h2></h2> 
<p>此次集成的是SSM的老项目，故中途关于查阅相关资料与测试使用了一些时间，不同与springboot或微服务集成，官网提供了相对完善的资料，此次是基于springMVC进行老版本(2.0.4)的集成工作。</p> 
<p>一、</p> 
<p>老项目是使用的Gradle构建工具,首先通过仓库查询到knife4j的依赖包，将以下两个包引入</p> 
<p><img alt="" height="90" src="https://images2.imgbox.com/bd/aa/V18fYyPz_o.png" width="1022"></p> 
<p> 二、创建配置文件  SwaggerConfig</p> 
<p>关键点说明:</p> 
<ol><li>.api是为了指定Controller扫描包路径</li><li>@ComponentScan 目的是为了使用knife4j增强功能，在2.0.4版本之前必须使用该写法，在2.0.5之后可以使用@EnableKnife4j</li></ol> 
<pre><code class="language-java">@EnableWebMvc
@EnableSwagger2
@Configuration
@ComponentScan(
		basePackages = {
				"com.github.xiaoymin.knife4j.spring.plugin",
				"com.github.xiaoymin.knife4j.spring.web"
		}
)
public class SwaggerConfig {

	@Bean
	public Docket defaultApi() {
		return new Docket(DocumentationType.SWAGGER_2)
				.apiInfo(groupApiInfo())
				.groupName("平台接口")
				.select()		                            
.apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))
				.paths(PathSelectors.any())
				.build();
	}


	private ApiInfo groupApiInfo() {
		return new ApiInfoBuilder()
				.title("调试接口文档")
				.description("对外关键接口文档说明")
				.termsOfServiceUrl("http://www.group.com/")
				.contact("group@qq.com")
				.version("1.0")
				.build();
	}

}</code></pre> 
<p>**注意点: 区别于SpringBoot的注入,不使用<code>@Configuration</code>注解注入到Spring的IOC容器中,采用<code>&lt;bean&gt;</code>XML注入的方式注入到Spring的容器中</p> 
<p>例如我的配置是: </p> 
<p><img alt="" height="72" src="https://images2.imgbox.com/97/f0/0dY3Damb_o.png" width="1200"></p> 
<p>三、配置静态文件</p> 
<p>由于knife4j是通过webjar的方式提供服务,因此对外访问的<code>doc.html</code>需要在我们的mvc环境中配置静态目录,否则会出现404，在<code>spring.xml</code>主容器的配置文件中配置</p> 
<p>例如我的配置是:</p> 
<p><img alt="" height="124" src="https://images2.imgbox.com/76/9e/eYnuz3sv_o.png" width="1200"></p> 
<p>另外这里需要注意的是: 需要在地址 &lt;mvc:exclude-mapping path 中将上述地址排除，否则会跳转到默认页面中</p> 
<p>另外需要在web.xml中进行配置:  添加部分<code>servlet-mapping</code>节点，添加这些节点是防止swagger的接口出现404的出现</p> 
<p><img alt="" height="1128" src="https://images2.imgbox.com/0f/23/ydkIXZpo_o.png" width="1200"></p> 
<p>四、基础配置已配置好，可以在需要的接口上进行注解的配置</p> 
<p>1、首先在控制器的接口中添加@Api的注解 </p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/e5/94/hGQedYZR_o.png" width="978"></p> 
<p>2、在指定的接口上指定接口方法与接口参数等信息 例如:</p> 
<p> <img alt="" height="250" src="https://images2.imgbox.com/99/2a/7qIXcUPM_o.png" width="1200"></p> 
<p>五、完成基本的配置 可以尝试访问doc路径地址</p> 
<p><img alt="" height="820" src="https://images2.imgbox.com/ad/0c/oLKqqJnf_o.png" width="1200"> </p> 
<p></p> 
<p>剩下的工作即 将旧有的showdoc中的文档 一一对应的在系统中编写对应的接口进行迁移测试即可，当迁移测试完善完成后，即可舍弃旧有的文档工具。 </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f5575a473bdf34378de73c089394531d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android App手势冲突处理中上下左右滑动的处理以及侧滑边缘菜单的讲解及实战（附源码 可直接使用）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9fa799a7f400fe19a9855ebc4f599d0a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GEE开发之Modis_NDVI数据分析获取大总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>