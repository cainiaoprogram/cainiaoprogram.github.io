<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Docker实现Mysql读写分离（主从同步） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Docker实现Mysql读写分离（主从同步）" />
<meta property="og:description" content="概念 Mysql读写分离主要是通过主从数据库复制来实现，Mysql自带的二进制复制技术；Mysql5.7与Mysql8操作稍有差别，Mysql8的授权模式有改动，需要先创建用户；实现主从同步后，使用MyCat等软件实现读写分离；使用Docker来模拟两台服务器，原理和使用2台不同IP的服务器一样； 安装Docker 下载Docker Desktop https://www.docker.com/get-started，这个是有图形界面的Docker，可以省去很多命令操作，对系统有一定要求；直接安装即可； 拉取mysql docker pull mysql:5.7 在Docker Hub查看版本，本文使用5.7版本 https://hub.docker.com/_/mysql?tab=tags
制作主从Mysql镜像 1. 任意位置创建2个文件夹，并分别创建Dockerfile和My.cnf Dockerfile – 打包配置文件My.cnf – Mysql配置文件，这里修改好以后替换Mysql原有文件，也可以打包以后进入容器修改，但是Docker原生没有Vim编辑，需要更新源安装，但是速度很慢； 2. 编写Dockerfile FROM mysql:5.7 COPY my.cnf /etc/mysql/ EXPOSE 3306 CMD [&#34;mysqld&#34;] master和slave相同mysql:5.7 – 不写版本号5.7会拉取最新版Mysql，最新版的授权有变化，需修改授权方式 3. 编写My.cnf master： [mysqld] pid-file = /var/run/mysqld/mysqld.pid socket = /var/run/mysqld/mysqld.sock datadir = /var/lib/mysql secure-file-priv= NULL # 新添加的在下面 #启用二进制，必须 log-bin=mysql-bin #填写整数，每个数据库不同 server-id=1 slave: [mysqld] pid-file = /var/run/mysqld/mysqld.pid socket = /var/run/mysqld/mysqld.sock datadir = /var/lib/mysql secure-file-priv= NULL # 新添加的在下面 #启用二进制，必须 log-bin=mysql-bin #填写整数，每个数据库不同 server-id=2 更多配置参考 server-id=1 #任意自然数n，只要保证两台MySQL主机不重复就可以了。 log-bin=mysql-bin #开启二进制日志 auto_increment_increment=2 #步进值auto_imcrement。一般有n台主MySQL就填n auto_increment_offset=1 #起始值。一般填第n台主MySQL。此时为第一台主MySQL binlog-ignore=mysql #忽略mysql库【我一般都不写】 binlog-ignore=information_schema #忽略information_schema库【我一般都不写】 replicate-do-db=aa #要同步的数据库，不填默认所有库 # 配置好后重启MySQL # https://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/09abab63c81bf9351539026cf48474d7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-09T11:26:53+08:00" />
<meta property="article:modified_time" content="2023-11-09T11:26:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Docker实现Mysql读写分离（主从同步）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>概念</h2> 
<ul><li>Mysql读写分离主要是通过主从数据库复制来实现，Mysql自带的二进制复制技术；</li><li>Mysql5.7与Mysql8操作稍有差别，Mysql8的授权模式有改动，需要先创建用户；</li><li>实现主从同步后，使用MyCat等软件实现读写分离；</li><li>使用Docker来模拟两台服务器，原理和使用2台不同IP的服务器一样；</li></ul> 
<h2><a id="Docker_6"></a>安装Docker</h2> 
<ul><li>下载<code>Docker Desktop</code> https://www.docker.com/get-started，这个是有图形界面的Docker，可以省去很多命令操作，对系统有一定要求；</li><li>直接安装即可；</li></ul> 
<h2><a id="mysql_10"></a>拉取mysql</h2> 
<pre><code class="prism language-java">docker pull mysql<span class="token operator">:</span><span class="token number">5.7</span>
</code></pre> 
<ul><li>在Docker Hub查看版本，本文使用5.7版本 <code>https://hub.docker.com/_/mysql?tab=tags</code><br> <img src="https://images2.imgbox.com/ad/4b/fwSZrdP7_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="Mysql_17"></a>制作主从Mysql镜像</h2> 
<h3><a id="1_2DockerfileMycnf_18"></a>1. 任意位置创建2个文件夹，并分别创建<code>Dockerfile</code>和<code>My.cnf</code></h3> 
<p><img src="https://images2.imgbox.com/1b/a8/cbDyMHjY_o.png" alt="在这里插入图片描述"></p> 
<ul><li><code>Dockerfile</code> – 打包配置文件</li><li><code>My.cnf</code> – Mysql配置文件，这里修改好以后替换Mysql原有文件，也可以打包以后进入容器修改，但是Docker原生没有Vim编辑，需要更新源安装，但是速度很慢；</li></ul> 
<h3><a id="2_Dockerfile_23"></a>2. 编写<code>Dockerfile</code></h3> 
<pre><code class="prism language-java"><span class="token constant">FROM</span> mysql<span class="token operator">:</span><span class="token number">5.7</span>
<span class="token constant">COPY</span> my<span class="token punctuation">.</span>cnf <span class="token operator">/</span>etc<span class="token operator">/</span>mysql<span class="token operator">/</span>  
<span class="token constant">EXPOSE</span> <span class="token number">3306</span>
<span class="token constant">CMD</span> <span class="token punctuation">[</span><span class="token string">"mysqld"</span><span class="token punctuation">]</span>
</code></pre> 
<ul><li>master和slave相同</li><li><code>mysql:5.7</code> – 不写版本号5.7会拉取最新版Mysql，最新版的授权有变化，需修改授权方式</li></ul> 
<h3><a id="3_Mycnf_34"></a>3. 编写<code>My.cnf</code></h3> 
<h4><a id="master_35"></a>master：</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
pid<span class="token operator">-</span>file        <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mysqld<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>pid
socket          <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mysqld<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock
datadir         <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql
secure<span class="token operator">-</span>file<span class="token operator">-</span>priv<span class="token operator">=</span> <span class="token constant">NULL</span>

# 新添加的在下面

#启用二进制，必须
log<span class="token operator">-</span>bin<span class="token operator">=</span>mysql<span class="token operator">-</span>bin
#填写整数，每个数据库不同
server<span class="token operator">-</span>id<span class="token operator">=</span><span class="token number">1</span>
</code></pre> 
<h4><a id="slave_50"></a>slave:</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
pid<span class="token operator">-</span>file        <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mysqld<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>pid
socket          <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mysqld<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>sock
datadir         <span class="token operator">=</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql
secure<span class="token operator">-</span>file<span class="token operator">-</span>priv<span class="token operator">=</span> <span class="token constant">NULL</span>

# 新添加的在下面

#启用二进制，必须
log<span class="token operator">-</span>bin<span class="token operator">=</span>mysql<span class="token operator">-</span>bin
#填写整数，每个数据库不同
server<span class="token operator">-</span>id<span class="token operator">=</span><span class="token number">2</span>
</code></pre> 
<ul><li>更多配置参考</li></ul> 
<pre><code class="prism language-javascript">server<span class="token operator">-</span>id<span class="token operator">=</span><span class="token number">1</span>   #任意自然数n，只要保证两台MySQL主机不重复就可以了。

log<span class="token operator">-</span>bin<span class="token operator">=</span>mysql<span class="token operator">-</span>bin   #开启二进制日志

auto_increment_increment<span class="token operator">=</span><span class="token number">2</span>   #步进值auto_imcrement。一般有n台主MySQL就填n

auto_increment_offset<span class="token operator">=</span><span class="token number">1</span>   #起始值。一般填第n台主MySQL。此时为第一台主MySQL

binlog<span class="token operator">-</span>ignore<span class="token operator">=</span>mysql   #忽略mysql库【我一般都不写】

binlog<span class="token operator">-</span>ignore<span class="token operator">=</span>information_schema   #忽略information_schema库【我一般都不写】

replicate<span class="token operator">-</span><span class="token keyword">do</span><span class="token operator">-</span>db<span class="token operator">=</span>aa   #要同步的数据库，不填默认所有库

# 配置好后重启MySQL
# https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>cnblogs<span class="token punctuation">.</span>com<span class="token operator">/</span>phpstudy2015<span class="token operator">-</span><span class="token number">6</span><span class="token operator">/</span>p<span class="token operator">/</span><span class="token number">6485819</span><span class="token punctuation">.</span>html#_label7
</code></pre> 
<h3><a id="4__85"></a>4. 打包</h3> 
<ul><li>master文件夹下</li></ul> 
<pre><code class="prism language-java">docker build <span class="token operator">-</span>t master<span class="token operator">/</span>mysql <span class="token punctuation">.</span>
</code></pre> 
<ul><li>slave文件夹下</li></ul> 
<pre><code class="prism language-java">docker build <span class="token operator">-</span>t slave<span class="token operator">/</span>mysql <span class="token punctuation">.</span>
</code></pre> 
<ul><li> <p><code>.</code> – 点代表本文件夹下所有，必写</p> </li><li> <p>查看是否成功</p> </li></ul> 
<p><img src="https://images2.imgbox.com/2b/d9/zhtdzNFK_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Mysql_101"></a>创建主从Mysql容器</h2> 
<pre><code class="prism language-java">docker run <span class="token operator">-</span>p <span class="token number">17717</span><span class="token operator">:</span><span class="token number">3306</span> <span class="token operator">--</span>name mysql<span class="token operator">-</span>master <span class="token operator">-</span>e <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token operator">-</span>d master<span class="token operator">/</span>mysql
docker run <span class="token operator">-</span>p <span class="token number">17718</span><span class="token operator">:</span><span class="token number">3306</span> <span class="token operator">--</span>name mysql<span class="token operator">-</span>slave <span class="token operator">-</span>e <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token operator">-</span>d slave<span class="token operator">/</span>mysql

</code></pre> 
<ul><li>查看运行结果：<br> <img src="https://images2.imgbox.com/1f/fe/dwGaMsg7_o.png" alt="在这里插入图片描述"></li><li>如果运行失败，点击mysql-master标题进入查看日志；</li></ul> 
<h2><a id="__111"></a>主从配置 <mark>（关键步骤）</mark></h2> 
<h3><a id="mysqlmaster_112"></a>进入mysql-master操作</h3> 
<h4><a id="1__113"></a>1. 点击<code>&gt;-</code>按钮进入容器内部</h4> 
<pre><code class="prism language-java"><span class="token comment">//点击`&gt;-`按钮相当于命令行执行，操作2选一</span>
docker exec <span class="token operator">-</span>it mysql<span class="token operator">-</span>slave bash
</code></pre> 
<h4><a id="2_mysql_118"></a>2. 登陆mysql</h4> 
<pre><code class="prism language-java">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p
<span class="token comment">//然后输入密码123456</span>
</code></pre> 
<h4><a id="3_123"></a>3.给从数据库授权</h4> 
<pre><code class="prism language-java">mysql<span class="token operator">&gt;</span><span class="token constant">GRANT</span> <span class="token constant">REPLICATION</span> <span class="token constant">SLAVE</span> <span class="token constant">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span>* <span class="token constant">TO</span> <span class="token char">'user'</span>@'<span class="token number">192.168</span><span class="token number">.2</span><span class="token number">.14</span>' <span class="token constant">IDENTIFIED</span> <span class="token constant">BY</span> <span class="token char">'123456'</span><span class="token punctuation">;</span>（指定ip）
或者
mysql<span class="token operator">&gt;</span><span class="token constant">GRANT</span> <span class="token constant">REPLICATION</span> <span class="token constant">SLAVE</span> <span class="token constant">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span>* <span class="token keyword">to</span> <span class="token char">'user'</span>@<span class="token char">'%'</span> identified by <span class="token char">'123456'</span><span class="token punctuation">;</span>（所有ip）
</code></pre> 
<ul><li>mysql5.7可以直接执行，如果是Mysql8版本，可以参考这里 <a href="https://blog.csdn.net/qq_38388677/article/details/116985689?spm=1001.2101.3001.6650.2&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.no_search_link">mysql 8.0.21 对用户授权报错</a> <a href="https://blog.csdn.net/hxpjava1/article/details/86688662">新版Mysql授权报错</a></li><li><code>'user'@'192.168.99.100'</code> – user是指定从数据库用户名，ip是从服务器主机ip，这里就是本机局域网ip</li><li><code>123456</code> – Mysql登陆密码</li></ul> 
<h4><a id="4_133"></a>4.查询主数据库状态信息</h4> 
<pre><code class="prism language-java">mysql<span class="token operator">&gt;</span> show master status<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token class-name">File</span>             <span class="token operator">|</span> <span class="token class-name">Position</span> <span class="token operator">|</span> <span class="token class-name">Binlog_Do_DB</span> <span class="token operator">|</span> <span class="token class-name">Binlog_Ignore_DB</span> <span class="token operator">|</span> <span class="token class-name">Executed_Gtid_Set</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> mysql<span class="token operator">-</span>bin<span class="token punctuation">.</span><span class="token number">000003</span> <span class="token operator">|</span>     <span class="token number">137</span> <span class="token operator">|</span>              <span class="token operator">|</span>                  <span class="token operator">|</span>                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">1</span> row in set <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<ul><li><code>File</code> ,<code>Position</code> 和主数据库<code>对外端口</code> <mark>Port:17717</mark> 是关键值，需要记录</li><li>主库千万不要再做任何操作，防止状态改变</li></ul> 
<h3><a id="mysqlslave_146"></a>进入mysql-slave操作</h3> 
<h4><a id="1_147"></a>1.点击<code>&gt;-</code>按钮进入从数据库内部</h4> 
<h4><a id="2123456_148"></a>2.登陆数据库，密码123456</h4> 
<h4><a id="3_149"></a>3.与主库进行连结：</h4> 
<pre><code class="prism language-java">mysql<span class="token operator">&gt;</span> change master <span class="token keyword">to</span>
<span class="token namespace">master_host</span><span class="token operator">=</span>'<span class="token number">192.168</span><span class="token number">.2</span><span class="token number">.14</span>'<span class="token punctuation">,</span>
master_user<span class="token operator">=</span><span class="token char">'user'</span><span class="token punctuation">,</span>
master_log_file<span class="token operator">=</span>'mysql<span class="token operator">-</span>bin<span class="token punctuation">.</span><span class="token number">000003</span>'<span class="token punctuation">,</span>
master_log_pos<span class="token operator">=</span><span class="token number">137</span><span class="token punctuation">,</span>
master_port<span class="token operator">=</span><span class="token number">17717</span><span class="token punctuation">,</span>
master_password<span class="token operator">=</span><span class="token char">'123456'</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li><code>master_host</code> – 主库IP地址，这里就是本机IP</li><li><code>master_user</code> – 连结主库使用的用户名，就是刚才授权的用户名</li><li><code>master_log_file</code> – 刚才需要记录的主库的File值</li><li><code>master_log_pos</code> – 刚次需要记录的主库的Position值</li><li><code>master_port</code> – 主库的外端口</li><li><code>master_password='123456';</code> – 主库密码，分号结束</li></ul> 
<h4><a id="4_166"></a>4.启动</h4> 
<pre><code class="prism language-java">mysql<span class="token operator">&gt;</span> start slave<span class="token punctuation">;</span><span class="token comment">// 启动从服务器复制功能</span>
</code></pre> 
<h4><a id="5_170"></a>5.检查是否启动成功</h4> 
<pre><code class="prism language-css">mysql&gt; show slave status\G
*************************** 1. row ***************************
               <span class="token property">Slave_IO_State</span><span class="token punctuation">:</span> Waiting for master to send event
                  <span class="token property">Master_Host</span><span class="token punctuation">:</span> 192.168.2.14
                  <span class="token property">Master_User</span><span class="token punctuation">:</span> user
                  <span class="token property">Master_Port</span><span class="token punctuation">:</span> 32768
                <span class="token property">Connect_Retry</span><span class="token punctuation">:</span> 60
              <span class="token property">Master_Log_File</span><span class="token punctuation">:</span> mysql-bin.000003
          <span class="token property">Read_Master_Log_Pos</span><span class="token punctuation">:</span> 1338
               <span class="token property">Relay_Log_File</span><span class="token punctuation">:</span> 8d1e3b87d499-relay-bin.000002
                <span class="token property">Relay_Log_Pos</span><span class="token punctuation">:</span> 1221
        <span class="token property">Relay_Master_Log_File</span><span class="token punctuation">:</span> mysql-bin.000003
             <span class="token property">Slave_IO_Running</span><span class="token punctuation">:</span> Yes 
            <span class="token property">Slave_SQL_Running</span><span class="token punctuation">:</span> Yes
              <span class="token property">Replicate_Do_DB</span><span class="token punctuation">:</span> 
              ...
1 row in set <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>
</code></pre> 
<ul><li>可以看到很多刚才配置过的信息</li><li><code>Slave_IO_Running</code> / <code>Slave_SQL_Running</code> – 都为Yes是表示启动成功，其他值都不成功</li><li><code>Replicate_Do_DB</code> – 空表示所有库</li></ul> 
<h2><a id="_194"></a>测试</h2> 
<h3><a id="master_195"></a>进入master容器</h3> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">create</span> <span class="token keyword">database</span> mytest<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">Database</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> mytest             <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">use</span> mytest
<span class="token keyword">Database</span> changed
mysql<span class="token operator">&gt;</span>  <span class="token keyword">create</span> <span class="token keyword">table</span> demo<span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.04</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> demo <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'uname'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> demo<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------+-----------+</span>
<span class="token operator">|</span> id   <span class="token operator">|</span> name      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-----------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span>   uname   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-----------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre> 
<h3><a id="slave_226"></a>进入slave容器</h3> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token operator">|</span> <span class="token keyword">Database</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> mytest             <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">use</span> mytest
<span class="token keyword">Database</span> changed
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> demo<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------+-----------+</span>
<span class="token operator">|</span> id   <span class="token operator">|</span> name      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-----------+</span>
<span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span> uname     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------+-----------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<ul><li>测试成功</li></ul> 
<h2><a id="Mycat_252"></a>配置读写分离Mycat</h2> 
<div class="mermaid"> 
 <svg id="mermaid-svg-sxg8eW33Faab9l70" width="271.25" xmlns="http://www.w3.org/2000/svg" height="341" viewbox="0 0 271.25 341" class="mermaid-svg"> 
  <style>#mermaid-svg-sxg8eW33Faab9l70 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-sxg8eW33Faab9l70 .error-icon{fill:#552222;}#mermaid-svg-sxg8eW33Faab9l70 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-sxg8eW33Faab9l70 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-sxg8eW33Faab9l70 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-sxg8eW33Faab9l70 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-sxg8eW33Faab9l70 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-sxg8eW33Faab9l70 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-sxg8eW33Faab9l70 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-sxg8eW33Faab9l70 .marker.cross{stroke:#333333;}#mermaid-svg-sxg8eW33Faab9l70 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-sxg8eW33Faab9l70 g.classGroup text{fill:#9370DB;fill:#131300;stroke:none;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:10px;}#mermaid-svg-sxg8eW33Faab9l70 g.classGroup text .title{font-weight:bolder;}#mermaid-svg-sxg8eW33Faab9l70 .nodeLabel,#mermaid-svg-sxg8eW33Faab9l70 .edgeLabel{color:#131300;}#mermaid-svg-sxg8eW33Faab9l70 .edgeLabel .label rect{fill:#ECECFF;}#mermaid-svg-sxg8eW33Faab9l70 .label text{fill:#131300;}#mermaid-svg-sxg8eW33Faab9l70 .edgeLabel .label span{background:#ECECFF;}#mermaid-svg-sxg8eW33Faab9l70 .classTitle{font-weight:bolder;}#mermaid-svg-sxg8eW33Faab9l70 .node rect,#mermaid-svg-sxg8eW33Faab9l70 .node circle,#mermaid-svg-sxg8eW33Faab9l70 .node ellipse,#mermaid-svg-sxg8eW33Faab9l70 .node polygon,#mermaid-svg-sxg8eW33Faab9l70 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-sxg8eW33Faab9l70 .divider{stroke:#9370DB;stroke:1;}#mermaid-svg-sxg8eW33Faab9l70 g.clickable{cursor:pointer;}#mermaid-svg-sxg8eW33Faab9l70 g.classGroup rect{fill:#ECECFF;stroke:#9370DB;}#mermaid-svg-sxg8eW33Faab9l70 g.classGroup line{stroke:#9370DB;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5;}#mermaid-svg-sxg8eW33Faab9l70 .classLabel .label{fill:#9370DB;font-size:10px;}#mermaid-svg-sxg8eW33Faab9l70 .relation{stroke:#333333;stroke-width:1;fill:none;}#mermaid-svg-sxg8eW33Faab9l70 .dashed-line{stroke-dasharray:3;}#mermaid-svg-sxg8eW33Faab9l70 #compositionStart,#mermaid-svg-sxg8eW33Faab9l70 .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #compositionEnd,#mermaid-svg-sxg8eW33Faab9l70 .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #dependencyStart,#mermaid-svg-sxg8eW33Faab9l70 .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #dependencyStart,#mermaid-svg-sxg8eW33Faab9l70 .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #extensionStart,#mermaid-svg-sxg8eW33Faab9l70 .extension{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #extensionEnd,#mermaid-svg-sxg8eW33Faab9l70 .extension{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #aggregationStart,#mermaid-svg-sxg8eW33Faab9l70 .aggregation{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 #aggregationEnd,#mermaid-svg-sxg8eW33Faab9l70 .aggregation{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-svg-sxg8eW33Faab9l70 .edgeTerminals{font-size:11px;}#mermaid-svg-sxg8eW33Faab9l70 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style> 
  <g transform="translate(0, 0)"> 
   <defs> 
    <marker id="classDiagram-aggregationStart" class="marker aggregation classDiagram" refx="0" refy="7" markerwidth="190" markerheight="240" orient="auto"> 
     <path d="M 18,7 L9,13 L1,7 L9,1 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-aggregationEnd" class="marker aggregation classDiagram" refx="19" refy="7" markerwidth="20" markerheight="28" orient="auto"> 
     <path d="M 18,7 L9,13 L1,7 L9,1 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-extensionStart" class="marker extension classDiagram" refx="0" refy="7" markerwidth="190" markerheight="240" orient="auto"> 
     <path d="M 1,7 L18,13 V 1 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-extensionEnd" class="marker extension classDiagram" refx="19" refy="7" markerwidth="20" markerheight="28" orient="auto"> 
     <path d="M 1,1 V 13 L18,7 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-compositionStart" class="marker composition classDiagram" refx="0" refy="7" markerwidth="190" markerheight="240" orient="auto"> 
     <path d="M 18,7 L9,13 L1,7 L9,1 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-compositionEnd" class="marker composition classDiagram" refx="19" refy="7" markerwidth="20" markerheight="28" orient="auto"> 
     <path d="M 18,7 L9,13 L1,7 L9,1 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-dependencyStart" class="marker dependency classDiagram" refx="0" refy="7" markerwidth="190" markerheight="240" orient="auto"> 
     <path d="M 5,7 L9,13 L1,7 L9,1 Z"></path> 
    </marker> 
   </defs> 
   <defs> 
    <marker id="classDiagram-dependencyEnd" class="marker dependency classDiagram" refx="19" refy="7" markerwidth="20" markerheight="28" orient="auto"> 
     <path d="M 18,7 L9,13 L14,7 L9,1 Z"></path> 
    </marker> 
   </defs> 
   <g class="root"> 
    <g class="clusters"></g> 
    <g class="edgePaths"> 
     <path d="M138.2890625,73L138.2890625,77.16666666666667C138.2890625,81.33333333333333,138.2890625,89.66666666666667,138.2890625,98C138.2890625,106.33333333333333,138.2890625,114.66666666666667,138.2890625,118.83333333333333L138.2890625,123" id="id1" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#classDiagram-dependencyEnd)"></path> 
     <path d="M108.1171875,178.2339271089271L100.42708333333333,184.02827259077262C92.73697916666667,189.82261807261807,77.35677083333333,201.41130903630904,69.66666666666667,211.3723211848212C61.9765625,221.33333333333334,61.9765625,229.66666666666666,61.9765625,233.83333333333334L61.9765625,238" id="id2" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#classDiagram-dependencyEnd)"></path> 
     <path d="M168.4609375,178.2339271089271L176.15104166666666,184.02827259077262C183.84114583333334,189.82261807261807,199.22135416666666,201.41130903630904,206.91145833333334,211.3723211848212C214.6015625,221.33333333333334,214.6015625,229.66666666666666,214.6015625,233.83333333333334L214.6015625,238" id="id3" class="  edge-pattern-solid relation" style="fill:none" marker-end="url(#classDiagram-dependencyEnd)"></path> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel"> 
      <g class="label" transform="translate(0, 0)"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="edgeLabel"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel"> 
      <g class="label" transform="translate(0, 0)"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="edgeLabel"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel"> 
      <g class="label" transform="translate(0, 0)"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="edgeLabel"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" id="classid-java-8" transform="translate(138.2890625, 40.5)"> 
      <rect class="outer title-state" x="-23.1796875" y="-32.5" width="46.359375" height="65"></rect> 
      <line class="divider" x1="-23.1796875" x2="23.1796875" y1="5.5" y2="5.5"></line> 
      <line class="divider" x1="-23.1796875" x2="23.1796875" y1="21.5" y2="21.5"></line> 
      <g class="label"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel"></span> 
        </div> 
       </foreignobject> 
       <foreignobject class="classTitle" width="31.359375" height="26" transform="translate( -15.6796875, -25)"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel">java</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="node default" id="classid-mycat-9" transform="translate(138.2890625, 155.5)"> 
      <rect class="outer title-state" x="-30.171875" y="-32.5" width="60.34375" height="65"></rect> 
      <line class="divider" x1="-30.171875" x2="30.171875" y1="5.5" y2="5.5"></line> 
      <line class="divider" x1="-30.171875" x2="30.171875" y1="21.5" y2="21.5"></line> 
      <g class="label"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel"></span> 
        </div> 
       </foreignobject> 
       <foreignobject class="classTitle" width="45.34375" height="26" transform="translate( -22.671875, -25)"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel">mycat</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="node default" id="classid-mysqlMaster-10" transform="translate(61.9765625, 285.5)"> 
      <rect class="outer title-state" x="-53.9765625" y="-47.5" width="107.953125" height="95"></rect> 
      <line class="divider" x1="-53.9765625" x2="53.9765625" y1="-9.5" y2="-9.5"></line> 
      <line class="divider" x1="-53.9765625" x2="53.9765625" y1="36.5" y2="36.5"></line> 
      <g class="label"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel"></span> 
        </div> 
       </foreignobject> 
       <foreignobject class="classTitle" width="92.953125" height="26" transform="translate( -46.4765625, -40)"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel">mysqlMaster</span> 
        </div> 
       </foreignobject> 
       <foreignobject width="64" height="26" transform="translate( -46.4765625, 2)"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel">数据写入</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="node default" id="classid-mysqlSlave-11" transform="translate(214.6015625, 285.5)"> 
      <rect class="outer title-state" x="-48.6484375" y="-47.5" width="97.296875" height="95"></rect> 
      <line class="divider" x1="-48.6484375" x2="48.6484375" y1="-9.5" y2="-9.5"></line> 
      <line class="divider" x1="-48.6484375" x2="48.6484375" y1="36.5" y2="36.5"></line> 
      <g class="label"> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel"></span> 
        </div> 
       </foreignobject> 
       <foreignobject class="classTitle" width="82.296875" height="26" transform="translate( -41.1484375, -40)"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel">mysqlSlave</span> 
        </div> 
       </foreignobject> 
       <foreignobject width="64" height="26" transform="translate( -41.1484375, 2)"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span class="nodeLabel">数据读取</span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<h3><a id="1_267"></a>1.拉取镜像</h3> 
<h3><a id="2_268"></a>2.手写配置项目</h3> 
<h3><a id="3v_269"></a>3.将配置项通过<code>-v</code>挂载的方式启动容器</h3> 
<h3><a id="4navicat_270"></a>4.navicat测试</h3> 
<blockquote> 
 <p>具体参考 https://www.cnblogs.com/konglingxi/p/14808850.html</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9908c39cbae2c7176e131fafca524ea9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Matlab（R2014a版本）一阶、二阶系统响应</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d9514ebee6fe2fa870624760deb9af7f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Conda常用命令</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>