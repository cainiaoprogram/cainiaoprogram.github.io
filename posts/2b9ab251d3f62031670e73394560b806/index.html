<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Wargames与bash知识12 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Wargames与bash知识12" />
<meta property="og:description" content="Wargames与bash知识12 Bandit20 关卡提示：
主目录中有一个setuid二进制文件，它执行以下操作：它在您指定为命令行参数的端口上连接到localhost。然后，它从连接中读取一行文本，并将其与前一级别的密码（bandit20）进行比较。如果密码正确，它将传输下一级别（bandit21）的密码。
注意：试着连接到您自己的网络守护程序，看看它是否如您所想的那样工作
推荐命令：
ssh, nc, cat, bash, screen, tmux, Unix ‘job control’ (bg, fg, jobs, &amp;, CTRL-Z, …)
有没有觉得的这个关卡有点眼熟：某个关卡我们使用nc给一个端口（好像是30000）发送一个字符串，然后服务器给回复一个密码。这个关卡是展现服务器端是如何实现的吧，不过细究的还有有很大的区别：那个关卡回复是自动的，但在这个关卡我们需要手动运行一个程序才能实现。
Nc的命令前面已经谈过了，就不再复述。
解决这个问题需要使用两个终端，咱们继续使用windows的wls2子系统unbuntu来做演示。
使用ssh登录服务器
g
yj@guyanjun:~$ ssh -l bandit20 -p 2220 bandit.labs.overthewire.org The authenticity of host &#39;[bandit.labs.overthewire.org]:2220 ([51.20.13.48]:2220)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:IJ7FrX0mKSSHTJ63ezxjqtnOE0Hg116Aq&#43;v5mN0&#43;HdE. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;[bandit.labs.overthewire.org]:2220,[51.20.13.48]:2220&#39; (ECDSA) to the list of known hosts. _ _ _ _ | |__ __ _ _ __ __| (_) |_ | &#39;_ \ / _` | &#39;_ \ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2b9ab251d3f62031670e73394560b806/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-09T12:10:16+08:00" />
<meta property="article:modified_time" content="2024-01-09T12:10:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Wargames与bash知识12</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Wargamesbash12_0"></a>Wargames与bash知识12</h3> 
<h3><a id="Bandit20_2"></a>Bandit20</h3> 
<p>关卡提示：<br> 主目录中有一个setuid二进制文件，它执行以下操作：它在您指定为命令行参数的端口上连接到localhost。然后，它从连接中读取一行文本，并将其与前一级别的密码（bandit20）进行比较。如果密码正确，它将传输下一级别（bandit21）的密码。<br> 注意：试着连接到您自己的网络守护程序，看看它是否如您所想的那样工作</p> 
<p>推荐命令：<br> ssh, nc, cat, bash, screen, tmux, Unix ‘job control’ (bg, fg, jobs, &amp;, CTRL-Z, …)</p> 
<p>有没有觉得的这个关卡有点眼熟：某个关卡我们使用nc给一个端口（好像是30000）发送一个字符串，然后服务器给回复一个密码。这个关卡是展现服务器端是如何实现的吧，不过细究的还有有很大的区别：那个关卡回复是自动的，但在这个关卡我们需要手动运行一个程序才能实现。<br> Nc的命令前面已经谈过了，就不再复述。<br> 解决这个问题需要使用两个终端，咱们继续使用windows的wls2子系统unbuntu来做演示。</p> 
<p>使用ssh登录服务器<br> g</p> 
<pre><code class="prism language-bash">yj@guyanjun:~$ <span class="token function">ssh</span> <span class="token parameter variable">-l</span> bandit20 <span class="token parameter variable">-p</span> <span class="token number">2220</span> bandit.labs.overthewire.org
The authenticity of <span class="token function">host</span> <span class="token string">'[bandit.labs.overthewire.org]:2220 ([51.20.13.48]:2220)'</span> can<span class="token string">'t be established.
ECDSA key fingerprint is SHA256:IJ7FrX0mKSSHTJ63ezxjqtnOE0Hg116Aq+v5mN0+HdE.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="token punctuation">[</span>bandit.labs.overthewire.org<span class="token punctuation">]</span>:2220,<span class="token punctuation">[</span><span class="token number">51.20</span>.13.48<span class="token punctuation">]</span>:2220<span class="token string">' (ECDSA) to the list of known hosts.
                         _                     _ _ _
                        | |__   __ _ _ __   __| (_) |_
                        | '</span>_ <span class="token punctuation">\</span> / _<span class="token variable"><span class="token variable">`</span> <span class="token operator">|</span> '_ <span class="token punctuation">\</span> / _<span class="token variable">`</span></span> <span class="token operator">|</span> <span class="token operator">|</span> __<span class="token operator">|</span>
                        <span class="token operator">|</span> <span class="token operator">|</span>_<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>_
                        <span class="token operator">|</span>_.__/ <span class="token punctuation">\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span> <span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>__,_<span class="token operator">|</span>_<span class="token operator">|</span><span class="token punctuation">\</span>__<span class="token operator">|</span>


                      This is an OverTheWire game server.
            More information on http://www.overthewire.org/wargames
           ………
</code></pre> 
<p>运行命令获得相关信息：</p> 
<pre><code class="prism language-bash">bandit20@bandit:~$ ./suconnect
Usage: ./suconnect <span class="token operator">&lt;</span>portnumber<span class="token operator">&gt;</span>
This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back.
</code></pre> 
<p>使用左边的终端向端口11000发送字符串（端口可以自行指定，注意不要使用知名端口），使用右边的终端运行./suconnect 11000命令获得所需密码</p> 
<p><img src="https://images2.imgbox.com/f0/e3/7xkspw3Z_o.png" alt="在这里插入图片描述"></p> 
<p>现在尝试发送一个错误是字符串看看会有什么报错</p> 
<p><img src="https://images2.imgbox.com/1d/c6/bqKRLWId_o.png" alt="在这里插入图片描述"></p> 
<p>如果不喜欢使用的两个终端，可以尝试将nc放入后台</p> 
<p>b</p> 
<pre><code class="prism language-bash">andit20@bandit:~$ <span class="token function">nc</span> <span class="token parameter variable">-l</span> <span class="token number">11000</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"VxCazJaVykI6W36BkBU0mJTCM8rR95XT"</span> <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">383771</span>
bandit20@bandit:~$ ./suconnect <span class="token number">11000</span>
Read: VxCazJaVykI6W36BkBU0mJTCM8rR95XT
Password matches, sending next password
NvEJF7oVjkddltPSrdKEFOllh9V1IBcq
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>+  Done                    <span class="token function">nc</span> <span class="token parameter variable">-l</span> <span class="token number">11000</span> <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"VxCazJaVykI6W36BkBU0mJTCM8rR95XT"</span>
bandit20@bandit:~$
</code></pre> 
<p>将linux命令放入后台的方法很简单，直接在命令结尾添加一个 &amp; 符号。为演示效果，我使用while做了一个死循环。</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token keyword">while</span> <span class="token boolean">true</span> <span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span> <span class="token keyword">done</span> <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">693</span>
</code></pre> 
<p>返回的信息：1 是任务后 693是进程号<br> 可以使用jobs 查看后台运行的命令</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token function">jobs</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>+  运行中               <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span> <span class="token operator">&amp;</span>
</code></pre> 
<p>可以使用kill %1或者 kill 693 “杀死”后台进程</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token function">kill</span> %1
gyj@guyanjun:~$ <span class="token function">jobs</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>+  已终止               <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span>
</code></pre> 
<p>使用fg 任务号将命令放回前台</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token function">fg</span>
<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span>
</code></pre> 
<p>使用crtl-z 将命令暂停且放入后台</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token function">fg</span>
<span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span>
^Z
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>+  已停止               <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span>
</code></pre> 
<p>使用bg %1 恢复后台暂停的命令，使其在后台运行</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token function">bg</span> %1
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>+ <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span> <span class="token operator">&amp;</span>
</code></pre> 
<p>这个技巧可以解决命令忘记放入后台的情况。</p> 
<p>使用&amp;将命令放入后台，如果关闭了shell终端，后台的命令也会退出。为了解决这个问题，可以使用 nohup命令</p> 
<pre><code class="prism language-bash">gyj@guyanjun:~$ <span class="token function">nohup</span> <span class="token function">sleep</span> <span class="token number">2000</span> <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token number">1261</span>
gyj@guyanjun:~$ nohup: 忽略输入并把输出追加到<span class="token string">'nohup.out'</span>

gyj@guyanjun:~$ <span class="token function">nohup</span> <span class="token function">sleep</span> <span class="token number">3000</span> <span class="token operator">&gt;</span>aa.out <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token number">1264</span>
gyj@guyanjun:~$ nohup: 忽略输入重定向错误到标准输出端

gyj@guyanjun:~$ <span class="token function">nohup</span> <span class="token function">sleep</span> <span class="token number">3000</span> <span class="token operator">&amp;&gt;</span>aa.out <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token number">1265</span>

gyj@guyanjun:~$ <span class="token function">jobs</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>   运行中               <span class="token keyword">while</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token function">sleep</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token keyword">done</span> <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>   运行中               <span class="token function">nohup</span> <span class="token function">sleep</span> <span class="token number">2000</span> <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>-  运行中               <span class="token function">nohup</span> <span class="token function">sleep</span> <span class="token number">3000</span> <span class="token operator">&gt;</span> aa.out <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>+  运行中               <span class="token function">nohup</span> <span class="token function">sleep</span> <span class="token number">3000</span> <span class="token operator">&amp;&gt;</span> aa.out <span class="token operator">&amp;</span>
gyj@guyanjun:~$
</code></pre> 
<p>请注意使用nohup需要将后台的进程的输出处理一下，shell退出以后，后台程序原本输出到屏幕的输出就无处可去了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/39bbf9c1486e890d02a30a95502d944e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二叉树与堆的深度解析：数据结构中的关键概念及应用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bcd0e7fe95745c7fb307bf4d4565e733/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【送书福利-第三十二期】《FFmpeg 音视频开发基础与实战》</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>