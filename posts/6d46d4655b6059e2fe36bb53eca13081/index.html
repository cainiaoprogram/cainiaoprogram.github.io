<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HTML&#43;JS&#43;CSS歌词滚动效果 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HTML&#43;JS&#43;CSS歌词滚动效果" />
<meta property="og:description" content="代码下载：【免费】HTML&#43;JS&#43;CSS歌词滚动效果资源-CSDN文库 一些代码说明： 初始化歌词数据和时间字符串转换为秒数： // 初始化歌词数据 const initWords = () =&gt; { let lines = lrc.split(&#39;\n&#39;); let res = []; lines.forEach(item =&gt; { let parts = item.split(&#39;]&#39;); let timeStr = parts[0].substring(1); let obj = { time: parseTime(timeStr), // 调用 parseTime 函数将时间字符串转换为秒数 words: parts[1] }; res.push(obj); }); return res; }; // 时间字符串转换为秒数 const parseTime = (timeStr) =&gt; { let parts = timeStr.split(&#39;:&#39;); let time = &#43;parts[0] * 60 &#43; &#43;parts[1]; return time; }; let lrcData = initWords(); // 调用初始化歌词数据函数 获取当前显示歌词下标： // 得到当前显示歌词下标 const findIndex = () =&gt; { let curTime = doms." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/6d46d4655b6059e2fe36bb53eca13081/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-11T16:33:30+08:00" />
<meta property="article:modified_time" content="2024-01-11T16:33:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HTML&#43;JS&#43;CSS歌词滚动效果</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="background-color:transparent;">代码下载：<a href="https://download.csdn.net/download/xhc6666/88729421?spm=1001.2014.3001.5503" title="【免费】HTML+JS+CSS歌词滚动效果资源-CSDN文库">【免费】HTML+JS+CSS歌词滚动效果资源-CSDN文库</a></h2> 
<h2>一些代码说明：</h2> 
<h3> 初始化歌词数据和时间字符串转换为秒数：</h3> 
<pre><code class="language-javascript">// 初始化歌词数据
const initWords = () =&gt; {
  let lines = lrc.split('\n');
  let res = [];
  lines.forEach(item =&gt; {
    let parts = item.split(']');
    let timeStr = parts[0].substring(1);
    let obj = {
      time: parseTime(timeStr), // 调用 parseTime 函数将时间字符串转换为秒数
      words: parts[1]
    };
    res.push(obj);
  });
  return res;
};

// 时间字符串转换为秒数
const parseTime = (timeStr) =&gt; {
  let parts = timeStr.split(':');
  let time = +parts[0] * 60 + +parts[1];
  return time;
};

let lrcData = initWords(); // 调用初始化歌词数据函数
</code></pre> 
<h3>获取当前显示歌词下标：</h3> 
<pre><code class="language-javascript">// 得到当前显示歌词下标
const findIndex = () =&gt; {
  let curTime = doms.audio.currentTime;
  for (let i = 0; i &lt; lrcData.length; i++) {
    if (curTime &lt; lrcData[i].time) {
      return i - 1;
    }
  }
  return lrcData.length - 1;
};
</code></pre> 
<h3>歌词元素显示：</h3> 
<pre><code class="language-javascript">// 歌词元素显示
const creatLrcElements = () =&gt; {
  let frag = document.createDocumentFragment(); // 创建文档片段
  for (let i = 0; i &lt; lrcData.length; i++) {
    let li = document.createElement('li');
    li.textContent = lrcData[i].words;
    frag.appendChild(li);
  }
  doms.ul.appendChild(frag); // 将文档片段添加到 ul 元素中
};
creatLrcElements();
</code></pre> 
<h3>设置偏移和滚动事件监听器：</h3> 
<pre><code class="language-javascript">// 设置偏移
const setOffset = () =&gt; {
  let index = findIndex();
  let offset = liHeight * index + liHeight / 2 - containerHeight / 2;
  if (offset &lt; 0) {
    offset = 0;
  } else if (offset &gt; maxHeight) {
    offset = maxHeight;
  }
  doms.ul.style.transform = `translateY(-${offset}px)`;

  let li = doms.ul.querySelector('.active');
  if (li) {
    li.classList.remove('active');
  }
  li = doms.ul.children[index];
  if (li) {
    li.classList.add('active');
  }
};

doms.audio.addEventListener('timeupdate', setOffset); // 监听音频播放时间更新事件

// 添加滚动事件监听器
doms.container.addEventListener('wheel', function(event) {
  var deltaY = event.deltaY; // 获取滚动的垂直方向位移
  doms.container.scrollTop += deltaY; // 根据滚动位移调整列表的滚动位置
  event.preventDefault(); // 阻止页面滚动
});
</code></pre> 
<p></p> 
<p>这些代码主要实现了歌词的初始化、显示和随音频播放的同步滚动。其中，<code>initWords</code> 函数用于将歌词字符串解析成数据数组，<code>parseTime</code> 函数用于将时间字符串转换为秒数。通过 <code>setOffset</code> 函数实现歌词的滚动和高亮显示。最后，添加了一个滚动事件监听器，以便用户通过滚动调整歌词显示位置。</p> 
<p></p> 
<h2 style="background-color:transparent;">注意：</h2> 
<p>文章说明：该功能是根据“渡一前端”视频敲出来的，并不属于原创，但是转载或是翻译的连接我找不到了，所以使用的原创标签，特此说明一下。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02c51bd188a6e8e21d9044623fa2c387/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【PostgreSql】本地备份为dump文件与恢复数据库（单表和整个数据库）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bfad5526d35340115ed9d757f1a56682/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">HarmonyOS4.0系统性深入开发18公共事件简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>