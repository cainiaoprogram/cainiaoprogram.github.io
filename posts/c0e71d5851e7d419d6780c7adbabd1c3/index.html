<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QT QAxWidget控件 使用详解 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QT QAxWidget控件 使用详解" />
<meta property="og:description" content="本文详细的介绍了QAxWidget控件的各种操作，例如：新建界面、使用示例、显示网页、显示pdf、显示Off、源文件详细说明其它文章等等操作。
ActiveX控件是一种可重用的二进制组件，用于在Windows操作系统上提供特定的功能和服务。以下是一些常见的ActiveX控件的示例：1. Internet Explorer Web Browser Control：用于在应用程序中嵌入和显示Web浏览器。2. Microsoft Office组件（如Word、Excel、PowerPoint）：用于在应用程序中嵌入和操作Office文档。3. Windows Media Player Control：用于在应用程序中嵌入和播放音频和视频文件。4. Adobe Flash Player Control：用于在应用程序中嵌入和播放Flash动画和视频。5. Crystal Reports Viewer Control：用于在应用程序中显示和打印Crystal Reports报表6. Windows Common Controls（如TreeView、ListView、ProgressBar）：用于在应用程序中创建常见的用户界面控件。7. Microsoft DataGrid Control：用于在应用程序中显示和编辑数据表格。8. Microsoft Windows Image Acquisition Control：用于在应用程序中获取和处理图像。9. Microsoft Windows Media Encoder Control：用于在应用程序中进行音频和视频编码。
本系列QT全面详解文章目前共有三十八篇，本系列文章较为详细的讲述了QT控件的基础操作和使用，也谢谢大家的关注、点赞、收藏。
本文作者原创，转载请附上文章出处与本文链接。
QT QAxWidget控件 使用详解目录
1 新建界面
2 使用示例
3 显示网页
4 显示pdf
5 显示Off
6 源文件
7 详细说明
8 其它文章
1 新建界面 2 使用示例 // ui-&gt;axWidget-&gt;setControl(&#34;{8856F961-340A-11D0-A96B-00C04FD705A2}&#34;); // ui-&gt;axWidget-&gt;dynamicCall(&#34;MethodName&#34;, &#34;123&#34;, &#34;hello&#34;); // QVariant value = ui-&gt;axWidget-&gt;dynamicCall(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c0e71d5851e7d419d6780c7adbabd1c3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-13T23:45:00+08:00" />
<meta property="article:modified_time" content="2023-09-13T23:45:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QT QAxWidget控件 使用详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        本文详细的介绍了QAxWidget控件的各种操作，例如：<a href="https://blog.csdn.net/qq_37529913/article/details/132706110#1%20%E6%96%B0%E5%BB%BA%E7%95%8C%E9%9D%A2" title="新建界面">新建界面</a>、<a href="#2%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B" rel="nofollow">使用示例</a>、<a href="#3%20%E6%98%BE%E7%A4%BA%E7%BD%91%E9%A1%B5" rel="nofollow">显示网页</a>、<a href="#4%20%E6%98%BE%E7%A4%BApdf" rel="nofollow">显示pdf</a>、<a href="#5%20%E6%98%BE%E7%A4%BAOff" rel="nofollow">显示Off</a>、<a href="#6%20%E6%BA%90%E6%96%87%E4%BB%B6" rel="nofollow">源文件</a><a href="https://blog.csdn.net/qq_37529913/article/details/132706110#6%20%E5%AD%90%E7%AA%97%E5%8F%A3%E7%BA%A7%E8%81%94%E6%8E%92%E5%88%97" title="子窗口级联排列、"></a><a href="#7%20%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E" rel="nofollow">详细说明</a><a href="https://blog.csdn.net/qq_37529913/article/details/132706110#7%20%E5%AD%90%E7%AA%97%E5%8F%A3%E5%B9%B3%E9%93%BA%E6%8E%92%E5%88%97" title="子窗口平铺排列、"></a>其它文章等等操作。</p> 
<p>        ActiveX控件是一种可重用的二进制组件，用于在Windows操作系统上提供特定的功能和服务。以下是一些常见的ActiveX控件的示例：1. Internet Explorer Web Browser Control：用于在应用程序中嵌入和显示Web浏览器。2. Microsoft Office组件（如Word、Excel、PowerPoint）：用于在应用程序中嵌入和操作Office文档。3. Windows Media Player Control：用于在应用程序中嵌入和播放音频和视频文件。4. Adobe Flash Player Control：用于在应用程序中嵌入和播放Flash动画和视频。5. Crystal Reports Viewer Control：用于在应用程序中显示和打印Crystal Reports报表6. Windows Common Controls（如TreeView、ListView、ProgressBar）：用于在应用程序中创建常见的用户界面控件。7. Microsoft DataGrid Control：用于在应用程序中显示和编辑数据表格。8. Microsoft Windows Image Acquisition Control：用于在应用程序中获取和处理图像。9. Microsoft Windows Media Encoder Control：用于在应用程序中进行音频和视频编码。</p> 
<p>        本系列QT全面详解文章目前共有三十八篇，本系列文章较为详细的讲述了QT控件的基础操作和使用，也谢谢大家的关注、点赞、收藏。</p> 
<p><img alt="" height="1051" src="https://images2.imgbox.com/29/0c/vwm1NYjL_o.png" width="1000"></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"> <strong><u>本文作者原创，转载请附上文章出处与本文链接。</u></strong></span></p> 
</blockquote> 
<p id="main-toc"><strong>QT QAxWidget控件 使用详解目录</strong></p> 
<p id="1%20%E6%96%B0%E5%BB%BA%E7%95%8C%E9%9D%A2-toc" style="margin-left:0px;"><a href="#1%20%E6%96%B0%E5%BB%BA%E7%95%8C%E9%9D%A2" rel="nofollow">1 新建界面</a></p> 
<p id="2%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B-toc" style="margin-left:0px;"><a href="#2%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B" rel="nofollow">2 使用示例</a></p> 
<p id="3%20%E6%98%BE%E7%A4%BA%E7%BD%91%E9%A1%B5-toc" style="margin-left:0px;"><a href="#3%20%E6%98%BE%E7%A4%BA%E7%BD%91%E9%A1%B5" rel="nofollow">3 显示网页</a></p> 
<p id="4%20%E6%98%BE%E7%A4%BApdf-toc" style="margin-left:0px;"><a href="#4%20%E6%98%BE%E7%A4%BApdf" rel="nofollow">4 显示pdf</a></p> 
<p id="5%20%E6%98%BE%E7%A4%BAOff-toc" style="margin-left:0px;"><a href="#5%20%E6%98%BE%E7%A4%BAOff" rel="nofollow">5 显示Off</a></p> 
<p id="6%20%E6%BA%90%E6%96%87%E4%BB%B6-toc" style="margin-left:0px;"><a href="#6%20%E6%BA%90%E6%96%87%E4%BB%B6" rel="nofollow">6 源文件</a></p> 
<p id="7%20%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E-toc" style="margin-left:0px;"><a href="#7%20%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E" rel="nofollow">7 详细说明</a></p> 
<p id="8%20%E5%85%B6%E5%AE%83%E6%96%87%E7%AB%A0-toc" style="margin-left:0px;"><a href="#8%20%E5%85%B6%E5%AE%83%E6%96%87%E7%AB%A0" rel="nofollow">8 其它文章</a></p> 
<hr id="hr-toc"> 
<h2 id="1%20%E6%96%B0%E5%BB%BA%E7%95%8C%E9%9D%A2">1 新建界面</h2> 
<p><img alt="" height="683" src="https://images2.imgbox.com/4d/43/k5CdcAib_o.png" width="1200"></p> 
<h2 id="2%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B">2 使用示例</h2> 
<pre><code class="language-cpp">//    ui-&gt;axWidget-&gt;setControl("{8856F961-340A-11D0-A96B-00C04FD705A2}");
//    ui-&gt;axWidget-&gt;dynamicCall("MethodName", "123", "hello");
//    QVariant value = ui-&gt;axWidget-&gt;dynamicCall("PropertyName");</code></pre> 
<h2 id="3%20%E6%98%BE%E7%A4%BA%E7%BD%91%E9%A1%B5">3 显示网页</h2> 
<pre><code class="language-cpp">    ui-&gt;axWidget-&gt;setControl(QString::fromUtf8("{8856F961-340A-11D0-A96B-00C04FD705A2}"));//注册组件ID
    ui-&gt;axWidget-&gt;setProperty("DisplayAlerts",false);//不显示警告信息
    ui-&gt;axWidget-&gt;setProperty("DisplayScrollBars",true);//不显示滚动条
    QString webstr=QString("www.baidu.com");//设置要打开的网页
    ui-&gt;axWidget-&gt;dynamicCall("Navigate(const QString&amp;)",webstr);//显示网页</code></pre> 
<h2 id="4%20%E6%98%BE%E7%A4%BApdf">4 显示pdf</h2> 
<pre><code class="language-cpp">//    QString msFilePath;
//    msFilePath = "D:/t.pdf";

//    mpAxWidgetPdf = new QAxWidget("AcroPDF.PDF", this-&gt;ui-&gt;widget);//Excel.Application //Adobe Acrobat Reader
//    mpAxWidgetOff = new QAxWidget("Word.Application", this-&gt;ui-&gt;widget_2);

//    // 创建一个QAxWidget对象，并设置其控制为Excel.Application
//    // 注释中提到不显示窗体，设置DisplayAlerts为false
//    mpAxWidgetPdf-&gt;dynamicCall("SetVisible (bool Visible)", "false");
//    mpAxWidgetPdf-&gt;setProperty("DisplayAlerts", true);
//    auto rect = ui-&gt;widget-&gt;geometry();
//    mpAxWidgetPdf-&gt;setGeometry(rect);
//    mpAxWidgetPdf-&gt;setControl(msFilePath);
//    mpAxWidgetPdf-&gt;show();</code></pre> 
<h2 id="5%20%E6%98%BE%E7%A4%BAOff">5 显示Off</h2> 
<pre><code class="language-cpp">//    // 创建一个QAxWidget对象，并设置其控制为Word.Application
//    // 注释中提到不显示窗体，设置DisplayAlerts为true
//    mpAxWidgetOff-&gt;dynamicCall("SetVisible (bool Visible)", "false");
//    mpAxWidgetOff-&gt;setProperty("DisplayAlerts", true);
//    rect = this-&gt;ui-&gt;widget_2-&gt;geometry();
//    mpAxWidgetOff-&gt;setGeometry(rect);
//    mpAxWidgetOff-&gt;setControl(msFilePath);
//    mpAxWidgetOff-&gt;show();</code></pre> 
<h2 id="6%20%E6%BA%90%E6%96%87%E4%BB%B6">6 源文件</h2> 
<pre><code class="language-cpp">#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include &lt;QMainWindow&gt;
#include &lt;QAxWidget&gt;

//加入GBK申明，否则中文乱码 全局使用GBK文件操作因为有中文所以使用
#pragma execution_character_set("utf-8")

QT_BEGIN_NAMESPACE
namespace Ui { class MainWindow; }
QT_END_NAMESPACE

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    MainWindow(QWidget *parent = nullptr);
    ~MainWindow();

private:
    Ui::MainWindow *ui;

    QString Title;
    QString Version;
    QString BlogText;

    QAxWidget* mpAxWidgetPdf;
    QAxWidget* mpAxWidgetOff;
};
#endif // MAINWINDOW_H
</code></pre> 
<pre><code class="language-cpp">#include "mainwindow.h"
#include "ui_mainwindow.h"
#include &lt;QDebug&gt;
#include &lt;QVariant&gt;
//#include "office.h"
MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
    , ui(new Ui::MainWindow)
{
    ui-&gt;setupUi(this);

    Title = "QT QAxWidget  CSDN 双子座断点 ";
    Version = "V 1.0 ";
    BlogText = "https://blog.csdn.net/qq_37529913?type=lately/";
    setWindowTitle(Title + Version + BlogText);

//    ui-&gt;axWidget-&gt;setControl("{8856F961-340A-11D0-A96B-00C04FD705A2}");
//    ui-&gt;axWidget-&gt;dynamicCall("MethodName", "123", "hello");
//    QVariant value = ui-&gt;axWidget-&gt;dynamicCall("PropertyName");

//    qDebug() &lt;&lt; value;


    ui-&gt;axWidget-&gt;setControl(QString::fromUtf8("{8856F961-340A-11D0-A96B-00C04FD705A2}"));//注册组件ID
    ui-&gt;axWidget-&gt;setProperty("DisplayAlerts",false);//不显示警告信息
    ui-&gt;axWidget-&gt;setProperty("DisplayScrollBars",true);//不显示滚动条
    QString webstr=QString("www.baidu.com");//设置要打开的网页
    ui-&gt;axWidget-&gt;dynamicCall("Navigate(const QString&amp;)",webstr);//显示网页

//    QString msFilePath;
//    msFilePath = "D:/t.pdf";

//    mpAxWidgetPdf = new QAxWidget("AcroPDF.PDF", this-&gt;ui-&gt;widget);//Excel.Application //Adobe Acrobat Reader
//    mpAxWidgetOff = new QAxWidget("Word.Application", this-&gt;ui-&gt;widget_2);

//    // 创建一个QAxWidget对象，并设置其控制为Excel.Application
//    // 注释中提到不显示窗体，设置DisplayAlerts为false
//    mpAxWidgetPdf-&gt;dynamicCall("SetVisible (bool Visible)", "false");
//    mpAxWidgetPdf-&gt;setProperty("DisplayAlerts", true);
//    auto rect = ui-&gt;widget-&gt;geometry();
//    mpAxWidgetPdf-&gt;setGeometry(rect);
//    mpAxWidgetPdf-&gt;setControl(msFilePath);
//    mpAxWidgetPdf-&gt;show();



//    // 创建一个QAxWidget对象，并设置其控制为Word.Application
//    // 注释中提到不显示窗体，设置DisplayAlerts为true
//    mpAxWidgetOff-&gt;dynamicCall("SetVisible (bool Visible)", "false");
//    mpAxWidgetOff-&gt;setProperty("DisplayAlerts", true);
//    rect = this-&gt;ui-&gt;widget_2-&gt;geometry();
//    mpAxWidgetOff-&gt;setGeometry(rect);
//    mpAxWidgetOff-&gt;setControl(msFilePath);
//    mpAxWidgetOff-&gt;show();




}

MainWindow::~MainWindow()
{
    delete ui;
}

</code></pre> 
<h2 id="7%20%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E">7 详细说明</h2> 
<p>    因为博主没有安装组件所以会失败，暂时没有涉及到这个的业务工作所以没有深入展开研究下去，把实现代码贴出来供参考</p> 
<p><img alt="" height="91" src="https://images2.imgbox.com/64/6a/gpF2WCFL_o.png" width="979"></p> 
<pre><code class="language-cpp">1. QVariant(Invalid)：这表示QVariant对象的值无效。可能是由于未正确初始化或设置对象的属性导致的。请确保在使用QVariant对象之前正确初始化和设置其值。

2. CoCreateInstance failure (没有注册类)：这表示无法创建指定类的实例。可能是由于未正确注册类或缺少相关的组件导致的。请确保所需的类已正确注册，并且系统中已安装了相关的组件。

3. QAxBase::setControl: requested control AcroPDF.PDF could not be instantiated：这表示无法实例化请求的控件。可能是由于控件未正确安装或未正确注册导致的。请确保所需的控件已正确安装，并且系统中已注册该控件。

4. QAxBase::dynamicCallHelper: Object is not initialized, or initialization failed：这表示对象未初始化或初始化失败。可能是由于对象的初始化过程中出现了错误或问题导致的。请确保在使用对象之前正确初始化对象，并检查初始化过程中是否有任何错误。

要解决这些问题，您可以尝试以下步骤：

1. 确保所需的控件已正确安装并注册。如果您使用的是Adobe Acrobat Reader控件来显示PDF文件，请确保已正确安装Adobe Acrobat Reader，并且系统中已注册该控件。

2. 检查代码中是否正确设置了控件的属性和参数。请确保在使用QAxWidget对象之前正确设置其属性和参数，以确保正确的初始化和实例化。

3. 确保您的应用程序具有足够的权限来访问所需的控件和组件。请检查您的应用程序的权限设置，并确保它具有访问所需控件和组件的权限</code></pre> 
<h2 id="8%20%E5%85%B6%E5%AE%83%E6%96%87%E7%AB%A0">8 其它文章</h2> 
<p>QT TextEdit控件_双子座断点的博客-CSDN博客_qt textedit</p> 
<p>QT QComboBox使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QtableView操作详解_双子座断点的博客-CSDN博客_qtableview增删改查</p> 
<p>Qt QStandardItemModel(1.超级详细用法)_双子座断点的博客-CSDN博客_qstandardmodel</p> 
<p>Qt QStandardItemModel(2.超级详细函数)_双子座断点的博客-CSDN博客_qstandarditemmodel点击事件</p> 
<p>QT QRadioButton使用详解_双子座断点的博客-CSDN博客_qt radiobutton</p> 
<p>QT QLineEdit使用详解_双子座断点的博客-CSDN博客_qt qlineedit</p> 
<p>Qt QMessageBox使用详解_双子座断点的博客-CSDN博客_qt message</p> 
<p>QChart折线图、饼状图、条形图、曲线图_双子座断点的博客-CSDN博客_qchart样式</p> 
<p>QChart属性详解_双子座断点的博客-CSDN博客_setanimationoptions</p> 
<p>QCharts QValueAxis使用_双子座断点的博客-CSDN博客_qvalueaxis</p> 
<p>Qt 5 等待提示框(开源 动态图)_双子座断点的博客-CSDN博客_qt 等待对话框</p> 
<p>QtDataVisualization 数据3D可视化_双子座断点的博客-CSDN博客_qtdatavisualizatio</p> 
<p>QT QSpinBox 整数计数器控件 使用详解_双子座断点的博客-CSDN博客<br> QT QDoubleSpinBox 浮点计数器控件(使用详解)_双子座断点的博客-CSDN博客_qdoublespinbox信号槽<br> QT QSlider、QHorizontalSlider、QVerticalSlider 控件 使用详解_双子座断点的博客-CSDN博客_qslider设置步长</p> 
<p>QT QTabWidget 控件 使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QCalendarWidget控件 使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QStackedWidget 控件 使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QVBoxLayout 垂直布局控件_双子座断点的博客-CSDN博客</p> 
<p>QT QHBoxLayout 水平布局控件_双子座断点的博客-CSDN博客<br> QT QGridLayout网格布局控件_双子座断点的博客-CSDN博客</p> 
<p>QT QVerticalSpacer 弹簧控件_双子座断点的博客-CSDN博客<br> QT QHorizontalSpacer弹簧控件_双子座断点的博客-CSDN博客<br> QT QLine 使用详解_双子座断点的博客-CSDN博客<br> QT QFontComboBox 使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QScrollArea控件 使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QToolBox控件使用详解_双子座断点的博客-CSDN博客</p> 
<p>QT QFrame控件使用详解_双子座断点的博客-CSDN博客<br><a href="https://blog.csdn.net/qq_37529913/article/details/132706110" title="QT QMdiArea控件 使用详解_双子座断点的博客-CSDN博客">QT QMdiArea控件 使用详解_双子座断点的博客-CSDN博客</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8ea1cc74a7ca20f8e8efc6a6af3fbb80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Latex之在作者名字后面加上OCRID的图标</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/22d5fa8aadd9b157f222456c1f903ec1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TCP/IP协议详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>