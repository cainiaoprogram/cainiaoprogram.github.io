<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[NPUCTF2020]EzRSA e和phi_n不互素怎么找d - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[NPUCTF2020]EzRSA e和phi_n不互素怎么找d" />
<meta property="og:description" content="题目 from gmpy2 import lcm , powmod , invert , gcd , mpz from Crypto.Util.number import getPrime from sympy import nextprime from random import randint p = getPrime(1024) q = getPrime(1024) n = p * q gift = lcm(p - 1 , q - 1) e = 54722 flag = b&#39;NPUCTF{******************}&#39; m = int.from_bytes(flag , &#39;big&#39;) c = powmod(m , e , n) print(&#39;n: &#39; , n) print(&#39;gift: &#39; , gift) print(&#39;c: &#39; , c) #n: 17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121 #gift: 2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104 #c: 3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319 分析 本题涉及到一个gmpy2的函数lcm(Least Common Multiple)求最小公倍数" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/faf974066ca81873c90c16cff6843cc1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-21T09:17:26+08:00" />
<meta property="article:modified_time" content="2023-09-21T09:17:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[NPUCTF2020]EzRSA e和phi_n不互素怎么找d</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <ul><li>题目</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> lcm <span class="token punctuation">,</span> powmod <span class="token punctuation">,</span> invert <span class="token punctuation">,</span> gcd <span class="token punctuation">,</span> mpz
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime
<span class="token keyword">from</span> sympy <span class="token keyword">import</span> nextprime
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint
p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
gift <span class="token operator">=</span> lcm<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">54722</span>
flag <span class="token operator">=</span> <span class="token string">b'NPUCTF{******************}'</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag <span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m <span class="token punctuation">,</span> e <span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n: '</span> <span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'gift: '</span> <span class="token punctuation">,</span> gift<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c: '</span> <span class="token punctuation">,</span> c<span class="token punctuation">)</span>

<span class="token comment">#n:  17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span>
<span class="token comment">#gift:  2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span>
<span class="token comment">#c:  3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span>
</code></pre> 
<ul><li>分析</li></ul> 
<blockquote> 
 <p>本题涉及到一个gmpy2的函数lcm(Least Common Multiple)求最小公倍数<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          = 
         
        
          ( 
         
        
          q 
         
        
          − 
         
        
          1 
         
        
          ) 
         
        
          ( 
         
        
          p 
         
        
          − 
         
        
          1 
         
        
          ) 
         
        
       
         \varphi(n)=(q-1)(p-1) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span><br> 这里涉及一个概念：两个数的乘积等于这两个数的最大公约数与最小公倍数的积。即：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          a 
         
        
          ∗ 
         
        
          b 
         
        
          = 
         
        
          ( 
         
        
          a 
         
        
          , 
         
        
            
         
        
          b 
         
        
          ) 
         
        
          ∗ 
         
        
          [ 
         
        
          a 
         
        
          , 
         
        
            
         
        
          b 
         
        
          ] 
         
        
       
         a*b=(a,\ b)*[a,\ b] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4653em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          = 
         
        
          g 
         
        
          i 
         
        
          f 
         
        
          t 
         
        
          ∗ 
         
        
          [ 
         
        
          q 
         
        
          − 
         
        
          1 
         
        
          , 
         
        
            
         
        
          p 
         
        
          − 
         
        
          1 
         
        
          ] 
         
        
       
         \varphi(n)=gift*[q-1,\ p-1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span><br> 已知<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           n 
          
         
        
       
         \textcolor{red}n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="color: red;">n</span></span></span></span></span>的值<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
          = 
         
        
          p 
         
        
          ∗ 
         
        
          q 
         
        
       
         n=p*q 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6597em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ) 
         
        
          = 
         
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
       
         len(\varphi(n))=len(n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span><br> 这里也可能是<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          b 
         
        
          i 
         
        
          n 
         
        
          ( 
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ) 
         
        
          ) 
         
        
          = 
         
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          b 
         
        
          i 
         
        
          n 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ) 
         
        
       
         len(bin(\varphi(n)))=len(bin(n)) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">bin</span><span class="mopen">(</span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)))</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">bin</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></span><br> 总之这两个值的位数是一样的，那那就可以猜测出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          [ 
         
        
          q 
         
        
          − 
         
        
          1 
         
        
          , 
         
        
            
         
        
          p 
         
        
          − 
         
        
          1 
         
        
          ] 
         
        
       
         [q-1,\ p-1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>的值<br> 如果是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ) 
         
        
          = 
         
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
       
         len(\varphi(n))=len(n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>可以求出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          [ 
         
        
          q 
         
        
          − 
         
        
          1 
         
        
          , 
         
        
            
         
        
          p 
         
        
          − 
         
        
          1 
         
        
          ] 
         
        
          = 
         
        
          8 
         
        
       
         [q-1,\ p-1]=8 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">8</span></span></span></span></span><br> 如果是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          b 
         
        
          i 
         
        
          n 
         
        
          ( 
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ) 
         
        
          ) 
         
        
          = 
         
        
          l 
         
        
          e 
         
        
          n 
         
        
          ( 
         
        
          b 
         
        
          i 
         
        
          n 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ) 
         
        
       
         len(bin(\varphi(n)))=len(bin(n)) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">bin</span><span class="mopen">(</span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)))</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">bin</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></span>可以求出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          [ 
         
        
          q 
         
        
          − 
         
        
          1 
         
        
          , 
         
        
            
         
        
          p 
         
        
          − 
         
        
          1 
         
        
          ] 
         
        
          = 
         
        
          [ 
         
        
          4 
         
        
          , 
         
        
            
         
        
          9 
         
        
          ] 
         
        
       
         [q-1,\ p-1]=[4,\ 9] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.0359em;">q</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">9</span><span class="mclose">]</span></span></span></span></span><br> 最后求出来是8<br> 最后求出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
       
         \varphi(n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>的值<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          = 
         
        
          g 
         
        
          i 
         
        
          f 
         
        
          t 
         
        
          ∗ 
         
        
          8 
         
        
       
         \varphi(n)=gift*8 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">8</span></span></span></span></span><br> 这里通过逆元求<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          d 
         
        
       
         d 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span>是求不出的<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
          = 
         
        
          54722 
         
        
       
         e=54722 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">54722</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
       
         e 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span></span>不是素数，也不和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
       
         \varphi(n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>互素<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
            
         
        
          / 
         
        
          / 
         
        
            
         
        
          [ 
         
        
          e 
         
        
          , 
         
        
            
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ] 
         
        
       
         e\ //\ [e,\ \varphi(n)] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord">//</span><span class="mspace"> </span><span class="mopen">[</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span></span></span>的值和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
            
         
        
          / 
         
        
          / 
         
        
            
         
        
          [ 
         
        
          e 
         
        
          , 
         
        
            
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ] 
         
        
       
         \varphi(n)\ //\ [e,\ \varphi(n)] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord">//</span><span class="mspace"> </span><span class="mopen">[</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span></span></span>的质互素<br> 求<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          d 
         
        
       
         d 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span>的值就是求逆元<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          d 
         
        
          ∗ 
         
        
          e 
         
        
          = 
         
        
          1 
          
         
          
          
            m 
           
          
            o 
           
          
            d 
           
          
          
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
       
         d*e=1\bmod \varphi(n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p> 
</blockquote> 
<ul><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           重点来了，这里我们要做的是将 
          
         
           e 
          
         
           进行一次变形，来得到逆元 
          
         
           d 
          
         
        
       
         \textcolor{red}{重点来了，这里我们要做的是将e进行一次变形，来得到逆元d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord cjk_fallback" style="color: red;">重点来了，这里我们要做的是将</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord cjk_fallback" style="color: red;">进行一次变形，来得到逆元</span><span class="mord mathnormal" style="color: red;">d</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           [ 
          
         
           e 
          
         
           , 
          
         
             
          
         
           φ 
          
         
           ( 
          
         
           n 
          
         
           ) 
          
         
           ] 
          
         
           = 
          
         
           2 
          
         
        
       
         \textcolor{red}{[e,\ \varphi(n)]=2} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen" style="color: red;">[</span><span class="mord mathnormal" style="color: red;">e</span><span class="mpunct" style="color: red;">,</span><span class="mspace" style="color: red;"><span style="color: red;"> </span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="color: red;">φ</span><span class="mopen" style="color: red;">(</span><span class="mord mathnormal" style="color: red;">n</span><span class="mclose" style="color: red;">)]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: red;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord" style="color: red;">2</span></span></span></span></span></li><li><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           变形的 
          
         
           e 
          
         
           我们这时把他叫作 
          
         
           e 
          
         
           _ 
          
         
           2 
          
         
           ，下面就是一系列的变形过程 
          
         
        
       
         \textcolor{red}{变形的e我们这时把他叫作e\_2，下面就是一系列的变形过程} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9933em; vertical-align: -0.31em;"></span><span class="mord cjk_fallback" style="color: red;">变形的</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord cjk_fallback" style="color: red;">我们这时把他叫作</span><span class="mord mathnormal" style="color: red;">e</span><span class="mord" style="color: red;">_2</span><span class="mord cjk_fallback" style="color: red;">，下面就是一系列的变形过程</span></span></span></span></span></li></ul> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
          _ 
         
        
          2 
         
        
          = 
         
        
          e 
         
        
            
         
        
          / 
         
        
          / 
         
        
            
         
        
          [ 
         
        
          e 
         
        
          , 
         
        
            
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ] 
         
        
       
         e\_2=e\ //\ [e,\ \varphi(n)] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9544em; vertical-align: -0.31em;"></span><span class="mord mathnormal">e</span><span class="mord">_2</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord">//</span><span class="mspace"> </span><span class="mopen">[</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
          _ 
         
        
          2 
         
        
          = 
         
        
          e 
         
        
            
         
        
          / 
         
        
          / 
         
        
            
         
        
          2 
         
        
       
         e\_2=e\ //\ 2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9544em; vertical-align: -0.31em;"></span><span class="mord mathnormal">e</span><span class="mord">_2</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mspace"> </span><span class="mord">//</span><span class="mspace"> </span><span class="mord">2</span></span></span></span></span><br> 因为<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          = 
         
         
         
           m 
          
         
           e 
          
          
         
          
          
            m 
           
          
            o 
           
          
            d 
           
          
          
        
          n 
         
        
       
         c=m^e\bmod n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          = 
         
        
          ( 
         
         
         
           m 
          
         
           2 
          
         
         
         
           ) 
          
          
          
            e 
           
          
            / 
           
          
            2 
           
          
          
         
          
          
            m 
           
          
            o 
           
          
            d 
           
          
          
        
          n 
         
        
       
         c=(m^2)^{e/2}\bmod n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">/2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
          进行了变形， 
         
        
          m 
         
        
          也要变，指数的乘除 
         
        
       
         {e进行了变形，m也要变，指数的乘除} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord cjk_fallback">进行了变形，</span><span class="mord mathnormal">m</span><span class="mord cjk_fallback">也要变，指数的乘除</span></span></span></span></span></span><br> 现在可以用逆元<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          d 
         
        
       
         d 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span>求出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           m 
          
         
           2 
          
         
        
       
         m^2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>的值，<br> 最后开根号就可以求出m的值，<br> 这里要注意，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          [ 
         
        
          e 
         
        
          , 
         
        
            
         
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
          ] 
         
        
       
         [e,\ \varphi(n)] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span></span></span>的值可能不是2<br> 剩下的就是解密的基本操作了<br> 代码如下：</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> mpz<span class="token punctuation">,</span> invert<span class="token punctuation">,</span> powmod<span class="token punctuation">,</span> iroot
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> n <span class="token operator">=</span> mpz<span class="token punctuation">(</span><span class="token number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> gift <span class="token operator">=</span> mpz<span class="token punctuation">(</span><span class="token number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> phi_n <span class="token operator">=</span> gift <span class="token operator">*</span> <span class="token number">8</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> e <span class="token operator">=</span> mpz<span class="token punctuation">(</span><span class="token number">54722</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> e_2 <span class="token operator">=</span> e <span class="token operator">//</span> <span class="token number">2</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> e_2
mpz<span class="token punctuation">(</span><span class="token number">27361</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> c <span class="token operator">=</span> mpz<span class="token punctuation">(</span><span class="token number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> d_2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e_2<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> d_2
mpz<span class="token punctuation">(</span><span class="token number">3623960926141555287499586936002588830496079841917313026194295760800408709320214823092595120348106137096187643430943490188125460015267714721383831801228978459738147422443015519352272682374528861550878044580645701539157928346749225751507239116578270629886685872725950227888153727090008690323645748696039492535572413478695359833744058610421607613148611079294300359070562314131322943755528912767514805442203168837293463002592529171033395324433632351223302828794321356947273613442834088890412435561603072808318967737183818601065838683683047315620557667562640144050484413871241100000176857555556621331996774524057292473889</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> m_2 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d_2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> m_2
mpz<span class="token punctuation">(</span><span class="token number">4457739276450750973807362088089319606097011997747961409022906575971021744219518190210017002304776543765491793897149413559709081776139101961</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> m <span class="token operator">=</span> iroot<span class="token punctuation">(</span>m_2<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> m
<span class="token punctuation">(</span>mpz<span class="token punctuation">(</span><span class="token number">2111335898536931279306810443240820489664022670971730129629668753766781</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> flag <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> flag
<span class="token string">b'NPUCTF{diff1cult_rsa_1s_e@sy}'</span>
</code></pre> 
<ul><li>e和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          φ 
         
        
          ( 
         
        
          n 
         
        
          ) 
         
        
       
         \varphi(n) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>不互质</li></ul> 
<blockquote> 
 <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
            
             
             
               [ 
              
             
               e 
              
             
               , 
              
             
                 
              
             
               φ 
              
             
               ( 
              
             
               n 
              
             
               ) 
              
             
               ] 
              
             
               ≠ 
              
             
               1 
              
             
            
           
           
           
          
          
           
           
            
             
             
               d 
              
             
               ∗ 
              
              
              
                e 
               
               
               
                 [ 
                
               
                 e 
                
               
                 , 
                
               
                   
                
               
                 φ 
                
               
                 ( 
                
               
                 n 
                
               
                 ) 
                
               
                 ] 
                
               
              
             
               = 
              
             
               1 
               
              
               
               
                 m 
                
               
                 o 
                
               
                 d 
                
               
               
             
               φ 
              
             
               ( 
              
             
               n 
              
             
               ) 
              
             
            
           
           
           
          
          
           
           
            
             
             
               c 
              
             
               = 
              
             
               ( 
              
              
              
                m 
               
               
               
                 [ 
                
               
                 e 
                
               
                 , 
                
               
                   
                
               
                 φ 
                
               
                 ( 
                
               
                 n 
                
               
                 ) 
                
               
                 ] 
                
               
              
              
              
                ) 
               
               
               
                 e 
                
               
                 / 
                
                
                
                  [ 
                 
                
                  e 
                 
                
                  , 
                 
                
                    
                 
                
                  [ 
                 
                
                  e 
                 
                
                  , 
                 
                
                    
                 
                
                  φ 
                 
                
                  ( 
                 
                
                  n 
                 
                
                  ) 
                 
                
                  ] 
                 
                
               
               
              
               
               
                 m 
                
               
                 o 
                
               
                 d 
                
               
               
             
               n 
              
             
            
           
           
           
          
         
        
          \begin{align} [e,\ \varphi(n)]\ne 1\\ d * \cfrac{e}{[e,\ \varphi(n)]}=1\bmod \varphi(n)\\ c = (m^{[e,\ \varphi(n)]})^{e/{[e,\ [e,\ \varphi(n)]}}\bmod n \end{align} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 5.924em; vertical-align: -2.712em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.212em;"><span class="" style="top: -5.962em;"><span class="pstrut" style="height: 3.59em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">1</span></span></span><span class="" style="top: -3.712em;"><span class="pstrut" style="height: 3.59em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.59em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">[</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)]</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.74em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class=""></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span class="" style="top: -1.538em;"><span class="pstrut" style="height: 3.59em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">e</span><span class="mpunct mtight">,</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)]</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mopen mtight">[</span><span class="mord mathnormal mtight">e</span><span class="mpunct mtight">,</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">e</span><span class="mpunct mtight">,</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">)]</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right: 0.0556em;"></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.712em;"><span class=""></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.212em;"><span class="" style="top: -5.962em;"><span class="pstrut" style="height: 3.59em;"></span><span class="eqn-num"></span></span><span class="" style="top: -3.712em;"><span class="pstrut" style="height: 3.59em;"></span><span class="eqn-num"></span></span><span class="" style="top: -1.538em;"><span class="pstrut" style="height: 3.59em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.712em;"><span class=""></span></span></span></span></span></span></span></span></span></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3cb2900d811c1053cf097d03b4cad1d6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql按月分组并补齐</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/219e95b882fcaa38bdaa396296832fbc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Django中的cookie和session</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>