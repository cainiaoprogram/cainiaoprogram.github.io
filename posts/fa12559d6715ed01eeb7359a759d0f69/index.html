<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于CBAM-CNN卷积神经网络预测研究（Python代码实现） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于CBAM-CNN卷积神经网络预测研究（Python代码实现）" />
<meta property="og:description" content="💥💥💞💞欢迎来到本博客❤️❤️💥💥
🏆博主优势：🌞🌞🌞博客内容尽量做到思维缜密，逻辑清晰，为了方便读者。
⛳️座右铭：行百里者，半于九十。
📋📋📋本文目录如下：🎁🎁🎁
目录
💥1 概述
📚2 运行结果
🎉3 参考文献
🌈4 Python代码及数据
💥1 概述 CBAM(CBAM-CNN)是一种用于计算机视觉领域的卷积神经网络结构，它能够有效地从图像中学习关注和调整。CBAM模型结合了通道注意力模块（Channel Attention Module）和空间注意力模块（Spatial Attention Module）两个部分，用于提升卷积神经网络的性能。
通道注意力模块（CAM）旨在通过学习不同通道之间的相关性，为每个通道分配适当的注意力权重。该模块首先通过全局平均池化获得整个通道的平均值，然后使用两个全连接层来生成一组注意力权重。这些权重用于调整每个通道的特征图。
空间注意力模块（SAM）旨在学习图像中不同空间区域的重要性。该模块通过对特征图在不同空间维度上进行最大池化和平均池化操作，然后使用一个卷积层来生成一组注意力权重。最后，这些权重被应用于原始特征图，以增强具有重要空间信息的区域。
通过结合通道注意力模块和空间注意力模块，CBAM能够动态地选择和调整特征图的通道和空间注意力，从而提取更准确和具有区分力的特征表示。这种注意力机制有助于网络更好地对图像进行感知，从而改善图像分类、目标检测、图像分割等计算机视觉任务的性能。
针对预测任务，可以使用CBAM-CNN模型进行图像分类或目标检测。在图像分类任务中，CBAM-CNN可以通过自适应地关注重要的通道和空间区域，提取图像特征并进行分类。在目标检测任务中，CBAM-CNN可以辅助检测网络对目标区域进行准确定位和分类。
需要注意的是，CBAM-CNN只是一种网络结构，具体的预测研究还需要根据具体的任务和数据集进行调整和优化。
📚2 运行结果 部分代码：
def forward(self, x): # 1.最大池化分支 max_branch = self.MaxPool(x) # 送入MLP全连接神经网络, 得到权重 max_in = max_branch.view(max_branch.size(0), -1) max_weight = self.fc_MaxPool(max_in) # 2.全局池化分支 avg_branch = self.AvgPool(x) # 送入MLP全连接神经网络, 得到权重 avg_in = avg_branch.view(avg_branch.size(0), -1) avg_weight = self.fc_AvgPool(avg_in) # MaxPool &#43; AvgPool 激活后得到权重weight weight = max_weight &#43; avg_weight weight = self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/fa12559d6715ed01eeb7359a759d0f69/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-15T08:41:24+08:00" />
<meta property="article:modified_time" content="2023-07-15T08:41:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于CBAM-CNN卷积神经网络预测研究（Python代码实现）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p> 💥💥💞💞<strong>欢迎来到本博客</strong>❤️❤️💥💥</p> 
 <p></p> 
 <p></p> 
 <p></p> 
 <p><strong><strong>🏆博主优势：</strong>🌞🌞🌞</strong>博客内容尽量做到思维缜密，逻辑清晰，为了方便读者。</p> 
 <p></p> 
 <p></p> 
 <p>⛳️<strong>座右铭：</strong>行百里者，半于九十。</p> 
 <p></p> 
 <p>📋📋📋<u><strong>本文目录如下：</strong></u>🎁🎁🎁</p> 
 <p id="main-toc"><strong>目录</strong></p> 
 <p id="%F0%9F%92%A51%20%E6%A6%82%E8%BF%B0-toc" style="margin-left:40px;"><a href="#%F0%9F%92%A51%20%E6%A6%82%E8%BF%B0" rel="nofollow">💥1 概述</a></p> 
 <p id="%F0%9F%93%9A2%20%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-toc" style="margin-left:40px;"><a href="#%F0%9F%93%9A2%20%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C" rel="nofollow">📚2 运行结果</a></p> 
 <p id="%F0%9F%8E%893%C2%A0%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE-toc" style="margin-left:40px;"><a href="#%F0%9F%8E%893%C2%A0%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE" rel="nofollow">🎉3 参考文献</a></p> 
 <p id="%F0%9F%8C%884%20Python%E4%BB%A3%E7%A0%81%E5%8F%8A%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#%F0%9F%8C%884%20Python%E4%BB%A3%E7%A0%81%E5%8F%8A%E6%95%B0%E6%8D%AE" rel="nofollow">🌈4 Python代码及数据</a></p> 
 <hr id="hr-toc"> 
 <p></p> 
 <p><img alt="" src="https://images2.imgbox.com/ef/ed/HG9zNdn8_o.gif"></p> 
</blockquote> 
<h3 id="%F0%9F%92%A51%20%E6%A6%82%E8%BF%B0"><strong>💥1 概述</strong></h3> 
<p><img alt="" height="571" src="https://images2.imgbox.com/00/97/OjKVfZLh_o.png" width="969"></p> 
<p><img alt="" height="1028" src="https://images2.imgbox.com/ee/c6/tIXKBxO0_o.png" width="923"></p> 
<p><img alt="" height="394" src="https://images2.imgbox.com/1c/55/CnsnB2Jh_o.png" width="881"></p> 
<p>CBAM(CBAM-CNN)是一种用于计算机视觉领域的卷积神经网络结构，它能够有效地从图像中学习关注和调整。CBAM模型结合了通道注意力模块（Channel Attention Module）和空间注意力模块（Spatial Attention Module）两个部分，用于提升卷积神经网络的性能。</p> 
<p>通道注意力模块（CAM）旨在通过学习不同通道之间的相关性，为每个通道分配适当的注意力权重。该模块首先通过全局平均池化获得整个通道的平均值，然后使用两个全连接层来生成一组注意力权重。这些权重用于调整每个通道的特征图。</p> 
<p>空间注意力模块（SAM）旨在学习图像中不同空间区域的重要性。该模块通过对特征图在不同空间维度上进行最大池化和平均池化操作，然后使用一个卷积层来生成一组注意力权重。最后，这些权重被应用于原始特征图，以增强具有重要空间信息的区域。</p> 
<p>通过结合通道注意力模块和空间注意力模块，CBAM能够动态地选择和调整特征图的通道和空间注意力，从而提取更准确和具有区分力的特征表示。这种注意力机制有助于网络更好地对图像进行感知，从而改善图像分类、目标检测、图像分割等计算机视觉任务的性能。</p> 
<p>针对预测任务，可以使用CBAM-CNN模型进行图像分类或目标检测。在图像分类任务中，CBAM-CNN可以通过自适应地关注重要的通道和空间区域，提取图像特征并进行分类。在目标检测任务中，CBAM-CNN可以辅助检测网络对目标区域进行准确定位和分类。</p> 
<p>需要注意的是，CBAM-CNN只是一种网络结构，具体的预测研究还需要根据具体的任务和数据集进行调整和优化。</p> 
<p><img alt="" height="798" src="https://images2.imgbox.com/95/c9/hKA5MzxI_o.png" width="1200"></p> 
<p><img alt="" height="352" src="https://images2.imgbox.com/05/4a/uWiFKz4Z_o.png" width="947"></p> 
<h3 id="%F0%9F%93%9A2%20%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><strong>📚</strong><strong>2 运行结果</strong></h3> 
<p><img alt="" height="1084" src="https://images2.imgbox.com/1a/98/oLOsnWjF_o.png" width="1200"></p> 
<p><img alt="" height="1084" src="https://images2.imgbox.com/81/ad/f26uSavw_o.png" width="1200"></p> 
<p><img alt="" height="1084" src="https://images2.imgbox.com/99/ef/MacbvZwa_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0b/3b/dpz5IDuP_o.png" width="1198"></p> 
<p> 部分代码：</p> 
<pre>def forward(self, x):
        # 1.最大池化分支
        max_branch = self.MaxPool(x)
        # 送入MLP全连接神经网络, 得到权重
        max_in = max_branch.view(max_branch.size(0), -1)
        max_weight = self.fc_MaxPool(max_in)

        # 2.全局池化分支
        avg_branch = self.AvgPool(x)
        # 送入MLP全连接神经网络, 得到权重
        avg_in = avg_branch.view(avg_branch.size(0), -1)
        avg_weight = self.fc_AvgPool(avg_in)

        # MaxPool + AvgPool 激活后得到权重weight
        weight = max_weight + avg_weight
        weight = self.sigmoid(weight)

        # 将维度为b, c的weight, reshape成b, c, 1, 1 与 输入x 相乘
        h, w = weight.shape
        # 通道注意力Mc
        Mc = torch.reshape(weight, (h, w, 1))

        # 乘积获得结果
        x = Mc * x

        return x


class SpatialAttentionModul(nn.Module):  # 空间注意力模块
    def __init__(self, in_channel):
        super(SpatialAttentionModul, self).__init__()
        self.conv = nn.Conv1d(2, 1, 7, padding=3)
        self.sigmoid = nn.Sigmoid()

    def forward(self, x):
        # x维度为 [N, C, H, W] 沿着维度C进行操作, 所以dim=1, 结果为[N, H, W]
        MaxPool = torch.max(x, dim=1).values  # torch.max 返回的是索引和value， 要用.values去访问值才行！
        AvgPool = torch.mean(x, dim=1)

        # 增加维度, 变成 [N, 1, H, W]
        MaxPool = torch.unsqueeze(MaxPool, dim=1)
        AvgPool = torch.unsqueeze(AvgPool, dim=1)

        # 维度拼接 [N, 2, H, W]
        x_cat = torch.cat((MaxPool, AvgPool), dim=1)  # 获得特征图

        # 卷积操作得到空间注意力结果
        x_out = self.conv(x_cat)
        Ms = self.sigmoid(x_out)

        # 与原图通道进行乘积
        x = Ms * x

        return x


if __name__ == '__main__':
    inputs = torch.randn(32, 512, 16)
    model = CBAM(in_channel=512)  # CBAM模块, 可以插入CNN及任意网络中, 输入特征图in_channel的维度
</pre> 
<pre><code>    def forward(self, x):
        # 1.最大池化分支
        max_branch = self.MaxPool(x)
        # 送入MLP全连接神经网络, 得到权重
        max_in = max_branch.view(max_branch.size(0), -1)
        max_weight = self.fc_MaxPool(max_in)

        # 2.全局池化分支
        avg_branch = self.AvgPool(x)
        # 送入MLP全连接神经网络, 得到权重
        avg_in = avg_branch.view(avg_branch.size(0), -1)
        avg_weight = self.fc_AvgPool(avg_in)

        # MaxPool + AvgPool 激活后得到权重weight
        weight = max_weight + avg_weight
        weight = self.sigmoid(weight)

        # 将维度为b, c的weight, reshape成b, c, 1, 1 与 输入x 相乘
        h, w = weight.shape
        # 通道注意力Mc
        Mc = torch.reshape(weight, (h, w, 1))

        # 乘积获得结果
        x = Mc * x

        return x


class SpatialAttentionModul(nn.Module):  # 空间注意力模块
    def __init__(self, in_channel):
        super(SpatialAttentionModul, self).__init__()
        self.conv = nn.Conv1d(2, 1, 7, padding=3)
        self.sigmoid = nn.Sigmoid()

    def forward(self, x):
        # x维度为 [N, C, H, W] 沿着维度C进行操作, 所以dim=1, 结果为[N, H, W]
        MaxPool = torch.max(x, dim=1).values  # torch.max 返回的是索引和value， 要用.values去访问值才行！
        AvgPool = torch.mean(x, dim=1)

        # 增加维度, 变成 [N, 1, H, W]
        MaxPool = torch.unsqueeze(MaxPool, dim=1)
        AvgPool = torch.unsqueeze(AvgPool, dim=1)

        # 维度拼接 [N, 2, H, W]
        x_cat = torch.cat((MaxPool, AvgPool), dim=1)  # 获得特征图

        # 卷积操作得到空间注意力结果
        x_out = self.conv(x_cat)
        Ms = self.sigmoid(x_out)

        # 与原图通道进行乘积
        x = Ms * x

        return x


if __name__ == '__main__':
    inputs = torch.randn(32, 512, 16)
    model = CBAM(in_channel=512)  # CBAM模块, 可以插入CNN及任意网络中, 输入特征图in_channel的维度</code></pre> 
<h3 id="%F0%9F%8E%893%C2%A0%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><strong><strong>🎉3</strong></strong><strong><strong> 参考文献</strong></strong></h3> 
<blockquote> 
 <p>部分理论来源于网络，如有侵权请联系删除。</p> 
</blockquote> 
<p>[1]黄昌顺,张金萍.基于CBAM-CNN的滚动轴承故障诊断方法[J].现代制造工程,2022(11):137-143.DOI:10.16731/j.cnki.1671-3133.2022.11.022.</p> 
<p>[2]杜先君,巩彬,余萍等.基于CBAM-CNN的模拟电路故障诊断[J].控制与决策,2022,37(10):2609-2618.DOI:10.13195/j.kzyjc.2021.1111.</p> 
<h3 id="%F0%9F%8C%884%20Python%E4%BB%A3%E7%A0%81%E5%8F%8A%E6%95%B0%E6%8D%AE"><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzk0MDMzNzYwOA==&amp;action=getalbum&amp;album_id=2591810113208958977#wechat_redirect" rel="nofollow" title="🌈">🌈</a><strong><strong>4 Python代码及数据</strong></strong></h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f294f7fa99386c298b2ba211c4dfbd96/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ubuntu中安装cmake</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/21824ef2fe67ad2a79195c22cc7364a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Apache新建站点，设置端口转发和访问密码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>