<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€æŒä¹…å±‚æ¡†æ¶ã€‘- SpringData - JPA - èœé¸Ÿç¨‹åºå‘˜åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ã€æŒä¹…å±‚æ¡†æ¶ã€‘- SpringData - JPA" />
<meta property="og:description" content="SpringData - JPA ğŸ˜„ç”Ÿå‘½ä¸æ¯ï¼Œå†™ä½œä¸æ­¢
ğŸ”¥ ç»§ç»­è¸ä¸Šå­¦ä¹ ä¹‹è·¯ï¼Œå­¦ä¹‹åˆ†äº«ç¬”è®°
ğŸ‘Š æ€»æœ‰ä¸€å¤©æˆ‘ä¹Ÿèƒ½åƒå„ä½å¤§ä½¬ä¸€æ ·
ğŸ† ä¸€ä¸ªæœ‰æ¢¦æœ‰æˆçš„äºº @æ€’æ”¾å§å¾·å¾·
ğŸŒåˆ†äº«å­¦ä¹ å¿ƒå¾—ï¼Œæ¬¢è¿æŒ‡æ­£ï¼Œå¤§å®¶ä¸€èµ·å­¦ä¹ æˆé•¿ï¼
JPA SpringData - JPAJPAç®€ä»‹ä»€ä¹ˆæ˜¯ORMï¼ŸSpringData-JPASpringBootæ•´åˆJPAå¯¼å…¥ä¾èµ–ç¼–å†™é…ç½®æ–‡ä»¶åˆ›å»ºå®ä½“ç±»å¯åŠ¨é¡¹ç›®å¯¹è¡¨æ“ä½œå¢åŠ æ•°æ®æŸ¥çœ‹æ•°æ®åˆ†é¡µæŸ¥æ‰¾æ ¹æ®IDæŸ¥æ‰¾ æ–¹æ³•å‘½åè§„åˆ™è‡ªå®šä¹‰æŸ¥è¯¢ç¼–å†™Repository ä½¿ç”¨JPQLçš„æ–¹å¼æŸ¥è¯¢(æ³¨è§£å¼SQL)è®¡æ•°å‚æ•°ä¼ é€’ å®ä½“å…³ç³»å¯¹åº”ä¸€å¯¹ä¸€ä¸€å¯¹å¤šå¤šå¯¹å¤š æ–‡ç« æ¨è JPAç®€ä»‹ JPA å³Java Persistence APIã€‚æ˜¯ä¸€æ¬¾æŒä¹…å±‚æ¡†æ¶ï¼Œä¸­æ–‡åJavaæŒä¹…å±‚APIï¼Œæ˜¯JDK 5.0æ³¨è§£æˆ–XMLæè¿°å¯¹è±¡ï¼å…³ç³»è¡¨çš„æ˜ å°„å…³ç³»ï¼Œå¹¶å°†è¿è¡ŒæœŸçš„å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ã€‚JPAçš„å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORMï¼‰æ¨¡å‹æ˜¯åŸºäºHibernateã€‚æ˜¯ä¸€æ¬¾é¢å‘å¯¹è±¡çš„ORMæ¡†æ¶ï¼ŒJPAä¸éœ€è¦å…³å¿ƒæ•°æ®åº“å­—æ®µï¼Œé€šè¿‡æ³¨è§£å°†æ•°æ®åº“è¡¨ä¸å®ä½“å®Œæˆæ˜ å°„ï¼Œåœ¨javaä¸­çš„æ“ä½œåªéœ€è¦å¯¹å®ä½“è¿›è¡Œæ“ä½œå³å¯ã€‚
ä»€ä¹ˆæ˜¯ORMï¼Ÿ ORMï¼ˆObject-Relational Mappingï¼‰ è¡¨ç¤ºå¯¹è±¡å…³ç³»æ˜ å°„ã€‚åœ¨é¢å‘å¯¹è±¡çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œé€šè¿‡ORMï¼Œå°±å¯ä»¥æŠŠå¯¹è±¡æ˜ å°„åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­ã€‚åªè¦æœ‰ä¸€å¥—ç¨‹åºèƒ½å¤Ÿåšåˆ°å»ºç«‹å¯¹è±¡ä¸æ•°æ®åº“çš„å…³è”ï¼Œæ“ä½œå¯¹è±¡å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®åº“æ•°æ®ï¼Œå°±å¯ä»¥è¯´è¿™å¥—ç¨‹åºå®ç°äº†ORMå¯¹è±¡å…³ç³»æ˜ å°„ã€‚ä¹Ÿå°±æ˜¯è¯´ORMæ˜¯å»ºç«‹äº†ä¸€ä¸ªå®ä½“ä¸æ•°æ®åº“è¡¨çš„å…³ç³»ï¼Œä½¿å¾—å¼€å‘è€…å¯¹å®ä½“çš„ç›´æ¥æ“ä½œè€Œä¸æ˜¯å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œä½†æ“ä½œå®ä½“ä¹Ÿå°±ç­‰åŒäºæ“ä½œäº†æ•°æ®åº“ã€‚
ORMæ¡†æ¶è¿˜æœ‰ï¼šMyBatisã€Hibernate
SpringData-JPA Spring Data JPA æ˜¯ Spring åŸºäº ORM æ¡†æ¶ã€JPA è§„èŒƒçš„åŸºç¡€ä¸Šå°è£…çš„ä¸€å¥—JPAåº”ç”¨æ¡†æ¶ï¼Œå¯ä½¿å¼€å‘è€…ç”¨æç®€çš„ä»£ç å³å¯å®ç°å¯¹æ•°æ®åº“çš„è®¿é—®å’Œæ“ä½œã€‚
å®ƒæä¾›äº†åŒ…æ‹¬å¢åˆ æ”¹æŸ¥ç­‰åœ¨å†…çš„å¸¸ç”¨åŠŸèƒ½ï¼Œä¸”æ˜“äºæ‰©å±•ï¼å­¦ä¹ å¹¶ä½¿ç”¨ Spring Data JPA å¯ä»¥æå¤§æé«˜å¼€å‘æ•ˆç‡ï¼
Spring Data JPA è®©æˆ‘ä»¬è§£è„±äº†DAOå±‚çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰CRUDéƒ½å¯ä»¥ä¾èµ–äºå®ƒæ¥å®ç°
åœ¨å®é™…çš„å·¥ä½œå·¥ç¨‹ä¸­ï¼Œæ¨èä½¿ç”¨Spring Data JPA &#43; ORMï¼ˆå¦‚ï¼šhibernateï¼‰å®Œæˆæ“ä½œï¼Œè¿™æ ·åœ¨åˆ‡æ¢ä¸åŒçš„ORMæ¡†æ¶æ—¶æä¾›äº†æå¤§çš„æ–¹ä¾¿ï¼ŒåŒæ—¶ä¹Ÿä½¿æ•°æ®åº“å±‚æ“ä½œæ›´åŠ ç®€å•ï¼Œæ–¹ä¾¿è§£è€¦ã€‚
SpringBootæ•´åˆJPA æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹ç®€å•å­¦ä¹ ä¸€ä¸‹JPAï¼Œå¹¶ä¸”åœ¨æ¡ˆä¾‹ä¸­å­¦ä¹ ä¸€äº›ç›¸å…³çŸ¥è¯†ã€‚
å¯¼å…¥ä¾èµ– éœ€è¦å¯¼å…¥jpaåæ ‡å’Œmysqlä¾èµ–åŒ…
&lt;dependencies&gt; &lt;!--jpa--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--Mysqlä¾èµ–åŒ…--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ç¼–å†™é…ç½®æ–‡ä»¶ å…ˆé…ç½®æ•°æ®æºï¼Œé‡‡ç”¨mysql8." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8c53c5d530e1fcbb9c5032a914783510/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-03T12:39:48+08:00" />
<meta property="article:modified_time" content="2022-10-03T12:39:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="èœé¸Ÿç¨‹åºå‘˜åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">èœé¸Ÿç¨‹åºå‘˜åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€æŒä¹…å±‚æ¡†æ¶ã€‘- SpringData - JPA</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SpringData__JPA_0"></a>SpringData - JPA</h2> 
<blockquote> 
 <p>ğŸ˜„ç”Ÿå‘½ä¸æ¯ï¼Œå†™ä½œä¸æ­¢<br> ğŸ”¥ ç»§ç»­è¸ä¸Šå­¦ä¹ ä¹‹è·¯ï¼Œå­¦ä¹‹åˆ†äº«ç¬”è®°<br> ğŸ‘Š æ€»æœ‰ä¸€å¤©æˆ‘ä¹Ÿèƒ½åƒå„ä½å¤§ä½¬ä¸€æ ·<br> ğŸ† <a href="https://blog.csdn.net/qq_43843951">ä¸€ä¸ªæœ‰æ¢¦æœ‰æˆçš„äºº</a> <a href="https://www.cnblogs.com/lyd-code/" rel="nofollow">@æ€’æ”¾å§å¾·å¾·</a><br> ğŸŒåˆ†äº«å­¦ä¹ å¿ƒå¾—ï¼Œæ¬¢è¿æŒ‡æ­£ï¼Œå¤§å®¶ä¸€èµ·å­¦ä¹ æˆé•¿ï¼</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/43/f5/FHpJtZ4j_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p></p> 
<div class="toc"> 
 <h4>JPA</h4> 
 <ul><li><a href="#SpringData__JPA_0" rel="nofollow">SpringData - JPA</a></li><li><ul><li><a href="#JPA_11" rel="nofollow">JPAç®€ä»‹</a></li><li><a href="#ORM_13" rel="nofollow">ä»€ä¹ˆæ˜¯ORMï¼Ÿ</a></li><li><a href="#SpringDataJPA_16" rel="nofollow">SpringData-JPA</a></li><li><a href="#SpringBootJPA_21" rel="nofollow">SpringBootæ•´åˆJPA</a></li><li><ul><li><a href="#_23" rel="nofollow">å¯¼å…¥ä¾èµ–</a></li><li><a href="#_41" rel="nofollow">ç¼–å†™é…ç½®æ–‡ä»¶</a></li><li><a href="#_65" rel="nofollow">åˆ›å»ºå®ä½“ç±»</a></li><li><a href="#_106" rel="nofollow">å¯åŠ¨é¡¹ç›®</a></li><li><a href="#_111" rel="nofollow">å¯¹è¡¨æ“ä½œ</a></li><li><ul><li><a href="#_112" rel="nofollow">å¢åŠ æ•°æ®</a></li><li><a href="#_158" rel="nofollow">æŸ¥çœ‹æ•°æ®</a></li><li><a href="#_170" rel="nofollow">åˆ†é¡µæŸ¥æ‰¾</a></li><li><a href="#ID_181" rel="nofollow">æ ¹æ®IDæŸ¥æ‰¾</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_199" rel="nofollow">æ–¹æ³•å‘½åè§„åˆ™è‡ªå®šä¹‰æŸ¥è¯¢</a></li><li><ul><li><a href="#Repository_202" rel="nofollow">ç¼–å†™Repository</a></li></ul> 
   </li><li><a href="#JPQLSQL_232" rel="nofollow">ä½¿ç”¨JPQLçš„æ–¹å¼æŸ¥è¯¢(æ³¨è§£å¼SQL)</a></li><li><ul><li><a href="#_234" rel="nofollow">è®¡æ•°</a></li><li><a href="#_253" rel="nofollow">å‚æ•°ä¼ é€’</a></li></ul> 
   </li><li><a href="#_266" rel="nofollow">å®ä½“å…³ç³»å¯¹åº”</a></li><li><ul><li><a href="#_268" rel="nofollow">ä¸€å¯¹ä¸€</a></li><li><a href="#_326" rel="nofollow">ä¸€å¯¹å¤š</a></li><li><a href="#_403" rel="nofollow">å¤šå¯¹å¤š</a></li></ul> 
   </li><li><a href="#_477" rel="nofollow">æ–‡ç« æ¨è</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="JPA_11"></a>JPAç®€ä»‹</h3> 
<p>JPA å³Java Persistence APIã€‚æ˜¯ä¸€æ¬¾æŒä¹…å±‚æ¡†æ¶ï¼Œä¸­æ–‡åJavaæŒä¹…å±‚APIï¼Œæ˜¯JDK 5.0æ³¨è§£æˆ–XMLæè¿°å¯¹è±¡ï¼å…³ç³»è¡¨çš„æ˜ å°„å…³ç³»ï¼Œå¹¶å°†è¿è¡ŒæœŸçš„å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ã€‚JPAçš„å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORMï¼‰æ¨¡å‹æ˜¯åŸºäºHibernateã€‚æ˜¯ä¸€æ¬¾é¢å‘å¯¹è±¡çš„ORMæ¡†æ¶ï¼ŒJPAä¸éœ€è¦å…³å¿ƒæ•°æ®åº“å­—æ®µï¼Œé€šè¿‡æ³¨è§£å°†æ•°æ®åº“è¡¨ä¸å®ä½“å®Œæˆæ˜ å°„ï¼Œåœ¨javaä¸­çš„æ“ä½œåªéœ€è¦å¯¹å®ä½“è¿›è¡Œæ“ä½œå³å¯ã€‚</p> 
<h3><a id="ORM_13"></a>ä»€ä¹ˆæ˜¯ORMï¼Ÿ</h3> 
<p>ORMï¼ˆObject-Relational Mappingï¼‰ è¡¨ç¤ºå¯¹è±¡å…³ç³»æ˜ å°„ã€‚åœ¨é¢å‘å¯¹è±¡çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œé€šè¿‡ORMï¼Œå°±å¯ä»¥æŠŠå¯¹è±¡æ˜ å°„åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­ã€‚åªè¦æœ‰ä¸€å¥—ç¨‹åºèƒ½å¤Ÿåšåˆ°å»ºç«‹å¯¹è±¡ä¸æ•°æ®åº“çš„å…³è”ï¼Œæ“ä½œå¯¹è±¡å°±å¯ä»¥ç›´æ¥æ“ä½œæ•°æ®åº“æ•°æ®ï¼Œå°±å¯ä»¥è¯´è¿™å¥—ç¨‹åºå®ç°äº†ORMå¯¹è±¡å…³ç³»æ˜ å°„ã€‚ä¹Ÿå°±æ˜¯è¯´ORMæ˜¯å»ºç«‹äº†ä¸€ä¸ªå®ä½“ä¸æ•°æ®åº“è¡¨çš„å…³ç³»ï¼Œä½¿å¾—å¼€å‘è€…å¯¹å®ä½“çš„ç›´æ¥æ“ä½œè€Œä¸æ˜¯å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œä½†æ“ä½œå®ä½“ä¹Ÿå°±ç­‰åŒäºæ“ä½œäº†æ•°æ®åº“ã€‚<br> ORMæ¡†æ¶è¿˜æœ‰ï¼šMyBatisã€Hibernate</p> 
<h3><a id="SpringDataJPA_16"></a>SpringData-JPA</h3> 
<p>Spring Data JPA æ˜¯ Spring åŸºäº ORM æ¡†æ¶ã€JPA è§„èŒƒçš„åŸºç¡€ä¸Šå°è£…çš„ä¸€å¥—JPAåº”ç”¨æ¡†æ¶ï¼Œå¯ä½¿å¼€å‘è€…ç”¨æç®€çš„ä»£ç å³å¯å®ç°å¯¹æ•°æ®åº“çš„è®¿é—®å’Œæ“ä½œã€‚<br> å®ƒæä¾›äº†åŒ…æ‹¬å¢åˆ æ”¹æŸ¥ç­‰åœ¨å†…çš„å¸¸ç”¨åŠŸèƒ½ï¼Œä¸”æ˜“äºæ‰©å±•ï¼å­¦ä¹ å¹¶ä½¿ç”¨ Spring Data JPA å¯ä»¥æå¤§æé«˜å¼€å‘æ•ˆç‡ï¼<br> Spring Data JPA è®©æˆ‘ä»¬è§£è„±äº†DAOå±‚çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰CRUDéƒ½å¯ä»¥ä¾èµ–äºå®ƒæ¥å®ç°<br> åœ¨å®é™…çš„å·¥ä½œå·¥ç¨‹ä¸­ï¼Œæ¨èä½¿ç”¨Spring Data JPA + ORMï¼ˆå¦‚ï¼šhibernateï¼‰å®Œæˆæ“ä½œï¼Œè¿™æ ·åœ¨åˆ‡æ¢ä¸åŒçš„ORMæ¡†æ¶æ—¶æä¾›äº†æå¤§çš„æ–¹ä¾¿ï¼ŒåŒæ—¶ä¹Ÿä½¿æ•°æ®åº“å±‚æ“ä½œæ›´åŠ ç®€å•ï¼Œæ–¹ä¾¿è§£è€¦ã€‚</p> 
<h3><a id="SpringBootJPA_21"></a>SpringBootæ•´åˆJPA</h3> 
<p>æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹ç®€å•å­¦ä¹ ä¸€ä¸‹JPAï¼Œå¹¶ä¸”åœ¨æ¡ˆä¾‹ä¸­å­¦ä¹ ä¸€äº›ç›¸å…³çŸ¥è¯†ã€‚</p> 
<h4><a id="_23"></a>å¯¼å…¥ä¾èµ–</h4> 
<p>éœ€è¦å¯¼å…¥jpaåæ ‡å’Œmysqlä¾èµ–åŒ…</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>jpa<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>data<span class="token operator">-</span>jpa<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token class-name">Mysql</span>ä¾èµ–åŒ…<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>mysql<span class="token operator">-</span>connector<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>runtime<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="_41"></a>ç¼–å†™é…ç½®æ–‡ä»¶</h4> 
<p>å…ˆé…ç½®æ•°æ®æºï¼Œé‡‡ç”¨mysql8.0ã€‚è¿˜åŒ…æ‹¬é…ç½®jpaçš„ç›¸å…³é…ç½®ã€‚ä¸»è¦æ˜¯é…ç½®jpaçš„sqlæ—¥å¿—æ‰“å°å’Œè‡ªåŠ¨åˆ›å»ºè¡¨æ ¼ã€‚</p> 
<pre><code class="prism language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/springboot_demo<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;useSSL=false&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">12356</span>
<span class="token key atrule">jpa</span><span class="token punctuation">:</span>
  <span class="token key atrule">show-sql</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">hibernate</span><span class="token punctuation">:</span>
    <span class="token key atrule">ddl-auto</span><span class="token punctuation">:</span> create <span class="token comment"># è‡ªåŠ¨åˆ›å»ºè¡¨æ ¼ï¼Œä¹‹åæ”¹æˆupdate</span>
</code></pre> 
<p>jpaçš„åº•å±‚æ˜¯é€šè¿‡hibernateæ‰§è¡Œçš„ï¼Œé€šè¿‡é…ç½®ddl-autoèƒ½å¤Ÿè‡ªåŠ¨åˆ›å»ºè¡¨ï¼Œä½†æ˜¯è¿™ä¸ªä¸å»ºè®®ä½¿ç”¨ï¼Œå¦‚æœæ˜¯createï¼Œåœ¨é¡¹ç›®è¿è¡Œçš„æ—¶å€™å°±ä¼šæŠŠå­˜åœ¨çš„è¡¨åˆ é™¤åœ¨æ·»åŠ ã€‚è¯¦æƒ…å¦‚ä¸‹ï¼š<br> ddl-autoå±æ€§ç”¨äºè®¾ç½®è‡ªåŠ¨è¡¨å®šä¹‰ï¼Œå¯ä»¥å®ç°è‡ªåŠ¨åœ¨æ•°æ®åº“ä¸­ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œè¡¨çš„ç»“æ„ä¼šæ ¹æ®æˆ‘ä»¬å®šä¹‰çš„å®ä½“ç±»å†³å®šï¼Œå®ƒæœ‰4ç§</p> 
<ul><li>create å¯åŠ¨æ—¶åˆ æ•°æ®åº“ä¸­çš„è¡¨ï¼Œç„¶ååˆ›å»ºï¼Œé€€å‡ºæ—¶ä¸åˆ é™¤æ•°æ®è¡¨</li><li>create-drop å¯åŠ¨æ—¶åˆ æ•°æ®åº“ä¸­çš„è¡¨ï¼Œç„¶ååˆ›å»ºï¼Œé€€å‡ºæ—¶åˆ é™¤æ•°æ®è¡¨ å¦‚æœè¡¨ä¸å­˜åœ¨æŠ¥é”™</li><li>update å¦‚æœå¯åŠ¨æ—¶è¡¨æ ¼å¼ä¸ä¸€è‡´åˆ™æ›´æ–°è¡¨ï¼ŒåŸæœ‰æ•°æ®ä¿ç•™</li><li>validate é¡¹ç›®å¯åŠ¨è¡¨ç»“æ„è¿›è¡Œæ ¡éªŒ å¦‚æœä¸ä¸€è‡´åˆ™æŠ¥é”™</li></ul> 
<p>æ¥ä¸‹æ¥å°±å¯ä»¥å¼€å§‹ä½“éªŒjpaäº†</p> 
<h4><a id="_65"></a>åˆ›å»ºå®ä½“ç±»</h4> 
<p>å¯è§é€šè¿‡æ³¨è§£å¯ä»¥å®ç°å®ä½“ä¸æ•°æ®åº“çš„ç›´æ¥æ˜ å°„ï¼Œjpaæ“ä½œçš„å°±æ˜¯è¿™äº›å®ä½“å°±ç­‰åŒæ“ä½œæ•°æ®åº“çš„è¡¨ç»“æ„ã€‚</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Generated</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author: lyd
 * @description: å®ä½“User
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sys_user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"user_id"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span> <span class="token comment">// è‡ªå¢</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> nickName<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<ul><li>@Dataï¼šlombokä¸‹çš„æ³¨è§£ï¼Œä¸»è¦æ˜¯æ–¹ä¾¿å¼€å‘ï¼Œå‡å°‘å¯¹getã€setã€tostringçš„ç¼–å†™ã€‚è¿™ä¸ªéœ€è¦å¯¼å…¥ç›¸åº”çš„ä¾èµ–åæ ‡ã€‚</li><li>@Entityï¼šå£°æ˜æ˜¯ä¸€ä¸ªå®ä½“ã€‚</li><li>@Table(name = â€œsys_userâ€)ï¼šæŒ‡æ˜æ•°æ®åº“ä¸­è¡¨çš„åå­—å®ç°å®ä½“ä¸æ•°æ®è¡¨æ˜ å°„ã€‚</li><li>@Idï¼šå£°æ˜ä¸»é”®ã€‚</li><li>@Column(name = â€œuser_idâ€)ï¼šæŒ‡æ˜æ˜¯è¡¨ä¸­çš„å“ªä¸ªå­—æ®µã€‚</li><li>@GeneratedValue(strategy = GenerationType.IDENTITY)ï¼š GenerationType.IDENTITYï¼šå®ç°è‡ªå¢</li></ul> 
<h4><a id="_106"></a>å¯åŠ¨é¡¹ç›®</h4> 
<p>å½“æˆ‘ä»¬å¯åŠ¨é¡¹ç›®çš„æ—¶å€™ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„ã€‚<br> <img src="https://images2.imgbox.com/fb/26/xAYuyC3p_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> çœ‹ä¸€ä¸‹æ•°æ®åº“ï¼Œå‘ç°è¡¨å·²ç»è‡ªåŠ¨åˆ›å»º<br> <img src="https://images2.imgbox.com/69/e2/RkUqgNYG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="_111"></a>å¯¹è¡¨æ“ä½œ</h4> 
<h5><a id="_112"></a>å¢åŠ æ•°æ®</h5> 
<p>é¦–å…ˆéœ€è¦åˆ›å»ºUserRepositoryæ¥å£ï¼Œè¦é€šè¿‡ç»§æ‰¿JpaRepository&lt;T, ID&gt;ï¼Œæä¾›å®ä½“ç±»å’Œidçš„ç±»å‹ã€‚</p> 
<pre><code class="prism language-java"><span class="token comment">/**
 * @author: lyd
 * @description: UserRepository
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">JpaSpecificationExecutor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
   
<span class="token punctuation">}</span>
</code></pre> 
<p>ç¼–å†™æµ‹è¯•ç±»<br> é€šè¿‡è°ƒç”¨saveæ–¹æ³•å³å¯å®Œæˆä¿å­˜æ“ä½œ</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">UserRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @author: lyd
 * @description: æµ‹è¯•ç±»
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpaTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserRepository</span> userRepository<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token class-name">InsertTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setNickName</span><span class="token punctuation">(</span><span class="token string">"æ€’æ”¾å§å¾·å¾·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"lyd_code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"lyd_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> save <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿è¡Œç»“æœ<br> <img src="https://images2.imgbox.com/60/4f/M9l3tVBG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="_158"></a>æŸ¥çœ‹æ•°æ®</h5> 
<p>é€šè¿‡findAllå°±å¯ä»¥ç›´æ¥è·å–å¾—åˆ°æ‰€æœ‰çš„æ•°æ®ã€‚</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">QueryTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> all <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    all<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å°±èƒ½åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°ï¼š<br> <img src="https://images2.imgbox.com/fd/5b/XKLI90Xw_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="_170"></a>åˆ†é¡µæŸ¥æ‰¾</h5> 
<p>jpaä¹Ÿæ˜¯å®ç°äº†åˆ†é¡µæ“ä½œçš„æ–¹æ³•ã€‚é€šè¿‡PageRequest.of(0,1)å¯ä»¥å®Œæˆåˆ†é¡µã€‚</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">PageRequestTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å…¶åº•å±‚å¯¹æ•°æ®åº“çš„æ“ä½œå°±ä¼šåŠ ä¸Šlimit.<br> <img src="https://images2.imgbox.com/56/84/ew04IjGp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="ID_181"></a>æ ¹æ®IDæŸ¥æ‰¾</h5> 
<p>è¿”å›æ˜¯Optionalç±»ï¼ŒUserç±»å‹çš„æ•°ç»„</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">FindByIdTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> user <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>Java8 æ–°ç‰¹æ€§Optionalç±»<br> Optional ç±»æ–°ç‰¹æ€§</p> 
 <p>Optional ç±»æ˜¯ä¸€ä¸ªå¯ä»¥ä¸ºnullçš„å®¹å™¨å¯¹è±¡<br> å¦‚æœå€¼å­˜åœ¨åˆ™isPresent()æ–¹æ³•ä¼šè¿”å›trueï¼Œè°ƒç”¨get()æ–¹æ³•ä¼šè¿”å›è¯¥å¯¹è±¡<br> Optional æ˜¯ä¸ªå®¹å™¨ï¼šå®ƒå¯ä»¥ä¿å­˜ç±»å‹Tçš„å€¼ï¼Œæˆ–ä»…ä¿å­˜nullã€‚Optionalæä¾›å¾ˆå¤šæœ‰ç”¨çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨æ˜¾å¼è¿›è¡Œç©ºå€¼æ£€æµ‹<br> Optional ç±»çš„å¼•å…¥å¾ˆå¥½çš„è§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸</p> 
</blockquote> 
<h3><a id="_199"></a>æ–¹æ³•å‘½åè§„åˆ™è‡ªå®šä¹‰æŸ¥è¯¢</h3> 
<p>æ–¹æ³•å‘½åè§„åˆ™æŸ¥è¯¢å°±æ˜¯æ ¹æ®æ–¹æ³•çš„åå­—ï¼Œå°±èƒ½åˆ›å»ºæŸ¥è¯¢ã€‚éœ€è¦æŒ‰ç…§Spring Data JPAæä¾›çš„æ–¹æ³•å‘½åè§„åˆ™å®šä¹‰æ–¹æ³•çš„åç§°ï¼Œå°±å¯ä»¥å®ŒæˆæŸ¥è¯¢å·¥ä½œã€‚Spring Data JPAåœ¨ç¨‹åºæ‰§è¡Œçš„æ—¶å€™ä¼šæ ¹æ®æ–¹æ³•åç§°è¿›è¡Œè§£æï¼Œå¹¶è‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢è¯­å¥è¿›è¡ŒæŸ¥è¯¢ã€‚é€šè¿‡jpaçš„è§„åˆ™è¦æ±‚æ¥å®ç°è‡ªå·±å‘½åæŸ¥è¯¢ã€‚<br> æŒ‰ç…§Spring Data JPA å®šä¹‰çš„è§„åˆ™ï¼ŒæŸ¥è¯¢æ–¹æ³•ä»¥findByå¼€å¤´ï¼Œæ¶‰åŠæ¡ä»¶æŸ¥è¯¢æ—¶ï¼Œæ¡ä»¶çš„å±æ€§ç”¨æ¡ä»¶å…³é”®å­—è¿æ¥ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼šæ¡ä»¶å±æ€§é¦–å­—æ¯éœ€å¤§å†™ã€‚æ¡†æ¶åœ¨è¿›è¡Œæ–¹æ³•åè§£ææ—¶ï¼Œä¼šå…ˆæŠŠæ–¹æ³•åå¤šä½™çš„å‰ç¼€æˆªå–æ‰ï¼Œç„¶åå¯¹å‰©ä¸‹éƒ¨åˆ†è¿›è¡Œè§£æã€‚</p> 
<h4><a id="Repository_202"></a>ç¼–å†™Repository</h4> 
<p>æ ¹æ®ä¸€å®šçš„è§„åˆ™æ¥ç¼–å†™æ–¹æ³•å‘½åã€‚jpaä¼šè‡ªåŠ¨è¯†åˆ«æ–¹æ³•åç§°è¿›è¡Œæ“ä½œã€‚</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>repository</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">JpaRepository</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>repository<span class="token punctuation">.</span></span><span class="token class-name">JpaSpecificationExecutor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author: lyd
 * @description: UserRepository
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">JpaSpecificationExecutor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//æ ¹æ®nicknameæŸ¥è¯¢</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllByNickName</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>é€šè¿‡æµ‹è¯•å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š<br> <img src="https://images2.imgbox.com/20/54/k89BA3pA_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åœ¨ç¼–å†™repositoryçš„æ—¶å€™ä¼šæœ‰ä¸€äº›è§„åˆ™æç¤ºï¼Œä¹Ÿå°±æ˜¯åªæœ‰ç¬¦åˆè¿™äº›è§„åˆ™æ‰èƒ½å¤Ÿè¢«è¯†åˆ«ã€‚è¿™é‡Œåªæ˜¯å±•ç°äº†findxxxï¼Œå®é™…ä¸Šè¿˜æœ‰è®¸å¤šã€‚<br> <img src="https://images2.imgbox.com/f4/ab/UyW0GtKU_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å…·ä½“çš„å…³é”®å­—ï¼Œä½¿ç”¨æ–¹æ³•å’Œç”Ÿäº§æˆSQLå¦‚ä¸‹è¡¨æ‰€ç¤º<br> <img src="https://images2.imgbox.com/25/a5/yvysETsj_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="JPQLSQL_232"></a>ä½¿ç”¨JPQLçš„æ–¹å¼æŸ¥è¯¢(æ³¨è§£å¼SQL)</h3> 
<p>é€šè¿‡Queryæ³¨è§£å¯ä»¥å®ç°æ›´å¤šçµæ´»çš„æ¡ä»¶æŸ¥è¯¢ç­‰SQLÂ·æ“ä½œã€‚@Query æ³¨è§£çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œåªéœ€åœ¨æ–¹æ³•ä¸Šé¢æ ‡æ³¨è¯¥æ³¨è§£ï¼ŒåŒæ—¶æä¾›ä¸€ä¸ªJPQLæŸ¥è¯¢è¯­å¥å³å¯ï¼Œå¹¶ä¸”ï¼Œåœ¨è¿™äº›SQLè¯­å¥ä¸­éƒ½æ˜¯ä½¿ç”¨å®ä½“æ¥è¿›è¡Œæ“ä½œï¼Œå¹¶éæ•°æ®åº“çš„è¡¨ç»“æ„æ¥æ“ä½œã€‚</p> 
<h4><a id="_234"></a>è®¡æ•°</h4> 
<p>é€šè¿‡Queryå¯ä»¥å†™è‡ªå·±çš„SQLè¯­å¥</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select count(u) from User u"</span><span class="token punctuation">)</span> <span class="token comment">// è¿™é‡Œä½¿ç”¨çš„æ˜¯å®ä½“ï¼Œå¹¶ä¸æ˜¯æ•°æ®åº“çš„è¡¨åå’Œå­—æ®µ</span>
<span class="token class-name">Integer</span> <span class="token function">countUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>æµ‹è¯•</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">CountUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Integer</span> integer <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">countUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ç»“æœ<br> <img src="https://images2.imgbox.com/bb/d2/FAfLjDWV_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="_253"></a>å‚æ•°ä¼ é€’</h4> 
<p>åœ¨é€šè¿‡æ³¨è§£å†™SQLçš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦æ˜¯æºå¸¦å‚æ•°çš„ï¼Œè€ŒQueryé€šè¿‡?å ä½ç¬¦æ¥è·å¾—ä¼ æ¥çš„å‚æ•°æ•°æ®ï¼Œé€šè¿‡å‚æ•°çš„ä½ç½®å®šä½å“ªä¸ªå‚æ•°ã€‚</p> 
<pre><code class="prism language-java"><span class="token comment">//ä¿®æ”¹æ•°æ® ä¸€å®šåŠ ä¸Š@Modifying æ³¨è§£</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token annotation punctuation">@Modifying</span>
<span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"update User set username=?1 where id=?2"</span><span class="token punctuation">)</span>
<span class="token keyword">int</span> <span class="token function">updateUsernameByIds</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>ç»“æœ<br> <img src="https://images2.imgbox.com/e0/8b/YculdU9p_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä¹Ÿå¯ä»¥ä½¿ç”¨åŸç”Ÿçš„SQLï¼Œåªéœ€è¦åŠ ä¸Š nativeQuery = true å³å¯ã€‚</p> 
<h3><a id="_266"></a>å®ä½“å…³ç³»å¯¹åº”</h3> 
<p>jpaä¸­å®ä½“åŒ…æ‹¬ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šï¼Œå¤šå¯¹ä¸€å…³ç³»ï¼Œå¹¶ä¸”æä¾›äº†ç›¸åº”çš„æ³¨è§£ã€‚æ¥ä¸‹æ¥é€šè¿‡æ¡ˆä¾‹æ¥å®ç°å…³ç³»ã€‚</p> 
<h4><a id="_268"></a>ä¸€å¯¹ä¸€</h4> 
<p>é¦–å…ˆåˆ›å»ºéƒ¨é—¨è¡¨ï¼Œä½¿ç”¨æˆ·æŒ‡å‘ä¸€ä¸ªéƒ¨é—¨ã€‚</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @author: lyd
 * @description: éƒ¨é—¨
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"sys_dept"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dept</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dept_id"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨Userå®ä½“ä¸­åŠ å­—æ®µï¼Œé€šè¿‡OneToOneæ³¨è§£å®Œæˆã€‚</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@OneToOne</span><span class="token punctuation">(</span>fetch <span class="token operator">=</span> <span class="token class-name">FetchType</span><span class="token punctuation">.</span>LAZY<span class="token punctuation">,</span> cascade <span class="token operator">=</span> <span class="token class-name">CascadeType</span><span class="token punctuation">.</span>ALL<span class="token punctuation">)</span> <span class="token comment">//è®¾ç½®å…³è”æ“ä½œä¸ºALL</span>
<span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"dept_id"</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Dept</span> dept<span class="token punctuation">;</span>
</code></pre> 
<p>è¿™é‡Œçš„å…³è”çº§åˆ«ä¹Ÿæ˜¯æœ‰å¤šä¸ª,ä¸€èˆ¬è®¾ç½®ä¸ºallå°±è¡Œ</p> 
<ul><li>ALLï¼šæ‰€æœ‰æ“ä½œéƒ½è¿›è¡Œå…³è”æ“ä½œ</li><li>PERSISTï¼šæ’å…¥æ“ä½œæ—¶æ‰è¿›è¡Œå…³è”æ“ä½œ</li><li>REMOVEï¼šåˆ é™¤æ“ä½œæ—¶æ‰è¿›è¡Œå…³è”æ“ä½œ</li><li>MERGEï¼šä¿®æ”¹æ“ä½œæ—¶æ‰è¿›è¡Œå…³è”æ“ä½œ<br> è¿™æ ·å°±å¯ä»¥ç¼–å†™æµ‹è¯•</li></ul> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">OneToOneTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setNickName</span><span class="token punctuation">(</span><span class="token string">"çˆ±å›½å¾·å¾·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"lyd_code_studio"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"lyd_open"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Dept</span> dept <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dept<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"ç ”å‘éƒ¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setDept</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">User</span> save <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>é€šè¿‡æµ‹è¯•å¯å¾—æ•°æ®åº“ç»“æœï¼Œ<br> <img src="https://images2.imgbox.com/28/d0/bgixrJc7_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/8d/77/DGkat5k5_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> é€šè¿‡å…³è”ï¼Œä¼šåœ¨ä¸¤ä¸ªè¡¨ä¸­è¿›è¡Œæ’å…¥ï¼Œåˆ é™¤ä¹Ÿæ˜¯ä¼šåˆ é™¤ä¸¤ä¸ªè¡¨ä¸­æ•°æ®ã€‚</p> 
<h4><a id="_326"></a>ä¸€å¯¹å¤š</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@OneToMany</span><span class="token operator">:</span>
   	ä½œç”¨ï¼šå»ºç«‹ä¸€å¯¹å¤šçš„å…³ç³»æ˜ å°„
    å±æ€§ï¼š
    	targetEntityClassï¼šæŒ‡å®šå¤šçš„å¤šæ–¹çš„ç±»çš„å­—èŠ‚ç 
    	mappedByï¼šæŒ‡å®šä»è¡¨å®ä½“ç±»ä¸­å¼•ç”¨ä¸»è¡¨å¯¹è±¡çš„åç§°ã€‚
    	cascadeï¼šæŒ‡å®šè¦ä½¿ç”¨çš„çº§è”æ“ä½œ
    	fetchï¼šæŒ‡å®šæ˜¯å¦é‡‡ç”¨å»¶è¿ŸåŠ è½½
    	orphanRemovalï¼šæ˜¯å¦ä½¿ç”¨å­¤å„¿åˆ é™¤
</code></pre> 
<p>åˆ›å»ºä¸€ä¸ªæ–‡ç« è¡¨æ¥å®ç°ä¸€å¯¹å¤šå…³ç³»ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥å‘è¡¨å¤šä¸ªæ–‡ç« ï¼Œä¸€ä¸ªæ–‡ç« åªå±äºä¸€ä¸ªç”¨æˆ·ï¼Œå› æ­¤åœ¨ç”¨æˆ·è¡¨ä¸­æ˜¯ä¸€å¯¹å¤šï¼Œåœ¨æ–‡ç« è¡¨å°±æ˜¯å¤šå¯¹ä¸€ã€‚<br> é€šè¿‡@ManyToOneæ³¨è§£å®Œæˆå…³ç³»</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @author: lyd
 * @description: æ–‡ç« è¡¨
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"yun_article"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"article_id"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> length <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">// æ˜ å°„ä¸ºå­—æ®µï¼Œå€¼ä¸èƒ½ä¸ºç©º</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Basic</span><span class="token punctuation">(</span>fetch <span class="token operator">=</span> <span class="token class-name">FetchType</span><span class="token punctuation">.</span>LAZY<span class="token punctuation">)</span> <span class="token comment">// æ‡’åŠ è½½</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// æ˜ å°„ä¸ºå­—æ®µï¼Œå€¼ä¸èƒ½ä¸ºç©º</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ManyToOne</span><span class="token punctuation">(</span>cascade<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token class-name">CascadeType</span><span class="token punctuation">.</span>MERGE<span class="token punctuation">,</span><span class="token class-name">CascadeType</span><span class="token punctuation">.</span>REFRESH<span class="token punctuation">}</span><span class="token punctuation">,</span>optional<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">//å¯é€‰å±æ€§optional=false,è¡¨ç¤ºuserä¸èƒ½ä¸ºç©ºã€‚åˆ é™¤æ–‡ç« ï¼Œä¸å½±å“ç”¨æˆ·</span>
    <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"user_id"</span><span class="token punctuation">)</span><span class="token comment">//è®¾ç½®åœ¨articleè¡¨ä¸­çš„å…³è”å­—æ®µ(å¤–é”®)</span>
    <span class="token keyword">private</span> <span class="token class-name">User</span> user<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨userå®ä½“è¿™è¾¹å°±æ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼Œå¹¶ä¸”é€šè¿‡æ³¨è§£å®Œæˆã€‚</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">,</span>cascade<span class="token operator">=</span><span class="token class-name">CascadeType</span><span class="token punctuation">.</span>ALL<span class="token punctuation">,</span>fetch<span class="token operator">=</span><span class="token class-name">FetchType</span><span class="token punctuation">.</span>LAZY<span class="token punctuation">)</span>
<span class="token comment">//çº§è”ä¿å­˜ã€æ›´æ–°ã€åˆ é™¤ã€åˆ·æ–°;å»¶è¿ŸåŠ è½½ã€‚å½“åˆ é™¤ç”¨æˆ·ï¼Œä¼šçº§è”åˆ é™¤è¯¥ç”¨æˆ·çš„æ‰€æœ‰æ–‡ç« </span>
<span class="token comment">//æ‹¥æœ‰mappedByæ³¨è§£çš„å®ä½“ç±»ä¸ºå…³ç³»è¢«ç»´æŠ¤ç«¯</span>
<span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Article</span><span class="token punctuation">&gt;</span></span> articles<span class="token punctuation">;</span>
</code></pre> 
<p>æµ‹è¯•ï¼Œéœ€è¦åˆ›å»ºArticleRepository</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">OneToMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Article</span> article1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Article</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article1<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"å¦‚ä½•å†™å¥½åšå®¢"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article1<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">"å¦‚ä½•å†™å¥½åšå®¢"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article1<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    articleRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>article1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Article</span> article2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Article</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article2<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"å¦‚ä½•æ›´è¿›ä¸€æ­¥å­¦ä¹ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article2<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">"ä¸æ–­åœ°å·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article2<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    articleRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>article2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿è¡Œç»“æœ<br> <img src="https://images2.imgbox.com/50/4d/ZiAd7WLp_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ•°æ®åº“ä¸­<br> <img src="https://images2.imgbox.com/27/41/u6qgb4y9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="_403"></a>å¤šå¯¹å¤š</h4> 
<p>JPAä¸­ä½¿ç”¨@ManyToManyæ¥æ³¨è§£å¤šå¯¹å¤šçš„å…³ç³»ï¼Œç”±ä¸€ä¸ªå…³è”è¡¨æ¥ç»´æŠ¤ã€‚è¿™ä¸ªå…³è”è¡¨çš„è¡¨åé»˜è®¤æ˜¯ï¼šä¸»è¡¨å+ä¸‹åˆ’çº¿+ä»è¡¨åã€‚(ä¸»è¡¨æ˜¯æŒ‡å…³ç³»ç»´æŠ¤ç«¯å¯¹åº”çš„è¡¨,ä»è¡¨æŒ‡å…³ç³»è¢«ç»´æŠ¤ç«¯å¯¹åº”çš„è¡¨)ã€‚è¿™ä¸ªå…³è”è¡¨åªæœ‰ä¸¤ä¸ªå¤–é”®å­—æ®µï¼Œåˆ†åˆ«æŒ‡å‘ä¸»è¡¨IDå’Œä»è¡¨IDã€‚å­—æ®µçš„åç§°é»˜è®¤ä¸ºï¼šä¸»è¡¨å+ä¸‹åˆ’çº¿+ä¸»è¡¨ä¸­çš„ä¸»é”®åˆ—åï¼Œä»è¡¨å+ä¸‹åˆ’çº¿+ä»è¡¨ä¸­çš„ä¸»é”®åˆ—åã€‚é€šè¿‡@JoinTableæ¥å®ç°ä¸­é—´è¡¨ã€‚<br> åˆ›å»ºè§’è‰²è¡¨</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Set</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @author: lyd
 * @description: è§’è‰²è¡¨
 * @Date: 2022/10/2
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sys_role"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Role</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"role_id"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ManyToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"roles"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"level"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> level <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨ç”¨æˆ·è¡¨ä¸­</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@ManyToMany</span>
<span class="token annotation punctuation">@JoinTable</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"sys_users_roles"</span><span class="token punctuation">,</span>
        joinColumns <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"user_id"</span><span class="token punctuation">,</span>referencedColumnName <span class="token operator">=</span> <span class="token string">"user_id"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        inverseJoinColumns <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"role_id"</span><span class="token punctuation">,</span>referencedColumnName <span class="token operator">=</span> <span class="token string">"role_id"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Role</span><span class="token punctuation">&gt;</span></span> roles<span class="token punctuation">;</span>
</code></pre> 
<p>æµ‹è¯•</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">ManyToMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Role</span> role <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Role</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    role<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    role<span class="token punctuation">.</span><span class="token function">setLevel</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    role<span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string">"ç®¡ç†å‘˜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    roleRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Role</span><span class="token punctuation">&gt;</span></span> roles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    roles<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"lyd_code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setNickName</span><span class="token punctuation">(</span><span class="token string">"æ€’æ”¾å¾·å¾·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"lyd_code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span><span class="token function">setRoles</span><span class="token punctuation">(</span>roles<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> save <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨æ•°æ®åº“ä¸­çš„ä¸­é—´è¡¨å°±èƒ½å¤Ÿçœ‹åˆ°å¦‚ä¸‹æ•°æ®ã€‚<br> <img src="https://images2.imgbox.com/7d/94/wcNbEpeI_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_477"></a>æ–‡ç« æ¨è</h3> 
<ul><li><a href="https://www.ydlclass.com/doc21xnv/frame/jpa/jpa.html#%E7%AC%AC%E4%B8%80%E7%AB%A0-orm%E6%A6%82%E8%BF%B0-%E4%BA%86%E8%A7%A3" rel="nofollow">å…ƒåŠ¨åŠ›æ–‡æ¡£åˆé›† - SPRING-DATA-JPA</a></li><li><font color="red">CSDN</font>ï¼š<a href="https://blog.csdn.net/cmx1060220219/article/details/106259423">https://blog.csdn.net/cmx1060220219/article/details/106259423</a></li><li><font color="red">CSDN</font>ï¼š<a href="https://blog.csdn.net/localhost01/article/details/83422893">https://blog.csdn.net/localhost01/article/details/83422893</a></li></ul> 
<p>ğŸ‘åˆ›ä½œä¸æ˜“ï¼Œå¦‚æœ‰é”™è¯¯è¯·æŒ‡æ­£ï¼Œæ„Ÿè°¢è§‚çœ‹ï¼è®°å¾—ç‚¹èµå“¦ï¼ğŸ‘</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b9080c5b92e5234e140e7cb16916b3d/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">yolov5â€”â€”é—®é¢˜è®°å½•</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f992df156fa9ddb3f19b44f040e73129/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">åä¸º----VRFéš”ç¦»ï¼ˆç”Ÿäº§ç½‘å’ŒåŠå…¬ç½‘çš„éš”ç¦»ï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 èœé¸Ÿç¨‹åºå‘˜åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>