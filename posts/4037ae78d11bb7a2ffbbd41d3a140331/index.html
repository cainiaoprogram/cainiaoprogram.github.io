<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sklearn的特征抽取和特征筛选 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sklearn的特征抽取和特征筛选" />
<meta property="og:description" content="数据分析过程中，往往需要处理很多类型的数据，数值型和非数值型，无论是在回归问题还是分类问题中，特征工程都是重中之重。
我们都知道，特征值和特征向量在高等数学和线性代数中极为关键，特征工程，从表面上来说，就是从大大小小的数据中，筛选出有意义或者有用的条目，进而转换成一种数学表达，让机器和算法能够理解其中的意义。好比一个班上的每个学生，都有性别、年龄、身高、体重、成绩、性格特点等等特征，年龄、身高、体重、成绩属于数值型的特征，可以直接为我们所用，性别、性格特点属于非数值型特征，需要通过转换才能被算法理解。
python的sklearn包，包含了特征工程常用的工具和api，主要有以下几个方面：
特征抽取 sklearn.feature_extraction：包含了常用的用于特征抽取的api
DictVectorizer(dtype=&lt;class ‘numpy.float64’&gt;, separator=’=’, sparse=True, sort=True)
通过字典传入抽取特征,用于将标签型或非数值型数据的抽取和转换，sparse参数表示是否转换为稀疏矩阵&gt;&gt;&gt; from sklearn.feature_extraction import DictVectorizer &gt;&gt;&gt; v = DictVectorizer(sparse=False) &gt;&gt;&gt; D = [{&#39;foo&#39;: 1, &#39;bar&#39;: 2}, {&#39;foo&#39;: 3, &#39;baz&#39;: 1}] &gt;&gt;&gt; X = v.fit_transform(D) &gt;&gt;&gt; X array([[2., 0., 1.], [0., 1., 3.]]) FeatureHasher(n_features=1048576, input_type=’dict’, dtype=&lt;class ‘numpy.float64’&gt;, alternate_sign=True)
将输入转换为hash矩阵，n_features为特征的列数,也就是特征维数，input_type为输入的python数据类型，通常用于处理特征的维度较大的问题。&gt;&gt;&gt; from sklearn.feature_extraction import FeatureHasher &gt;&gt;&gt; h = FeatureHasher(n_features=10) &gt;&gt;&gt; D = [{&#39;dog&#39;: 1, &#39;cat&#39;:2, &#39;elephant&#39;:4},{&#39;dog&#39;: 2, &#39;run&#39;: 5}] &gt;&gt;&gt; f = h." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/4037ae78d11bb7a2ffbbd41d3a140331/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-23T15:36:23+08:00" />
<meta property="article:modified_time" content="2019-07-23T15:36:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sklearn的特征抽取和特征筛选</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>数据分析过程中，往往需要处理很多类型的数据，数值型和非数值型，无论是在回归问题还是分类问题中，特征工程都是重中之重。<br> 我们都知道，特征值和特征向量在高等数学和线性代数中极为关键，特征工程，从表面上来说，就是从大大小小的数据中，筛选出有意义或者有用的条目，进而转换成一种数学表达，让机器和算法能够理解其中的意义。好比一个班上的每个学生，都有性别、年龄、身高、体重、成绩、性格特点等等特征，年龄、身高、体重、成绩属于数值型的特征，可以直接为我们所用，性别、性格特点属于非数值型特征，需要通过转换才能被算法理解。<br> python的sklearn包，包含了特征工程常用的工具和api，主要有以下几个方面：</p> 
<h3><a id="_3"></a>特征抽取</h3> 
<p>sklearn.feature_extraction：包含了常用的用于特征抽取的api</p> 
<ul><li>DictVectorizer(dtype=&lt;class ‘numpy.float64’&gt;, separator=’=’, sparse=True, sort=True)<br> 通过字典传入抽取特征,用于将标签型或非数值型数据的抽取和转换，sparse参数表示是否转换为稀疏矩阵<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction <span class="token keyword">import</span> DictVectorizer
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> v <span class="token operator">=</span> DictVectorizer<span class="token punctuation">(</span>sparse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> D <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'foo'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'foo'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X <span class="token operator">=</span> v<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>D<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> </li><li>FeatureHasher(n_features=1048576, input_type=’dict’, dtype=&lt;class ‘numpy.float64’&gt;, alternate_sign=True)<br> 将输入转换为hash矩阵，n_features为特征的列数,也就是特征维数，input_type为输入的python数据类型，通常用于处理特征的维度较大的问题。<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction <span class="token keyword">import</span> FeatureHasher
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> h <span class="token operator">=</span> FeatureHasher<span class="token punctuation">(</span>n_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> D <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'dog'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'cat'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'elephant'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string">'dog'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'run'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> f <span class="token operator">=</span> h<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>D<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> f<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> </li><li>image<br> 从图像中直接抽取特征 
  <ul><li>image.extract_patches_2d(image, patch_size, max_patches=None, random_state=None)<br> 从二维图像中抽取特征，patch_size为输出的色块或图像块的维度，是一个二维元祖，max_patches表示最大的色块维度，random_state表示当max_patches不为none时，是否采用随机数采样填充色块的值。输出的每个图像块均为一个RGB三通道构成</li></ul> <pre><code class="prism language-python">	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_sample_image
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction <span class="token keyword">import</span> image
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token comment"># Use the array data from the first image in this dataset:</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> one_image <span class="token operator">=</span> load_sample_image<span class="token punctuation">(</span><span class="token string">"china.jpg"</span><span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Image shape: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>one_image<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
	Image shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">427</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> patches <span class="token operator">=</span> image<span class="token punctuation">.</span>extract_patches_2d<span class="token punctuation">(</span>one_image<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Patches shape: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>patches<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
	Patches shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">272214</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token comment"># Here are just two of these patches:</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>patches<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
	<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">174</span> <span class="token number">201</span> <span class="token number">231</span><span class="token punctuation">]</span>
	  <span class="token punctuation">[</span><span class="token number">174</span> <span class="token number">201</span> <span class="token number">231</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
	 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">173</span> <span class="token number">200</span> <span class="token number">230</span><span class="token punctuation">]</span>
	  <span class="token punctuation">[</span><span class="token number">173</span> <span class="token number">200</span> <span class="token number">230</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>patches<span class="token punctuation">[</span><span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">187</span> <span class="token number">214</span> <span class="token number">243</span><span class="token punctuation">]</span>
	  <span class="token punctuation">[</span><span class="token number">188</span> <span class="token number">215</span> <span class="token number">244</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
	 <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">187</span> <span class="token number">214</span> <span class="token number">243</span><span class="token punctuation">]</span>
	  <span class="token punctuation">[</span><span class="token number">188</span> <span class="token number">215</span> <span class="token number">244</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
  <ul><li>image.grid_to_graph(n_x, n_y, n_z=1, mask=None, return_as=&lt;class ‘scipy.sparse.coo.coo_matrix’&gt;, dtype=&lt;class ‘int’&gt;)</li><li>image.img_to_graph(img, mask=None, return_as=&lt;class ‘scipy.sparse.coo.coo_matrix’&gt;, dtype=None)<br> 图像转换为连通图矩阵</li><li>image.reconstruct_from_patches_2d(patches, image_size)<br> 用图像块矩阵构造图片</li><li>image.PatchExtractor(patch_size=None, max_patches=None, random_state=None)<br> 同extract_patches_2d，用法不同<pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_sample_images
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction <span class="token keyword">import</span> image
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token comment"># Use the array data from the second image in this dataset:</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X <span class="token operator">=</span> load_sample_images<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>images<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Image shape: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
Image shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">427</span><span class="token punctuation">,</span> <span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> pe <span class="token operator">=</span> image<span class="token punctuation">.</span>PatchExtractor<span class="token punctuation">(</span>patch_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> pe_fit <span class="token operator">=</span> pe<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> pe_trans <span class="token operator">=</span> pe<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Patches shape: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>pe_trans<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
Patches shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">545706</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> </li></ul> </li><li>text 
  <ul><li>text.CountVectorizer(input=’content’, encoding=’utf-8’, decode_error=’strict’, strip_accents=None, lowercase=True, preprocessor=None, tokenizer=None, stop_words=None, token_pattern=’(?u)\b\w\w+\b’, ngram_range=(1, 1), analyzer=’word’, max_df=1.0, min_df=1, max_features=None, vocabulary=None, binary=False, dtype=&lt;class ‘numpy.int64’&gt;)<br> 根据词典，矢量词频统计</li></ul> <pre><code class="prism language-python">	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> CountVectorizer
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> corpus <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'This is the first document.'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'This document is the second document.'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'And this is the third one.'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'Is this the first document?'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> vectorizer <span class="token operator">=</span> CountVectorizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>vectorizer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">[</span><span class="token string">'and'</span><span class="token punctuation">,</span> <span class="token string">'document'</span><span class="token punctuation">,</span> <span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'is'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'second'</span><span class="token punctuation">,</span> <span class="token string">'the'</span><span class="token punctuation">,</span> <span class="token string">'third'</span><span class="token punctuation">,</span> <span class="token string">'this'</span><span class="token punctuation">]</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>toarray<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
	<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">]</span>
	 <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">]</span>
	 <span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span><span class="token punctuation">]</span>
	 <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
  <ul><li>text.HashingVectorizer(input=’content’, encoding=’utf-8’, decode_error=’strict’, strip_accents=None, lowercase=True, preprocessor=None, tokenizer=None, stop_words=None, token_pattern=’(?u)\b\w\w+\b’, ngram_range=(1, 1), analyzer=’word’, n_features=1048576, binary=False, norm=’l2’, alternate_sign=True, dtype=&lt;class ‘numpy.float64’&gt;)<br> 矢量词频统计，词典自动生成</li></ul> <pre><code class="prism language-python">	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> HashingVectorizer
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> corpus <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'This is the first document.'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'This document is the second document.'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'And this is the third one.'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token string">'Is this the first document?'</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> vectorizer <span class="token operator">=</span> HashingVectorizer<span class="token punctuation">(</span>n_features<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>corpus<span class="token punctuation">)</span>
	<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
	<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
</code></pre> 
  <ul><li> <p>text.TfidfTransformer(norm=’l2’, use_idf=True, smooth_idf=True, sublinear_tf=False)</p> </li><li> <p>text.TfidfVectorizer(input=’content’, encoding=’utf-8’, decode_error=’strict’, strip_accents=None, lowercase=True, preprocessor=None, tokenizer=None, analyzer=’word’, stop_words=None, token_pattern=’(?u)\b\w\w+\b’, ngram_range=(1, 1), max_df=1.0, min_df=1, max_features=None, vocabulary=None, binary=False, dtype=&lt;class ‘numpy.float64’&gt;, norm=’l2’, use_idf=True, smooth_idf=True, sublinear_tf=False)</p> </li></ul> </li></ul> 
<h3><a id="_112"></a>特征筛选</h3> 
<p>sklearn.feature_selection,包含了特征筛选所用的api</p> 
<ul><li> <p>GenericUnivariateSelect(score_func=, mode=’percentile’, param=1e-05)<br> 单变量筛选器，score_func为评价函数，mode为筛选策略，主要有{‘percentile’, ‘k_best’, ‘fpr’, ‘fdr’, ‘fwe’}几种，具体有什么意义见下文。param筛选策略的参数。</p> <pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancer
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> GenericUnivariateSelect<span class="token punctuation">,</span> chi2
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X<span class="token punctuation">.</span>shape
<span class="token punctuation">(</span><span class="token number">569</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> transformer <span class="token operator">=</span> GenericUnivariateSelect<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> <span class="token string">'k_best'</span><span class="token punctuation">,</span> param<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X_new <span class="token operator">=</span> transformer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X_new<span class="token punctuation">.</span>shape
<span class="token punctuation">(</span><span class="token number">569</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre> <p>评价函数分为以下几种：</p> 
  <ul><li>f_classif<br> 方差分析中f值，也就是通常说的F检验，主要用于判断两个样本之间方差是否存在明显差异，主要用于特征对类别（标记）的<strong>分类任务中</strong>。</li><li>mutual_info_classif<br> 变量和目标值之间的互信息，<strong>用于分类任务</strong>，计算公式如下。互信息是一种有用的信息度量，它可以看成是一个随机变量中包含的关于另一个随机变量的信息量，或者说是一个随机变量由于已知另一个随机变量而减少的不肯定性。<br> <img src="https://images2.imgbox.com/0f/59/kkxng1ur_o.png" alt="在这里插入图片描述"></li><li>chi2<br> 卡方检验，主要用于<strong>分类任务中</strong>。</li><li>f_regression<br> 特征和类别（标记）的F值，主要用于<strong>回归分析</strong>。</li><li>mutual_info_regression<br> 互信息，用于目标值为连续变量（非标记或类别）的分类任务。</li></ul> </li><li> <p>SelectPercentile(score_func=, percentile=10)<br> 基于评价函数结果的百分位数来筛选特征，score_func为评价函数，percentile是百分比。例如选择卡方检验，选择10百分数，则输出结果会筛选出卡方检验值的前10%的特征作出输出特征。</p> <pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_digits
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectPercentile<span class="token punctuation">,</span> chi2
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X<span class="token punctuation">,</span> y <span class="token operator">=</span> load_digits<span class="token punctuation">(</span>return_X_y<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X<span class="token punctuation">.</span>shape
<span class="token punctuation">(</span><span class="token number">1797</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X_new <span class="token operator">=</span> SelectPercentile<span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> percentile<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X_new<span class="token punctuation">.</span>shape
<span class="token punctuation">(</span><span class="token number">1797</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p>SelectKBest(score_func=, k=10)<br> 基于评价函数结果筛选出最高的前K个特征</p> </li><li> <p>SelectFpr(score_func=, alpha=0.05)<br> 基于特征的<strong>假正率</strong>测试，筛选特征。假正率=被模型预测为正的负样本/(被模型预测为正的负样本+被模型预测为负的负样本)，具体如下，主要用于二分类任务。score_func为评价函数，默认为f_classif，alpha评价函数的p值的上限值。</p> 
  <table><thead><tr><th><br></th><th>预正</th><th>预负</th></tr></thead><tbody><tr><td>实正</td><td>真正（TP）</td><td>假负(FN)</td></tr><tr><td>实负</td><td>假正（FP）</td><td>正负(TN)）</td></tr></tbody></table> 
  <ul><li>True Positive Rate（真正率 , TPR）或灵敏度（sensitivity）<br> TPR = TP /（TP + FN）<br> 正样本预测结果数 / 正样本实际数</li><li>True Negative Rate（真负率 , TNR）或特指度（specificity）<br> TNR = TN /（TN + FP）<br> 负样本预测结果数 / 负样本实际数</li><li>False Positive Rate （假正率, FPR）<br> FPR = FP /（FP + TN）<br> 被预测为正的负样本结果数 /负样本实际数</li><li>False Negative Rate（假负率 , FNR）<br> FNR = FN /（TP + FN）<br> 被预测为负的正样本结果数 / 正样本实际数</li></ul> </li><li> <p>SelectFdr(score_func=, alpha=0.05)<br> 基于错误发现率（fdr）进行特征筛选，定义是错误拒绝（拒绝真的原假设）的个数占所有被拒绝的原假设个数的比例的期望值。通俗一点理解，就是实际为负的那部分样本中，通过特征计算得出的为负的样本所占的比例。alpha为p值的上限值。同样用于<strong>二分类任务</strong>。</p> </li><li> <p>SelectFwe(score_func=, alpha=0.05)<br> 基于总Ⅰ型错误率筛选特征，关于FDR和FWE的知识，可参考<a href="https://blog.csdn.net/shengchaohua163/article/details/86738462">链接</a></p> </li><li> <p>SelectFromModel(estimator, threshold=None, prefit=False, norm_order=1, max_features=None)<br> 基于模型选择特征，简单理解就是先采用模型对每个特征进行一次分类或回归任务，通过错误率或者误差筛选特征，estimator为评价器，也就是回归或分类模型，必须带有特征权重feature_importances_或者系数coef_；threshold为阈值，特征的权重大于或等于阈值的将会保留，否则就会被剔除；prefit是否直接fit筛选器；norm_order：规定的系数的个数；max_features=最大筛选特征量。</p> </li><li> <p>RFE(estimator, n_features_to_select=None, step=1, verbose=0)<br> 递归筛选特征，给定一个带权重或系数的评价器，RFE会对权重进行排序，首先对所有特征进行评价计算，进行迭代计算，每次迭代计算筛选出step个权重或系数最小的特征，直到剩余的特征数等于n_features_to_select。verbose用于是否输出过程。</p> <pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_friedman1
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> RFE
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVR
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_friedman1<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> estimator <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"linear"</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> selector <span class="token operator">=</span> RFE<span class="token punctuation">(</span>estimator<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> selector <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> selector<span class="token punctuation">.</span>support_ 
array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span>
       <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> selector<span class="token punctuation">.</span>ranking_
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p>RFECV(estimator, step=1, min_features_to_select=1, cv=’warn’, scoring=None, verbose=0, n_jobs=None)<br> 同RFE，加入了交叉验证的过程。</p> </li><li> <p>VarianceThreshold(threshold=0.0)<br> 方差阈值筛选，threshold是方差的阈值</p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a4eb2cd752f1b00c08cd03006f4c429e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql数据库基础与权限认证</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/70e54a2b17ff9c7da37fc78933330b4c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">好站推荐-四个在线识别字体网站，从此不在为找字体烦恼</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>