<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>selenium&#43;Python(事件) - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="selenium&#43;Python(事件)" />
<meta property="og:description" content="1、操作测试对象
前面讲到了不少知识都是定位元素，定位只是第一步，定位之后需要对这个元素进
行操作。鼠标点击或者键盘输入，这要取决于我们定位的是按钮还输入框。
一般来说，webdriver 中比较常用的操作对象的方法有下面几个
click 点击对象send_keys 在对象上模拟按键输入clear 清除对象的内容，如果可以的话submit 清除对象的内容，如果可以的话text 用于获取元素的文本信息 1.1 、鼠标点击与键盘输入
在我们本系列开篇的第一个例子里就用到了到 click 和 send_skys ，
coding=utf-8 from selenium import webdriver import time driver = webdriver.Firefox() driver.get(&#34;http://www.baidu.com&#34;) driver.find_element_by_id(&#34;kw&#34;).clear() driver.find_element_by_id(&#34;kw&#34;).send_keys(&#34;selenium&#34;) time.sleep(2) #通过 submit() 来操作 driver.find_element_by_id(&#34;su&#34;).submit() time.sleep(3) driver.quit() send_keys(&#34;xx&#34;) 用于在一个输入框里输入 xx 内容。
click() 用于点击一个按钮。
clear() 用于清除输入框的内容，比如百度输入框里默认有个“请输入关键
字”的信息，再比如我们的登陆框一般默认会有“账号”“密码”这样的默认信息。
clear 可以帮助我们清除这些信息。
1.2 、submit 提交表单
我们把“百度一下”的操作从 click 换成 submit 可以达到相同的效果：
#coding=utf-8 from selenium import webdriver import time driver = webdriver.Firefox() driver.get(&#34;http://www.baidu.com&#34;) driver.find_element_by_id(&#34;kw&#34;).send_keys(&#34;selenium&#34;) time." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/21aedb6b3aa93dac646711bb14989383/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-21T11:00:00+08:00" />
<meta property="article:modified_time" content="2017-08-21T11:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">selenium&#43;Python(事件)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p><span style="font-size:16px;"><strong>1、操作测试对象</strong></span><br>前面讲到了不少知识都是定位元素，定位只是第一步，定位之后需要对这个元素进<br>行操作。鼠标点击或者键盘输入，这要取决于我们定位的是按钮还输入框。<br>一般来说，webdriver 中比较常用的操作对象的方法有下面几个</p> 
 <ul><li>click 点击对象</li><li>send_keys 在对象上模拟按键输入</li><li>clear 清除对象的内容，如果可以的话</li><li>submit 清除对象的内容，如果可以的话</li><li>text 用于获取元素的文本信息</li></ul> 
 <p>1.1 、鼠标点击与键盘输入<br>在我们本系列开篇的第一个例子里就用到了到 click 和 send_skys ，</p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">coding=utf-8
from selenium import webdriver
import time
driver = webdriver.Firefox()
driver.get("http://www.baidu.com")
driver.find_element_by_id("kw").clear()
driver.find_element_by_id("kw").send_keys("selenium")
time.sleep(2)
#通过 submit() 来操作
driver.find_element_by_id("su").submit()
time.sleep(3)
driver.quit()
</code></pre> 
 </div> 
 <p>send_keys("xx") 用于在一个输入框里输入 xx 内容。</p> 
 <p>click() 用于点击一个按钮。</p> 
 <p>clear() 用于清除输入框的内容，比如百度输入框里默认有个“请输入关键<br>字”的信息，再比如我们的登陆框一般默认会有“账号”“密码”这样的默认信息。<br>clear 可以帮助我们清除这些信息。<br>1.2 、submit 提交表单<br>我们把“百度一下”的操作从 click 换成 submit 可以达到相同的效果：</p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">#coding=utf-8
from selenium import webdriver
import time
driver = webdriver.Firefox()
driver.get("http://www.baidu.com")
driver.find_element_by_id("kw").send_keys("selenium")
time.sleep(2)
#通过 submit() 来操作
driver.find_element_by_id("su").submit()
time.sleep(3)
driver.quit()
</code></pre> 
 </div> 
 <p>1.3 、text 获取元素文本</p> 
 <p>text 用于获取元素的文本信息<br>下面把百度首页底部的声明打印输出</p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">#coding=utf-8
from selenium import webdriver
import time
driver = webdriver.Firefox()
driver.get("http://www.baidu.com")
time.sleep(2)
#id = cp 元素的文本信息
data=driver.find_element_by_id("cp").text
print data #打印信息
time.sleep(3)
driver.quit()
</code></pre> 
 </div> 
 <p>输出：</p> 
 <p>&gt;&gt;&gt;</p> 
 <p>©2013 Baidu 使用百度前必读 京 ICP 证030173号<br>1.4 、get_attribute 获得属性值<br>get_attribute<br>获得属性值。<br>这个函数的用法前面已经有出现过，在定位一组元素的时候有使用到它<br>一般用法：<br>select = driver.find_element_by_tag_name("select")<br>allOptions = select.find_elements_by_tag_name("option")<br>for option in allOptions:<br>print "Value is: " + option.get_attribute("value")<br>option.click()<br><span style="font-size:16px;"><strong>2、键盘事件</strong></span><br>本章重点：</p> 
 <p> </p> 
 <ul><li>键盘按键用法</li><li>键盘组合键用法</li><li>send_keys() 输入中文乱码问题</li></ul> 
 <p>2.1 、键盘按键用法</p> 
 <p> </p> 
 <p> </p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">#coding=utf-8
from selenium import webdriver
from selenium.webdriver.common.keys import Keys #需要引入 keys 包
import os,time
driver = webdriver.Firefox()
driver.get("http://passport.kuaibo.com/login/?referrer=http%3A%2F%2Fwebcloud
.kuaibo.com%2F")
time.sleep(3)
driver.maximize_window() # 浏览器全屏显示
driver.find_element_by_id("user_name").clear()
driver.find_element_by_id("user_name").send_keys("fnngj")
#tab 的定位相相于清除了密码框的默认提示信息，等同上面的 clear()
driver.find_element_by_id("user_name").send_keys(Keys.TAB)
time.sleep(3)
driver.find_element_by_id("user_pwd").send_keys("123456")
#通过定位密码框，enter（回车）来代替登陆按钮
driver.find_element_by_id("user_pwd").send_keys(Keys.ENTER)
'''
#也可定位登陆按钮，通过 enter（回车）代替 click()
driver.find_element_by_id("login").send_keys(Keys.ENTER)
'''
time.sleep(3)
driver.quit()</code></pre> 
 </div> 
 <p>要想调用键盘按键操作需要引入 keys 包：<br>from selenium.webdriver.common.keys import Keys<br>通过 send_keys()调用按键：<br>send_keys(Keys.TAB) # TAB<br>send_keys(Keys.ENTER) # 回车<br>注意：这个操作和页面元素的遍历顺序有关，假如当前定位在账号输入框，按键<br>盘的 tab 键后遍历的不是密码框，那就不法输入密码。 假如输入密码后，还有<br>需要填写验证码，那么回车也起不到登陆的效果。<br>2.2 、键盘组合键用法</p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">#coding=utf-8
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import time
driver = webdriver.Firefox()
driver.get("http://www.baidu.com")
#输入框输入内容
driver.find_element_by_id("kw").send_keys("selenium")
time.sleep(3)
#ctrl+a 全选输入框内容
driver.find_element_by_id("kw").send_keys(Keys.CONTROL,'a')
time.sleep(3)
#ctrl+x 剪切输入框内容
driver.find_element_by_id("kw").send_keys(Keys.CONTROL,'x')
time.sleep(3)
#输入框重新输入内容，搜索
driver.find_element_by_id("kw").send_keys(u"虫师 cnblogs")
driver.find_element_by_id("su").click()
time.sleep(3)
driver.quit()
</code></pre> 
 </div> 
 <p>上面的操作向我们演示了键盘组合按键的用法。</p> 
 <p>2.3 、中文乱码问题<br>selenium2 python 在 send_keys()中输入中文一直报错，其实前面加个小 u 就解决了：<br>coding=utf-8<br>send_keys(u"输入中文")<br>需要注意的是 utf-8并不是万能的，我们需要保持脚本、浏览器、程序三者编码之<br>间的转换；如果 utf-8不能解决，可以尝试 GBK 或修改浏览器的默认编码。<br><span style="font-size:16px;"><strong>3、鼠标事件</strong></span><br>本 章 重点：<br>ActionChains 类</p> 
 <ul><li>perform() 执行所以隐藏在ActionChains中的行为</li><li>context_click() 右击</li><li><em>move_to_element() 模拟鼠标悬停操作  （用法和context_click() 相同）</em></li><li>double_click() 双击</li><li>drag_and_drop() 拖动测试的产品中有一个操作是右键点击文件列表会弹出一个快捷菜单，可以方<em>便的选择快捷菜单中的选择对文件进行操作（删除、移动、重命名）</em></li></ul> 
 <p><em id="__mceDel"><em><em>之前学习</em>元素的点击非常简单：</em></em></p> 
 <p><em><em><em>driver.find_element_by_id(“xxx”).click()<br>那么鼠标的双击、右击、拖动等是否也是这样的写法呢？例如右击：<br>driver.find_element_by_id(“xxx”).context_click()<br>经过运行脚本得到了下面的错误提示：<br>AttributeError: 'WebElement' object has no attribute 'context_click'<br>提示右点方法不属于 webelement 对象，通过查找文档，发现属于<br>ActionChains 类，但文档中没有具体写法。<br>3.1 、鼠标右键<br>下面介绍鼠标右键的用法，以百度私有云为例：<br></em></em></em></p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">#coding=utf-8
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
import time
driver = webdriver.Firefox()
driver.get("https://baidu.com")
#登陆百度
driver.find_element_by_id("user_name").send_keys("username")
driver.find_element_by_id("user_pwd").send_keys("123456")
driver.find_element_by_id("dl_an_submit").click()
time.sleep(3)
#定位到要右击的元素
qqq=driver.find_element_by_xpath("/html/body/div/div[2]/div[2]/div/div[3]/table/tbody/tr/td[2]")
#对定位到的元素执行鼠标右键操作
ActionChains(driver).context_click(qqq).perform()
#你也可以使用三行的写法，但我觉得上面两行写法更容易理解
chain = ActionChains(driver)
implement =driver.find_element_by_xpath("/html/body/div/div[2]/div[2]/div/div[3]/table/tbody/tr/td[2]")
chain.context_click(implement).perform()
time.sleep(3) #休眠3秒
driver.close()
</code></pre> 
 </div> 
 <p>这里需要注意的是，在使用 ActionChains 类之前，要先将包引入。</p> 
 <p>右击的操作会了，下面的其它方法比葫芦画瓢也能写出来。<br>3.2 、鼠标双击<br>鼠标双击的写法：<br>#定位到要双击的元素<br>qqq =driver.find_element_by_xpath("xxx")<br>#对定位到的元素执行鼠标双击操作<br>ActionChains(driver).double_click(qqq).perform()<br>3.3 、鼠标拖放<br>鼠标拖放操作的写法：<br>#定位元素的原位置<br>element = driver.find_element_by_name("source")<br>#定位元素要移动到的目标位置<br>target = driver.find_element_by_name("target")<br>#执行元素的移动操作<br>ActionChains(driver).drag_and_drop(element, target).perform()</p> 
 <p>3.4鼠标移动到对应位置，展示后面操作</p> 
 <ul><li>perform() 执行所以隐藏在ActionChains中的行为</li></ul> 
 <p>以百度设置为例：</p> 
 <div class="cnblogs_Highlighter"> 
  <pre><code class="language-python">#coding=utf-8
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
import time
#访问百度
driver=webdriver.Firefox()
driver.get("http://www.baidu.com")
#鼠标悬停在设置上
link=driver.find_element_by_link_text('设置')<br>#perform展示后面的操作
ActionChains(driver).move_to_element(link).perform()
driver.find_element_by_link_text("搜索设置").click()
driver.close()
</code></pre> 
 </div> 
 <p>　　</p> 
</div> 
<p>转载于:https://www.cnblogs.com/101718qiong/p/7403206.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9a0974486932b04d4b7703a3bcb59720/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Eigen库使用教程之旋转矩阵，旋转向量和四元数的初始化和相互转换的实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e39830adb2c7475b51ed776358ec2622/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mockito单元测试demo</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>