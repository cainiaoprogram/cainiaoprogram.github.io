<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于FPGA的五子棋游戏设计 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于FPGA的五子棋游戏设计" />
<meta property="og:description" content="基于FPGA的五子棋游戏设计
本文基于FPGA设计五子棋游戏，使用按键输入，使用VGA接口输出。五子棋的棋具与围棋相同，棋子分为黑白两色，棋盘为10×10，棋子放置于棋盘线交叉点上。两人对局，各执一色，轮流下一子，先将横、竖或斜线的5个或5个以上同色棋子连成不间断的一排者为胜。
VGA技术介绍：
VGA 接口就是显卡上输出模拟信号的接口，也叫 D-Sub 接口。VGA 接口是一种 D
型口，上面共有 15 针空，分成三排，每排五个。VGA 接口是目前中低端电脑配置上的主流口。
VGA显示中，FPGA需要产生5个信号：R、G、B三基色信号，行同步信号HS，场同步信号VS。以上接口的5个孔对应着我们FPGA中产生的5个重要的信号，其中R、G、B是数据信号；HS、VS是控制信号。下面是VGA 显示模块与CRT 显示器的控制框图：
像素是产生各种颜色的基本单元。根据物理学中的混色原理，三色发光的亮度比例适当，可呈现白色。适当的调整发光比例可以出现不同的颜色。三基色混色原理示意图如下图所示：
对于显示器来说，RGB三个信号其实是模拟信号，其电平的高低，可以表示颜色的深浅。利用这个原理，我们就可以产生丰富的色彩。为了控制电压的高低，我们就必须用到DA芯片。例如下图中，FPGA产生RGB三种信号，这时RGB都是多位的数字信号。DA芯片根据数字信号的值，产生不同电压的模拟信号rgb。
DE1-SoC板上有一个15针D-SUB连接器，用于VGA输出。VGA同步信号直接从Cyclone V SoC FPGA和Analog器件ADV7123三路10位高速视频DAC（仅使用较高的8位）转换从数字到模拟的信号代表三种基本颜色（红色，绿色和蓝色）。 它可以支持高达SXGA标准（1280 * 1024），信号以100MHz传输。 下图显示FPGA和VGA之间连接的信号。
显示器采用光栅扫描方式，即轰击荧光屏的电子束在 CRT 屏幕上从左到右（受水平同步信号 HSYNC 控制）、从上到下（受垂直同步信号 VSYNC 控制）做有规律的移动。电子束采用光栅扫描方式，从屏幕左上角一点开始，向右逐点进行扫描，形成一条水平线；到达最右端后，又回到下一条水平线的左端，重复上面的过程；当电子束完成右下角一点的扫描后，形成一帧。此后，电子束又回到左上方起点，开始下一帧的扫描。这种方法也就是常说的逐行扫描显示。
完成一行扫描的时间称为水平扫描时间，其倒数称为行频率；完成一帧（整屏）扫描的时间称为垂直扫描时间，其倒数称为场频率，即刷新一屏的频率，常见的有60Hz，75Hz等等。标准的VGA显示的场频60Hz。
行时序和场时序都需要同步脉冲（Sync a）、显示后沿（Back porch b）、显示时序段（Display interval c）和显示前沿（Front porch d）四部分。VGA工业标准显示模式要求：行同步，场同步都为负极性，即同步脉冲要求是负脉冲。
VGA支持的规格
我们以第一个分辨率640/480来分析，其刷新速率是60Hz，每幅图像有525行，每行有800个值。也就是说完成一幅图像约是1s/60=16.6ms，完成一行约为16.6ms/525=31.75us，完成一个像素传送约来31.75us /800=40ns。因此为了方便设计，接口的时候设为25MHz最方便，每个时钟送一个数据。
VGA时序设计
根据上节的介绍，VGA时序要求如下
VGA时序代码设计
/**********VGA驱动**********/ always@(posedge vga_clk or negedge rst_n)begin if(!rst_n)begin hcount &lt;= 10&#39;d0; end else if(hcount == 10&#39;d799)begin hcount &lt;= 10&#39;d0; end else begin hcount &lt;= hcount&#43;1&#39;b1; end end always@(posedge vga_clk or negedge rst_n)begin if(!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c5e99c64d456afa801fb7217bc0ca184/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-28T09:29:56+08:00" />
<meta property="article:modified_time" content="2023-11-28T09:29:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于FPGA的五子棋游戏设计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><a href="https://www.bilibili.com/video/BV1gh411j7Ex/" rel="nofollow">基于FPGA的五子棋游戏设计</a><br> 本文基于FPGA设计五子棋游戏，使用按键输入，使用VGA接口输出。五子棋的棋具与围棋相同，棋子分为黑白两色，棋盘为10×10，棋子放置于棋盘线交叉点上。两人对局，各执一色，轮流下一子，先将横、竖或斜线的5个或5个以上同色棋子连成不间断的一排者为胜。<br> VGA技术介绍：<br> VGA 接口就是显卡上输出模拟信号的接口，也叫 D-Sub 接口。VGA 接口是一种 D<br> 型口，上面共有 15 针空，分成三排，每排五个。VGA 接口是目前中低端电脑配置上的主流口。<br> VGA显示中，FPGA需要产生5个信号：R、G、B三基色信号，行同步信号HS，场同步信号VS。以上接口的5个孔对应着我们FPGA中产生的5个重要的信号，其中R、G、B是数据信号；HS、VS是控制信号。下面是VGA 显示模块与CRT 显示器的控制框图：<br> <img src="https://images2.imgbox.com/3c/6f/ZJMN6Dxe_o.png" alt="在这里插入图片描述"></p> 
<p>像素是产生各种颜色的基本单元。根据物理学中的混色原理，三色发光的亮度比例适当，可呈现白色。适当的调整发光比例可以出现不同的颜色。三基色混色原理示意图如下图所示：<br> <img src="https://images2.imgbox.com/61/d0/eL7I114q_o.png" alt="在这里插入图片描述"></p> 
<p>对于显示器来说，RGB三个信号其实是模拟信号，其电平的高低，可以表示颜色的深浅。利用这个原理，我们就可以产生丰富的色彩。为了控制电压的高低，我们就必须用到DA芯片。例如下图中，FPGA产生RGB三种信号，这时RGB都是多位的数字信号。DA芯片根据数字信号的值，产生不同电压的模拟信号rgb。</p> 
<p><img src="https://images2.imgbox.com/45/45/1HRaXSeC_o.png" alt="在这里插入图片描述"></p> 
<p>DE1-SoC板上有一个15针D-SUB连接器，用于VGA输出。VGA同步信号直接从Cyclone V SoC FPGA和Analog器件ADV7123三路10位高速视频DAC（仅使用较高的8位）转换从数字到模拟的信号代表三种基本颜色（红色，绿色和蓝色）。 它可以支持高达SXGA标准（1280 * 1024），信号以100MHz传输。 下图显示FPGA和VGA之间连接的信号。</p> 
<p><img src="https://images2.imgbox.com/f0/e7/DtLZjJvt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5a/f4/G1Ec4KEO_o.png" alt="在这里插入图片描述"></p> 
<p>显示器采用光栅扫描方式，即轰击荧光屏的电子束在 CRT 屏幕上从左到右（受水平同步信号 HSYNC 控制）、从上到下（受垂直同步信号 VSYNC 控制）做有规律的移动。电子束采用光栅扫描方式，从屏幕左上角一点开始，向右逐点进行扫描，形成一条水平线；到达最右端后，又回到下一条水平线的左端，重复上面的过程；当电子束完成右下角一点的扫描后，形成一帧。此后，电子束又回到左上方起点，开始下一帧的扫描。这种方法也就是常说的逐行扫描显示。<br> 完成一行扫描的时间称为水平扫描时间，其倒数称为行频率；完成一帧（整屏）扫描的时间称为垂直扫描时间，其倒数称为场频率，即刷新一屏的频率，常见的有60Hz，75Hz等等。标准的VGA显示的场频60Hz。<br> 行时序和场时序都需要同步脉冲（Sync a）、显示后沿（Back porch b）、显示时序段（Display interval c）和显示前沿（Front porch d）四部分。VGA工业标准显示模式要求：行同步，场同步都为负极性，即同步脉冲要求是负脉冲。</p> 
<p>VGA支持的规格<br> <img src="https://images2.imgbox.com/45/b2/t2Kfsz7T_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/f5/43/ch0jAIQg_o.png" alt="在这里插入图片描述"></p> 
<p>我们以第一个分辨率640/480来分析，其刷新速率是60Hz，每幅图像有525行，每行有800个值。也就是说完成一幅图像约是1s/60=16.6ms，完成一行约为16.6ms/525=31.75us，完成一个像素传送约来31.75us /800=40ns。因此为了方便设计，接口的时候设为25MHz最方便，每个时钟送一个数据。</p> 
<p>VGA时序设计</p> 
<p>根据上节的介绍，VGA时序要求如下</p> 
<p><img src="https://images2.imgbox.com/7c/42/jXB56bsf_o.png" alt="在这里插入图片描述"></p> 
<p>VGA时序代码设计</p> 
<pre><code class="prism language-c"><span class="token comment">/**********VGA驱动**********/</span>
always@<span class="token punctuation">(</span>posedge vga_clk or negedge rst_n<span class="token punctuation">)</span>begin
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>begin
      	hcount <span class="token operator">&lt;=</span> <span class="token number">10</span>'d0<span class="token punctuation">;</span>
	 end
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount <span class="token operator">==</span> <span class="token number">10</span>'d799<span class="token punctuation">)</span>begin
        hcount <span class="token operator">&lt;=</span> <span class="token number">10</span>'d0<span class="token punctuation">;</span>
     end
    <span class="token keyword">else</span> begin
	    hcount <span class="token operator">&lt;=</span> hcount<span class="token operator">+</span><span class="token number">1</span>'b1<span class="token punctuation">;</span>
     end
 end

 always@<span class="token punctuation">(</span>posedge vga_clk or negedge rst_n<span class="token punctuation">)</span>begin
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span> begin
       vcount <span class="token operator">&lt;=</span> <span class="token number">10</span>'d0<span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount <span class="token operator">==</span> <span class="token number">10</span>'d799<span class="token punctuation">)</span>begin
        <span class="token keyword">if</span><span class="token punctuation">(</span>vcount<span class="token operator">==</span><span class="token number">524</span><span class="token punctuation">)</span>
            vcount <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            vcount <span class="token operator">&lt;=</span> vcount<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    end
 end
	
always@<span class="token punctuation">(</span>posedge vga_clk or negedge rst_n<span class="token punctuation">)</span>begin
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>begin
        hsync <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount<span class="token operator">==</span><span class="token number">10</span>'d95<span class="token punctuation">)</span>begin
        hsync <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount<span class="token operator">==</span><span class="token number">10</span>'d799<span class="token punctuation">)</span>begin
        hsync <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
    end
end

always@<span class="token punctuation">(</span>posedge vga_clk or negedge rst_n<span class="token punctuation">)</span>begin
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>begin
        vsync <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>vcount<span class="token operator">&lt;</span><span class="token number">10</span>'d2<span class="token punctuation">)</span>begin
        vsync <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> begin
        vsync <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
    end
end    
</code></pre> 
<p>VGA时序仿真结果</p> 
<p><img src="https://images2.imgbox.com/12/02/mrolKcPR_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/71/6d/eIacnW29_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/76/c1/C0J63UtW_o.png" alt="在这里插入图片描述"></p> 
<p>五子棋设计<br> 为了节约FPGA资源，本文设计并编写了10x10 五子棋的专用算法。棋子半径大小20个像素。光标当前的棋子所在位置使用青色表示，因为屏幕背景色是黑色，棋盘背景色是白色，所以黑白棋子使用紫色和黄色代替。<br> 棋盘设计：<br> 设10x10数组reg [9:0] PLAYED [9:0]; 数组中每一位代表棋盘的一个交叉点。数组的某位为0时，代表无子状态； 为l时，代表有棋子；<br> 设10x10数组reg [9:0] CHESS_COLOR [9:0];表示棋子的颜色。<br> 产生棋盘格的代码如下：</p> 
<pre><code class="prism language-c"><span class="token comment">//产生竖长条</span>
always@<span class="token punctuation">(</span>posedge vga_clk <span class="token punctuation">)</span>
begin
    <span class="token keyword">if</span><span class="token punctuation">(</span>hcount<span class="token operator">&lt;=</span><span class="token number">200</span><span class="token operator">||</span>hcount<span class="token operator">&gt;=</span><span class="token number">640</span><span class="token punctuation">)</span>begin
    v_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1 <span class="token punctuation">;</span>    
	v_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'h000<span class="token punctuation">;</span><span class="token comment">//hei</span>
    end <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount <span class="token operator">==</span><span class="token number">240</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">280</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">320</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">360</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">400</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">440</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">480</span><span class="token operator">||</span>hcount <span class="token operator">==</span><span class="token number">520</span><span class="token operator">||</span>hcount<span class="token operator">==</span><span class="token number">560</span><span class="token operator">||</span>hcount<span class="token operator">==</span><span class="token number">600</span><span class="token punctuation">)</span> begin
    v_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1 <span class="token punctuation">;</span>    
      v_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'h000<span class="token punctuation">;</span><span class="token comment">//hei</span>
   end <span class="token keyword">else</span> begin
    v_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0 <span class="token punctuation">;</span>    
     v_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hfff<span class="token punctuation">;</span><span class="token comment">//bai</span>
     end
end

<span class="token comment">//产生横长条</span>
always@<span class="token punctuation">(</span>posedge vga_clk <span class="token punctuation">)</span>
begin
    <span class="token keyword">if</span><span class="token punctuation">(</span>vcount<span class="token operator">&lt;=</span><span class="token number">50</span><span class="token operator">||</span>vcount<span class="token operator">&gt;=</span><span class="token number">490</span><span class="token punctuation">)</span> begin
    h_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1 <span class="token punctuation">;</span>
	h_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'h000<span class="token punctuation">;</span><span class="token comment">//hei</span>
    end <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>vcount <span class="token operator">==</span><span class="token number">90</span><span class="token operator">||</span>vcount <span class="token operator">==</span><span class="token number">130</span><span class="token operator">||</span>vcount <span class="token operator">==</span><span class="token number">170</span><span class="token operator">||</span>vcount<span class="token operator">==</span><span class="token number">210</span> <span class="token operator">||</span>vcount<span class="token operator">==</span><span class="token number">250</span><span class="token operator">||</span>vcount <span class="token operator">==</span><span class="token number">290</span><span class="token operator">||</span>vcount <span class="token operator">==</span><span class="token number">330</span><span class="token operator">||</span>vcount<span class="token operator">==</span><span class="token number">370</span> <span class="token operator">||</span>vcount<span class="token operator">==</span><span class="token number">410</span><span class="token operator">||</span>vcount<span class="token operator">==</span><span class="token number">450</span><span class="token punctuation">)</span> begin
    h_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1 <span class="token punctuation">;</span>    
      h_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'h000<span class="token punctuation">;</span>
   end <span class="token keyword">else</span> begin
    h_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0 <span class="token punctuation">;</span>      
     h_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hfff<span class="token punctuation">;</span>
     end
end  
</code></pre> 
<p>2)当前棋子光标提示设计：<br> 当前棋子位置提示显示数据为x_data,显示青色。V_dat和H_dat是横竖线的，显示为黑色，y_dat为棋子颜色。</p> 
<p>/</p> 
<pre><code class="prism language-bash">/显示模块 
always@<span class="token punctuation">(</span>posedge vga_clk<span class="token punctuation">)</span>
begin
if<span class="token punctuation">(</span>dat_act<span class="token punctuation">)</span>begin
  if<span class="token punctuation">(</span>over<span class="token operator">==</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">over2</span><span class="token operator">==</span><span class="token number">0</span>  <span class="token operator">&amp;&amp;</span>   <span class="token assign-left variable">debug_flag</span><span class="token operator">==</span><span class="token number">0</span>    <span class="token punctuation">)</span> begin
    if<span class="token punctuation">(</span>curchess_flag<span class="token punctuation">)</span>
     disp_rgb <span class="token operator">&lt;=</span>x_dat<span class="token punctuation">;</span>    // 
    <span class="token keyword">else</span> if<span class="token punctuation">(</span>v_flag<span class="token punctuation">)</span>
     disp_rgb <span class="token operator">&lt;=</span>v_dat<span class="token punctuation">;</span>    // 
    <span class="token keyword">else</span> if<span class="token punctuation">(</span>h_flag<span class="token punctuation">)</span>
     disp_rgb <span class="token operator">&lt;=</span>h_dat<span class="token punctuation">;</span>    // 
    <span class="token keyword">else</span> if<span class="token punctuation">(</span>chess_flag<span class="token punctuation">)</span>
     disp_rgb <span class="token operator">&lt;=</span>y_dat<span class="token punctuation">;</span>    //  
    <span class="token keyword">else</span>
     disp_rgb <span class="token operator">&lt;=</span><span class="token number">12</span><span class="token string">'hfff;    //   
  end else
   disp_rgb &lt;=z_dat;    			//游戏结束则显示另外画面
end
else begin
disp_rgb = 12'</span>h000<span class="token punctuation">;</span>  //VGA区域之外  
end   
end
</code></pre> 
<p>3)按钮上、下、左、右、落子：</p> 
<pre><code class="prism language-c">always@<span class="token punctuation">(</span>posedge sysclk or negedge rst_n<span class="token punctuation">)</span>begin
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>begin
        PLAYED<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        PLAYED<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>      
    
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
        CHESS_COLOR<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span>'d0<span class="token punctuation">;</span>  
    end
    <span class="token keyword">else</span>
begin
    <span class="token keyword">case</span><span class="token punctuation">(</span>key_en_tem<span class="token punctuation">)</span>
         <span class="token number">5</span>'b00100<span class="token operator">:</span>begin 
                                          <span class="token keyword">if</span> <span class="token punctuation">(</span>ball_x_pos<span class="token operator">==</span> <span class="token number">10</span>'d240<span class="token punctuation">)</span>
                                                 ball_x_pos<span class="token operator">&lt;=</span><span class="token number">10</span>'d600<span class="token punctuation">;</span>
                                             <span class="token keyword">else</span> 
                                                ball_x_pos<span class="token operator">&lt;=</span>ball_x_pos<span class="token operator">-</span><span class="token number">10</span>'d40<span class="token punctuation">;</span>
                    end
         <span class="token number">5</span>'b01000<span class="token operator">:</span>begin 
                                          <span class="token keyword">if</span> <span class="token punctuation">(</span>ball_x_pos<span class="token operator">==</span><span class="token number">10</span>'d600<span class="token punctuation">)</span>
                                                ball_x_pos<span class="token operator">&lt;=</span><span class="token number">10</span>'d240<span class="token punctuation">;</span>
                                             <span class="token keyword">else</span> 
                                                 ball_x_pos<span class="token operator">&lt;=</span> ball_x_pos<span class="token operator">+</span><span class="token number">10</span>'d40<span class="token punctuation">;</span>
                                         end 
        <span class="token number">5</span>'b00001<span class="token operator">:</span> begin 
                                           <span class="token keyword">if</span> <span class="token punctuation">(</span>ball_y_pos<span class="token operator">==</span> <span class="token number">10</span>'d90<span class="token punctuation">)</span>
                                               ball_y_pos<span class="token operator">&lt;=</span><span class="token number">10</span>'d450<span class="token punctuation">;</span>
                                           <span class="token keyword">else</span> 
                                                ball_y_pos<span class="token operator">&lt;=</span>ball_y_pos<span class="token operator">-</span><span class="token number">10</span>'d40<span class="token punctuation">;</span>                                                
                                                 end
       <span class="token number">5</span>'b00010<span class="token operator">:</span> begin
                                           <span class="token keyword">if</span><span class="token punctuation">(</span>ball_y_pos<span class="token operator">==</span> <span class="token number">10</span>'d450<span class="token punctuation">)</span>
                                           ball_y_pos<span class="token operator">&lt;=</span><span class="token number">10</span>'d90<span class="token punctuation">;</span>
                                           <span class="token keyword">else</span>         
                                           ball_y_pos<span class="token operator">&lt;=</span>ball_y_pos<span class="token operator">+</span><span class="token number">10</span>'d40<span class="token punctuation">;</span> 
                                           end      
       <span class="token number">5</span>'b10000<span class="token operator">:</span> begin
                                         <span class="token keyword">if</span><span class="token punctuation">(</span>PLAYED<span class="token punctuation">[</span>current_y<span class="token punctuation">]</span><span class="token punctuation">[</span>current_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
                                          begin
                                              PLAYED<span class="token punctuation">[</span>current_y<span class="token punctuation">]</span><span class="token punctuation">[</span>current_x<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">;</span>                                     
CHESS_COLOR<span class="token punctuation">[</span>current_y<span class="token punctuation">]</span><span class="token punctuation">[</span>current_x<span class="token punctuation">]</span><span class="token operator">&lt;=</span>change_color<span class="token punctuation">;</span>
                                          end
                                           end     
</code></pre> 
<p>(4)判胜：<br> 横竖正斜反斜四个方向出现连续落子，且颜色一样，输出胜利提示。</p> 
<pre><code class="prism language-bash">
```c
//输赢状态判断1
always@<span class="token punctuation">(</span>posedge vga_clk <span class="token punctuation">)</span>
    if<span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>begin
    over<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">;</span> 
    end
    <span class="token keyword">else</span>
begin
    <span class="token keyword">if</span> <span class="token punctuation">(</span>  <span class="token punctuation">(</span>scan_x<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+1<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+2<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+3<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+4<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>//heng
    <span class="token operator">&amp;&amp;</span>   <span class="token punctuation">(</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+1<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+2<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+3<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+4<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>       <span class="token punctuation">)</span>     
    begin
    over<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> if<span class="token punctuation">(</span> <span class="token punctuation">(</span>scan_y<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+1<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+2<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+3<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+4<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>//shu
      <span class="token operator">&amp;&amp;</span>     <span class="token punctuation">(</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+1<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+2<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+3<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+4<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    begin
    over<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">else</span> if<span class="token punctuation">(</span>  <span class="token punctuation">(</span>scan_x<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span>scan_y<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+1<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+1<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+2<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+2<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+3<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+3<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+4<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+4<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>//chenggong
     <span class="token operator">&amp;&amp;</span>  <span class="token punctuation">(</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+1<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+1<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+2<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+2<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+3<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+3<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+4<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x+4<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    over<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>scan_y<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token operator">&amp;&amp;</span>scan_x<span class="token operator">&gt;=</span><span class="token number">4</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+1<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-1<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+2<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-2<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+3<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-3<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>CHESS_COLOR<span class="token punctuation">[</span>scan_y+4<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-4<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>PLAYED<span class="token punctuation">[</span>scan_y<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+1<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-1<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+2<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-2<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+3<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-3<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>PLAYED<span class="token punctuation">[</span>scan_y+4<span class="token punctuation">]</span><span class="token punctuation">[</span>scan_x-4<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    over<span class="token operator">&lt;=</span><span class="token number">1</span><span class="token punctuation">;</span>
end        
</code></pre> 
<pre><code>
```c
//输赢状态判断2 yellow
always@(posedge vga_clk )
    if(!rst_n)begin
    over2&lt;=0;    
    debug_flag&lt;=0;   
    end
    else
begin
    if( (scan_x&lt;=5&amp;&amp;CHESS_COLOR[scan_y][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y][scan_x+1]==0&amp;&amp;CHESS_COLOR[scan_y][scan_x+2]==0&amp;&amp;CHESS_COLOR[scan_y][scan_x+3]==0&amp;&amp;CHESS_COLOR[scan_y][scan_x+4]==0)//heng
    &amp;&amp;   (PLAYED[scan_y][scan_x]==1&amp;&amp;PLAYED[scan_y][scan_x+1]==1&amp;&amp;PLAYED[scan_y][scan_x+2]==1&amp;&amp;PLAYED[scan_y][scan_x+3]==1&amp;&amp;PLAYED[scan_y][scan_x+4]==1)       ) 
    over2&lt;=1;
    else if( (scan_y&lt;=5&amp;&amp;CHESS_COLOR[scan_y][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y+1][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y+2][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y+3][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y+4][scan_x]==0)//shu
    &amp;&amp;     (PLAYED[scan_y][scan_x]==1&amp;&amp;PLAYED[scan_y+1][scan_x]==1&amp;&amp;PLAYED[scan_y+2][scan_x]==1&amp;&amp;PLAYED[scan_y+3][scan_x]==1&amp;&amp;PLAYED[scan_y+4][scan_x]==1) )
    begin
    over2&lt;=1;
    debug_flag&lt;=1;  
    end
    else if(  (scan_x&lt;=5&amp;&amp;scan_y&lt;=5&amp;&amp;CHESS_COLOR[scan_y][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y+1][scan_x+1]==0&amp;&amp;CHESS_COLOR[scan_y+2][scan_x+2]==0&amp;&amp;CHESS_COLOR[scan_y+3][scan_x+3]==0&amp;&amp;CHESS_COLOR[scan_y+4][scan_x+4]==0)//chenggong
    &amp;&amp;  (PLAYED[scan_y][scan_x]==1&amp;&amp;PLAYED[scan_y+1][scan_x+1]==1&amp;&amp;PLAYED[scan_y+2][scan_x+2]==1&amp;&amp;PLAYED[scan_y+3][scan_x+3]==1&amp;&amp;PLAYED[scan_y+4][scan_x+4]==1) )
    over2&lt;=1;
    else if ( (scan_y&lt;=5&amp;&amp;scan_x&gt;=4&amp;&amp;CHESS_COLOR[scan_y][scan_x]==0&amp;&amp;CHESS_COLOR[scan_y+1][scan_x-1]==0&amp;&amp;CHESS_COLOR[scan_y+2][scan_x-2]==0&amp;&amp;CHESS_COLOR[scan_y+3][scan_x-3]==0&amp;&amp;CHESS_COLOR[scan_y+4][scan_x-4]==0)
    &amp;&amp; (PLAYED[scan_y][scan_x]==1&amp;&amp;PLAYED[scan_y+1][scan_x-1]==1&amp;&amp;PLAYED[scan_y+2][scan_x-2]==1&amp;&amp;PLAYED[scan_y+3][scan_x-3]==1&amp;&amp;PLAYED[scan_y+4][scan_x-4]==1) )
    over2&lt;=1;  
end        
</code></pre> 
<p>(5)win画面：在任一方胜利后VGA显示win三个字母画面输出胜利提示。根据棋子颜色win显示不同颜色以显示</p> 
<pre><code class="prism language-c"><span class="token comment">//产生win画面1</span>
always@<span class="token punctuation">(</span>posedge vga_clk <span class="token punctuation">)</span>
begin
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">240</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">260</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">300</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">320</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">360</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">380</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">420</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">440</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">480</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">560</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">580</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>vcount <span class="token operator">&gt;=</span><span class="token number">200</span><span class="token operator">&amp;&amp;</span>vcount <span class="token operator">&lt;=</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">)</span>begin
    z_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>over<span class="token punctuation">)</span>
	z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hf0f<span class="token punctuation">;</span>
    <span class="token keyword">else</span>
	z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hff0<span class="token punctuation">;</span>    
    end <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">260</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">380</span><span class="token operator">&amp;&amp;</span>vcount<span class="token operator">&gt;=</span><span class="token number">340</span><span class="token operator">&amp;&amp;</span>vcount <span class="token operator">&lt;=</span><span class="token number">360</span><span class="token punctuation">)</span> begin
    z_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>over<span class="token punctuation">)</span>
	z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hf0f<span class="token punctuation">;</span>
    <span class="token keyword">else</span>
	z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hff0<span class="token punctuation">;</span>    
     end <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>hcount<span class="token operator">&gt;=</span><span class="token number">500</span><span class="token operator">&amp;&amp;</span>hcount<span class="token operator">&lt;=</span><span class="token number">560</span><span class="token operator">&amp;&amp;</span>vcount<span class="token operator">&gt;=</span><span class="token number">200</span><span class="token operator">&amp;&amp;</span>vcount <span class="token operator">&lt;=</span><span class="token number">220</span><span class="token punctuation">)</span> begin
      z_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b1<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>over<span class="token punctuation">)</span>
	z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hf0f<span class="token punctuation">;</span>
    <span class="token keyword">else</span>
	z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hff0<span class="token punctuation">;</span>    
    end <span class="token keyword">else</span> begin
        z_flag <span class="token operator">&lt;=</span> <span class="token number">1</span>'b0<span class="token punctuation">;</span>
        z_dat <span class="token operator">&lt;=</span> <span class="token number">12</span>'hfff<span class="token punctuation">;</span>
     end
end       
</code></pre> 
<p>遇到的问题：<br> 1 棋子颜色显示不稳定，下棋时棋子颜色随机产生不受控制。原因怀疑是时钟一开始是分频产生的25M，后面换成pll锁相环后问题果然解决。<br> 一开始的时钟产生方法：</p> 
<pre><code class="prism language-c">always@<span class="token punctuation">(</span>posedge sysclk<span class="token punctuation">)</span>
begin
    vga_clk <span class="token operator">&lt;=</span> <span class="token operator">~</span>vga_clk<span class="token punctuation">;</span>
end   
优化后的：
    pll <span class="token function">pll</span><span class="token punctuation">(</span>
	<span class="token punctuation">.</span><span class="token function">inclk0</span><span class="token punctuation">(</span>sysclk<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token function">c0</span><span class="token punctuation">(</span>vga_clk<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c555eaafd79057ff3972060215d6d481/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python-爬虫（可直接使用）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5cdcda5ba15cacbe3c0a4d875c7fe05a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JS 倒计时方法（可改造）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>