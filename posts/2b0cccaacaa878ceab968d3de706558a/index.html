<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python操作Oracle数据库 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python操作Oracle数据库" />
<meta property="og:description" content="1. 准备工作 ① 首先，你必须安装好Oracle数据库。Oracle数据库的安装并不是那么容易，大家可以去找一个安装教程，慢慢研究。
② 其次，你既然用Python操作Oracle，你必须要安装Python吧。Python的安装过程较为简单。但是有一点需要注意：一定要安装64位的Python，不要使用32位的。
③ 最后，也是最复杂的一步。我们需要进行instantclient的下载安装和环境配置，它是oracle数据库的客户端，这个最好也是下载64位的。
2. instantclient的安装与配置 1）instantclient的下载地址
在进行instantclient的安装与配置之前，我先提供给大家一个下载链接，供大家下载，我们直接下载像11或者12这样的高版本，即可。
instantclient的下载地址：http://suo.im/5Dlqrr
2）instantclient的安装
① 直接解压instantclient安装包；
② 解压后的文件位置，不要随意放置；
我们需要将instantclient安装包，解压后得到的文件夹，放置在Oracle安装目录下的product的直接字目录下。
3）instantclient的环境配置
① 按照图中操作，完成环境变量的配置；
② 将其解压目录下的oraociei11.dll、oraocci11.dll、oci.dll文件复制到python安装目录的Lib/site-packages文件夹下；
instantclient安装包解压后的文件夹：
python安装目录下的Lib/site-packages文件夹：
3. 其他需要特别注意的点
1）解决中文乱码问题
当使用Python读取到Oracle数据库中的某张表，如果该表中存在中文，会出现中文乱码的问题。因此需要设置NLS_LANG环境变量，来解决这个问题，下面提供了两种方式。
① 打开CMD黑窗口，输入以下命令；
C:\Users\AA&gt;set nls_lang=SIMPLIFIED CHINESE_CHINA.ZHS16GBK ② 直接在写代码的时候，输入以下命令；
import os os.environ[&#39;NLS_LANG&#39;] = &#39;SIMPLIFIED CHINESE_CHINA.UTF8&#39; 注意： 上述两种方式书写命令的位置不同，不要弄错了。其次，上述设置NLS_LANG环境变量的方式，仅对当前窗口有效。其实，我们也可以永久修改NLS_LANG环境变量，但是请不要这么做。
2）关于cx_Oracle驱动包的安装，需要注意的问题
cx_Oracle是Python操作Oracle数据库，需要使用的驱动包。类似于Python操作MySQL使用的pymysql驱动包。
对于我来说，我直接使用下面这个命令，就安装成功：
pip insatll cx_Oracle 如果你的系统环境，导致安装失败，我这里提供两个链接，供你下载和学习：
cx_Oracle驱动包的下载：http://suo.im/6fGFSR
cx_Oracle安装教程：http://suo.im/5DlvxT
4. Python与Oracle交互操作 其实Python操作Oracle数据库，和Python操作MySQL数据库，基本上都是一样的道理，一通百通。我之前已经写了一个Python操作MySQL数据库的详细教程，下面提供给大家这个链接。
Python操作MySQL数据库：http://suo.im/6fGJhl
1）Python链接Oracle服务器的3种方式
① 用户名、密码和监听写在一起
import cx_Oracle db = cx_Oracle.connect(&#39;scott/a123456@DESKTOP-V4LKB10:1521/orcl&#39;) ② 用户名、密码和监听分开写
import cx_Oracle db = cx_Oracle." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2b0cccaacaa878ceab968d3de706558a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-10T10:14:12+08:00" />
<meta property="article:modified_time" content="2020-08-10T10:14:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python操作Oracle数据库</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1__0"></a>1. 准备工作</h2> 
<p>① <strong>首先，你必须安装好Oracle数据库</strong>。Oracle数据库的安装并不是那么容易，大家可以去找一个安装教程，慢慢研究。<br> ② <strong>其次</strong>，你既然用Python操作Oracle，<strong>你必须要安装Python吧</strong>。Python的安装过程较为简单。但是有一点需要注意：一定要安装64位的Python，不要使用32位的。<br> ③ <strong>最后</strong>，也是最复杂的一步。我们需要<strong>进行instantclient的下载安装和环境配置</strong>，它是oracle数据库的客户端，这个最好也是下载64位的。</p> 
<h2><a id="2_instantclient_5"></a>2. instantclient的安装与配置</h2> 
<p><strong>1）instantclient的下载地址</strong></p> 
<p>在进行instantclient的安装与配置之前，我先提供给大家一个下载链接，供大家下载，我们直接下载像11或者12这样的高版本，即可。<br> instantclient的下载地址：http://suo.im/5Dlqrr<br> <strong>2）instantclient的安装</strong></p> 
<p>① 直接解压instantclient安装包；<br> <img src="https://images2.imgbox.com/65/d8/N37QKER3_o.png" alt="在这里插入图片描述"><br> ② 解压后的文件位置，不要随意放置；<br> 我们需要将instantclient安装包，解压后得到的文件夹，放置在Oracle安装目录下的product的直接字目录下。<br> <img src="https://images2.imgbox.com/2a/4b/Ta5MsNK8_o.png" alt="在这里插入图片描述"><br> <strong>3）instantclient的环境配置</strong></p> 
<p>① 按照图中操作，完成环境变量的配置；<br> <img src="https://images2.imgbox.com/30/8a/nnasjEQz_o.png" alt="在这里插入图片描述"><br> ② 将其解压目录下的oraociei11.dll、oraocci11.dll、oci.dll文件复制到python安装目录的Lib/site-packages文件夹下；<br> <strong>instantclient安装包解压后的文件夹：</strong><br> <img src="https://images2.imgbox.com/c5/07/Sh5TsH0a_o.png" alt="在这里插入图片描述"><br> <strong>python安装目录下的Lib/site-packages文件夹：</strong><br> <img src="https://images2.imgbox.com/c2/24/M3gyZnQp_o.png" alt="在这里插入图片描述"><br> <strong>3. 其他需要特别注意的点</strong></p> 
<p><strong>1）解决中文乱码问题</strong></p> 
<p><strong>当使用Python读取到Oracle数据库中的某张表，如果该表中存在中文，会出现中文乱码的问题</strong>。因此需要设置NLS_LANG环境变量，来解决这个问题，下面提供了两种方式。<br> ① 打开CMD黑窗口，输入以下命令；</p> 
<pre><code class="prism language-c">C<span class="token punctuation">:</span>\Users\AA<span class="token operator">&gt;</span>set nls_lang<span class="token operator">=</span>SIMPLIFIED CHINESE_CHINA<span class="token punctuation">.</span>ZHS16GBK
</code></pre> 
<p>② 直接在写代码的时候，输入以下命令；</p> 
<pre><code class="prism language-c">import os
os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'NLS_LANG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SIMPLIFIED CHINESE_CHINA.UTF8'</span>
</code></pre> 
<p>注意： 上述两种方式书写命令的位置不同，不要弄错了。其次，上述设置NLS_LANG环境变量的方式，仅对当前窗口有效。其实，我们也可以永久修改NLS_LANG环境变量，但是请不要这么做。<br> <strong>2）关于cx_Oracle驱动包的安装，需要注意的问题</strong></p> 
<p>cx_Oracle是Python操作Oracle数据库，需要使用的驱动包。类似于Python操作MySQL使用的pymysql驱动包。<br> 对于我来说，我直接使用下面这个命令，就安装成功：</p> 
<pre><code class="prism language-c">pip insatll cx_Oracle
</code></pre> 
<p>如果你的系统环境，导致安装失败，我这里提供两个链接，供你下载和学习：<br> <strong>cx_Oracle驱动包的下载：http://suo.im/6fGFSR</strong><br> <strong>cx_Oracle安装教程：http://suo.im/5DlvxT</strong></p> 
<h2><a id="4_PythonOracle_53"></a>4. Python与Oracle交互操作</h2> 
<p>其实Python操作Oracle数据库，和Python操作MySQL数据库，基本上都是一样的道理，一通百通。我之前已经写了一个Python操作MySQL数据库的详细教程，下面提供给大家这个链接。<br> <strong>Python操作MySQL数据库：http://suo.im/6fGJhl</strong><br> <strong>1）Python链接Oracle服务器的3种方式</strong></p> 
<p>① 用户名、密码和监听写在一起</p> 
<pre><code class="prism language-c">import cx_Oracle
db <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'scott/a123456@DESKTOP-V4LKB10:1521/orcl'</span><span class="token punctuation">)</span>
</code></pre> 
<p>② 用户名、密码和监听分开写</p> 
<pre><code class="prism language-c">import cx_Oracle
db <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">"scott"</span><span class="token punctuation">,</span><span class="token string">"a123456"</span><span class="token punctuation">,</span><span class="token string">"192.168.2.1:1521/orcl"</span><span class="token punctuation">)</span>
</code></pre> 
<p>③ 配置监听并连接</p> 
<pre><code class="prism language-c">import cx_Oracle
moniter <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">makedsn</span><span class="token punctuation">(</span><span class="token string">'192.168.2.1'</span><span class="token punctuation">,</span><span class="token number">1521</span><span class="token punctuation">,</span><span class="token string">'orcl'</span><span class="token punctuation">)</span>
db <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'scott'</span><span class="token punctuation">,</span><span class="token string">'a123456'</span><span class="token punctuation">,</span>moniter<span class="token punctuation">)</span>
</code></pre> 
<p><strong>2）Python怎么获取Oracle中的数据（查）</strong></p> 
<p>数据分析师日常工作用到最多的就是“查”，因此我们只讲述怎么查数据。关于其它的增删改操作，都是类似于MySQL，这里就不详细说明。<br> <strong>① fetchone()：一次获取一条记录；</strong></p> 
<pre><code class="prism language-c">import cx_Oracle
# 注意：一定要加下面这两行代码，负责会中文乱码；
import os
os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'NLS_LANG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SIMPLIFIED CHINESE_CHINA.UTF8'</span>

db <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">"scott"</span><span class="token punctuation">,</span><span class="token string">"a123456"</span><span class="token punctuation">,</span><span class="token string">"192.168.2.1:1521/orcl"</span><span class="token punctuation">)</span>
cursor <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

cursor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">'select count(*) from emp1'</span><span class="token punctuation">)</span>
aa <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">fetchone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>aa<span class="token punctuation">)</span>
cursor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">'select ename,deptno,sal from emp1'</span><span class="token punctuation">)</span>     
<span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span>aa<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">fetchone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> <span class="token string">"我的名字叫{}，所在部门是{}，工资是{}美元"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span>
    <span class="token function">display</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>截取部分结果如下：<br> <img src="https://images2.imgbox.com/09/3d/kHZ7b9t7_o.png" alt="在这里插入图片描述"><br> ② fetchall()：一次获取所有记录；</p> 
<pre><code class="prism language-c">import cx_Oracle
# 注意：一定要加下面这两行代码，负责会中文乱码；
import os
os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'NLS_LANG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SIMPLIFIED CHINESE_CHINA.UTF8'</span>

db <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">"scott"</span><span class="token punctuation">,</span><span class="token string">"a123456"</span><span class="token punctuation">,</span><span class="token string">"192.168.2.1:1521/orcl"</span><span class="token punctuation">)</span>
cursor <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

cursor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">'select ename,deptno,sal from emp1'</span><span class="token punctuation">)</span>    
aa <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">fetchall</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token macro property"># print(aa)</span>
<span class="token keyword">for</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c in aa<span class="token punctuation">:</span>
    d <span class="token operator">=</span> <span class="token string">"我的名字叫{}，所在部门是{}，工资是{}美元"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span>
    <span class="token function">display</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>截取部分结果如下：<br> <img src="https://images2.imgbox.com/bc/0a/2U2HjgKU_o.png" alt="在这里插入图片描述"><br> ③ 使用pandas中的read_sql()方法，将提取到的数据直接转化为DataFrame进行操作；</p> 
<pre><code class="prism language-c">import cx_Oracle
import pandas as pd
import os
os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">'NLS_LANG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SIMPLIFIED CHINESE_CHINA.UTF8'</span>

db <span class="token operator">=</span> cx_Oracle<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">"scott"</span><span class="token punctuation">,</span><span class="token string">"a123456"</span><span class="token punctuation">,</span><span class="token string">"192.168.2.1:1521/orcl"</span><span class="token punctuation">)</span>
cursor <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">cursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">read_sql</span><span class="token punctuation">(</span><span class="token string">"select * from emp where deptno=20"</span><span class="token punctuation">,</span>db<span class="token punctuation">)</span>
<span class="token function">display</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>

df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">read_sql</span><span class="token punctuation">(</span><span class="token string">"select * from emp where deptno=30"</span><span class="token punctuation">,</span>db<span class="token punctuation">)</span>
<span class="token function">display</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
</code></pre> 
<p>结果如下：<br> <img src="https://images2.imgbox.com/5b/4b/qhmn1CJ7_o.png" alt="在这里插入图片描述"></p> 
<p>参考链接 ：<br> python操作Oracle数据库 ： https://mp.weixin.qq.com/s/9qE396HRqJfi8nCB6sMotQ</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3e54cd2971c8ea5ed87ad47749529edf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">简单粗暴PyTorch之transforms详解(一)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/251129f293e6daadebceeed7355afecd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RK1808固件升级说明</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>