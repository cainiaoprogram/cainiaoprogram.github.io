<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot集成Flowable modeler设计器 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBoot集成Flowable modeler设计器" />
<meta property="og:description" content="文章目录 SpringBoot整合Flowable
flowable GitHub仓库：
https://github.com/flowable/flowable-engine
下载源码，或者git clone
找到 modules/flowable-ui-modeler/flowable-ui-modeler-app 模块，拷贝该模块下resource/static/目录下的所有内容至自己项目的resource/static/目录下。
注意：一定要注意源码版本要与项目中的flowable一致，否则会有资源文件获取不到
这里我复制到了 static/modeler/ 目录下
然后启动项目，访问其中的index页面：
http://localhost:10001/modeler/index.html（根据情况修改访问路径）
官方提供首页：
发现少了点东西，f12检查
与官方对比下发现，路径中多了静态资源目录 modeler
我们找到static/modeler/scripts/app-cfg.js 这个文件，做下修改
FLOWABLE.CONFIG = { &#39;onPremise&#39; : true, &#39;contextRoot&#39; : &#34;&#34;, &#39;webContextRoot&#39; : &#34;&#34;, &#39;datesLocalization&#39; : false }; 重启访问index.html
路径是对了，但是还是404错误，account请求是获取登录用户信息的，我们可以实现这个请求，返回一个内置用户，去除登录逻辑；
在项目中全局查找/app/rest/account，在static/modeler/scripts/configuration/url-config.js文件中定义的，我们将请求路径修改一下
参考官方modeler的响应
@RestController @RequestMapping(&#34;/modeler/app&#34;) public class AppRestResource { @GetMapping(&#34;/rest/account&#34;) public String getAccount() { // 参考官方提供的响应数据 return &#34;{\&#34;id\&#34;:\&#34;admin\&#34;,\&#34;firstName\&#34;:\&#34;Test\&#34;,\&#34;lastName\&#34;:\&#34;Administrator\&#34;,\&#34;email\&#34;:\&#34;admin@flowable.org\&#34;,\&#34;fullName\&#34;:\&#34;Test Administrator\&#34;,\&#34;groups\&#34;:[],\&#34;privileges\&#34;:[\&#34;access-idm\&#34;,\&#34;access-rest-api\&#34;,\&#34;access-task\&#34;,\&#34;access-modeler\&#34;,\&#34;access-admin\&#34;]}&#34;; } } 重启再访问
这时虽然页面看起来没有问题，但是一些操作还是无法完成的，再看一下static/modeler/scripts/configuration/url-config.js这个文件，其中有很多请求服务端都没有实现的；两种方法：1、参考源码一个个自己实现；2、引入这些请求的源码包
很显然，选择第二种方式，引入源码包
&lt;dependency&gt; &lt;groupId&gt;org.flowable&lt;/groupId&gt; &lt;artifactId&gt;flowable-ui-modeler-rest&lt;/artifactId&gt; &lt;version&gt;${flowable.version}&lt;/version&gt; &lt;/dependency&gt; 重启访问，发现需要登录" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/48df463787f4e1ae7c40c3296d9f010d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-06T11:46:02+08:00" />
<meta property="article:modified_time" content="2021-01-06T11:46:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot集成Flowable modeler设计器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
</div> 
<p></p> 
<p><a href="https://blog.csdn.net/m0_46157986/article/details/112256802">SpringBoot整合Flowable</a></p> 
<p>flowable GitHub仓库：<br> <a href="https://github.com/flowable/flowable-engine">https://github.com/flowable/flowable-engine</a></p> 
<p>下载源码，或者<code>git clone</code></p> 
<p>找到 <code>modules/flowable-ui-modeler/flowable-ui-modeler-app</code> 模块，拷贝该模块下resource/static/目录下的所有内容至自己项目的resource/static/目录下。</p> 
<p><strong>注意：一定要注意源码版本要与项目中的flowable一致，否则会有资源文件获取不到</strong></p> 
<p><img src="https://images2.imgbox.com/c4/d2/j9IwVBrd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1b/a2/2HTc5XLL_o.png" alt="在这里插入图片描述"><br> 这里我复制到了 static/modeler/ 目录下</p> 
<p>然后启动项目，访问其中的index页面：<br> http://localhost:10001/modeler/index.html（根据情况修改访问路径）</p> 
<p><img src="https://images2.imgbox.com/be/15/Unpk0fcZ_o.png" alt="在这里插入图片描述"></p> 
<p>官方提供首页：<br> <img src="https://images2.imgbox.com/35/29/e2laiVuY_o.png" alt="在这里插入图片描述"><br> 发现少了点东西，f12检查<br> <img src="https://images2.imgbox.com/0b/a5/03wHpc61_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/66/79/yHnGrBXn_o.png" alt="在这里插入图片描述"></p> 
<p>与官方对比下发现，路径中多了静态资源目录 modeler<br> <img src="https://images2.imgbox.com/43/ae/bPlCJRaE_o.png" alt="在这里插入图片描述"><br> 我们找到<code>static/modeler/scripts/app-cfg.js</code> 这个文件，做下修改</p> 
<pre><code class="prism language-javascript"><span class="token constant">FLOWABLE</span><span class="token punctuation">.</span><span class="token constant">CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">'onPremise'</span> <span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token string">'contextRoot'</span> <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
	<span class="token string">'webContextRoot'</span> <span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
	<span class="token string">'datesLocalization'</span> <span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>重启访问index.html<br> <img src="https://images2.imgbox.com/ca/c7/CkW3COhI_o.png" alt="在这里插入图片描述"><br> 路径是对了，但是还是404错误，account请求是获取登录用户信息的，我们可以实现这个请求，返回一个内置用户，去除登录逻辑；</p> 
<p>在项目中全局查找<code>/app/rest/account</code>，在<code>static/modeler/scripts/configuration/url-config.js</code>文件中定义的，我们将请求路径修改一下<br> <img src="https://images2.imgbox.com/41/62/5FQ3Kbec_o.png" alt="在这里插入图片描述"><br> 参考官方modeler的响应</p> 
<p><img src="https://images2.imgbox.com/99/f3/jDFnXhI2_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/modeler/app"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppRestResource</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/rest/account"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> String <span class="token function">getAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 参考官方提供的响应数据</span>
        <span class="token keyword">return</span> <span class="token string">"{\"id\":\"admin\",\"firstName\":\"Test\",\"lastName\":\"Administrator\",\"email\":\"admin@flowable.org\",\"fullName\":\"Test Administrator\",\"groups\":[],\"privileges\":[\"access-idm\",\"access-rest-api\",\"access-task\",\"access-modeler\",\"access-admin\"]}"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>重启再访问</p> 
<p><img src="https://images2.imgbox.com/88/1c/bmkI52ug_o.png" alt="在这里插入图片描述"><br> 这时虽然页面看起来没有问题，但是一些操作还是无法完成的，再看一下<code>static/modeler/scripts/configuration/url-config.js</code>这个文件，其中有很多请求服务端都没有实现的；两种方法：1、参考源码一个个自己实现；2、引入这些请求的源码包</p> 
<p>很显然，选择第二种方式，引入源码包</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.flowable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>flowable-ui-modeler-rest<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${flowable.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>重启访问，发现需要登录<br> <img src="https://images2.imgbox.com/58/c9/2hPWs6c0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/34/ef/ztJYWpTj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bd/3f/kXtk7xKB_o.png" alt="在这里插入图片描述"><br> Flowable Security自动配置类<code>org.flowable.spring.boot.FlowableSecurityAutoConfiguration</code>，其在<code>org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration</code>配置前完成自动配置<br> <img src="https://images2.imgbox.com/c0/68/jlArXJIX_o.png" alt="该类在一个自动配置类中引用，这个配置类在"><br> 因此只要排除SecurityAutoConfiguration的自动配置，Flowable Security就不会被配置。在启动类<code>@SpringBootApplication</code>中排除SecurityAutoConfiguration</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>
        exclude <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>SecurityAutoConfiguration<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>重启访问，发现没有了登陆认证，但是其他操作还是无法操作（http请求404），虽然我们引入了请求源码包，但是SpringBoot并没有扫描这些包</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"org.flowable.ui"</span><span class="token punctuation">,</span>
        <span class="token string">"top.theonly.flowable.springboot"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>重启，报错了（日了狗了）</p> 
<pre><code>Description:

Parameter 1 of constructor in org.flowable.ui.modeler.service.AppDefinitionPublishService required a bean of type 'org.flowable.ui.modeler.properties.FlowableModelerAppProperties' that could not be found.

The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)


Action:

Consider defining a bean of type 'org.flowable.ui.modeler.properties.FlowableModelerAppProperties' in your configuration.
</code></pre> 
<p>在AppDefinitionPublishService中，没有找到类型为FlowableModelerAppProperties的bean</p> 
<p><img src="https://images2.imgbox.com/0c/5f/ZvQK7ATD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/06/11/I34UCo7g_o.png" alt="在这里插入图片描述"><br> FlowableModelerAppProperties没有交给Spring容器管理。</p> 
<p>我们可以定义个类继承FlowableModelerAppProperties，交给Spring容器管理。</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomFlowableModelerAppProperties</span> <span class="token keyword">extends</span> <span class="token class-name">FlowableModelerAppProperties</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>
</code></pre> 
<p>重启，又又报错了</p> 
<pre><code>org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'editorGroupsResource': Unsatisfied dependency expressed through field 'remoteIdmService'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteIdmServiceImpl' defined in URL [jar:file:/C:/DevTools/Maven/repository/org/flowable/flowable-ui-common/6.4.2/flowable-ui-common-6.4.2.jar!/org/flowable/ui/common/service/idm/RemoteIdmServiceImpl.class]: Bean instantiation via constructor failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.flowable.ui.common.service.idm.RemoteIdmServiceImpl]: Constructor threw exception; nested exception is java.lang.IllegalArgumentException: `flowable.common.app.idm-url` must be set
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:598) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:90) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:376) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1402) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:591) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:514) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:321) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:226) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:319) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:863) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:878) ~[spring-context-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:550) ~[spring-context-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:141) ~[spring-boot-2.1.16.RELEASE.jar:2.1.16.RELEASE]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:744) [spring-boot-2.1.16.RELEASE.jar:2.1.16.RELEASE]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:391) [spring-boot-2.1.16.RELEASE.jar:2.1.16.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:312) [spring-boot-2.1.16.RELEASE.jar:2.1.16.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1215) [spring-boot-2.1.16.RELEASE.jar:2.1.16.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1204) [spring-boot-2.1.16.RELEASE.jar:2.1.16.RELEASE]
	at top.theonly.flowable.springboot.FlowableSpringBootApplication.main(FlowableSpringBootApplication.java:19) [classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_241]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_241]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_241]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_241]
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) [spring-boot-devtools-2.1.16.RELEASE.jar:2.1.16.RELEASE]
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteIdmServiceImpl' defined in URL [jar:file:/C:/DevTools/Maven/repository/org/flowable/flowable-ui-common/6.4.2/flowable-ui-common-6.4.2.jar!/org/flowable/ui/common/service/idm/RemoteIdmServiceImpl.class]: Bean instantiation via constructor failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.flowable.ui.common.service.idm.RemoteIdmServiceImpl]: Constructor threw exception; nested exception is java.lang.IllegalArgumentException: `flowable.common.app.idm-url` must be set
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:304) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:285) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1338) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1185) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:554) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:514) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:321) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:226) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:319) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:277) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1273) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1193) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:595) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	... 24 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.flowable.ui.common.service.idm.RemoteIdmServiceImpl]: Constructor threw exception; nested exception is java.lang.IllegalArgumentException: `flowable.common.app.idm-url` must be set
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:184) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:117) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:300) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	... 37 common frames omitted
Caused by: java.lang.IllegalArgumentException: `flowable.common.app.idm-url` must be set
	at org.springframework.util.Assert.hasText(Assert.java:284) ~[spring-core-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	at org.flowable.ui.common.properties.FlowableCommonAppProperties.determineIdmAppUrl(FlowableCommonAppProperties.java:135) ~[flowable-ui-common-6.4.2.jar:6.4.2]
	at org.flowable.ui.common.service.idm.RemoteIdmServiceImpl.&lt;init&gt;(RemoteIdmServiceImpl.java:59) ~[flowable-ui-common-6.4.2.jar:6.4.2]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:1.8.0_241]
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62) ~[na:1.8.0_241]
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:1.8.0_241]
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423) ~[na:1.8.0_241]
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:172) ~[spring-beans-5.1.17.RELEASE.jar:5.1.17.RELEASE]
	... 39 common frames omitted
</code></pre> 
<p><img src="https://images2.imgbox.com/ef/76/laL6VC54_o.png" alt="在这里插入图片描述"><br> FlowableCommonAppProperties中的这三个属性是没有配置，那就配置一下呗<br> <code>application.properties</code></p> 
<pre><code class="prism language-properties"># 随便配置，不会用到
flowable.common.app.idm-url=a
flowable.common.app.idm-admin.user=a
flowable.common.app.idm-admin.password=a
</code></pre> 
<p>重启访问，又报错了（点根烟继续）<br> <img src="https://images2.imgbox.com/dc/3f/LTCdAmw6_o.png" alt="在这里插入图片描述"><br> mybatis mapper 映射文件找不到<br> <img src="https://images2.imgbox.com/54/18/4KbL8RsJ_o.png" alt="在这里插入图片描述"><br> 新建一个mybatis配置文件<code>mybatis-cfg.xml</code>，将上面三个映射文件添加进来</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="token doctype">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>META-INF/modeler-mybatis-mappings/Model.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>META-INF/modeler-mybatis-mappings/ModelHistory.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>META-INF/modeler-mybatis-mappings/ModelRelation.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>配置mybatis配置文件位置</p> 
<pre><code class="prism language-properties">mybatis.config-location=classpath:mybatis/mybatis-cfg.xml
</code></pre> 
<p>重启，又又又又报错</p> 
<pre><code>Caused by: java.lang.IllegalArgumentException: No enum constant org.apache.ibatis.type.JdbcType.${blobType}
</code></pre> 
<p><img src="https://images2.imgbox.com/0e/6e/F0pGzQ7g_o.png" alt="在这里插入图片描述"><br> 将这两个属性在mybatis配置文件中配置一下</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="token doctype">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blobType<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>BLOB<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>META-INF/modeler-mybatis-mappings/Model.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>META-INF/modeler-mybatis-mappings/ModelHistory.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>META-INF/modeler-mybatis-mappings/ModelRelation.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>重启访问，后台又又又又又报错</p> 
<pre><code>### Cause: java.sql.SQLSyntaxErrorException: Table 'flowable-springboot2.act_de_model' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'flowable-springboot2.act_de_model' doesn't exist] with root cause
</code></pre> 
<p>act_de_model表不存在</p> 
<p>使用liquibase生成表</p> 
<p>引入依赖</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.liquibase<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>liquibase-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.6.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>copy <code>flowable-modeler-app-db-changelog.xml</code>到自己项目resource中<br> <img src="https://images2.imgbox.com/d5/9b/sZQmN3iu_o.png" alt="在这里插入图片描述"><br> 写一个类来生成表</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowableLiquibaseTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException<span class="token punctuation">,</span> LiquibaseException <span class="token punctuation">{<!-- --></span>
        DruidDataSource dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://127.0.0.1:3306/flowable-springboot?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai&amp;nullCatalogMeansCurrent=true&amp;useSSL=false"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        DruidPooledConnection connection <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        DatabaseConnection databaseConnection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcConnection</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Database db <span class="token operator">=</span> DatabaseFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findCorrectDatabaseImplementation</span><span class="token punctuation">(</span>databaseConnection<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Liquibase liquibase <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Liquibase</span><span class="token punctuation">(</span><span class="token string">"liquibase/flowable-modeler-app-db-changelog.xml"</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ClassLoaderResourceAccessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db<span class="token punctuation">)</span><span class="token punctuation">;</span>

        liquibase<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">"flowable"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行main方法</p> 
<pre><code>11:13:08.790 [main] INFO liquibase.lockservice.StandardLockService - Successfully released change log lock
</code></pre> 
<p>查看数据库，表已生成<br> <img src="https://images2.imgbox.com/91/a9/tl1bAXYq_o.png" alt="在这里插入图片描述"><br> 重启访问，创建模型，保存时报错<br> <img src="https://images2.imgbox.com/a9/28/VwaNRD8n_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7b/7e/qU2u4w5m_o.png" alt="在这里插入图片描述"><br> 获取不到当前用户的id<br> <img src="https://images2.imgbox.com/19/20/YZzD07sK_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3d/e4/RjUUgw6e_o.png" alt="在这里插入图片描述"><br> 那定义一个拦截器，拦截以app开头的路径，设置一个user</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomHandlerInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">,</span> Object handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{<!-- --></span>
        String servletPath <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getServletPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>servletPath<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"/app"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            User user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserEntityImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            SecurityUtils<span class="token punctuation">.</span><span class="token function">assumeUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p>添加拦截器</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomInterceptorAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurerAdapter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span>InterceptorRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CustomHandlerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">addInterceptors</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>重启访问，创建模型，终于成功了<br> <img src="https://images2.imgbox.com/a1/fd/JdMgUjjT_o.png" alt="在这里插入图片描述"><br> 查看数据库<br> <img src="https://images2.imgbox.com/44/b9/61i7FEba_o.png" alt="在这里插入图片描述"><br> 保存模型，也成功<br> <img src="https://images2.imgbox.com/f0/a8/6p2Yu3ex_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bd/95/q22hbNir_o.png" alt="在这里插入图片描述"></p> 
<p>OK，真不容易</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/263afa7acb5266ebdcecd319dda16f29/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python学习笔记-12.函数的递归</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85deb1e7b188c28b88c9584ad33316df/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机网络——链路层与局域网</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>