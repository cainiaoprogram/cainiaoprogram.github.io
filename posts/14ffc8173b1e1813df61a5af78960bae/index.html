<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HighLight组件封装 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HighLight组件封装" />
<meta property="og:description" content="1.思路： 自己在写HighLight组件的时候，是这样的思想：比如说有这么一段字：’王宝强好帅’，高亮词是[‘宝强’,’帅’]，那么我就去遍历这个数组，将数组的元素去匹配文本，将’宝强’和’帅’替换为&lt;span&gt;宝强&lt;/span&gt;和&lt;span&gt;帅&lt;/span&gt;，最后的结果就是得到这样一个字符串’王&lt;span&gt;宝强&lt;/span&gt;好 &lt;span&gt;帅&lt;/span&gt;’，再用div包裹一下，最后再通过div的dangerouslySetInnerHTML属性就可以将一个被div字符串包裹的文本变为一个react.element类型的数据了，我们就可以对span标签的样式进行修改了。代码如下：
import React from &#39;react&#39;; type HighLightProps = { content: string; highLightWords: string[]; color: string; }; const HighLight: React.FC&lt;HighLightProps&gt; = ({ content, highLightWords, color, }) =&gt; { function spliceContent() { // 对数组进行排序，eg：[&#39;宝强&#39;,&#39;王宝强&#39;]转为[&#39;王宝强&#39;,&#39;宝强&#39;]。因为[&#39;宝强&#39;,&#39;王宝强&#39;]在进行高亮的时候【王宝强】三个字只有宝强二字才能够高亮 const highLightWordsSort = highLightWords.sort( (x: string, y: string) =&gt; y.length - x.length, ); if (highLightWordsSort.length === 0) { return &lt;div&gt;{content}&lt;/div&gt;; } else { let contentCopy = content; for (const ele of highLightWordsSort) { const reg = new RegExp(ele); contentCopy = contentCopy?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/14ffc8173b1e1813df61a5af78960bae/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-08T00:17:26+08:00" />
<meta property="article:modified_time" content="2022-05-08T00:17:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HighLight组件封装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1.思路：</h2> 
<p>自己在写HighLight组件的时候，是这样的思想：比如说有这么一段字：’王宝强好帅’，高亮词是[‘宝强’,’帅’]，那么我就去遍历这个数组，将数组的元素去匹配文本，将’宝强’和’帅’替换为&lt;span&gt;宝强&lt;/span&gt;和&lt;span&gt;帅&lt;/span&gt;，最后的结果就是得到这样一个字符串’王&lt;span&gt;宝强&lt;/span&gt;好 &lt;span&gt;帅&lt;/span&gt;’，再用div包裹一下，最后再通过div的dangerouslySetInnerHTML属性就可以将一个被div字符串包裹的文本变为一个react.element类型的数据了，我们就可以对span标签的样式进行修改了。代码如下：</p> 
<pre><code class="language-TypeScript">import React from 'react';

type HighLightProps = {
  content: string;
  highLightWords: string[];
  color: string;
};
const HighLight: React.FC&lt;HighLightProps&gt; = ({
  content,
  highLightWords,
  color,
}) =&gt; {
  function spliceContent() {
    // 对数组进行排序，eg：['宝强','王宝强']转为['王宝强','宝强']。因为['宝强','王宝强']在进行高亮的时候【王宝强】三个字只有宝强二字才能够高亮
    const highLightWordsSort = highLightWords.sort(
      (x: string, y: string) =&gt; y.length - x.length,
    );
    if (highLightWordsSort.length === 0) {
      return &lt;div&gt;{content}&lt;/div&gt;;
    } else {
      let contentCopy = content;
      for (const ele of highLightWordsSort) {
        const reg = new RegExp(ele);
        contentCopy = contentCopy?.replace(
          reg,
          `&lt;span style=color:${color}&gt;${ele}&lt;/span&gt;`,
        );
      }
      return (
        &lt;div
          dangerouslySetInnerHTML={<!-- -->{
            __html: `&lt;div&gt;${contentCopy}&lt;/div&gt;`,
          }}&gt;&lt;/div&gt;
      );
    }
  }
  return &lt;&gt;{spliceContent()}&lt;/&gt;;
};
export default HighLight;
</code></pre> 
<h2>2.遇到的问题：</h2> 
<p>但是现在遇到了这么一个问题：’王宝强好帅’如果遇到[‘宝强’,’王宝强’]这样的高亮词，最后只有‘宝强’二字高亮了，‘王’字没有高亮。这是因为第一次匹配了’宝强’之后得到了这样一个结果’ 王&lt;span&gt;宝强&lt;/span&gt;好帅’，第二次再匹配’王宝强’的时候是匹配不到的。</p> 
<h2>3.解决办法：</h2> 
<p>那么该怎么办呢？细心一点我们会发现如果先匹配’王宝强’再匹配’宝强’的话，结果是这样的’ &lt;span&gt;王&lt;span&gt;宝强&lt;/span&gt;&lt;/span&gt;好帅’，这样是符合预期的。那我们就一开始把这个数组进行一个排序，字多的排到前面就大功告成了，是不是很惊喜，很意外？</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7ca8b792e7d015ff77ebe93f4fff68ed/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pytorch accuracy和Loss 的计算</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/982269d5fb76be9367bff59703310b04/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Paying More Attetion to Attention:Improving the Performance of Convolutional Neural Networks via AT</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>