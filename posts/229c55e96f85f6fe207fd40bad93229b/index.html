<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#和Visionpro混合编程实现工业相机实时图像采集 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#和Visionpro混合编程实现工业相机实时图像采集" />
<meta property="og:description" content="C s h a r p 和 V i s i o n p r o 混 合 编 程 实 现 工 业 相 机 实 时 图 像 采 集 Csharp和Visionpro混合编程实现工业相机实时图像采集 Csharp和Visionpro混合编程实现工业相机实时图像采集 using System; using System.Collections.Generic; using System.ComponentModel; using System.Data; using System.Drawing; using System.Linq; using System.Text; using System.Windows.Forms; using Cognex.VisionPro; using Cognex.VisionPro.ImageFile; using System.IO; using PylonC.NET; using System.Runtime.InteropServices; using System.Threading; namespace Demo { public partial class Form1 : Form { private CogImageFileTool m_ImageFileTool; private Thread ThreadObject; //线程 private bool ThreadStop = false; public Form1() { InitializeComponent(); //线程对象实例化 ThreadObject = new Thread(new ThreadStart(ThreadFunction)); //打开相机 OpenCameraSoftTrigger(); } private void DisplayImage(object sender, EventArgs e) { if (ThreadObject." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/229c55e96f85f6fe207fd40bad93229b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-17T11:36:02+08:00" />
<meta property="article:modified_time" content="2020-12-17T11:36:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#和Visionpro混合编程实现工业相机实时图像采集</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="CsharpVisionpro_0"></a><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          C 
         
        
          s 
         
        
          h 
         
        
          a 
         
        
          r 
         
        
          p 
         
        
          和 
         
        
          V 
         
        
          i 
         
        
          s 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          p 
         
        
          r 
         
        
          o 
         
        
          混 
         
        
          合 
         
        
          编 
         
        
          程 
         
        
          实 
         
        
          现 
         
        
          工 
         
        
          业 
         
        
          相 
         
        
          机 
         
        
          实 
         
        
          时 
         
        
          图 
         
        
          像 
         
        
          采 
         
        
          集 
         
        
       
         Csharp和Visionpro混合编程实现工业相机实时图像采集 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">p</span><span class="mord cjk_fallback">和</span><span class="mord mathdefault" style="margin-right: 0.22222em;">V</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord cjk_fallback">混</span><span class="mord cjk_fallback">合</span><span class="mord cjk_fallback">编</span><span class="mord cjk_fallback">程</span><span class="mord cjk_fallback">实</span><span class="mord cjk_fallback">现</span><span class="mord cjk_fallback">工</span><span class="mord cjk_fallback">业</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">机</span><span class="mord cjk_fallback">实</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">图</span><span class="mord cjk_fallback">像</span><span class="mord cjk_fallback">采</span><span class="mord cjk_fallback">集</span></span></span></span></span></span></h3> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> System<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">;</span>
<span class="token keyword">using</span> Cognex<span class="token punctuation">.</span>VisionPro<span class="token punctuation">;</span>
<span class="token keyword">using</span> Cognex<span class="token punctuation">.</span>VisionPro<span class="token punctuation">.</span>ImageFile<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">;</span>
<span class="token keyword">using</span> PylonC<span class="token punctuation">.</span>NET<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Demo
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token class-name">Form</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> <span class="token class-name">CogImageFileTool</span> m_ImageFileTool<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Thread</span> ThreadObject<span class="token punctuation">;</span>                <span class="token comment">//线程</span>
        <span class="token keyword">private</span> <span class="token keyword">bool</span>   ThreadStop <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//线程对象实例化</span>
            ThreadObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadStart</span><span class="token punctuation">(</span>ThreadFunction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//打开相机</span>
            <span class="token function">OpenCameraSoftTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">DisplayImage</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>ThreadObject<span class="token punctuation">.</span>ThreadState <span class="token operator">==</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>ThreadState<span class="token punctuation">.</span>Unstarted<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                ThreadObject<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>


        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">StopPlay_button_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            ThreadStop <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>

            <span class="token comment">//停止采集图像</span>
            Pylon<span class="token punctuation">.</span><span class="token function">DeviceClose</span><span class="token punctuation">(</span>hDev<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Pylon<span class="token punctuation">.</span><span class="token function">DestroyDevice</span><span class="token punctuation">(</span>hDev<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">//线程回调函数</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ThreadFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> ImageWidth <span class="token operator">=</span> <span class="token number">1280</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ImageHeight <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>
            <span class="token class-name">CogImage8Grey</span> Image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CogImage8Grey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> cogRoot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CogImage8Root</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IntPtr</span> ImageBufferPtr <span class="token operator">=</span> Marshal<span class="token punctuation">.</span><span class="token function">AllocHGlobal</span><span class="token punctuation">(</span>ImageWidth <span class="token operator">*</span> ImageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ImageBuffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token class-name">ImageWidth</span> <span class="token operator">*</span> ImageHeight<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadStop<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//采集单张图像</span>
                <span class="token function">SnapAcquisitionSoftTrigger</span><span class="token punctuation">(</span><span class="token keyword">ref</span> ImageBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//将图像数据从托管区拷贝到非托管区</span>
                Marshal<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>ImageBuffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ImageBufferPtr<span class="token punctuation">,</span> ImageWidth <span class="token operator">*</span> ImageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//初始化</span>
                cogRoot<span class="token punctuation">.</span><span class="token function">Initialize</span><span class="token punctuation">(</span>ImageWidth<span class="token punctuation">,</span> ImageHeight<span class="token punctuation">,</span> ImageBufferPtr<span class="token punctuation">,</span> ImageWidth<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//指定Image图像数据为cogRoot</span>
                Image<span class="token punctuation">.</span><span class="token function">SetRoot</span><span class="token punctuation">(</span>cogRoot<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//将图像数据传给cogRecordDisplay1控件</span>
                cogRecordDisplay1<span class="token punctuation">.</span>Image <span class="token operator">=</span> <span class="token class-name">Image</span> <span class="token keyword">as</span> CogImage8Grey<span class="token punctuation">;</span>

                <span class="token comment">//显示图像</span>
                cogRecordDisplay1<span class="token punctuation">.</span><span class="token function">Fit</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>


        <span class="token comment">///balser  sdk/</span>
        <span class="token keyword">private</span> <span class="token class-name">PYLON_DEVICE_HANDLE</span> hDev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PYLON_DEVICE_HANDLE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">/* Handle for the pylon device. */</span>
        <span class="token keyword">private</span> <span class="token keyword">uint</span> numDevices<span class="token punctuation">;</span>                                        <span class="token comment">/* Number of available devices. */</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">int</span> numGrabs <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>                              <span class="token comment">/* Number of images to grab. */</span>
        <span class="token keyword">private</span> PylonBuffer<span class="token operator">&lt;</span>Byte<span class="token operator">&gt;</span> imgBuf <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                        <span class="token comment">/* Buffer used for grabbing. */</span>

        <span class="token comment">//打开相机</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">OpenCameraSoftTrigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">bool</span> isAvail<span class="token punctuation">;</span>

            Pylon<span class="token punctuation">.</span><span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">/* Enumerate all camera devices. You must call PylonEnumerateDevices() before creating a device. */</span>
            numDevices <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">EnumerateDevices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> numDevices<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"没有找到相机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">/* Get a handle for the first device found.  */</span>
                hDev <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">CreateDeviceByIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">/* Before using the device, it must be opened. Open it for configuring parameters and for grabbing images. */</span>
            Pylon<span class="token punctuation">.</span><span class="token function">DeviceOpen</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> Pylon<span class="token punctuation">.</span>cPylonAccessModeControl <span class="token operator">|</span> Pylon<span class="token punctuation">.</span>cPylonAccessModeStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">/* Set the pixel format to Mono8, where gray values will be output as 8 bit values for each pixel. */</span>
            <span class="token comment">/* ... Check first to see if the device supports the Mono8 format. */</span>
            isAvail <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureIsAvailable</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"EnumEntry_PixelFormat_Mono8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isAvail<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">/* Feature is not available. */</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"设备不支持8位灰度图像"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">/* ... Set the pixel format to Mono8. */</span>
            Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"PixelFormat"</span><span class="token punctuation">,</span> <span class="token string">"Mono8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">/* Disable acquisition start trigger if available. */</span>
            isAvail <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureIsAvailable</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"EnumEntry_TriggerSelector_AcquisitionStart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isAvail<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"TriggerSelector"</span><span class="token punctuation">,</span> <span class="token string">"AcquisitionStart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"TriggerMode"</span><span class="token punctuation">,</span> <span class="token string">"Off"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


            <span class="token comment">/* Disable frame burst start trigger if available */</span>
            isAvail <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureIsAvailable</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"EnumEntry_TriggerSelector_FrameBurstStart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isAvail<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"TriggerSelector"</span><span class="token punctuation">,</span> <span class="token string">"FrameBurstStart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"TriggerMode"</span><span class="token punctuation">,</span> <span class="token string">"Off"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">/* Disable frame start trigger if available */</span>
            isAvail <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureIsAvailable</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"EnumEntry_TriggerSelector_FrameStart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isAvail<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"TriggerSelector"</span><span class="token punctuation">,</span> <span class="token string">"FrameStart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureFromString</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"TriggerMode"</span><span class="token punctuation">,</span> <span class="token string">"Off"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">/* For GigE cameras, we recommend increasing the packet size for better
            performance. If the network adapter supports jumbo frames, set the packet
            size to a value &gt; 1500, e.g., to 8192. In this sample, we only set the packet size
            to 1500. */</span>
            <span class="token comment">/* ... Check first to see if the GigE camera packet size parameter is supported and if it is writable. */</span>
            isAvail <span class="token operator">=</span> Pylon<span class="token punctuation">.</span><span class="token function">DeviceFeatureIsWritable</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"GevSCPSPacketSize"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>isAvail<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">/* ... The device supports the packet size feature. Set a value. */</span>
                Pylon<span class="token punctuation">.</span><span class="token function">DeviceSetIntegerFeature</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token string">"GevSCPSPacketSize"</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>


        <span class="token comment">//采集单张图像</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SnapAcquisitionSoftTrigger</span><span class="token punctuation">(</span><span class="token keyword">ref</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ImageBufferPtr<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token class-name">PylonGrabResult_t</span> grabResult<span class="token punctuation">;</span>

            <span class="token comment">/* Grab one single frame from stream channel 0. The
            camera is set to "single frame" acquisition mode.
            Wait up to 500 ms for the image to be grabbed.
            If imgBuf is null a buffer is automatically created with the right size.*/</span>
            Pylon<span class="token punctuation">.</span><span class="token function">DeviceGrabSingleFrame</span><span class="token punctuation">(</span>hDev<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">ref</span> imgBuf<span class="token punctuation">,</span> <span class="token keyword">out</span> grabResult<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IntPtr</span> dataAddress <span class="token operator">=</span> imgBuf<span class="token punctuation">.</span>Pointer<span class="token punctuation">;</span>

            <span class="token comment">/* Check to see if the image was grabbed successfully. */</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>grabResult<span class="token punctuation">.</span>Status <span class="token operator">==</span> EPylonGrabStatus<span class="token punctuation">.</span>Grabbed<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Marshal<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>dataAddress<span class="token punctuation">,</span> ImageBufferPtr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1280</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"图像抓取失败!n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a2f450ecb4a3fc5931967d5d84679b83/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;----矩阵转置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ad31f0b00a6cebe0fce6767f35e2ac35/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python read函数返回值_python read()方法定义及使用（实例解析）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>