<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PHP的pack/unpack - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PHP的pack/unpack" />
<meta property="og:description" content="PHP: pack - Manual PHP中文手册 PHP中国镜像 php 国内镜像 PHP官方网站
PHP: unpack - Manual PHP中文手册 PHP中国镜像 php 国内镜像 PHP官方网站
1、作用 （1）pack：将数据打包成二进制字符串。将输入数据打包成format格式的二进制字符串。 pack(string $format, mixed ...$values): string
（2）unpack：根据指定的format将二进制字符串解包成数组。
注：对于一个二进制字符串可能是由多部分组成，每部分都是一个&lt;K,V&gt;，多个就是k-v数组了。待会儿看个具体的例子就知道了。
unpack(string $format, string $string, int $offset = 0): array|false
支持的格式如下：
我们简单的关注下几种格式即可。
#n 无符号短整型(16位，大端字节序) 高尾端 尾端放在高地址 #v 无符号短整型(16位，小端字节序) 低尾端 尾端放在低地址 #c 有符号字符 #C 无符号字符 2、使用方式 （1）pack的使用。
#同时将4部分数据按照分别指定的格式打包为二进制字符串，格式如下。 #①将16进制数据0x1234按照n(无符号短整型(16位，大端字节序))格式打包成二进制字符串 #②将16进制数据0x5678按照v(无符号短整型(16位，小端字节序))格式打包成二进制字符串 #③将10进制数据65按照c(有符号字符)格式打包成二进制字符串 #④将10进制数据66按照c(无符号字符)格式打包成二进制字符串 &lt;?php $binarydata = pack(&#34;nvcC&#34;, 0x1234, 0x5678, 65, 66); print_r(&#34;packresult:&#34; . $binarydata); #4xVAB print_r(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/67fa643ecb822ed70d69c24ab17a6762/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-10T10:48:31+08:00" />
<meta property="article:modified_time" content="2023-12-10T10:48:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PHP的pack/unpack</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p><a href="https://php.p2hp.com/manual/zh/function.pack.php" rel="nofollow" title="PHP: pack - Manual  PHP中文手册  PHP中国镜像 php 国内镜像 PHP官方网站">PHP: pack - Manual PHP中文手册 PHP中国镜像 php 国内镜像 PHP官方网站</a></p> 
<p><a href="https://php.p2hp.com/manual/zh/function.unpack.php%C2%A0" rel="nofollow" title="PHP: unpack - Manual  PHP中文手册  PHP中国镜像 php 国内镜像 PHP官方网站">PHP: unpack - Manual PHP中文手册 PHP中国镜像 php 国内镜像 PHP官方网站</a></p> 
<p></p> 
<h5>1、作用</h5> 
<p>（1）pack：将数据打包成二进制字符串。将输入数据打包成format格式的二进制字符串。 </p> 
<blockquote> 
 <p><strong>pack</strong>(string <code>$format</code>, <a href="https://php.p2hp.com/manual/zh/language.types.declarations.php#language.types.declarations.mixed" rel="nofollow" title="mixed">mixed</a> <code>...$values</code>): string</p> 
</blockquote> 
<p>（2）unpack：根据指定的format将二进制字符串解包成数组。</p> 
<p>注：对于一个二进制字符串可能是由多部分组成，每部分都是一个&lt;K,V&gt;，多个就是k-v数组了。待会儿看个具体的例子就知道了。</p> 
<blockquote> 
 <p><strong>unpack</strong>(string <code>$format</code>, string <code>$string</code>, int <code>$offset</code> = 0): array|false</p> 
</blockquote> 
<p>支持的格式如下：</p> 
<p><img alt="" height="1062" src="https://images2.imgbox.com/55/ab/sJqcpD8z_o.png" width="997"></p> 
<p>我们简单的关注下几种格式即可。</p> 
<blockquote> 
 <pre>#n 无符号短整型(16位，大端字节序)  高尾端 尾端放在高地址
#v 无符号短整型(16位，小端字节序)  低尾端 尾端放在低地址
#c 有符号字符
#C 无符号字符</pre> 
</blockquote> 
<h5>2、使用方式</h5> 
<p>（1）pack的使用。</p> 
<pre><code class="language-php">#同时将4部分数据按照分别指定的格式打包为二进制字符串，格式如下。
#①将16进制数据0x1234按照n(无符号短整型(16位，大端字节序))格式打包成二进制字符串
#②将16进制数据0x5678按照v(无符号短整型(16位，小端字节序))格式打包成二进制字符串
#③将10进制数据65按照c(有符号字符)格式打包成二进制字符串
#④将10进制数据66按照c(无符号字符)格式打包成二进制字符串

&lt;?php
$binarydata = pack("nvcC", 0x1234, 0x5678, 65, 66);
print_r("packresult:" . $binarydata);  #4xVAB
print_r("&lt;pre&gt;");
?&gt;
</code></pre> 
<p>输出如下。注：后面会针对这四个元素挨个分析，明确这个“4xVAB”是怎么来的。</p> 
<p><img alt="" height="43" src="https://images2.imgbox.com/de/af/6OCdS06c_o.png" width="203"></p> 
<p>（2）unpack的使用。</p> 
<blockquote> 
 <p>$elems = unpack("<span style="background-color:#fe2c24;">n</span><span style="color:#956fe7;">elem1</span>/<span style="background-color:#fe2c24;">v</span><span style="color:#956fe7;">elem2</span>/<span style="background-color:#fe2c24;">c</span><span style="color:#956fe7;">elem3</span>/<span style="background-color:#fe2c24;">C</span>e<span style="color:#956fe7;">lem4</span>", $binarydata);</p> 
</blockquote> 
<p><strong>①知道这个二进制字符串由四部分组成，每部分的格式分别为nvcC；</strong></p> 
<p><strong>②上述加了红色背景的就是指定格式，这个要和打包的时候指定的格式保持一致；</strong></p> 
<p><strong>③后面紫色的elem1/elem2/elem3/elem4就是你自己取的名字，方便后续对没部分的引用。</strong></p> 
<p><strong>④对照输出结果，一目了然。</strong></p> 
<pre><code class="language-php">#对于上面构建的二进制字符串进行unpack。
#已知其由nccC四部分组成就用着四部分就行解析即可。


&lt;?php
$binarydata = pack("nvcC", 0x1234, 0x5678, 65, 66);
print_r("packresult:" . $binarydata);  #4xVAB
print_r("&lt;pre&gt;");

$elems = unpack("nelem1/velem2/celem3/Celem4", $binarydata);
print_r($elems);
print_r("&lt;pre&gt;");
?&gt;


packresult:4xVAB
Array
(
    [elem1] =&gt; 4660
    [elem2] =&gt; 22136
    [elem3] =&gt; 65
    [elem4] =&gt; 66
)
</code></pre> 
<p>输出结果如下：</p> 
<p><img alt="" height="148" src="https://images2.imgbox.com/48/7a/HPv5XlLy_o.png" width="372"></p> 
<p> 显然，4660就是0x1234的十进制结果、22136就是0x5678的十进制结果，65/66同理。</p> 
<p></p> 
<h5>3、具体测试</h5> 
<p>分析上面这个case，看看直接打印二进制字符串的结果“4xVAB”是怎么来的。</p> 
<p>务必对照ascii码表。<a href="https://baijiahao.baidu.com/s?id=1704767913015693638&amp;wfr=spider&amp;for=pc" rel="nofollow" title="百度安全验证">百度安全验证</a></p> 
<p></p> 
<pre><code class="language-php">#输出了一个4,分析下这个4是怎么来的。
$binarydata = pack("n", 0x1234);
print_r($binarydata);  
print_r("&lt;pre&gt;");


#0x12  Bin(00010010) Dec(18) #查询ascii码表0~31分配给了控制字符;这里的18表示"设备控制2"并不对应可见字符。
#0x34  Bin(00110100) Dec(52) #查询ascii码表对应可打印字符"4"
结论:显然4就是这么来的。




$binarydata = pack("v", 0x5678);
print_r($binarydata);  #xV
print_r("&lt;pre&gt;");


#0x56 Bin(01010110) Dec(56)   #查询ascii码表对应字符V
#0x78 Bin(01111000) Dec(120)  #查询ascii码表对应字符x
结论:又因为v表示小端字节序(低尾端,即尾端在低地址);所以先打印的顺序是xV。



$binarydata = pack("c", 65);
print_r($binarydata);  
print_r("&lt;pre&gt;");

#Dec(65) #查询ascii码表对应可见字符A
#结论:所以输出了A


$binarydata = pack("c", 66);
print_r($binarydata);  
print_r("&lt;pre&gt;");

#Dec(66) #查询ascii码表对应可见字符B
#结论:所以输出了B



</code></pre> 
<p><strong>注：也就是说直接利用print之类的方法直接打印二进制字符串可能并没有什么实际意义。实际能打印出来的只是这些二进制对应的ascii码而已。</strong></p> 
<p></p> 
<p></p> 
<p>其实和python的pack/unpack本质上差不多。<a href="https://blog.csdn.net/mijichui2153/article/details/108692649?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22108692649%22%2C%22source%22%3A%22mijichui2153%22%7D" title="python使用struct处理二进制数据(使用pack和unpack进行打包和解包)_calcsize函数_焱齿的博客-CSDN博客">python使用struct处理二进制数据(使用pack和unpack进行打包和解包)_calcsize函数_焱齿的博客-CSDN博客</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/74d57e652965705c8dff74eb82206cb9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">01_C&#43;&#43; Qt开发：Qt的安装与配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31d2ce37b9a71968da114dfb80c1556d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">22.MongoDB删除操作效率及相关问题验证</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>