<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql 数据库练习题 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql 数据库练习题" />
<meta property="og:description" content="在我们学习mysql数据库时需要一些题目进行练习，所以我将一些视频中的练习题来分享给大家 库文件代码，将这段代码复制到文件中后缀名改为.sql就可以用了
drop table if exists dept; drop table if exists salgrade; drop table if exists emp; create table dept( deptno int(10) primary key, dname varchar(14), loc varchar(13) ); create table salgrade( grade int(11), losal int(11), hisal int(11) ); create table emp( empno int(4) primary key, ename varchar(10), job varchar(9), mgr int(4), hiredate date, sal double(7,2), comm double(7,2), deptno int(2) ); insert into dept(deptno,dname,loc) values(10,&#39;ACCOUNTING&#39;,&#39;NEW YORK&#39;); insert into dept(deptno,dname,loc) values(20,&#39;RESEARCHING&#39;,&#39;DALLAS&#39;); insert into dept(deptno,dname,loc) values(30,&#39;SALES&#39;,&#39;CHICAGO&#39;); insert into dept(deptno,dname,loc) values(40,&#39;OPERATIONS&#39;,&#39;BOSTON&#39;); insert into salgrade(grade,losal,hisal) values(1,700,1200); insert into salgrade(grade,losal,hisal) values(2,1201,1400); insert into salgrade(grade,losal,hisal) values(3,1401,2000); insert into salgrade(grade,losal,hisal) values(4,2001,3000); insert into salgrade(grade,losal,hisal) values(5,3001,5000); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7369,&#39;SIMITH&#39;,&#39;CLERK&#39;,7902,&#39;1980-12-17&#39;,800,null,20); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7499,&#39;ALLEN&#39;,&#39;SALESMAN&#39;,7698,&#39;1981-02-20&#39;,1600,300,30); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7521,&#39;WARD&#39;,&#39;SALESMAN&#39;,7698,&#39;1981-02-22&#39;,1250,500,30); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7566,&#39;JONES&#39;,&#39;MANAGER&#39;,7839,&#39;1981-04-02&#39;,2975,null,20); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7654,&#39;MARTIN&#39;,&#39;SALESMAN&#39;,7698,&#39;1981-09-28&#39;,1250,1400,30); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7698,&#39;BLAKE&#39;,&#39;MANAGER&#39;,7839,&#39;1981-05-01&#39;,2850,null,30); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7782,&#39;CLARK&#39;,&#39;MANAGER&#39;,7839,&#39;1981-06-09&#39;,2450,null,10); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7788,&#39;SCOTT&#39;,&#39;ANALYST&#39;,7566,&#39;1987-04-19&#39;,3000,null,20); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7839,&#39;KING&#39;,&#39;PRESIDENT&#39;,null,&#39;1981-11-17&#39;,5000,null,10); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7844,&#39;TURNER&#39;,&#39;SALESMAN&#39;,7698,&#39;1981-09-08&#39;,1500,null,30); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7876,&#39;ADAMS&#39;,&#39;CLERK&#39;,7788,&#39;1987-05-23&#39;,1100,null,20); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7900,&#39;JAMES&#39;,&#39;CLERK&#39;,7698,&#39;1981-12-03&#39;,950,null,30); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7902,&#39;FORD&#39;,&#39;ANALYST&#39;,7566,&#39;1981-12-03&#39;,3000,null,20); insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7934,&#39;MILLER&#39;,&#39;CLERK&#39;,7782,&#39;1982-01-23&#39;,1300,null,10); select * from dept; select * from salgrade; select * from emp; 一，作业" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ced4557f258054ec700f04af6cd88142/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-19T20:14:54+08:00" />
<meta property="article:modified_time" content="2019-03-19T20:14:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql 数据库练习题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在我们学习mysql数据库时需要一些题目进行练习，所以我将一些视频中的练习题来分享给大家 </p> 
<p>库文件代码，将这段代码复制到文件中后缀名改为.sql就可以用了</p> 
<pre class="has"><code class="language-sql">drop table if exists dept;
drop table if exists salgrade;
drop table if exists emp;

create table dept(
		deptno int(10) primary key,
		dname varchar(14),
		loc varchar(13)
		);
		
create table salgrade(
		grade int(11),
		losal int(11),
		hisal int(11)
		);
		
create table emp(
		empno int(4) primary key,
		ename varchar(10),
		job varchar(9),
		mgr int(4),
		hiredate date,
		sal double(7,2),
		comm double(7,2),
		deptno int(2)
		);
		
insert into dept(deptno,dname,loc) values(10,'ACCOUNTING','NEW YORK');
insert into dept(deptno,dname,loc) values(20,'RESEARCHING','DALLAS');
insert into dept(deptno,dname,loc) values(30,'SALES','CHICAGO');
insert into dept(deptno,dname,loc) values(40,'OPERATIONS','BOSTON');

insert into salgrade(grade,losal,hisal) values(1,700,1200);
insert into salgrade(grade,losal,hisal) values(2,1201,1400);
insert into salgrade(grade,losal,hisal) values(3,1401,2000);
insert into salgrade(grade,losal,hisal) values(4,2001,3000);
insert into salgrade(grade,losal,hisal) values(5,3001,5000);

insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7369,'SIMITH','CLERK',7902,'1980-12-17',800,null,20);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7499,'ALLEN','SALESMAN',7698,'1981-02-20',1600,300,30);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7521,'WARD','SALESMAN',7698,'1981-02-22',1250,500,30);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7566,'JONES','MANAGER',7839,'1981-04-02',2975,null,20);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7654,'MARTIN','SALESMAN',7698,'1981-09-28',1250,1400,30);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7698,'BLAKE','MANAGER',7839,'1981-05-01',2850,null,30);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7782,'CLARK','MANAGER',7839,'1981-06-09',2450,null,10);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7788,'SCOTT','ANALYST',7566,'1987-04-19',3000,null,20);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7839,'KING','PRESIDENT',null,'1981-11-17',5000,null,10);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7844,'TURNER','SALESMAN',7698,'1981-09-08',1500,null,30);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7876,'ADAMS','CLERK',7788,'1987-05-23',1100,null,20);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7900,'JAMES','CLERK',7698,'1981-12-03',950,null,30);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7902,'FORD','ANALYST',7566,'1981-12-03',3000,null,20);
insert into emp(empno,ename,job,mgr,hiredate,sal,comm,deptno)
	values(7934,'MILLER','CLERK',7782,'1982-01-23',1300,null,10);
	
select * from dept;
select * from salgrade;
select * from emp;</code></pre> 
<p><strong>一，作业</strong><br>         <strong> 1、取得每个部门最高薪水的人员名称</strong><br>          第一步：先查出每个部门的最高薪水<br>         select deptno,max(sal) as maxsal from emp group by deptno;<br>         <img alt="" class="has" height="145" src="https://images2.imgbox.com/1f/7c/nHVBOFFV_o.png" width="220"><br>         第二步：再用emp表与第一个查询当作表进行表连接,然后进行判断emp表中的部门编号要与第一表中的部门编号相同并且emp表中的sal等于第一个表中的部门薪水最大值<br>         select <br>             e.ename,e.sal <br>         from <br>             emp e <br>         join <br>             (select deptno,max(sal) as maxsal from emp group by deptno) s <br>         on <br>             e.deptno=s.deptno and e.sal=s.maxsal;<br>         <img alt="" class="has" height="147" src="https://images2.imgbox.com/a4/41/m64cpUX8_o.png" width="236"><br>         <strong>2,哪些人的薪水在部门的平均薪水之上<br>  </strong>       第一步：对于这个问题可以先查出各个部门的平均薪水<br>         select deptno,avg(sal) as sal from emp group by deptno;</p> 
<p><img alt="" class="has" height="147" src="https://images2.imgbox.com/e2/fb/ZuewDWZw_o.png" width="233"><br>         第二步：接下可以把第一个搜索当作一张表，再用emp与它进行表连接,然后进行判断emp表中的sal大于第一种表中的平均薪水<br>         而且还要判断是否是自己部门的<br>         select <br>             e.ename,e.sal,e.deptno <br>         from <br>             emp e <br>         join <br>             (select deptno,avg(sal) as sal from emp group by deptno) d <br>         on <br>             e.deptno=d.deptno and e.sal&gt;d.sal;</p> 
<p><img alt="" class="has" height="167" src="https://images2.imgbox.com/26/1c/7rgzToEe_o.png" width="275"><br><strong>        3,取得部门中（所有人的）平均的薪水等级，</strong><br>         第一步;先查出所有人的薪水等级<br>         select e.ename,s.grade,e.deptno from emp e join salgrade s on e.sal between losal and hisal;</p> 
<p><img alt="" class="has" height="345" src="https://images2.imgbox.com/c8/cb/evYzJEPV_o.png" width="285"><br>         第二步：再用emp与第一个查询当做表进行表连接,进行分组筛选并求出部门所有人的薪水等级<br>         select <br>             d.deptno,avg(grade) <br>         from <br>             (select e.ename,s.grade,e.deptno from emp e join salgrade s <br>         on <br>             e.sal between losal and hisal) d group by d.deptno;</p> 
<p><img alt="" class="has" height="146" src="https://images2.imgbox.com/ca/15/WLPMJylO_o.png" width="236"><br><strong>        4,不准用组函数（Max），取得最高薪水（给出两种解决方案）<br>  </strong>       第一种方案<br>         按照薪水的降序排列,取第一个<br>         select ename,sal from emp order by sal desc limit 1;</p> 
<p><img alt="" class="has" height="120" src="https://images2.imgbox.com/c1/f1/NJhmNJhg_o.png" width="226"><br>         第二个<br>         自连接<br>         emp表和emp表自连接：条件是a.sal&lt;b.sal<br>         select sal from emp where sal not in(select distinct a.sal from emp a join emp b on a.sal&lt;b.sal);<br>         <img alt="" class="has" height="120" src="https://images2.imgbox.com/47/8b/O7tVUVLT_o.png" width="226"><br><strong>        5、取得平均薪水最高的部门的部门编号（至少给出两种解决方案）</strong><br>         第一种方案：<br>         第一步,先查出各部门的平均薪水<br>         select avg(sal) as avgsal,deptno from emp group by deptno;</p> 
<p><img alt="" class="has" height="144" src="https://images2.imgbox.com/2d/b8/qu9xA1u5_o.png" width="256"><br>         第二步,取得平均薪水的最大值降序排列去第一个<br>         select avg(sal) avgsal,deptno from emp  group by deptno order by sal desc limit 1;</p> 
<p><img alt="" class="has" height="114" src="https://images2.imgbox.com/fd/b9/voYBN6ke_o.png" width="246"><br>         第三步,为了防止有重复最大值遗漏,第一步和第二步相结合<br>         select <br>             e.avgsal,e.deptno <br>         from  <br>             (select avg(sal) as avgsal,deptno from emp group by deptno) e <br>         join <br>             (select avg(sal) avgsal,deptno from emp  group by deptno order by sal desc limit 1) d<br>         on <br>             e.avgsal=d.avgsal;</p> 
<p><img alt="" class="has" height="114" src="https://images2.imgbox.com/0f/d0/aem3cLsK_o.png" width="246"><br>         第二种方案：<br>         第一步：先查出各部门的平均薪水<br>         select avg(sal) as avgsal,deptno from emp group by deptno;</p> 
<p><img alt="" class="has" height="150" src="https://images2.imgbox.com/d3/9d/q5YK91kA_o.png" width="254"><br>         第二步：再将第一个表当作表e，然后用max()函数求出平均薪水最高的部门<br>         select max(e.sal),e.deptno from (select avg(sal) as sal,deptno from emp group by deptno) e;</p> 
<p><img alt="" class="has" height="114" src="https://images2.imgbox.com/d9/2e/zue201Li_o.png" width="246"><br>         第三步：<br>         select <br>             avg(sal) as avgsal ,deptno <br>         from <br>             emp group by deptno <br>         having <br>             avg(sal)=(select max(e.sal) from (select avg(sal) as sal from emp group by deptno) e);</p> 
<p><img alt="" class="has" height="114" src="https://images2.imgbox.com/ce/dd/1uQ0gh1M_o.png" width="246"></p> 
<p> <strong> 6、取得平均薪水最高的部门的部门名称</strong><br>         第一步：求得最高平均薪水<br>         select max(e.sal) from (select avg(sal) as sal from emp group by deptno) e;<br>       <img alt="" class="has" height="117" src="https://images2.imgbox.com/40/ce/u3x85bhI_o.png" width="228">  <br>         第二步：将emp与dept进行表连接，条件是部门的平均薪水等于最高薪水<br>         select<br>             avg(a.sal) as avgsal ,d.dname <br>         from <br>             emp a <br>         join <br>             dept d <br>         on <br>             a.deptno=d.deptno group by d.dname <br>         having <br>             avg(a.sal)=(select max(e.sal) from (select avg(sal) as sal from emp group by deptno) e);</p> 
<p><img alt="" class="has" height="122" src="https://images2.imgbox.com/1f/73/zfz9S2zU_o.png" width="287"><br>       <strong>  7、求平均薪水的等级最高的部门的部门名称</strong><br>         第一步：将表emp与表dept进行表表连接，求出平均薪水与部门编号，部门名称<br>         select <br>             avg(t.sal) as avgsal,t.deptno,d.dname <br>         from <br>             emp t<br>         join<br>             dept d<br>         on<br>             t.deptno=d.deptno group by t.deptno;<br>         <br>         <img alt="" class="has" height="152" src="https://images2.imgbox.com/b5/a9/nSpUZhVW_o.png" width="383"><br>         <br>         第二步：求出各部门薪水等级<br>         select <br>             e.deptno,s.grade,e.dname<br>         from<br>             salgrade s <br>         join <br>                     (select <br>                     avg(t.sal) as avgsal,t.deptno,d.dname <br>                 from <br>                     emp t<br>                 join<br>                     dept d<br>                 on<br>                     t.deptno=d.deptno group by t.deptno) e<br>         on <br>             e.avgsal between losal and hisal;<br>                 <img alt="" class="has" height="156" src="https://images2.imgbox.com/87/21/20R0xAzY_o.png" width="323"><br>         第三步：求出最大部门最大薪水等级<br>         select <br>             e.deptno,max(s.grade) as maxgrade<br>         from <br>             salgrade s <br>         join <br>             (select avg(sal) as avgsal,deptno from emp group by deptno) e<br>         on <br>             e.avgsal between losal and hisal ;<br>     <img alt="" class="has" height="97" src="https://images2.imgbox.com/a6/4d/sLlJstoo_o.png" width="245"><br>         第四步：求出薪水等级最高的都有什么部门<br>         select     <br>             b.grade,b.dname<br>         from <br>                 (select <br>                 e.deptno,max(s.grade) as maxgrade<br>             from <br>                 salgrade s <br>             join <br>                 (select avg(sal) as avgsal,deptno from emp group by deptno) e<br>             on <br>                 e.avgsal between losal and hisal) a<br>         join  <br>                 (    select <br>                     e.deptno,s.grade,e.dname<br>                 from<br>                     salgrade s <br>                 join <br>                             (select <br>                             avg(t.sal) as avgsal,t.deptno,d.dname <br>                         from <br>                             emp t<br>                         join<br>                             dept d<br>                         on<br>                             t.deptno=d.deptno group by t.deptno) e<br>                 on <br>                     e.avgsal between losal and hisal) b<br>         on <br>             a.maxgrade=b.grade;<br>         <img alt="" class="has" height="132" src="https://images2.imgbox.com/ff/05/SFhgqUbI_o.png" width="247"><br>       <strong>  8、取得比普通员工(员工代码没有在mgr字段上出现的)的最高薪水还要高的领导人姓名</strong><br>         第一步,查出领导编号<br>         select distinct mgr from emp;<br>         第二步,查出普通员工<br>         select empno,ename,sal from emp where empno not in(select distinct mgr from emp where mgr is not null);<br>         第三步,查出普通员工最高薪水<br>         select max(sal)as maxsal from emp where empno not in(select distinct mgr from emp where mgr is not null);<br>         第四步,查出比普通员工的最高薪水还要高的领导人姓名<br>         select <br>             ename,sal <br>         from <br>             emp <br>         where <br>             sal&gt;(select max(sal)as maxsal from emp where empno not in(select distinct mgr from emp where mgr is not null));<br>         <img alt="" class="has" height="200" src="https://images2.imgbox.com/51/cf/31LukvEl_o.png" width="227"><br>        <strong> 9、取得薪水最高的前五名员工</strong><br>         select ename,sal from emp order by sal desc limit 5;</p> 
<p><img alt="" class="has" height="184" src="https://images2.imgbox.com/b4/22/WpI3qN1L_o.png" width="234"><br>         <strong>10、取得薪水最高的第六到第十名员工</strong><br>         select ename,sal from emp order by sal desc limit 5,5;</p> 
<p><img alt="" class="has" height="184" src="https://images2.imgbox.com/8f/f0/YJ2KCKem_o.png" width="231"></p> 
<p> <strong>     11、取得最后入职的5名员工</strong><br>         select ename,hiredate from emp order by hiredate desc limit 5;<br>         <img alt="" class="has" height="181" src="https://images2.imgbox.com/3f/1e/UwtgvFQD_o.png" width="234"><br>         <strong>12、取得每个薪水等级有多少员工<br>  </strong>       select s.grade,count(s.grade) from emp e join salgrade s on sal between losal and hisal group by s.grade;<br>         <img alt="" class="has" height="183" src="https://images2.imgbox.com/8c/da/1HbUx5cy_o.png" width="279"><br>         <strong>14、列出所有员工及领导的姓名<br>  </strong>       将emp表当作两个表进行左外连接<br>         select e.ename empname,ifnull(d.ename,'not') leadername from emp e  left join emp d on e.mgr=d.empno;<br>         <img alt="" class="has" height="342" src="https://images2.imgbox.com/3e/d6/CdNKilzf_o.png" width="294"><br>       <strong>  15、列出受雇日期早于其直接上级的所有员工的编号,姓名,部门名称<br>  </strong>       第一步：查出受雇日期早于其直接上级的员工编号，姓名，部门编号<br>         select e.empno,e.ename empname,e.deptno from emp e  left join emp d on e.mgr=d.empno where e.hiredate&lt;d.hiredate;</p> 
<p><img alt="" class="has" height="199" src="https://images2.imgbox.com/eb/05/9i8OOfYf_o.png" width="291"><br>         第二步：将第一步当作表a与部门进行表连接，查出员工所在的部门<br>         select <br>             a.empno,a.empname empname,d.dname <br>         from<br>             dept d<br>         join <br>         (select e.empno,e.ename empname,e.deptno from emp e  left join emp d on e.mgr=d.empno where e.hiredate&lt;d.hiredate)<br>         a<br>         on a.deptno=d.deptno;</p> 
<p><img alt="" class="has" height="199" src="https://images2.imgbox.com/63/b2/r6abwLXx_o.png" width="291"><br>       <strong>  16、列出部门名称和这些部门的员工信息,同时列出那些没有员工的部门.</strong><br>         select d.dname,e.* from emp e right join  dept d on e.deptno=d.deptno;</p> 
<p><img alt="" class="has" height="357" src="https://images2.imgbox.com/fa/21/XMJyIA7l_o.png" width="850"><br>       <strong>  17、列出至少有5个员工的所有部门</strong><br>         select count(e.ename),d.dname from emp e join dept d on e.deptno=d.deptno group by d.dname having count(e.ename)&gt;=5;</p> 
<p><img alt="" class="has" height="125" src="https://images2.imgbox.com/24/aa/UjiISRBI_o.png" width="315"><br>         <strong>18、列出薪金比"SIMITH"多的所有员工信息.<br>  </strong>       第一步：查出SIMITH的薪水<br>         select sal from emp where ename='SIMITH';</p> 
<p><img alt="" class="has" height="108" src="https://images2.imgbox.com/8e/fe/9KwAGCR0_o.png" width="208"><br>         第二步：查出大于SIMITH薪水的员工<br>         select ename,sal from emp where  sal&gt;(select sal from emp where ename='SIMITH');</p> 
<p><img alt="" class="has" height="331" src="https://images2.imgbox.com/2f/bd/FYr0O8YK_o.png" width="249"><br>         <strong>19、列出所有"CLERK"(办事员)的姓名及其部门名称,部门的人数.<br>  </strong>       第一步：查出工作为CLERK的员工<br>         select ename,job,deptno from emp where job='CLERK';</p> 
<p><img alt="" class="has" height="166" src="https://images2.imgbox.com/1e/11/R5Qvusgy_o.png" width="268"><br>         第二步：<br>         select e.ename,d.dname,count(*) from dept d join<br>         (select ename,job,deptno from emp where job='CLERK') e on e.deptno=d.deptno group by d.dname;</p> 
<p><img alt="" class="has" height="149" src="https://images2.imgbox.com/d6/4d/ErHNdsTx_o.png" width="344"><br>       <strong>  20、列出最低薪金大于1500的各种工作及从事此工作的全部雇员人数.<br>  </strong>       select min(sal),job,count(ename) from emp group by job having min(sal)&gt;1500;</p> 
<p><img alt="" class="has" height="143" src="https://images2.imgbox.com/95/95/72iMEweW_o.png" width="384"></p> 
<p><strong>21、列出在部门"SALES"&lt;销售部&gt;工作的员工的姓名,假定不知道销售部的部门编号.</strong><br>         第一步：查出部门"SALES"的部门编号<br>         select deptno from dept where dname='SALES';</p> 
<p><img alt="" class="has" height="118" src="https://images2.imgbox.com/bd/69/LDtuTu5J_o.png" width="237"><br>         第二步：查看在部门"SALES"工作的员工<br>         select ename from emp where deptno=(select deptno from dept where dname='SALES');</p> 
<p><img alt="" class="has" height="211" src="https://images2.imgbox.com/56/ad/OK6GXjtZ_o.png" width="234"><br>        <strong> 22、列出薪金高于公司平均薪金的所有员工,所在部门,上级领导,雇员的工资等级.</strong><br>          将三个表进行表连接，按照条件进行判断<br>         select <br>             e.ename empname,a.ename leadername,d.dname,s.grade <br>         from<br>             emp e <br>         left join  <br>             emp a <br>         on <br>             e.mgr=a.empno<br>         join <br>             dept d <br>         on <br>             e.deptno=d.deptno<br>         join <br>             salgrade s<br>         on  <br>             e.sal between s.losal and s.hisal where e.sal&gt;(select avg(sal) from emp);</p> 
<p><img alt="" class="has" height="203" src="https://images2.imgbox.com/b3/e2/FfeoShvt_o.png" width="442"></p> 
<p>      <strong>  23、列出与"SCOTT"从事相同工作的所有员工及部门名称.</strong><br>         第一步：查出SCOTT的工作<br>         select job from emp where ename='SCOTT';</p> 
<p><img alt="" class="has" height="113" src="https://images2.imgbox.com/ef/06/m6jptcLW_o.png" width="159"><br>         第二步：列出与"SCOTT"从事相同工作的所有员工及部门名称.<br>         select <br>             e.ename,d.dname <br>         from <br>             emp e <br>         join <br>             dept d <br>         on <br>             e.job=(select job from emp where ename='SCOTT') where e.deptno=d.deptno;</p> 
<p><img alt="" class="has" height="126" src="https://images2.imgbox.com/fb/39/dcoAweZW_o.png" width="247"><br>        <strong> 24、列出薪金等于部门30中员工的薪金的其他员工的姓名和薪金.</strong><br>         第一步：查出部门30中的员工薪水<br>         select distinct sal from emp where deptno=30;</p> 
<p><img alt="" class="has" height="180" src="https://images2.imgbox.com/78/fa/nUHHJZPD_o.png" width="178"><br>         第二步：列出薪金等于部门30中员工的薪金的其他员工的姓名和薪金.<br>         select ename,sal from emp where sal in(select distinct sal from emp where deptno=30) and deptno!=30;<br>         <br>      <strong>   25、列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金.部门名称.</strong><br>         第一步：部门30中的最高薪水<br>         select max(sal) from emp where deptno=30;</p> 
<p><img alt="" class="has" height="112" src="https://images2.imgbox.com/c4/be/xRsA9iH2_o.png" width="139"><br>         第二步：列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金.部门名称.<br>         select e.ename,e.sal,d.dname from emp e join dept d on e.deptno=d.deptno where e.sal&gt;(select max(sal) from emp where deptno=30) and e.deptno&lt;&gt;30;<br>         <img alt="" class="has" height="131" src="https://images2.imgbox.com/8d/63/BG4F0a6i_o.png" width="307"><br>        <strong> 26、列出在每个部门工作的员工数量,平均工资和平均服务期限.</strong><br>         select <br>             d.dname,count(e.ename),ifnull(avg(e.sal),0),ifnull(avg(to_days(now())-to_days(e.hiredate))/365,0) as avgtime <br>         from <br>             emp e <br>         right join <br>             dept d <br>         on <br>             e.deptno=d.deptno group by d.dname;<br>         <img alt="" class="has" height="158" src="https://images2.imgbox.com/2a/fe/JcuVIZZ4_o.png" width="638"><br>  <strong>       27、列出所有员工的姓名、部门名称和工资。</strong><br>         select e.ename,d.dname,e.sal from emp e join dept d on e.deptno=d.deptno;</p> 
<p><img alt="" class="has" height="339" src="https://images2.imgbox.com/92/a9/OaYxvwK9_o.png" width="326"><br>      <strong>   28、列出所有部门的详细信息和人数</strong><br>         select d.*,count(e.ename) from emp e right join dept d on e.deptno=d.deptno group by deptno;</p> 
<p><img alt="" class="has" height="161" src="https://images2.imgbox.com/1d/4e/96Wb6im9_o.png" width="483"><br>     <strong>    29、列出各种工作的最低工资及从事此工作的雇员姓名</strong><br>         第一步：列出各种工作的最低工资<br>         select job,min(sal) as minsal from emp group by job;</p> 
<p><img alt="" class="has" height="180" src="https://images2.imgbox.com/81/c9/2SXI8Gxa_o.png" width="264"><br>         第二步：列出各种工作的最低工资及从事此工作的雇员姓名<br>         select <br>             d.ename,d.sal,d.job <br>         from <br>             emp d <br>         join <br>             (select job,min(sal) as minsal from emp group by job) e <br>         on<br>             d.job=e.job and e.minsal=d.sal;</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/e0/e9/fAHz999v_o.png"><br><strong>        30、列出各个部门的MANAGER(领导)的最低薪金</strong><br>         select deptno,min(sal) from emp where job='MANAGER' group by deptno;</p> 
<p><img alt="" class="has" height="142" src="https://images2.imgbox.com/5f/9b/jwrzdKOq_o.png" width="223"><br>       <strong>  31、列出所有员工的年工资,按年薪从低到高排序</strong><br>         select ename,(sal+ifnull(comm,0))*12 as yearsal from emp  order by sal ;</p> 
<p><img alt="" class="has" height="341" src="https://images2.imgbox.com/c0/45/Z24pNZV6_o.png" width="202"><br>         32、求出员工领导的薪水超过3000的员工名称与领导名称<br>         select e.ename empname,s.ename leadername,s.sal from emp e left join emp s on e.mgr=s.empno where s.sal&gt;3000;</p> 
<p><img alt="" class="has" height="257" src="https://images2.imgbox.com/05/86/RLmScx29_o.png" width="316"><br>     <strong>    33、求出部门名称中,带'S'字符的部门员工的工资合计、部门人数.</strong><br>         select <br>             d.deptno,ifnull(sum(sal),0),count(e.ename) <br>         from <br>             emp e <br>         right join <br>             dept d <br>         on <br>             e.deptno=d.deptno and d.dname like '%s%' group by d.deptno; </p> 
<p><img alt="" class="has" height="157" src="https://images2.imgbox.com/81/43/0wt8n4mL_o.png" width="442"><br>       <strong>  34、给任职日期超过30年的员工加薪10%.</strong><br>         select ename,sal*1.1 sal from emp where (to_days(now())-to_days(hiredate))/365&gt;30;</p> 
<p><img alt="" class="has" height="338" src="https://images2.imgbox.com/71/76/IHK19Bd6_o.png" width="215"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/abe87c1aa6228a0393af48f9eb8710c4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">接口测试与接口性能测试总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/89451a2748cd645f6174eeb5271a6657/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux各文件夹的结构说明及用途介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>