<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习----线性回归 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习----线性回归" />
<meta property="og:description" content="第一关：简单线性回归与多元线性回归
1、下面属于多元线性回归的是？
A、 求得正方形面积与对角线之间的关系。
B、 建立股票价格与成交量、换手率等因素之间的线性关系。
C、 建立西瓜价格与西瓜大小、西瓜产地、甜度等因素之间的线性关系。
D、 建立西瓜书销量与时间之间的线性关系。
2、若线性回归方程得到多个解，下面哪些方法能够解决此问题？
A、 获取更多的训练样本
B、 选取样本有效的特征，使样本数量大于特征数
C、 加入正则化项
D、 不考虑偏置项b
3、下列关于线性回归分析中的残差（预测值减去真实值）说法正确的是？
A、 残差均值总是为零
B、 残差均值总是小于零
C、 残差均值总是大于零
D、 以上说法都不对
答案：1.BC 2.ABC 3.A
第2关：线性回归的正规方程解 #encoding=utf8 import numpy as np def mse_score(y_predict,y_test): &#39;&#39;&#39; input:y_predict(ndarray):预测值 y_test(ndarray):真实值 ouput:mse(float):mse损失函数值 &#39;&#39;&#39; #********* Begin *********# mse=np.mean((y_predict-y_test)/2) #********* End *********# return mse class LinearRegression : def __init__(self): &#39;&#39;&#39;初始化线性回归模型&#39;&#39;&#39; self.theta = None def fit_normal(self,train_data,train_label): &#39;&#39;&#39; input:train_data(ndarray):训练样本 train_label(ndarray):训练标签 &#39;&#39;&#39; #********* Begin *********# x = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/cef7ee277fb0fe0ca366e73849eecf46/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-25T15:20:49+08:00" />
<meta property="article:modified_time" content="2023-03-25T15:20:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习----线性回归</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>第一关：简单线性回归与多元线性回归</p> 
<ul><li> <p>1、下面属于多元线性回归的是？</p> </li><li>A、 <p>求得正方形面积与对角线之间的关系。</p> B、 <p>建立股票价格与成交量、换手率等因素之间的线性关系。</p> C、 <p>建立西瓜价格与西瓜大小、西瓜产地、甜度等因素之间的线性关系。</p> D、 <p>建立西瓜书销量与时间之间的线性关系。</p> </li><li> <p>2、若线性回归方程得到多个解，下面哪些方法能够解决此问题？</p> A、 <p>获取更多的训练样本</p> B、 <p>选取样本有效的特征，使样本数量大于特征数</p> C、 <p>加入正则化项</p> D、 <p>不考虑偏置项b</p> </li><li> <p>3、下列关于线性回归分析中的残差（预测值减去真实值）说法正确的是？</p> A、 <p>残差均值总是为零</p> B、 <p>残差均值总是小于零</p> C、 <p>残差均值总是大于零</p> D、 <p>以上说法都不对</p> </li></ul> 
<p>答案：1.BC     2.ABC     3.A</p> 
<h4>第2关：线性回归的正规方程解</h4> 
<pre><code class="hljs">#encoding=utf8 
import numpy as np
def mse_score(y_predict,y_test):
    '''
    input:y_predict(ndarray):预测值
          y_test(ndarray):真实值
    ouput:mse(float):mse损失函数值
    '''
    #********* Begin *********#
    mse=np.mean((y_predict-y_test)/2)
    #********* End *********#
    return mse
class LinearRegression :
    def __init__(self):
        '''初始化线性回归模型'''
        self.theta = None
    def fit_normal(self,train_data,train_label):
        '''
        input:train_data(ndarray):训练样本
              train_label(ndarray):训练标签
        '''
        #********* Begin *********#
        x = np.hstack([np.ones((len(train_data),1)),train_data])
        self.theta =np.linalg.inv(x.T.dot(x)).dot(x.T).dot(train_label)
        #********* End *********#
        return self.theta
    def predict(self,test_data):
        '''
        input:test_data(ndarray):测试样本
        '''
        #********* Begin *********#
        x = np.hstack([np.ones((len(test_data),1)),test_data])
        return x.dot(self.theta)
        #********* End *********#</code></pre> 
<h4>第3关：衡量线性回归的性能指标：</h4> 
<pre><code class="hljs">#encoding=utf8 
import numpy as np
#mse
def mse_score(y_predict,y_test):
    mse = np.mean((y_predict-y_test)**2)
    return mse
#r2
def r2_score(y_predict,y_test):
    '''
    input:y_predict(ndarray):预测值
          y_test(ndarray):真实值
    output:r2(float):r2值
    '''
    #********* Begin *********#
    r2=1-mse_score(y_predict,y_test)/np.var(y_test)
    #********* End *********#
    return r2
class LinearRegression :
    def __init__(self):
        '''初始化线性回归模型'''
        self.theta = None
    def fit_normal(self,train_data,train_label):
        '''
        input:train_data(ndarray):训练样本
              train_label(ndarray):训练标签
        '''
        #********* Begin *********#
        x=np.hstack([np.ones((len(train_data),1)),train_data])
        self.theta=np.linalg.inv(x.T.dot(x)).dot(x.T).dot(train_label)  
        #********* End *********#
        return self
    def predict(self,test_data):
        '''
        input:test_data(ndarray):测试样本
        '''
        #********* Begin *********#
        x=np.hstack([np.ones((len(test_data),1)),test_data])
        return x.dot(self.theta)
        #********* End *********#
</code></pre> 
<h4>第4关：scikit-learn线性回归实践 - 波斯顿房价预测：</h4> 
<pre><code class="hljs">#encoding=utf8
#********* Begin *********#
from sklearn.linear_model import LinearRegression
import pandas as pd
train_data = pd.read_csv('./step3/train_data.csv')
train_label = pd.read_csv('./step3/train_label.csv')
train_label = train_label['target']
test_data = pd.read_csv('./step3/test_data.csv')
lr = LinearRegression()
lr.fit(train_data, train_label)
predict = lr.predict(test_data)
df = pd.DataFrame({'result': predict})
df.to_csv('./step3/result.csv', index = False)
#********* End *********#
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/84487fc6db193a163f8448b007ea2eed/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">非常想学黑客技术，但是却又不知道如何入门？看这里就够了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/08a89611551b4c703af958e3e60e9a9f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CentOS yum使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>