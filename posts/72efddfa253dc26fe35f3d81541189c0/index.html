<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JS前端DES加密参数 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JS前端DES加密参数" />
<meta property="og:description" content="DES加密为可解密的机制，这里使用DES进行加密方便后台解密还原参数值。本文的功能中des.js与Des.java作用相同，在不同地方产生作用。在登录的页面引入des.js文件，后台写个Des.java类，然后在登录验证前调用即可，方便易用。 jsp页面js函数与表单改造： 注意：要让表单中明文文本框不提交，只需将该文本框的name属性去掉即可。前后台加解密的三个密码字符串要一直。 &lt;script type=&#34;text/javascript&#34;&gt;
function setPass(originId,decId){
var orginName = window.parent.document.getElementById(&#39;orginName&#39;).value;
var newName = strEnc(orginName,&#39;itmp&#39;,&#39;des&#39;,&#39;encrypt&#39;);
window.parent.document.getElementById(&#39;userId&#39;).value = newName;
var orginPass = window.parent.document.getElementById(originId).value;
var newPass = strEnc(orginPass,&#39;itmp&#39;,&#39;des&#39;,&#39;encrypt&#39;);
//alert(&#39;newPass=&#39; &#43; newPass &#43; &#39; pass=&#39;&#43;strDec(newPass,&#39;itmp&#39;,&#39;des&#39;,&#39;encrypt&#39;));
window.parent.document.getElementById(decId).value = newPass;
}
&lt;/script&gt;
&lt;form id=&#34;form&#34; name=&#34;form&#34; action=&#34;${ctx}/j_spring_security_check&#34; method=&#34;post&#34;&gt;
&lt;table width=&#34;100%&#34; border=&#34;0&#34; cellspacing=&#34;0&#34; cellpadding=&#34;0&#34;&gt;
&lt;tr&gt;
&lt;td width=&#34;20%&#34; height=&#34;10&#34; class=&#34;black14&#34; align=&#34;center&#34; valign=&#34;middle&#34;&gt;&lt;/td&gt;
&lt;td colspan=&#34;2&#34; align=&#34;left&#34;&gt;
&lt;div class=&#34;error${param.error==true?&#39;&#39;:&#39;hide&#39;}&#34; style=&#34;color:red;&#34;&gt;
${sessionScope[&#39;SPRING_SECURITY_LAST_EXCEPTION&#39;].message}
&lt;/div&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td width=&#34;20%&#34; height=&#34;35&#34; class=&#34;black14&#34;&gt;用户名&lt;/td&gt;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/72efddfa253dc26fe35f3d81541189c0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-07-08T14:27:26+08:00" />
<meta property="article:modified_time" content="2016-07-08T14:27:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JS前端DES加密参数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    DES加密为可解密的机制，这里使用DES进行加密方便后台解密还原参数值。本文的功能中des.js与Des.java作用相同，在不同地方产生作用。在登录的页面引入des.js文件，后台写个Des.java类，然后在登录验证前调用即可，方便易用。 
<br> 
<br>jsp页面js函数与表单改造： 
<br>注意：要让表单中明文文本框不提交，只需将该文本框的name属性去掉即可。前后台加解密的三个密码字符串要一直。 
<br> 
<pre><code class="language-java"><br>&lt;script type="text/javascript"&gt;<br>function setPass(originId,decId){<!-- --><br>	var orginName = window.parent.document.getElementById('orginName').value;<br>	var newName = strEnc(orginName,'itmp','des','encrypt');<br>	window.parent.document.getElementById('userId').value = newName;<br><br>	var orginPass = window.parent.document.getElementById(originId).value;<br>	var newPass = strEnc(orginPass,'itmp','des','encrypt');<br>	//alert('newPass=' + newPass + ' pass='+strDec(newPass,'itmp','des','encrypt'));<br>	window.parent.document.getElementById(decId).value = newPass;<br>}<br>&lt;/script&gt;<br><br>&lt;form id="form" name="form" action="${ctx}/j_spring_security_check" method="post"&gt;<br>	&lt;table width="100%" border="0" cellspacing="0" cellpadding="0"&gt;<br> 	 &lt;tr&gt;<br>     	&lt;td width="20%" height="10" class="black14" align="center" valign="middle"&gt;&lt;/td&gt;<br>     	&lt;td colspan="2" align="left"&gt;<br>        	&lt;div class="error${param.error==true?'':'hide'}" style="color:red;"&gt;<br>		${sessionScope['SPRING_SECURITY_LAST_EXCEPTION'].message}<br>		&lt;/div&gt;<br>    	&lt;/td&gt;<br>    &lt;/tr&gt;<br>   &lt;tr&gt;<br>     &lt;td width="20%" height="35" class="black14"&gt;用户名&lt;/td&gt;<br>     &lt;td colspan="2" align="left"&gt;&lt;label &gt;<br>       &lt;input type="text" id="orginName" value="${sessionScope['SPRING_SECURITY_LAST_USERNAME']}" class="input" /&gt;<br>       &lt;input type="hidden" id="userId" name="j_username" value="" class="input"/&gt;<br>     &lt;/label&gt;&lt;/td&gt;<br>   &lt;/tr&gt;<br>   &lt;tr&gt;<br>     &lt;td height="35" class="black14"&gt;密   码&lt;/td&gt;<br>     &lt;td colspan="2" align="left"&gt;&lt;label &gt;<br>       &lt;input type="password" id="orginPass" class="input" onblur="setPass('orginPass','password');"/&gt;<br>       &lt;input type="hidden" name="j_password" id="password" class="input"/&gt;<br>     &lt;/label&gt;&lt;/td&gt;<br>   &lt;/tr&gt;<br>   &lt;tr&gt;<br>     &lt;td height="35" class="black14"&gt;验证码&lt;/td&gt;<br>     &lt;td width="37%" align="left"&gt;&lt;label&gt;<br>       &lt;input type="text" name="validateCode" class="input2"/&gt;<br>     &lt;/label&gt;&lt;/td&gt;<br>     &lt;td width="43%" align="left"&gt;<br>     	&lt;img onclick="this.src='kaptcha.validate'" src="kaptcha.validate" width="77" height="28" /&gt;<br>     &lt;/td&gt;<br>   &lt;/tr&gt;<br>   &lt;tr&gt;<br>     &lt;td height="93" colspan="3" align="center"&gt;<br>     	&lt;a href="#"&gt;<br>     		&lt;input type="image" src="${ctx}/css/remake/images/button_login.gif" width="111" height="36" border="0" /&gt;<br>     	&lt;/a&gt;<br>     &lt;/td&gt;<br>   &lt;/tr&gt;<br> &lt;/table&gt;<br>&lt;/form&gt;<br></code></pre> 
<br> 
<br>后台登录验证调用Des的解密方法进行解密 
<br> 
<pre><code class="language-java"><br>Des des = new Des();<br>String pass=des.strDec(orginPass, 'itmp','des','encrypt');<br></code></pre> 
<br> 
<br>后台加解密类Des.java代码如下： 
<br> 
<pre><code class="language-java"><br>package com.eshore.itmp.model.web.security;<br><br>import java.util.ArrayList;<br>import java.util.List;<br><br>/**<br> * 页面端加密解密处理类<br> * <br> * @author ahomeeye<br> * <br> */<br>public class Des {<!-- --><br><br>	public Des() {<!-- --><br>	}<br><br>	/*<br>	 * encrypt the string to string made up of hex return the encrypted string<br>	 */<br>	public String strEnc(String data, String firstKey, String secondKey,<br>			String thirdKey) {<!-- --><br><br>		int leng = data.length();<br>		String encData = "";<br>		List firstKeyBt = null, secondKeyBt = null, thirdKeyBt = null;<br>		int firstLength = 0, secondLength = 0, thirdLength = 0;<br>		if (firstKey != null &amp;&amp; firstKey != "") {<!-- --><br>			firstKeyBt = getKeyBytes(firstKey);<br>			firstLength = firstKeyBt.size();<br>		}<br>		if (secondKey != null &amp;&amp; secondKey != "") {<!-- --><br>			secondKeyBt = getKeyBytes(secondKey);<br>			secondLength = secondKeyBt.size();<br>		}<br>		if (thirdKey != null &amp;&amp; thirdKey != "") {<!-- --><br>			thirdKeyBt = getKeyBytes(thirdKey);<br>			thirdLength = thirdKeyBt.size();<br>		}<br><br>		if (leng &gt; 0) {<!-- --><br>			if (leng &lt; 4) {<!-- --><br>				int[] bt = strToBt(data);<br>				int[] encByte = null;<br>				if (firstKey != null &amp;&amp; firstKey != "" &amp;&amp; secondKey != null<br>						&amp;&amp; secondKey != "" &amp;&amp; thirdKey != null<br>						&amp;&amp; thirdKey != "") {<!-- --><br>					int[] tempBt;<br>					int x, y, z;<br>					tempBt = bt;<br>					for (x = 0; x &lt; firstLength; x++) {<!-- --><br>						tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>					}<br>					for (y = 0; y &lt; secondLength; y++) {<!-- --><br>						tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));<br>					}<br>					for (z = 0; z &lt; thirdLength; z++) {<!-- --><br>						tempBt = enc(tempBt, (int[]) thirdKeyBt.get(z));<br>					}<br>					encByte = tempBt;<br>				} else {<!-- --><br>					if (firstKey != null &amp;&amp; firstKey != "" &amp;&amp; secondKey != null<br>							&amp;&amp; secondKey != "") {<!-- --><br>						int[] tempBt;<br>						int x, y;<br>						tempBt = bt;<br>						for (x = 0; x &lt; firstLength; x++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>						}<br>						for (y = 0; y &lt; secondLength; y++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));<br>						}<br>						encByte = tempBt;<br>					} else {<!-- --><br>						if (firstKey != null &amp;&amp; firstKey != "") {<!-- --><br>							int[] tempBt;<br>							int x = 0;<br>							tempBt = bt;<br>							for (x = 0; x &lt; firstLength; x++) {<!-- --><br>								tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>							}<br>							encByte = tempBt;<br>						}<br>					}<br>				}<br>				encData = bt64ToHex(encByte);<br>			} else {<!-- --><br>				int iterator = (leng / 4);<br>				int remainder = leng % 4;<br>				int i = 0;<br>				for (i = 0; i &lt; iterator; i++) {<!-- --><br>					String tempData = data.substring(i * 4 + 0, i * 4 + 4);<br>					int[] tempByte = strToBt(tempData);<br>					int[] encByte = null;<br>					if (firstKey != null &amp;&amp; firstKey != "" &amp;&amp; secondKey != null<br>							&amp;&amp; secondKey != "" &amp;&amp; thirdKey != null<br>							&amp;&amp; thirdKey != "") {<!-- --><br>						int[] tempBt;<br>						int x, y, z;<br>						tempBt = tempByte;<br>						for (x = 0; x &lt; firstLength; x++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>						}<br>						for (y = 0; y &lt; secondLength; y++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));<br>						}<br>						for (z = 0; z &lt; thirdLength; z++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) thirdKeyBt.get(z));<br>						}<br>						encByte = tempBt;<br>					} else {<!-- --><br>						if (firstKey != null &amp;&amp; firstKey != ""<br>								&amp;&amp; secondKey != null &amp;&amp; secondKey != "") {<!-- --><br>							int[] tempBt;<br>							int x, y;<br>							tempBt = tempByte;<br>							for (x = 0; x &lt; firstLength; x++) {<!-- --><br>								tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>							}<br>							for (y = 0; y &lt; secondLength; y++) {<!-- --><br>								tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));<br>							}<br>							encByte = tempBt;<br>						} else {<!-- --><br>							if (firstKey != null &amp;&amp; firstKey != "") {<!-- --><br>								int[] tempBt;<br>								int x;<br>								tempBt = tempByte;<br>								for (x = 0; x &lt; firstLength; x++) {<!-- --><br>									tempBt = enc(tempBt,<br>											(int[]) firstKeyBt.get(x));<br>								}<br>								encByte = tempBt;<br>							}<br>						}<br>					}<br>					encData += bt64ToHex(encByte);<br>				}<br>				if (remainder &gt; 0) {<!-- --><br>					String remainderData = data.substring(iterator * 4 + 0,<br>							leng);<br>					int[] tempByte = strToBt(remainderData);<br>					int[] encByte = null;<br>					if (firstKey != null &amp;&amp; firstKey != "" &amp;&amp; secondKey != null<br>							&amp;&amp; secondKey != "" &amp;&amp; thirdKey != null<br>							&amp;&amp; thirdKey != "") {<!-- --><br>						int[] tempBt;<br>						int x, y, z;<br>						tempBt = tempByte;<br>						for (x = 0; x &lt; firstLength; x++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>						}<br>						for (y = 0; y &lt; secondLength; y++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));<br>						}<br>						for (z = 0; z &lt; thirdLength; z++) {<!-- --><br>							tempBt = enc(tempBt, (int[]) thirdKeyBt.get(z));<br>						}<br>						encByte = tempBt;<br>					} else {<!-- --><br>						if (firstKey != null &amp;&amp; firstKey != ""<br>								&amp;&amp; secondKey != null &amp;&amp; secondKey != "") {<!-- --><br>							int[] tempBt;<br>							int x, y;<br>							tempBt = tempByte;<br>							for (x = 0; x &lt; firstLength; x++) {<!-- --><br>								tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));<br>							}<br>							for (y = 0; y &lt; secondLength; y++) {<!-- --><br>								tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));<br>							}<br>							encByte = tempBt;<br>						} else {<!-- --><br>							if (firstKey != null &amp;&amp; firstKey != "") {<!-- --><br>								int[] tempBt;<br>								int x;<br>								tempBt = tempByte;<br>								for (x = 0; x &lt; firstLength; x++) {<!-- --><br>									tempBt = enc(tempBt,<br>											(int[]) firstKeyBt.get(x));<br>								}<br>								encByte = tempBt;<br>							}<br>						}<br>					}<br>					encData += bt64ToHex(encByte);<br>				}<br>			}<br>		}<br>		return encData;<br>	}<br><br>	/*<br>	 * decrypt the encrypted string to the original string<br>	 * <br>	 * return the original string<br>	 */<br>	public String strDec(String data, String firstKey, String secondKey,<br>			String thirdKey) {<!-- --><br>		int leng = data.length();<br>		String decStr = "";<br>		List firstKeyBt = null, secondKeyBt = null, thirdKeyBt = null;<br>		int firstLength = 0, secondLength = 0, thirdLength = 0;<br>		if (firstKey != null &amp;&amp; firstKey != "") {<!-- --><br>			firstKeyBt = getKeyBytes(firstKey);<br>			firstLength = firstKeyBt.size();<br>		}<br>		if (secondKey != null &amp;&amp; secondKey != "") {<!-- --><br>			secondKeyBt = getKeyBytes(secondKey);<br>			secondLength = secondKeyBt.size();<br>		}<br>		if (thirdKey != null &amp;&amp; thirdKey != "") {<!-- --><br>			thirdKeyBt = getKeyBytes(thirdKey);<br>			thirdLength = thirdKeyBt.size();<br>		}<br><br>		int iterator = leng / 16;<br>		int i = 0;<br>		for (i = 0; i &lt; iterator; i++) {<!-- --><br>			String tempData = data.substring(i * 16 + 0, i * 16 + 16);<br>			String strByte = hexToBt64(tempData);<br>			int[] intByte = new int[64];<br>			int j = 0;<br>			for (j = 0; j &lt; 64; j++) {<!-- --><br>				intByte[j] = Integer.parseInt(strByte.substring(j, j + 1));<br>			}<br>			int[] decByte = null;<br>			if (firstKey != null &amp;&amp; firstKey != "" &amp;&amp; secondKey != null<br>					&amp;&amp; secondKey != "" &amp;&amp; thirdKey != null &amp;&amp; thirdKey != "") {<!-- --><br>				int[] tempBt;<br>				int x, y, z;<br>				tempBt = intByte;<br>				for (x = thirdLength - 1; x &gt;= 0; x--) {<!-- --><br>					tempBt = dec(tempBt, (int[]) thirdKeyBt.get(x));<br>				}<br>				for (y = secondLength - 1; y &gt;= 0; y--) {<!-- --><br>					tempBt = dec(tempBt, (int[]) secondKeyBt.get(y));<br>				}<br>				for (z = firstLength - 1; z &gt;= 0; z--) {<!-- --><br>					tempBt = dec(tempBt, (int[]) firstKeyBt.get(z));<br>				}<br>				decByte = tempBt;<br>			} else {<!-- --><br>				if (firstKey != null &amp;&amp; firstKey != "" &amp;&amp; secondKey != null<br>						&amp;&amp; secondKey != "") {<!-- --><br>					int[] tempBt;<br>					int x, y, z;<br>					tempBt = intByte;<br>					for (x = secondLength - 1; x &gt;= 0; x--) {<!-- --><br>						tempBt = dec(tempBt, (int[]) secondKeyBt.get(x));<br>					}<br>					for (y = firstLength - 1; y &gt;= 0; y--) {<!-- --><br>						tempBt = dec(tempBt, (int[]) firstKeyBt.get(y));<br>					}<br>					decByte = tempBt;<br>				} else {<!-- --><br>					if (firstKey != null &amp;&amp; firstKey != "") {<!-- --><br>						int[] tempBt;<br>						int x, y, z;<br>						tempBt = intByte;<br>						for (x = firstLength - 1; x &gt;= 0; x--) {<!-- --><br>							tempBt = dec(tempBt, (int[]) firstKeyBt.get(x));<br>						}<br>						decByte = tempBt;<br>					}<br>				}<br>			}<br>			decStr += byteToString(decByte);<br>		}<br>		return decStr;<br>	}<br><br>	/*<br>	 * chang the string into the bit array<br>	 * <br>	 * return bit array(it's length % 64 = 0)<br>	 */<br>	public List getKeyBytes(String key) {<!-- --><br>		List keyBytes = new ArrayList();<br>		int leng = key.length();<br>		int iterator = (leng / 4);<br>		int remainder = leng % 4;<br>		int i = 0;<br>		for (i = 0; i &lt; iterator; i++) {<!-- --><br>			keyBytes.add(i, strToBt(key.substring(i * 4 + 0, i * 4 + 4)));<br>		}<br>		if (remainder &gt; 0) {<!-- --><br>			// keyBytes[i] = strToBt(key.substring(i*4+0,leng));<br>			keyBytes.add(i, strToBt(key.substring(i * 4 + 0, leng)));<br>		}<br>		return keyBytes;<br>	}<br><br>	/*<br>	 * chang the string(it's length &lt;= 4) into the bit array<br>	 * <br>	 * return bit array(it's length = 64)<br>	 */<br>	public int[] strToBt(String str) {<!-- --><br>		int leng = str.length();<br>		int[] bt = new int[64];<br>		if (leng &lt; 4) {<!-- --><br>			int i = 0, j = 0, p = 0, q = 0;<br>			for (i = 0; i &lt; leng; i++) {<!-- --><br>				int k = str.charAt(i);<br>				for (j = 0; j &lt; 16; j++) {<!-- --><br>					int pow = 1, m = 0;<br>					for (m = 15; m &gt; j; m--) {<!-- --><br>						pow *= 2;<br>					}<br>					// bt.set(16*i+j,""+(k/pow)%2));<br>					bt[16 * i + j] = (k / pow) % 2;<br>				}<br>			}<br>			for (p = leng; p &lt; 4; p++) {<!-- --><br>				int k = 0;<br>				for (q = 0; q &lt; 16; q++) {<!-- --><br>					int pow = 1, m = 0;<br>					for (m = 15; m &gt; q; m--) {<!-- --><br>						pow *= 2;<br>					}<br>					// bt[16*p+q]=parseInt(k/pow)%2;<br>					// bt.add(16*p+q,""+((k/pow)%2));<br>					bt[16 * p + q] = (k / pow) % 2;<br>				}<br>			}<br>		} else {<!-- --><br>			for (int i = 0; i &lt; 4; i++) {<!-- --><br>				int k = str.charAt(i);<br>				for (int j = 0; j &lt; 16; j++) {<!-- --><br>					int pow = 1;<br>					for (int m = 15; m &gt; j; m--) {<!-- --><br>						pow *= 2;<br>					}<br>					// bt[16*i+j]=parseInt(k/pow)%2;<br>					// bt.add(16*i+j,""+((k/pow)%2));<br>					bt[16 * i + j] = (k / pow) % 2;<br>				}<br>			}<br>		}<br>		return bt;<br>	}<br><br>	/*<br>	 * chang the bit(it's length = 4) into the hex<br>	 * <br>	 * return hex<br>	 */<br>	public String bt4ToHex(String binary) {<!-- --><br>		String hex = "";<br>		if (binary.equalsIgnoreCase("0000")) {<!-- --><br>			hex = "0";<br>		} else if (binary.equalsIgnoreCase("0001")) {<!-- --><br>			hex = "1";<br>		} else if (binary.equalsIgnoreCase("0010")) {<!-- --><br>			hex = "2";<br>		} else if (binary.equalsIgnoreCase("0011")) {<!-- --><br>			hex = "3";<br>		} else if (binary.equalsIgnoreCase("0100")) {<!-- --><br>			hex = "4";<br>		} else if (binary.equalsIgnoreCase("0101")) {<!-- --><br>			hex = "5";<br>		} else if (binary.equalsIgnoreCase("0110")) {<!-- --><br>			hex = "6";<br>		} else if (binary.equalsIgnoreCase("0111")) {<!-- --><br>			hex = "7";<br>		} else if (binary.equalsIgnoreCase("1000")) {<!-- --><br>			hex = "8";<br>		} else if (binary.equalsIgnoreCase("1001")) {<!-- --><br>			hex = "9";<br>		} else if (binary.equalsIgnoreCase("1010")) {<!-- --><br>			hex = "A";<br>		} else if (binary.equalsIgnoreCase("1011")) {<!-- --><br>			hex = "B";<br>		} else if (binary.equalsIgnoreCase("1100")) {<!-- --><br>			hex = "C";<br>		} else if (binary.equalsIgnoreCase("1101")) {<!-- --><br>			hex = "D";<br>		} else if (binary.equalsIgnoreCase("1110")) {<!-- --><br>			hex = "E";<br>		} else if (binary.equalsIgnoreCase("1111")) {<!-- --><br>			hex = "F";<br>		}<br><br>		return hex;<br>	}<br><br>	/*<br>	 * chang the hex into the bit(it's length = 4)<br>	 * <br>	 * return the bit(it's length = 4)<br>	 */<br>	public String hexToBt4(String hex) {<!-- --><br>		String binary = "";<br>		if (hex.equalsIgnoreCase("0")) {<!-- --><br>			binary = "0000";<br>		} else if (hex.equalsIgnoreCase("1")) {<!-- --><br>			binary = "0001";<br>		}<br>		if (hex.equalsIgnoreCase("2")) {<!-- --><br>			binary = "0010";<br>		}<br>		if (hex.equalsIgnoreCase("3")) {<!-- --><br>			binary = "0011";<br>		}<br>		if (hex.equalsIgnoreCase("4")) {<!-- --><br>			binary = "0100";<br>		}<br>		if (hex.equalsIgnoreCase("5")) {<!-- --><br>			binary = "0101";<br>		}<br>		if (hex.equalsIgnoreCase("6")) {<!-- --><br>			binary = "0110";<br>		}<br>		if (hex.equalsIgnoreCase("7")) {<!-- --><br>			binary = "0111";<br>		}<br>		if (hex.equalsIgnoreCase("8")) {<!-- --><br>			binary = "1000";<br>		}<br>		if (hex.equalsIgnoreCase("9")) {<!-- --><br>			binary = "1001";<br>		}<br>		if (hex.equalsIgnoreCase("A")) {<!-- --><br>			binary = "1010";<br>		}<br>		if (hex.equalsIgnoreCase("B")) {<!-- --><br>			binary = "1011";<br>		}<br>		if (hex.equalsIgnoreCase("C")) {<!-- --><br>			binary = "1100";<br>		}<br>		if (hex.equalsIgnoreCase("D")) {<!-- --><br>			binary = "1101";<br>		}<br>		if (hex.equalsIgnoreCase("E")) {<!-- --><br>			binary = "1110";<br>		}<br>		if (hex.equalsIgnoreCase("F")) {<!-- --><br>			binary = "1111";<br>		}<br>		return binary;<br>	}<br><br>	/*<br>	 * chang the bit(it's length = 64) into the string<br>	 * <br>	 * return string<br>	 */<br>	public String byteToString(int[] byteData) {<!-- --><br>		String str = "";<br>		for (int i = 0; i &lt; 4; i++) {<!-- --><br>			int count = 0;<br>			for (int j = 0; j &lt; 16; j++) {<!-- --><br>				int pow = 1;<br>				for (int m = 15; m &gt; j; m--) {<!-- --><br>					pow *= 2;<br>				}<br>				count += byteData[16 * i + j] * pow;<br>			}<br>			if (count != 0) {<!-- --><br>				str += "" + (char) (count);<br>			}<br>		}<br>		return str;<br>	}<br><br>	public String bt64ToHex(int[] byteData) {<!-- --><br>		String hex = "";<br>		for (int i = 0; i &lt; 16; i++) {<!-- --><br>			String bt = "";<br>			for (int j = 0; j &lt; 4; j++) {<!-- --><br>				bt += byteData[i * 4 + j];<br>			}<br>			hex += bt4ToHex(bt);<br>		}<br>		return hex;<br>	}<br><br>	public String hexToBt64(String hex) {<!-- --><br>		String binary = "";<br>		for (int i = 0; i &lt; 16; i++) {<!-- --><br>			binary += hexToBt4(hex.substring(i, i + 1));<br>		}<br>		return binary;<br>	}<br><br>	/*<br>	 * the 64 bit des core arithmetic<br>	 */<br><br>	public int[] enc(int[] dataByte, int[] keyByte) {<!-- --><br>		int[][] keys = generateKeys(keyByte);<br>		int[] ipByte = initPermute(dataByte);<br>		int[] ipLeft = new int[32];<br>		int[] ipRight = new int[32];<br>		int[] tempLeft = new int[32];<br>		int i = 0, j = 0, k = 0, m = 0, n = 0;<br>		for (k = 0; k &lt; 32; k++) {<!-- --><br>			ipLeft[k] = ipByte[k];<br>			ipRight[k] = ipByte[32 + k];<br>		}<br>		for (i = 0; i &lt; 16; i++) {<!-- --><br>			for (j = 0; j &lt; 32; j++) {<!-- --><br>				tempLeft[j] = ipLeft[j];<br>				ipLeft[j] = ipRight[j];<br>			}<br>			int[] key = new int[48];<br>			for (m = 0; m &lt; 48; m++) {<!-- --><br>				key[m] = keys[i][m];<br>			}<br>			int[] tempRight = xor(<br>					pPermute(sBoxPermute(xor(expandPermute(ipRight), key))),<br>					tempLeft);<br>			for (n = 0; n &lt; 32; n++) {<!-- --><br>				ipRight[n] = tempRight[n];<br>			}<br><br>		}<br><br>		int[] finalData = new int[64];<br>		for (i = 0; i &lt; 32; i++) {<!-- --><br>			finalData[i] = ipRight[i];<br>			finalData[32 + i] = ipLeft[i];<br>		}<br>		return finallyPermute(finalData);<br>	}<br><br>	public int[] dec(int[] dataByte, int[] keyByte) {<!-- --><br>		int[][] keys = generateKeys(keyByte);<br>		int[] ipByte = initPermute(dataByte);<br>		int[] ipLeft = new int[32];<br>		int[] ipRight = new int[32];<br>		int[] tempLeft = new int[32];<br>		int i = 0, j = 0, k = 0, m = 0, n = 0;<br>		for (k = 0; k &lt; 32; k++) {<!-- --><br>			ipLeft[k] = ipByte[k];<br>			ipRight[k] = ipByte[32 + k];<br>		}<br>		for (i = 15; i &gt;= 0; i--) {<!-- --><br>			for (j = 0; j &lt; 32; j++) {<!-- --><br>				tempLeft[j] = ipLeft[j];<br>				ipLeft[j] = ipRight[j];<br>			}<br>			int[] key = new int[48];<br>			for (m = 0; m &lt; 48; m++) {<!-- --><br>				key[m] = keys[i][m];<br>			}<br><br>			int[] tempRight = xor(<br>					pPermute(sBoxPermute(xor(expandPermute(ipRight), key))),<br>					tempLeft);<br>			for (n = 0; n &lt; 32; n++) {<!-- --><br>				ipRight[n] = tempRight[n];<br>			}<br>		}<br><br>		int[] finalData = new int[64];<br>		for (i = 0; i &lt; 32; i++) {<!-- --><br>			finalData[i] = ipRight[i];<br>			finalData[32 + i] = ipLeft[i];<br>		}<br>		return finallyPermute(finalData);<br>	}<br><br>	public int[] initPermute(int[] originalData) {<!-- --><br>		int[] ipByte = new int[64];<br>		int i = 0, m = 1, n = 0, j, k;<br>		for (i = 0, m = 1, n = 0; i &lt; 4; i++, m += 2, n += 2) {<!-- --><br>			for (j = 7, k = 0; j &gt;= 0; j--, k++) {<!-- --><br>				ipByte[i * 8 + k] = originalData[j * 8 + m];<br>				ipByte[i * 8 + k + 32] = originalData[j * 8 + n];<br>			}<br>		}<br>		return ipByte;<br>	}<br><br>	public int[] expandPermute(int[] rightData) {<!-- --><br>		int[] epByte = new int[48];<br>		int i, j;<br>		for (i = 0; i &lt; 8; i++) {<!-- --><br>			if (i == 0) {<!-- --><br>				epByte[i * 6 + 0] = rightData[31];<br>			} else {<!-- --><br>				epByte[i * 6 + 0] = rightData[i * 4 - 1];<br>			}<br>			epByte[i * 6 + 1] = rightData[i * 4 + 0];<br>			epByte[i * 6 + 2] = rightData[i * 4 + 1];<br>			epByte[i * 6 + 3] = rightData[i * 4 + 2];<br>			epByte[i * 6 + 4] = rightData[i * 4 + 3];<br>			if (i == 7) {<!-- --><br>				epByte[i * 6 + 5] = rightData[0];<br>			} else {<!-- --><br>				epByte[i * 6 + 5] = rightData[i * 4 + 4];<br>			}<br>		}<br>		return epByte;<br>	}<br><br>	public int[] xor(int[] byteOne, int[] byteTwo) {<!-- --><br>		// var xorByte = new Array(byteOne.length);<br>		// for(int i = 0;i &lt; byteOne.length; i ++){<!-- --><br>		// xorByte[i] = byteOne[i] ^ byteTwo[i];<br>		// }<br>		// return xorByte;<br>		int[] xorByte = new int[byteOne.length];<br>		for (int i = 0; i &lt; byteOne.length; i++) {<!-- --><br>			xorByte[i] = byteOne[i] ^ byteTwo[i];<br>		}<br>		return xorByte;<br>	}<br><br>	public int[] sBoxPermute(int[] expandByte) {<!-- --><br><br>		// var sBoxByte = new Array(32);<br>		int[] sBoxByte = new int[32];<br>		String binary = "";<br>		int[][] s1 = {<!-- --><br>				{ 14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7 },<br>				{ 0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8 },<br>				{ 4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0 },<br>				{ 15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 } };<br><br>		/* Table - s2 */<br>		int[][] s2 = {<!-- --><br>				{ 15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10 },<br>				{ 3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5 },<br>				{ 0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15 },<br>				{ 13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 } };<br><br>		/* Table - s3 */<br>		int[][] s3 = {<!-- --><br>				{ 10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8 },<br>				{ 13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1 },<br>				{ 13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7 },<br>				{ 1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 } };<br>		/* Table - s4 */<br>		int[][] s4 = {<!-- --><br>				{ 7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15 },<br>				{ 13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9 },<br>				{ 10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4 },<br>				{ 3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 } };<br><br>		/* Table - s5 */<br>		int[][] s5 = {<!-- --><br>				{ 2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9 },<br>				{ 14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6 },<br>				{ 4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14 },<br>				{ 11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 } };<br><br>		/* Table - s6 */<br>		int[][] s6 = {<!-- --><br>				{ 12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11 },<br>				{ 10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8 },<br>				{ 9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6 },<br>				{ 4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 } };<br><br>		/* Table - s7 */<br>		int[][] s7 = {<!-- --><br>				{ 4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1 },<br>				{ 13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6 },<br>				{ 1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2 },<br>				{ 6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12 } };<br><br>		/* Table - s8 */<br>		int[][] s8 = {<!-- --><br>				{ 13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7 },<br>				{ 1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2 },<br>				{ 7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8 },<br>				{ 2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11 } };<br><br>		for (int m = 0; m &lt; 8; m++) {<!-- --><br>			int i = 0, j = 0;<br>			i = expandByte[m * 6 + 0] * 2 + expandByte[m * 6 + 5];<br>			j = expandByte[m * 6 + 1] * 2 * 2 * 2 + expandByte[m * 6 + 2] * 2<br>					* 2 + expandByte[m * 6 + 3] * 2 + expandByte[m * 6 + 4];<br>			switch (m) {<!-- --><br>			case 0:<br>				binary = getBoxBinary(s1[i][j]);<br>				break;<br>			case 1:<br>				binary = getBoxBinary(s2[i][j]);<br>				break;<br>			case 2:<br>				binary = getBoxBinary(s3[i][j]);<br>				break;<br>			case 3:<br>				binary = getBoxBinary(s4[i][j]);<br>				break;<br>			case 4:<br>				binary = getBoxBinary(s5[i][j]);<br>				break;<br>			case 5:<br>				binary = getBoxBinary(s6[i][j]);<br>				break;<br>			case 6:<br>				binary = getBoxBinary(s7[i][j]);<br>				break;<br>			case 7:<br>				binary = getBoxBinary(s8[i][j]);<br>				break;<br>			}<br>			sBoxByte[m * 4 + 0] = Integer.parseInt(binary.substring(0, 1));<br>			sBoxByte[m * 4 + 1] = Integer.parseInt(binary.substring(1, 2));<br>			sBoxByte[m * 4 + 2] = Integer.parseInt(binary.substring(2, 3));<br>			sBoxByte[m * 4 + 3] = Integer.parseInt(binary.substring(3, 4));<br>		}<br>		return sBoxByte;<br>	}<br><br>	public int[] pPermute(int[] sBoxByte) {<!-- --><br>		int[] pBoxPermute = new int[32];<br>		pBoxPermute[0] = sBoxByte[15];<br>		pBoxPermute[1] = sBoxByte[6];<br>		pBoxPermute[2] = sBoxByte[19];<br>		pBoxPermute[3] = sBoxByte[20];<br>		pBoxPermute[4] = sBoxByte[28];<br>		pBoxPermute[5] = sBoxByte[11];<br>		pBoxPermute[6] = sBoxByte[27];<br>		pBoxPermute[7] = sBoxByte[16];<br>		pBoxPermute[8] = sBoxByte[0];<br>		pBoxPermute[9] = sBoxByte[14];<br>		pBoxPermute[10] = sBoxByte[22];<br>		pBoxPermute[11] = sBoxByte[25];<br>		pBoxPermute[12] = sBoxByte[4];<br>		pBoxPermute[13] = sBoxByte[17];<br>		pBoxPermute[14] = sBoxByte[30];<br>		pBoxPermute[15] = sBoxByte[9];<br>		pBoxPermute[16] = sBoxByte[1];<br>		pBoxPermute[17] = sBoxByte[7];<br>		pBoxPermute[18] = sBoxByte[23];<br>		pBoxPermute[19] = sBoxByte[13];<br>		pBoxPermute[20] = sBoxByte[31];<br>		pBoxPermute[21] = sBoxByte[26];<br>		pBoxPermute[22] = sBoxByte[2];<br>		pBoxPermute[23] = sBoxByte[8];<br>		pBoxPermute[24] = sBoxByte[18];<br>		pBoxPermute[25] = sBoxByte[12];<br>		pBoxPermute[26] = sBoxByte[29];<br>		pBoxPermute[27] = sBoxByte[5];<br>		pBoxPermute[28] = sBoxByte[21];<br>		pBoxPermute[29] = sBoxByte[10];<br>		pBoxPermute[30] = sBoxByte[3];<br>		pBoxPermute[31] = sBoxByte[24];<br>		return pBoxPermute;<br>	}<br><br>	public int[] finallyPermute(int[] endByte) {<!-- --><br>		int[] fpByte = new int[64];<br>		fpByte[0] = endByte[39];<br>		fpByte[1] = endByte[7];<br>		fpByte[2] = endByte[47];<br>		fpByte[3] = endByte[15];<br>		fpByte[4] = endByte[55];<br>		fpByte[5] = endByte[23];<br>		fpByte[6] = endByte[63];<br>		fpByte[7] = endByte[31];<br>		fpByte[8] = endByte[38];<br>		fpByte[9] = endByte[6];<br>		fpByte[10] = endByte[46];<br>		fpByte[11] = endByte[14];<br>		fpByte[12] = endByte[54];<br>		fpByte[13] = endByte[22];<br>		fpByte[14] = endByte[62];<br>		fpByte[15] = endByte[30];<br>		fpByte[16] = endByte[37];<br>		fpByte[17] = endByte[5];<br>		fpByte[18] = endByte[45];<br>		fpByte[19] = endByte[13];<br>		fpByte[20] = endByte[53];<br>		fpByte[21] = endByte[21];<br>		fpByte[22] = endByte[61];<br>		fpByte[23] = endByte[29];<br>		fpByte[24] = endByte[36];<br>		fpByte[25] = endByte[4];<br>		fpByte[26] = endByte[44];<br>		fpByte[27] = endByte[12];<br>		fpByte[28] = endByte[52];<br>		fpByte[29] = endByte[20];<br>		fpByte[30] = endByte[60];<br>		fpByte[31] = endByte[28];<br>		fpByte[32] = endByte[35];<br>		fpByte[33] = endByte[3];<br>		fpByte[34] = endByte[43];<br>		fpByte[35] = endByte[11];<br>		fpByte[36] = endByte[51];<br>		fpByte[37] = endByte[19];<br>		fpByte[38] = endByte[59];<br>		fpByte[39] = endByte[27];<br>		fpByte[40] = endByte[34];<br>		fpByte[41] = endByte[2];<br>		fpByte[42] = endByte[42];<br>		fpByte[43] = endByte[10];<br>		fpByte[44] = endByte[50];<br>		fpByte[45] = endByte[18];<br>		fpByte[46] = endByte[58];<br>		fpByte[47] = endByte[26];<br>		fpByte[48] = endByte[33];<br>		fpByte[49] = endByte[1];<br>		fpByte[50] = endByte[41];<br>		fpByte[51] = endByte[9];<br>		fpByte[52] = endByte[49];<br>		fpByte[53] = endByte[17];<br>		fpByte[54] = endByte[57];<br>		fpByte[55] = endByte[25];<br>		fpByte[56] = endByte[32];<br>		fpByte[57] = endByte[0];<br>		fpByte[58] = endByte[40];<br>		fpByte[59] = endByte[8];<br>		fpByte[60] = endByte[48];<br>		fpByte[61] = endByte[16];<br>		fpByte[62] = endByte[56];<br>		fpByte[63] = endByte[24];<br>		return fpByte;<br>	}<br><br>	public String getBoxBinary(int i) {<!-- --><br>		String binary = "";<br>		switch (i) {<!-- --><br>		case 0:<br>			binary = "0000";<br>			break;<br>		case 1:<br>			binary = "0001";<br>			break;<br>		case 2:<br>			binary = "0010";<br>			break;<br>		case 3:<br>			binary = "0011";<br>			break;<br>		case 4:<br>			binary = "0100";<br>			break;<br>		case 5:<br>			binary = "0101";<br>			break;<br>		case 6:<br>			binary = "0110";<br>			break;<br>		case 7:<br>			binary = "0111";<br>			break;<br>		case 8:<br>			binary = "1000";<br>			break;<br>		case 9:<br>			binary = "1001";<br>			break;<br>		case 10:<br>			binary = "1010";<br>			break;<br>		case 11:<br>			binary = "1011";<br>			break;<br>		case 12:<br>			binary = "1100";<br>			break;<br>		case 13:<br>			binary = "1101";<br>			break;<br>		case 14:<br>			binary = "1110";<br>			break;<br>		case 15:<br>			binary = "1111";<br>			break;<br>		}<br>		return binary;<br>	}<br><br>	/*<br>	 * generate 16 keys for xor<br>	 */<br>	public int[][] generateKeys(int[] keyByte) {<!-- --><br>		int[] key = new int[56];<br>		int[][] keys = new int[16][48];<br><br>		// keys[ 0] = new Array();<br>		// keys[ 1] = new Array();<br>		// keys[ 2] = new Array();<br>		// keys[ 3] = new Array();<br>		// keys[ 4] = new Array();<br>		// keys[ 5] = new Array();<br>		// keys[ 6] = new Array();<br>		// keys[ 7] = new Array();<br>		// keys[ 8] = new Array();<br>		// keys[ 9] = new Array();<br>		// keys[10] = new Array();<br>		// keys[11] = new Array();<br>		// keys[12] = new Array();<br>		// keys[13] = new Array();<br>		// keys[14] = new Array();<br>		// keys[15] = new Array();<br>		int[] loop = new int[] { 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1 };<br><br>		for (int i = 0; i &lt; 7; i++) {<!-- --><br>			for (int j = 0, k = 7; j &lt; 8; j++, k--) {<!-- --><br>				key[i * 8 + j] = keyByte[8 * k + i];<br>			}<br>		}<br><br>		int i = 0;<br>		for (i = 0; i &lt; 16; i++) {<!-- --><br>			int tempLeft = 0;<br>			int tempRight = 0;<br>			for (int j = 0; j &lt; loop[i]; j++) {<!-- --><br>				tempLeft = key[0];<br>				tempRight = key[28];<br>				for (int k = 0; k &lt; 27; k++) {<!-- --><br>					key[k] = key[k + 1];<br>					key[28 + k] = key[29 + k];<br>				}<br>				key[27] = tempLeft;<br>				key[55] = tempRight;<br>			}<br>			// var tempKey = new Array(48);<br>			int[] tempKey = new int[48];<br>			tempKey[0] = key[13];<br>			tempKey[1] = key[16];<br>			tempKey[2] = key[10];<br>			tempKey[3] = key[23];<br>			tempKey[4] = key[0];<br>			tempKey[5] = key[4];<br>			tempKey[6] = key[2];<br>			tempKey[7] = key[27];<br>			tempKey[8] = key[14];<br>			tempKey[9] = key[5];<br>			tempKey[10] = key[20];<br>			tempKey[11] = key[9];<br>			tempKey[12] = key[22];<br>			tempKey[13] = key[18];<br>			tempKey[14] = key[11];<br>			tempKey[15] = key[3];<br>			tempKey[16] = key[25];<br>			tempKey[17] = key[7];<br>			tempKey[18] = key[15];<br>			tempKey[19] = key[6];<br>			tempKey[20] = key[26];<br>			tempKey[21] = key[19];<br>			tempKey[22] = key[12];<br>			tempKey[23] = key[1];<br>			tempKey[24] = key[40];<br>			tempKey[25] = key[51];<br>			tempKey[26] = key[30];<br>			tempKey[27] = key[36];<br>			tempKey[28] = key[46];<br>			tempKey[29] = key[54];<br>			tempKey[30] = key[29];<br>			tempKey[31] = key[39];<br>			tempKey[32] = key[50];<br>			tempKey[33] = key[44];<br>			tempKey[34] = key[32];<br>			tempKey[35] = key[47];<br>			tempKey[36] = key[43];<br>			tempKey[37] = key[48];<br>			tempKey[38] = key[38];<br>			tempKey[39] = key[55];<br>			tempKey[40] = key[33];<br>			tempKey[41] = key[52];<br>			tempKey[42] = key[45];<br>			tempKey[43] = key[41];<br>			tempKey[44] = key[49];<br>			tempKey[45] = key[35];<br>			tempKey[46] = key[28];<br>			tempKey[47] = key[31];<br>			int m;<br>			switch (i) {<!-- --><br>			case 0:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[0][m] = tempKey[m];<br>				}<br>				break;<br>			case 1:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[1][m] = tempKey[m];<br>				}<br>				break;<br>			case 2:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[2][m] = tempKey[m];<br>				}<br>				break;<br>			case 3:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[3][m] = tempKey[m];<br>				}<br>				break;<br>			case 4:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[4][m] = tempKey[m];<br>				}<br>				break;<br>			case 5:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[5][m] = tempKey[m];<br>				}<br>				break;<br>			case 6:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[6][m] = tempKey[m];<br>				}<br>				break;<br>			case 7:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[7][m] = tempKey[m];<br>				}<br>				break;<br>			case 8:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[8][m] = tempKey[m];<br>				}<br>				break;<br>			case 9:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[9][m] = tempKey[m];<br>				}<br>				break;<br>			case 10:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[10][m] = tempKey[m];<br>				}<br>				break;<br>			case 11:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[11][m] = tempKey[m];<br>				}<br>				break;<br>			case 12:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[12][m] = tempKey[m];<br>				}<br>				break;<br>			case 13:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[13][m] = tempKey[m];<br>				}<br>				break;<br>			case 14:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[14][m] = tempKey[m];<br>				}<br>				break;<br>			case 15:<br>				for (m = 0; m &lt; 48; m++) {<!-- --><br>					keys[15][m] = tempKey[m];<br>				}<br>				break;<br>			}<br>		}<br>		return keys;<br>	}<br><br>	public static void main(String[] args) {<!-- --><br>		Des desObj = new Des();<br>		String key1 = "itmp";//des1(orginPass, "itmp", "des", "encrypt");<br>		String key2 = "des";<br>		String key3 = "encrypt";<br>		String data = "1";<br>		String str = desObj.strEnc(data, key1, key2, key3);<br>		System.out.println(str);<br>		String dec = desObj.strDec(str, key1, key2, key3);<br>		System.out.println(dec);<br>	}<br>}<br></code></pre> 
<br> 
<br>前台des.js加解密代码如下 
<br> 
<pre><code class="language-java"><br>/**<br>* DES加密解密<br>* @Copyright Copyright (c) 2006<br>* @author Guapo<br>* @see DESCore<br>*/<br><br>/*<br>* encrypt the string to string made up of hex<br>* return the encrypted string<br>*/<br>function strEnc(data,firstKey,secondKey,thirdKey){<!-- --><br><br> var leng = data.length;<br> var encData = "";<br> var firstKeyBt,secondKeyBt,thirdKeyBt,firstLength,secondLength,thirdLength;<br> if(firstKey != null &amp;&amp; firstKey != ""){    <br>   firstKeyBt = getKeyBytes(firstKey);<br>   firstLength = firstKeyBt.length;<br> }<br> if(secondKey != null &amp;&amp; secondKey != ""){<!-- --><br>   secondKeyBt = getKeyBytes(secondKey);<br>   secondLength = secondKeyBt.length;<br> }<br> if(thirdKey != null &amp;&amp; thirdKey != ""){<!-- --><br>   thirdKeyBt = getKeyBytes(thirdKey);<br>   thirdLength = thirdKeyBt.length;<br> }  <br><br> if(leng &gt; 0){<!-- --><br>   if(leng &lt; 4){<!-- --><br>     var bt = strToBt(data);      <br>     var encByte ;<br>     if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != "" &amp;&amp; thirdKey != null &amp;&amp; thirdKey != ""){<!-- --><br>       var tempBt;<br>       var x,y,z;<br>       tempBt = bt;        <br>       for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>         tempBt = enc(tempBt,firstKeyBt[x]);<br>       }<br>       for(y = 0;y &lt; secondLength ;y ++){<!-- --><br>         tempBt = enc(tempBt,secondKeyBt[y]);<br>       }<br>       for(z = 0;z &lt; thirdLength ;z ++){<!-- --><br>         tempBt = enc(tempBt,thirdKeyBt[z]);<br>       }        <br>       encByte = tempBt;        <br>     }else{<!-- --><br>       if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != ""){<!-- --><br>         var tempBt;<br>         var x,y;<br>         tempBt = bt;<br>         for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>           tempBt = enc(tempBt,firstKeyBt[x]);<br>         }<br>         for(y = 0;y &lt; secondLength ;y ++){<!-- --><br>           tempBt = enc(tempBt,secondKeyBt[y]);<br>         }<br>         encByte = tempBt;<br>       }else{<!-- --><br>         if(firstKey != null &amp;&amp; firstKey !=""){            <br>           var tempBt;<br>           var x = 0;<br>           tempBt = bt;            <br>           for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>             tempBt = enc(tempBt,firstKeyBt[x]);<br>           }<br>           encByte = tempBt;<br>         }<br>       }        <br>     }<br>     encData = bt64ToHex(encByte);<br>   }else{<!-- --><br>     var iterator = parseInt(leng/4);<br>     var remainder = leng%4;<br>     var i=0;      <br>     for(i = 0;i &lt; iterator;i++){<!-- --><br>       var tempData = data.substring(i*4+0,i*4+4);<br>       var tempByte = strToBt(tempData);<br>       var encByte ;<br>       if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != "" &amp;&amp; thirdKey != null &amp;&amp; thirdKey != ""){<!-- --><br>         var tempBt;<br>         var x,y,z;<br>         tempBt = tempByte;<br>         for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>           tempBt = enc(tempBt,firstKeyBt[x]);<br>         }<br>         for(y = 0;y &lt; secondLength ;y ++){<!-- --><br>           tempBt = enc(tempBt,secondKeyBt[y]);<br>         }<br>         for(z = 0;z &lt; thirdLength ;z ++){<!-- --><br>           tempBt = enc(tempBt,thirdKeyBt[z]);<br>         }<br>         encByte = tempBt;<br>       }else{<!-- --><br>         if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != ""){<!-- --><br>           var tempBt;<br>           var x,y;<br>           tempBt = tempByte;<br>           for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>             tempBt = enc(tempBt,firstKeyBt[x]);<br>           }<br>           for(y = 0;y &lt; secondLength ;y ++){<!-- --><br>             tempBt = enc(tempBt,secondKeyBt[y]);<br>           }<br>           encByte = tempBt;<br>         }else{<!-- --><br>           if(firstKey != null &amp;&amp; firstKey !=""){                      <br>             var tempBt;<br>             var x;<br>             tempBt = tempByte;<br>             for(x = 0;x &lt; firstLength ;x ++){                <br>               tempBt = enc(tempBt,firstKeyBt[x]);<br>             }<br>             encByte = tempBt;              <br>           }<br>         }<br>       }<br>       encData += bt64ToHex(encByte);<br>     }      <br>     if(remainder &gt; 0){<!-- --><br>       var remainderData = data.substring(iterator*4+0,leng);<br>       var tempByte = strToBt(remainderData);<br>       var encByte ;<br>       if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != "" &amp;&amp; thirdKey != null &amp;&amp; thirdKey != ""){<!-- --><br>         var tempBt;<br>         var x,y,z;<br>         tempBt = tempByte;<br>         for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>           tempBt = enc(tempBt,firstKeyBt[x]);<br>         }<br>         for(y = 0;y &lt; secondLength ;y ++){<!-- --><br>           tempBt = enc(tempBt,secondKeyBt[y]);<br>         }<br>         for(z = 0;z &lt; thirdLength ;z ++){<!-- --><br>           tempBt = enc(tempBt,thirdKeyBt[z]);<br>         }<br>         encByte = tempBt;<br>       }else{<!-- --><br>         if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != ""){<!-- --><br>           var tempBt;<br>           var x,y;<br>           tempBt = tempByte;<br>           for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>             tempBt = enc(tempBt,firstKeyBt[x]);<br>           }<br>           for(y = 0;y &lt; secondLength ;y ++){<!-- --><br>             tempBt = enc(tempBt,secondKeyBt[y]);<br>           }<br>           encByte = tempBt;<br>         }else{<!-- --><br>           if(firstKey != null &amp;&amp; firstKey !=""){            <br>             var tempBt;<br>             var x;<br>             tempBt = tempByte;<br>             for(x = 0;x &lt; firstLength ;x ++){<!-- --><br>               tempBt = enc(tempBt,firstKeyBt[x]);<br>             }<br>             encByte = tempBt;<br>           }<br>         }<br>       }<br>       encData += bt64ToHex(encByte);<br>     }                <br>   }<br> }<br> return encData;<br>}<br><br>/*<br>* decrypt the encrypted string to the original string <br>*<br>* return  the original string  <br>*/<br>function strDec(data,firstKey,secondKey,thirdKey){<!-- --><br> var leng = data.length;<br> var decStr = "";<br> var firstKeyBt,secondKeyBt,thirdKeyBt,firstLength,secondLength,thirdLength;<br> if(firstKey != null &amp;&amp; firstKey != ""){    <br>   firstKeyBt = getKeyBytes(firstKey);<br>   firstLength = firstKeyBt.length;<br> }<br> if(secondKey != null &amp;&amp; secondKey != ""){<!-- --><br>   secondKeyBt = getKeyBytes(secondKey);<br>   secondLength = secondKeyBt.length;<br> }<br> if(thirdKey != null &amp;&amp; thirdKey != ""){<!-- --><br>   thirdKeyBt = getKeyBytes(thirdKey);<br>   thirdLength = thirdKeyBt.length;<br> }<br><br> var iterator = parseInt(leng/16);<br> var i=0;  <br> for(i = 0;i &lt; iterator;i++){<!-- --><br>   var tempData = data.substring(i*16+0,i*16+16);    <br>   var strByte = hexToBt64(tempData);    <br>   var intByte = new Array(64);<br>   var j = 0;<br>   for(j = 0;j &lt; 64; j++){<!-- --><br>     intByte[j] = parseInt(strByte.substring(j,j+1));<br>   }    <br>   var decByte;<br>   if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != "" &amp;&amp; thirdKey != null &amp;&amp; thirdKey != ""){<!-- --><br>     var tempBt;<br>     var x,y,z;<br>     tempBt = intByte;<br>     for(x = thirdLength - 1;x &gt;= 0;x --){<!-- --><br>       tempBt = dec(tempBt,thirdKeyBt[x]);<br>     }<br>     for(y = secondLength - 1;y &gt;= 0;y --){<!-- --><br>       tempBt = dec(tempBt,secondKeyBt[y]);<br>     }<br>     for(z = firstLength - 1;z &gt;= 0 ;z --){<!-- --><br>       tempBt = dec(tempBt,firstKeyBt[z]);<br>     }<br>     decByte = tempBt;<br>   }else{<!-- --><br>     if(firstKey != null &amp;&amp; firstKey !="" &amp;&amp; secondKey != null &amp;&amp; secondKey != ""){<!-- --><br>       var tempBt;<br>       var x,y,z;<br>       tempBt = intByte;<br>       for(x = secondLength - 1;x &gt;= 0 ;x --){<!-- --><br>         tempBt = dec(tempBt,secondKeyBt[x]);<br>       }<br>       for(y = firstLength - 1;y &gt;= 0 ;y --){<!-- --><br>         tempBt = dec(tempBt,firstKeyBt[y]);<br>       }<br>       decByte = tempBt;<br>     }else{<!-- --><br>       if(firstKey != null &amp;&amp; firstKey !=""){<!-- --><br>         var tempBt;<br>         var x,y,z;<br>         tempBt = intByte;<br>         for(x = firstLength - 1;x &gt;= 0 ;x --){<!-- --><br>           tempBt = dec(tempBt,firstKeyBt[x]);<br>         }<br>         decByte = tempBt;<br>       }<br>     }<br>   }<br>   decStr += byteToString(decByte);<br> }      <br> return decStr;<br>}<br>/*<br>* chang the string into the bit array<br>* <br>* return bit array(it's length % 64 = 0)<br>*/<br>function getKeyBytes(key){<!-- --><br> var keyBytes = new Array();<br> var leng = key.length;<br> var iterator = parseInt(leng/4);<br> var remainder = leng%4;<br> var i = 0;<br> for(i = 0;i &lt; iterator; i ++){<!-- --><br>   keyBytes[i] = strToBt(key.substring(i*4+0,i*4+4));<br> }<br> if(remainder &gt; 0){<!-- --><br>   keyBytes[i] = strToBt(key.substring(i*4+0,leng));<br> }    <br> return keyBytes;<br>}<br><br>/*<br>* chang the string(it's length &lt;= 4) into the bit array<br>* <br>* return bit array(it's length = 64)<br>*/<br>function strToBt(str){  <br> var leng = str.length;<br> var bt = new Array(64);<br> if(leng &lt; 4){<!-- --><br>   var i=0,j=0,p=0,q=0;<br>   for(i = 0;i&lt;leng;i++){<!-- --><br>     var k = str.charCodeAt(i);<br>     for(j=0;j&lt;16;j++){      <br>       var pow=1,m=0;<br>       for(m=15;m&gt;j;m--){<!-- --><br>         pow *= 2;<br>       }        <br>       bt[16*i+j]=parseInt(k/pow)%2;<br>     }<br>   }<br>   for(p = leng;p&lt;4;p++){<!-- --><br>     var k = 0;<br>     for(q=0;q&lt;16;q++){      <br>       var pow=1,m=0;<br>       for(m=15;m&gt;q;m--){<!-- --><br>         pow *= 2;<br>       }        <br>       bt[16*p+q]=parseInt(k/pow)%2;<br>     }<br>   }  <br> }else{<!-- --><br>   for(i = 0;i&lt;4;i++){<!-- --><br>     var k = str.charCodeAt(i);<br>     for(j=0;j&lt;16;j++){      <br>       var pow=1;<br>       for(m=15;m&gt;j;m--){<!-- --><br>         pow *= 2;<br>       }        <br>       bt[16*i+j]=parseInt(k/pow)%2;<br>     }<br>   }  <br> }<br> return bt;<br>}<br><br>/*<br>* chang the bit(it's length = 4) into the hex<br>* <br>* return hex<br>*/<br>function bt4ToHex(binary) {<!-- --><br> var hex;<br> switch (binary) {<!-- --><br>   case "0000" : hex = "0"; break;<br>   case "0001" : hex = "1"; break;<br>   case "0010" : hex = "2"; break;<br>   case "0011" : hex = "3"; break;<br>   case "0100" : hex = "4"; break;<br>   case "0101" : hex = "5"; break;<br>   case "0110" : hex = "6"; break;<br>   case "0111" : hex = "7"; break;<br>   case "1000" : hex = "8"; break;<br>   case "1001" : hex = "9"; break;<br>   case "1010" : hex = "A"; break;<br>   case "1011" : hex = "B"; break;<br>   case "1100" : hex = "C"; break;<br>   case "1101" : hex = "D"; break;<br>   case "1110" : hex = "E"; break;<br>   case "1111" : hex = "F"; break;<br> }<br> return hex;<br>}<br><br>/*<br>* chang the hex into the bit(it's length = 4)<br>* <br>* return the bit(it's length = 4)<br>*/<br>function hexToBt4(hex) {<!-- --><br> var binary;<br> switch (hex) {<!-- --><br>   case "0" : binary = "0000"; break;<br>   case "1" : binary = "0001"; break;<br>   case "2" : binary = "0010"; break;<br>   case "3" : binary = "0011"; break;<br>   case "4" : binary = "0100"; break;<br>   case "5" : binary = "0101"; break;<br>   case "6" : binary = "0110"; break;<br>   case "7" : binary = "0111"; break;<br>   case "8" : binary = "1000"; break;<br>   case "9" : binary = "1001"; break;<br>   case "A" : binary = "1010"; break;<br>   case "B" : binary = "1011"; break;<br>   case "C" : binary = "1100"; break;<br>   case "D" : binary = "1101"; break;<br>   case "E" : binary = "1110"; break;<br>   case "F" : binary = "1111"; break;<br> }<br> return binary;<br>}<br><br>/*<br>* chang the bit(it's length = 64) into the string<br>* <br>* return string<br>*/<br>function byteToString(byteData){<!-- --><br> var str="";<br> for(i = 0;i&lt;4;i++){<!-- --><br>   var count=0;<br>   for(j=0;j&lt;16;j++){        <br>     var pow=1;<br>     for(m=15;m&gt;j;m--){<!-- --><br>       pow*=2;<br>     }              <br>     count+=byteData[16*i+j]*pow;<br>   }        <br>   if(count != 0){<!-- --><br>     str+=String.fromCharCode(count);<br>   }<br> }<br> return str;<br>}<br><br>function bt64ToHex(byteData){<!-- --><br> var hex = "";<br> for(i = 0;i&lt;16;i++){<!-- --><br>   var bt = "";<br>   for(j=0;j&lt;4;j++){    <br>     bt += byteData[i*4+j];<br>   }    <br>   hex+=bt4ToHex(bt);<br> }<br> return hex;<br>}<br><br>function hexToBt64(hex){<!-- --><br> var binary = "";<br> for(i = 0;i&lt;16;i++){<!-- --><br>   binary+=hexToBt4(hex.substring(i,i+1));<br> }<br> return binary;<br>}<br><br>/*<br>* the 64 bit des core arithmetic<br>*/<br><br>function enc(dataByte,keyByte){  <br> var keys = generateKeys(keyByte);    <br> var ipByte   = initPermute(dataByte);  <br> var ipLeft   = new Array(32);<br> var ipRight  = new Array(32);<br> var tempLeft = new Array(32);<br> var i = 0,j = 0,k = 0,m = 0, n = 0;<br> for(k = 0;k &lt; 32;k ++){<!-- --><br>   ipLeft[k] = ipByte[k];<br>   ipRight[k] = ipByte[32+k];<br> }    <br> for(i = 0;i &lt; 16;i ++){<!-- --><br>   for(j = 0;j &lt; 32;j ++){<!-- --><br>     tempLeft[j] = ipLeft[j];<br>     ipLeft[j] = ipRight[j];      <br>   }  <br>   var key = new Array(48);<br>   for(m = 0;m &lt; 48;m ++){<!-- --><br>     key[m] = keys[i][m];<br>   }<br>   var  tempRight = xor(pPermute(sBoxPermute(xor(expandPermute(ipRight),key))), tempLeft);      <br>   for(n = 0;n &lt; 32;n ++){<!-- --><br>     ipRight[n] = tempRight[n];<br>   }  <br><br> }  <br><br><br> var finalData =new Array(64);<br> for(i = 0;i &lt; 32;i ++){<!-- --><br>   finalData[i] = ipRight[i];<br>   finalData[32+i] = ipLeft[i];<br> }<br> return finallyPermute(finalData);  <br>}<br><br>function dec(dataByte,keyByte){  <br> var keys = generateKeys(keyByte);    <br> var ipByte   = initPermute(dataByte);  <br> var ipLeft   = new Array(32);<br> var ipRight  = new Array(32);<br> var tempLeft = new Array(32);<br> var i = 0,j = 0,k = 0,m = 0, n = 0;<br> for(k = 0;k &lt; 32;k ++){<!-- --><br>   ipLeft[k] = ipByte[k];<br>   ipRight[k] = ipByte[32+k];<br> }  <br> for(i = 15;i &gt;= 0;i --){<!-- --><br>   for(j = 0;j &lt; 32;j ++){<!-- --><br>     tempLeft[j] = ipLeft[j];<br>     ipLeft[j] = ipRight[j];      <br>   }  <br>   var key = new Array(48);<br>   for(m = 0;m &lt; 48;m ++){<!-- --><br>     key[m] = keys[i][m];<br>   }<br><br>   var  tempRight = xor(pPermute(sBoxPermute(xor(expandPermute(ipRight),key))), tempLeft);      <br>   for(n = 0;n &lt; 32;n ++){<!-- --><br>     ipRight[n] = tempRight[n];<br>   }  <br> }  <br><br><br> var finalData =new Array(64);<br> for(i = 0;i &lt; 32;i ++){<!-- --><br>   finalData[i] = ipRight[i];<br>   finalData[32+i] = ipLeft[i];<br> }<br> return finallyPermute(finalData);  <br>}<br><br>function initPermute(originalData){<!-- --><br> var ipByte = new Array(64);<br> for (i = 0, m = 1, n = 0; i &lt; 4; i++, m += 2, n += 2) {<!-- --><br>   for (j = 7, k = 0; j &gt;= 0; j--, k++) {<!-- --><br>     ipByte[i * 8 + k] = originalData[j * 8 + m];<br>     ipByte[i * 8 + k + 32] = originalData[j * 8 + n];<br>   }<br> }    <br> return ipByte;<br>}<br><br>function expandPermute(rightData){  <br> var epByte = new Array(48);<br> for (i = 0; i &lt; 8; i++) {<!-- --><br>   if (i == 0) {<!-- --><br>     epByte[i * 6 + 0] = rightData[31];<br>   } else {<!-- --><br>     epByte[i * 6 + 0] = rightData[i * 4 - 1];<br>   }<br>   epByte[i * 6 + 1] = rightData[i * 4 + 0];<br>   epByte[i * 6 + 2] = rightData[i * 4 + 1];<br>   epByte[i * 6 + 3] = rightData[i * 4 + 2];<br>   epByte[i * 6 + 4] = rightData[i * 4 + 3];<br>   if (i == 7) {<!-- --><br>     epByte[i * 6 + 5] = rightData[0];<br>   } else {<!-- --><br>     epByte[i * 6 + 5] = rightData[i * 4 + 4];<br>   }<br> }      <br> return epByte;<br>}<br><br>function xor(byteOne,byteTwo){  <br> var xorByte = new Array(byteOne.length);<br> for(i = 0;i &lt; byteOne.length; i ++){      <br>   xorByte[i] = byteOne[i] ^ byteTwo[i];<br> }  <br> return xorByte;<br>}<br><br>function sBoxPermute(expandByte){<!-- --><br><br>   var sBoxByte = new Array(32);<br>   var binary = "";<br>   var s1 = [<br>       [14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],<br>       [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],<br>       [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],<br>       [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 ]];<br><br>       /* Table - s2 */<br>   var s2 = [<br>       [15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],<br>       [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],<br>       [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],<br>       [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 ]];<br><br>       /* Table - s3 */<br>   var s3= [<br>       [10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],<br>       [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],<br>       [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],<br>       [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 ]];<br>       /* Table - s4 */<br>   var s4 = [<br>       [7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],<br>       [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],<br>       [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],<br>       [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 ]];<br><br>       /* Table - s5 */<br>   var s5 = [<br>       [2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],<br>       [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],<br>       [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],<br>       [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 ]];<br><br>       /* Table - s6 */<br>   var s6 = [<br>       [12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],<br>       [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],<br>       [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],<br>       [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 ]];<br><br>       /* Table - s7 */<br>   var s7 = [<br>       [4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],<br>       [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],<br>       [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],<br>       [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]];<br><br>       /* Table - s8 */<br>   var s8 = [<br>       [13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],<br>       [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],<br>       [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],<br>       [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]];<br><br>   for(m=0;m&lt;8;m++){<!-- --><br>   var i=0,j=0;<br>   i = expandByte[m*6+0]*2+expandByte[m*6+5];<br>   j = expandByte[m * 6 + 1] * 2 * 2 * 2 <br>     + expandByte[m * 6 + 2] * 2* 2 <br>     + expandByte[m * 6 + 3] * 2 <br>     + expandByte[m * 6 + 4];<br>   switch (m) {<!-- --><br>     case 0 :<br>       binary = getBoxBinary(s1[i][j]);<br>       break;<br>     case 1 :<br>       binary = getBoxBinary(s2[i][j]);<br>       break;<br>     case 2 :<br>       binary = getBoxBinary(s3[i][j]);<br>       break;<br>     case 3 :<br>       binary = getBoxBinary(s4[i][j]);<br>       break;<br>     case 4 :<br>       binary = getBoxBinary(s5[i][j]);<br>       break;<br>     case 5 :<br>       binary = getBoxBinary(s6[i][j]);<br>       break;<br>     case 6 :<br>       binary = getBoxBinary(s7[i][j]);<br>       break;<br>     case 7 :<br>       binary = getBoxBinary(s8[i][j]);<br>       break;<br>   }      <br>   sBoxByte[m*4+0] = parseInt(binary.substring(0,1));<br>   sBoxByte[m*4+1] = parseInt(binary.substring(1,2));<br>   sBoxByte[m*4+2] = parseInt(binary.substring(2,3));<br>   sBoxByte[m*4+3] = parseInt(binary.substring(3,4));<br> }<br> return sBoxByte;<br>}<br><br>function pPermute(sBoxByte){<!-- --><br> var pBoxPermute = new Array(32);<br> pBoxPermute[ 0] = sBoxByte[15]; <br> pBoxPermute[ 1] = sBoxByte[ 6]; <br> pBoxPermute[ 2] = sBoxByte[19]; <br> pBoxPermute[ 3] = sBoxByte[20]; <br> pBoxPermute[ 4] = sBoxByte[28]; <br> pBoxPermute[ 5] = sBoxByte[11]; <br> pBoxPermute[ 6] = sBoxByte[27]; <br> pBoxPermute[ 7] = sBoxByte[16]; <br> pBoxPermute[ 8] = sBoxByte[ 0]; <br> pBoxPermute[ 9] = sBoxByte[14]; <br> pBoxPermute[10] = sBoxByte[22]; <br> pBoxPermute[11] = sBoxByte[25]; <br> pBoxPermute[12] = sBoxByte[ 4]; <br> pBoxPermute[13] = sBoxByte[17]; <br> pBoxPermute[14] = sBoxByte[30]; <br> pBoxPermute[15] = sBoxByte[ 9]; <br> pBoxPermute[16] = sBoxByte[ 1]; <br> pBoxPermute[17] = sBoxByte[ 7]; <br> pBoxPermute[18] = sBoxByte[23]; <br> pBoxPermute[19] = sBoxByte[13]; <br> pBoxPermute[20] = sBoxByte[31]; <br> pBoxPermute[21] = sBoxByte[26]; <br> pBoxPermute[22] = sBoxByte[ 2]; <br> pBoxPermute[23] = sBoxByte[ 8]; <br> pBoxPermute[24] = sBoxByte[18]; <br> pBoxPermute[25] = sBoxByte[12]; <br> pBoxPermute[26] = sBoxByte[29]; <br> pBoxPermute[27] = sBoxByte[ 5]; <br> pBoxPermute[28] = sBoxByte[21]; <br> pBoxPermute[29] = sBoxByte[10]; <br> pBoxPermute[30] = sBoxByte[ 3]; <br> pBoxPermute[31] = sBoxByte[24];    <br> return pBoxPermute;<br>}<br><br>function finallyPermute(endByte){    <br> var fpByte = new Array(64);  <br> fpByte[ 0] = endByte[39]; <br> fpByte[ 1] = endByte[ 7]; <br> fpByte[ 2] = endByte[47]; <br> fpByte[ 3] = endByte[15]; <br> fpByte[ 4] = endByte[55]; <br> fpByte[ 5] = endByte[23]; <br> fpByte[ 6] = endByte[63]; <br> fpByte[ 7] = endByte[31]; <br> fpByte[ 8] = endByte[38]; <br> fpByte[ 9] = endByte[ 6]; <br> fpByte[10] = endByte[46]; <br> fpByte[11] = endByte[14]; <br> fpByte[12] = endByte[54]; <br> fpByte[13] = endByte[22]; <br> fpByte[14] = endByte[62]; <br> fpByte[15] = endByte[30]; <br> fpByte[16] = endByte[37]; <br> fpByte[17] = endByte[ 5]; <br> fpByte[18] = endByte[45]; <br> fpByte[19] = endByte[13]; <br> fpByte[20] = endByte[53]; <br> fpByte[21] = endByte[21]; <br> fpByte[22] = endByte[61]; <br> fpByte[23] = endByte[29]; <br> fpByte[24] = endByte[36]; <br> fpByte[25] = endByte[ 4]; <br> fpByte[26] = endByte[44]; <br> fpByte[27] = endByte[12]; <br> fpByte[28] = endByte[52]; <br> fpByte[29] = endByte[20]; <br> fpByte[30] = endByte[60]; <br> fpByte[31] = endByte[28]; <br> fpByte[32] = endByte[35]; <br> fpByte[33] = endByte[ 3]; <br> fpByte[34] = endByte[43]; <br> fpByte[35] = endByte[11]; <br> fpByte[36] = endByte[51]; <br> fpByte[37] = endByte[19]; <br> fpByte[38] = endByte[59]; <br> fpByte[39] = endByte[27]; <br> fpByte[40] = endByte[34]; <br> fpByte[41] = endByte[ 2]; <br> fpByte[42] = endByte[42]; <br> fpByte[43] = endByte[10]; <br> fpByte[44] = endByte[50]; <br> fpByte[45] = endByte[18]; <br> fpByte[46] = endByte[58]; <br> fpByte[47] = endByte[26]; <br> fpByte[48] = endByte[33]; <br> fpByte[49] = endByte[ 1]; <br> fpByte[50] = endByte[41]; <br> fpByte[51] = endByte[ 9]; <br> fpByte[52] = endByte[49]; <br> fpByte[53] = endByte[17]; <br> fpByte[54] = endByte[57]; <br> fpByte[55] = endByte[25]; <br> fpByte[56] = endByte[32]; <br> fpByte[57] = endByte[ 0]; <br> fpByte[58] = endByte[40]; <br> fpByte[59] = endByte[ 8]; <br> fpByte[60] = endByte[48]; <br> fpByte[61] = endByte[16]; <br> fpByte[62] = endByte[56]; <br> fpByte[63] = endByte[24];<br> return fpByte;<br>}<br><br>function getBoxBinary(i) {<!-- --><br> var binary = "";<br> switch (i) {<!-- --><br>   case 0 :binary = "0000";break;<br>   case 1 :binary = "0001";break;<br>   case 2 :binary = "0010";break;<br>   case 3 :binary = "0011";break;<br>   case 4 :binary = "0100";break;<br>   case 5 :binary = "0101";break;<br>   case 6 :binary = "0110";break;<br>   case 7 :binary = "0111";break;<br>   case 8 :binary = "1000";break;<br>   case 9 :binary = "1001";break;<br>   case 10 :binary = "1010";break;<br>   case 11 :binary = "1011";break;<br>   case 12 :binary = "1100";break;<br>   case 13 :binary = "1101";break;<br>   case 14 :binary = "1110";break;<br>   case 15 :binary = "1111";break;<br> }<br> return binary;<br>}<br>/*<br>* generate 16 keys for xor<br>*<br>*/<br>function generateKeys(keyByte){    <br> var key   = new Array(56);<br> var keys = new Array();  <br><br> keys[ 0] = new Array();<br> keys[ 1] = new Array();<br> keys[ 2] = new Array();<br> keys[ 3] = new Array();<br> keys[ 4] = new Array();<br> keys[ 5] = new Array();<br> keys[ 6] = new Array();<br> keys[ 7] = new Array();<br> keys[ 8] = new Array();<br> keys[ 9] = new Array();<br> keys[10] = new Array();<br> keys[11] = new Array();<br> keys[12] = new Array();<br> keys[13] = new Array();<br> keys[14] = new Array();<br> keys[15] = new Array();  <br> var loop = [1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];<br><br> for(i=0;i&lt;7;i++){<!-- --><br>   for(j=0,k=7;j&lt;8;j++,k--){<!-- --><br>     key[i*8+j]=keyByte[8*k+i];<br>   }<br> }    <br><br> var i = 0;<br> for(i = 0;i &lt; 16;i ++){<!-- --><br>   var tempLeft=0;<br>   var tempRight=0;<br>   for(j = 0; j &lt; loop[i];j ++){          <br>     tempLeft = key[0];<br>     tempRight = key[28];<br>     for(k = 0;k &lt; 27 ;k ++){<!-- --><br>       key[k] = key[k+1];<br>       key[28+k] = key[29+k];<br>     }  <br>     key[27]=tempLeft;<br>     key[55]=tempRight;<br>   }<br>   var tempKey = new Array(48);<br>   tempKey[ 0] = key[13];<br>   tempKey[ 1] = key[16];<br>   tempKey[ 2] = key[10];<br>   tempKey[ 3] = key[23];<br>   tempKey[ 4] = key[ 0];<br>   tempKey[ 5] = key[ 4];<br>   tempKey[ 6] = key[ 2];<br>   tempKey[ 7] = key[27];<br>   tempKey[ 8] = key[14];<br>   tempKey[ 9] = key[ 5];<br>   tempKey[10] = key[20];<br>   tempKey[11] = key[ 9];<br>   tempKey[12] = key[22];<br>   tempKey[13] = key[18];<br>   tempKey[14] = key[11];<br>   tempKey[15] = key[ 3];<br>   tempKey[16] = key[25];<br>   tempKey[17] = key[ 7];<br>   tempKey[18] = key[15];<br>   tempKey[19] = key[ 6];<br>   tempKey[20] = key[26];<br>   tempKey[21] = key[19];<br>   tempKey[22] = key[12];<br>   tempKey[23] = key[ 1];<br>   tempKey[24] = key[40];<br>   tempKey[25] = key[51];<br>   tempKey[26] = key[30];<br>   tempKey[27] = key[36];<br>   tempKey[28] = key[46];<br>   tempKey[29] = key[54];<br>   tempKey[30] = key[29];<br>   tempKey[31] = key[39];<br>   tempKey[32] = key[50];<br>   tempKey[33] = key[44];<br>   tempKey[34] = key[32];<br>   tempKey[35] = key[47];<br>   tempKey[36] = key[43];<br>   tempKey[37] = key[48];<br>   tempKey[38] = key[38];<br>   tempKey[39] = key[55];<br>   tempKey[40] = key[33];<br>   tempKey[41] = key[52];<br>   tempKey[42] = key[45];<br>   tempKey[43] = key[41];<br>   tempKey[44] = key[49];<br>   tempKey[45] = key[35];<br>   tempKey[46] = key[28];<br>   tempKey[47] = key[31];<br>   switch(i){<!-- --><br>     case 0: for(m=0;m &lt; 48 ;m++){ keys[ 0][m] = tempKey[m]; } break;<br>     case 1: for(m=0;m &lt; 48 ;m++){ keys[ 1][m] = tempKey[m]; } break;<br>     case 2: for(m=0;m &lt; 48 ;m++){ keys[ 2][m] = tempKey[m]; } break;<br>     case 3: for(m=0;m &lt; 48 ;m++){ keys[ 3][m] = tempKey[m]; } break;<br>     case 4: for(m=0;m &lt; 48 ;m++){ keys[ 4][m] = tempKey[m]; } break;<br>     case 5: for(m=0;m &lt; 48 ;m++){ keys[ 5][m] = tempKey[m]; } break;<br>     case 6: for(m=0;m &lt; 48 ;m++){ keys[ 6][m] = tempKey[m]; } break;<br>     case 7: for(m=0;m &lt; 48 ;m++){ keys[ 7][m] = tempKey[m]; } break;<br>     case 8: for(m=0;m &lt; 48 ;m++){ keys[ 8][m] = tempKey[m]; } break;<br>     case 9: for(m=0;m &lt; 48 ;m++){ keys[ 9][m] = tempKey[m]; } break;<br>     case 10: for(m=0;m &lt; 48 ;m++){ keys[10][m] = tempKey[m]; } break;<br>     case 11: for(m=0;m &lt; 48 ;m++){ keys[11][m] = tempKey[m]; } break;<br>     case 12: for(m=0;m &lt; 48 ;m++){ keys[12][m] = tempKey[m]; } break;<br>     case 13: for(m=0;m &lt; 48 ;m++){ keys[13][m] = tempKey[m]; } break;<br>     case 14: for(m=0;m &lt; 48 ;m++){ keys[14][m] = tempKey[m]; } break;<br>     case 15: for(m=0;m &lt; 48 ;m++){ keys[15][m] = tempKey[m]; } break;<br>   }<br> }<br> return keys;  <br>}<br>//end-------------------------------------------------------------------------------------------------------------<br>/*从后台请求加密密码字符串*/<br>function findDes(){<!-- --><br>	var jsonStr;<br>	$.ajax({<!-- --><br>		//以那一种方法向服务器请求数据<br>		type:"POST",<br>		//向那个资源发送请求<br>		url:"${ctx}/Login!findDesKey.do",<br>		//处理什么类型的数据<br>		dataType:"html",<br>		async:false,<br>		//根据返回数据进行什么处理<br>		success:function(returnedData){<!-- --><br><br>			//判断是否禁止撤单<br>			if(returnedData!=null || returnedData !=""){<!-- --><br>				jsonStr = eval('(' + returnedData + ')'); <br>			}else{<!-- --><br>				alert('des返回失败!请检查控件是否被禁用。'+jsonStr);<br>			}   					<br>		}<br><br>	});<br>	return jsonStr;<br>} <br><br></code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4bab1fa607578dd634c634f993ac8c66/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">FICO凭证错误：BKPFF$PRDCLN800在FI中达到的项目最大编号</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ae9ee2b92ecebb87febc63c1391e785a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C/C&#43;&#43;】回溯经典算法之--&gt;八皇后问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>