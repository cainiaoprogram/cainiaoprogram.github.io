<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Redis入门 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Redis入门" />
<meta property="og:description" content="开始 Redis是一个高性能的key-value 数据库，同时支持list，set，zset，hash等数据结构的存储
第一个尝试： （先用windows 版本看下入个门，一般linux用的多，学习来源菜鸟教程）
下载安装到一个你能找到的地方
推荐在某个盘下建一个tool的文件夹，把go啦java啦mysql啦Redis啦，这种工具性的工具放进去
https://github.com/tporadowski/redis/releases
下载zip版本
（前提，每个命令提示符都要先进入redis那个文件下，要不找不到，切换路径的命令：cd /d 路径）
在cmd(命令提示符中)打开服务端命令： redis-server.exe redis.windows.conf
再开一个命令提示符，开客服端：redis-cli.exe -h 127.0.0.1 -p 6379
设置键值对：set heiKey ha
取键值对：get heiKey
数据类型
stringhashlistsetzset (有序集合) 简介 偷一张网络视频的图
他是一种nosql数据库，
好处就是如图
作为缓存使用，减小io压力
NoSQL非关系型数据库
MemcacheRedismongoDBNeo4jApache Cassandra 分类Examples举例典型应用场景数据模型优点缺点键值（key-value）Tokyo Cabinet/Tyrant， Redis， Voldemort， Oracle BDB内容缓存，主要用于处理大量数据的高访问负载，也用于一些日志系统等等。Key 指向 Value 的键值对，通常用hash table来实现查找速度快数据无结构化，通常只被当作字符串或者二进制数据列存储数据库Cassandra， HBase， Riak分布式的文件系统以列簇式存储，将同一列数据存在一起查找速度快，可扩展性强，更容易进行分布式扩展功能相对局限文档型数据库CouchDB， MongoDbWeb应用（与Key-Value类似，Value是结构化的，不同的是数据库能够了解Value的内容）Key-Value对应的键值对，Value为结构化数据数据结构要求不严格，表结构可变，不需要像关系型数据库一样需要预先定义表结构查询性能不高，而且缺乏统一的查询语法。图形(Graph)数据库Neo4J， InfoGrid， Infinite Graph社交网络，推荐系统等。专注于构建关系图谱图结构利用图结构相关算法。比如最短路径寻址，N度关系查找等很多时候需要对整个图做计算才能得出需要的信息，而且这种结构不太好做分布式的集群方案。 linux版本学习 注意事项 xftp连接云服务器的实例主机密码就是root账户密码：W…….
下载安装 下载安装redis
稳定版本安装地址 : https://redis.io/download/#redis-downloads
在linux中安装redis需要有c语言编译环境，centos7，有gcc就行，通过命令检测是否有gcc，
gcc --version检查是否有gcc环境，有的话就解压tar -zxvf 压缩包名字进入redis文件夹make把redis编译成c文件make install安装 我在这里遇到过一个问题，原因是下错了版本，下载成了stack版本，当时没注意…
redis目录简介" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ad0cfedfde3b7accd44bc5b42e97e68e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-13T15:01:48+08:00" />
<meta property="article:modified_time" content="2022-06-13T15:01:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Redis入门</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="_0"></a>开始</h5> 
<p>Redis是一个高性能的key-value 数据库，同时支持list，set，zset，hash等数据结构的存储</p> 
<h6><a id="_4"></a>第一个尝试：</h6> 
<p>（先用windows 版本看下入个门，一般linux用的多，学习来源菜鸟教程）</p> 
<blockquote> 
 <p>下载安装到一个你能找到的地方</p> 
</blockquote> 
<p>推荐在某个盘下建一个tool的文件夹，把go啦java啦mysql啦Redis啦，这种工具性的工具放进去</p> 
<p>https://github.com/tporadowski/redis/releases</p> 
<p>下载zip版本</p> 
<p>（前提，每个命令提示符都要先进入redis那个文件下，要不找不到，<mark>切换路径的命令：cd /d 路径</mark>）</p> 
<ol><li> <p>在cmd(命令提示符中)打开服务端命令： redis-server.exe redis.windows.conf<br> <img src="https://images2.imgbox.com/4e/93/lAL4npPS_o.png" alt="在这里插入图片描述"></p> </li><li> <p>再开一个命令提示符，开客服端：redis-cli.exe -h 127.0.0.1 -p 6379</p> </li><li> <p>设置键值对：set heiKey ha</p> </li><li> <p>取键值对：get heiKey</p> </li></ol> 
<p><img src="https://images2.imgbox.com/f5/ae/gwbNzxUA_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>数据类型</p> 
</blockquote> 
<ul><li>string</li><li>hash</li><li>list</li><li>set</li><li>zset (有序集合)</li></ul> 
<h6><a id="_37"></a>简介</h6> 
<p>偷一张网络视频的图</p> 
<p><img src="https://images2.imgbox.com/14/e5/P8qSexpi_o.png" alt="在这里插入图片描述"></p> 
<p>他是一种nosql数据库，</p> 
<p>好处就是如图</p> 
<p>作为缓存使用，减小io压力</p> 
<p>NoSQL非关系型数据库</p> 
<ul><li>Memcache</li><li>Redis</li><li>mongoDB</li><li>Neo4j</li><li>Apache Cassandra</li></ul> 
<table><thead><tr><th><strong>分类</strong></th><th><strong>Examples举例</strong></th><th>典型应用场景</th><th>数据模型</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td><strong>键值（key-value）</strong></td><td>Tokyo Cabinet/Tyrant， Redis， Voldemort， Oracle BDB</td><td>内容缓存，主要用于处理大量数据的高访问负载，也用于一些日志系统等等。</td><td>Key 指向 Value 的键值对，通常用hash table来实现</td><td>查找速度快</td><td>数据无结构化，通常只被当作字符串或者二进制数据</td></tr><tr><td><strong>列存储数据库</strong></td><td>Cassandra， HBase， Riak</td><td>分布式的文件系统</td><td>以列簇式存储，将同一列数据存在一起</td><td>查找速度快，可扩展性强，更容易进行分布式扩展</td><td>功能相对局限</td></tr><tr><td><strong>文档型数据库</strong></td><td>CouchDB， MongoDb</td><td>Web应用（与Key-Value类似，Value是结构化的，不同的是数据库能够了解Value的内容）</td><td>Key-Value对应的键值对，Value为结构化数据</td><td>数据结构要求不严格，表结构可变，不需要像关系型数据库一样需要预先定义表结构</td><td>查询性能不高，而且缺乏统一的查询语法。</td></tr><tr><td><strong>图形(Graph)数据库</strong></td><td>Neo4J， InfoGrid， Infinite Graph</td><td>社交网络，推荐系统等。专注于构建关系图谱</td><td>图结构</td><td>利用图结构相关算法。比如最短路径寻址，N度关系查找等</td><td>很多时候需要对整个图做计算才能得出需要的信息，而且这种结构不太好做分布式的集群方案。</td></tr></tbody></table> 
<h5><a id="linux_65"></a>linux版本学习</h5> 
<h6><a id="_67"></a>注意事项</h6> 
<p>xftp连接云服务器的实例主机密码就是root账户密码：W…….</p> 
<hr> 
<h6><a id="_73"></a>下载安装</h6> 
<p>下载安装redis</p> 
<p>稳定版本安装地址 : https://redis.io/download/#redis-downloads</p> 
<p><img src="https://images2.imgbox.com/c2/0b/8jCnm199_o.png" alt="在这里插入图片描述"></p> 
<p>在linux中安装redis需要有c语言编译环境，centos7，有gcc就行，通过命令检测是否有gcc，</p> 
<ol><li><code>gcc --version</code>检查是否有gcc环境，有的话就</li><li>解压<code>tar -zxvf 压缩包名字</code></li><li>进入redis文件夹</li><li><code>make</code>把redis编译成c文件</li><li><code>make install</code>安装</li></ol> 
<p>我在这里遇到过一个问题，原因是下错了版本，下载成了stack版本，当时没注意…</p> 
<blockquote> 
 <p>redis目录简介<br> <img src="https://images2.imgbox.com/4c/b8/vz8i0meV_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h6><a id="redis_99"></a>启动redis(第一个例子)</h6> 
<ol start="6"><li> <p>推荐后台启动redis，所以需要，进入到redis目录下，<code>cp redis.conf /etc/redis.conf</code>复制到的目录可以任意（自己知道就行）</p> </li><li> <p>把后台启动改成允许，daemonize no 改成yes,在etc目录下<code>vi redis.conf</code></p> </li><li> <p><code>/daem</code>搜索一下daemonize no在哪里，vi（vim）命令可别忘了,然后<code>i</code>进入编辑模式，把no改成yes，<code>:wq</code>保存退出</p> </li><li> <p>在<code>/usr/local/bin</code>目录下后台启动<code>/etc</code>里边的redis.conf，命令:<code>redis-server /etc/redis.conf</code></p> </li><li> <p><code>redis-cli</code>连接上redis</p> </li><li> <p>欸嘿！第一个例子</p> <pre><code class="prism language-bash"><span class="token punctuation">[</span>root@jingZhi bin<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> heiKey ha
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get heiKey
<span class="token string">"ha"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">ping</span>
PONG
</code></pre> </li><li> <p>关闭redis的后台命令：<code>shutdown</code>然后<code>exit</code>,<br> 说一下我遇到的问题，第二次，先是关不掉，因为我查看进程发现redis还在后天运行，但是哈，之后直接把我服务器给关了，<br> shutdown是直接把电源关了，就是退出和linux系统的连接了，需要在阿里云管理平台开启服务器<br> 总之就是关闭后台redis这个我暂时没解决，就是关不掉后台<br> 所以就<code>exit</code>退出这个端口号就行了，让他一直在后端运行吧</p> </li><li> <p>查看进程<code>ps -ef | grep redis</code></p> </li></ol> 
<p>redis来源：Merz</p> 
<h6><a id="redis_135"></a>redis介绍</h6> 
<ul><li>默认16个数据库，默认使用0数据库</li><li>select 1切换到1数据库</li></ul> 
<h5><a id="_140"></a>五大数据类型</h5> 
<h6><a id="key_142"></a>key键操作</h6> 
<ul><li>这不是数据类型</li></ul> 
<blockquote> 
 <p>使用</p> 
</blockquote> 
<ul><li> <p><code>set key value</code>设置key-value</p> </li><li> <p>取出值<code>get key</code></p> </li></ul> 
<blockquote> 
 <p><strong>key键常用命令</strong></p> 
</blockquote> 
<ul><li><code>keys *</code>查看当前库所有key，匹配<code>keys*1</code></li><li><code>exists key</code>判断某个key是否存在</li><li><code>type key</code>查看key（的值）类型</li><li><code>del key</code>删除指定key</li><li><code>unlink key</code>根据value选择非阻塞删除<br> 表面上先删除，真正的删除在后续异步操作</li><li><code>expire key 20</code>设置指定key20秒后过期</li><li><code>ttl key</code>查看key还有多少秒过期，-1永远不过期，-2已经过期</li><li><code>select 3</code>选择数据库3，默认是0，redis有16个库</li><li><code>dbsize</code>查看有多少个key</li><li><code>flushdb</code>删除当前库所有key</li><li><code>flushall</code>删除所有库所有key，不常用</li><li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> HeiKey ha
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> qieKey xi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"qieKey"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"HeiKey"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> exists k1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> exists qieKey
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">type</span> HeiKey
string
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> del qieKey
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"HeiKey"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> naKey ni
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> expire HeiKey <span class="token number">20</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl HeiKey
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl HeiKey
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> -2                   <span class="token comment">#-2表示已经过期</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl naKey
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> -1                   <span class="token comment">#-1表示永远不过期</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token keyword">select</span> <span class="token number">3</span>
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token number">0</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> dbsize
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"naKey"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushdb
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h6><a id="String_214"></a>String</h6> 
<blockquote> 
 <p>说明</p> 
</blockquote> 
<ul><li>二进制安全的，string可以包含任何数据，例如图片，视频等</li><li>value最大长度为512M</li><li>String数据结构是简单动态字符串（SDS）,类似java的arraylist，个人感觉也类似go的切片，</li><li>长度小于1M是，动态加倍扩容，超过1M时候，每次+1M</li></ul> 
<blockquote> 
 <p>常用命令</p> 
</blockquote> 
<ul><li><code>set keyname value</code>设置</li><li><code>get keyname</code> 取值</li><li><code>append keyname value</code>追加内容</li><li><code>strlen keyname</code>查看key值长度</li><li><code>setnx keyname value</code>当key不存在时，设置key值</li><li><code>incr keyname</code>对数字值操作+1</li><li><code>decr keyname</code>对数字值操作-1</li><li><code>incrby keyname n </code>对数字值操作+n</li><li><code>decrby keyname n</code>对数字值操作-n</li><li><code>mset k1 v1 k2 v2</code>设置多个值</li><li><code>mget k1 k2</code>取出多个值</li><li><code>msetnx</code>懂得都懂，有一点说明，一旦有一个存在则设置都失败</li><li><code>getrange keyname 0 3</code>范围取值，0代表第一个,以此……</li><li><code>setrange keyname 3 覆盖的内容</code>3代表第四个开始覆盖</li><li><code>setex keyname n valuename</code>设置一个值，过期时间是n，值是valuename</li><li><code>ttl keyname</code>查看keyname过期时间</li><li><code>getset keyname valuename</code>设置valuename新值同时查看旧值</li><li>这一块内容需要做一个思维脑图，帮助记忆</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v100
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k2 v200
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k2"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"k1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k1
<span class="token string">"v100"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k1 v1100
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k1
<span class="token string">"v1100"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> append k1 abc
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k1
<span class="token string">"v1100abc"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> strlen k1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setnx k1 asdf
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setnx k3 v300
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> k4 <span class="token number">100</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incr k4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">101</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k4
<span class="token string">"101"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decr k4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">100</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incrby k4 <span class="token number">7</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">107</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> decrby k4 <span class="token number">8</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">99</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get k4
<span class="token string">"99"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset k1 v1 k2 v2 k3 v3
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mget k1 k2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> msetnx k11 v11 k1 v11
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> mset k11 v11 k22 v22
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name wangdahai
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name
<span class="token string">"wangdahai"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getrange name <span class="token number">0</span> <span class="token number">3</span>
<span class="token string">"wang"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setrange name <span class="token number">3</span> heiha
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name
<span class="token string">"wanheihai"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setex age <span class="token number">20</span> value30
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ttl age
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">17</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get age
<span class="token string">"value30"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getset name lalalal
<span class="token string">"wanheihai"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name
<span class="token string">"lalalal"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 

</code></pre> 
<h6><a id="List_319"></a>List</h6> 
<blockquote> 
 <p>说明</p> 
</blockquote> 
<ul><li>单键多值</li><li>底层是一个双向链表，两端操作方便，中间操作困难</li><li>按照插入顺序排序，添加元素到头部或者尾部</li><li>顺序放入，逆序取出，感觉有点像入栈，出栈</li></ul> 
<blockquote> 
 <p>常用命令</p> 
</blockquote> 
<ul><li><code>lpush/rpush k1 v1 v2 v3</code>设置一key多value</li><li><code>lrange keyname 0 -1</code>从左往右取值，0到-1 可以取到所有的值</li><li><code>lpop/rpop keyname</code> 从左/右出来一个值，并且删除这个值。</li><li><code>rpoplpush k1 k2</code>k1右边吐出1个值放到k2左边，把k1的最右边的放在k2的第一个了，其他的往后推1，</li><li><code>lindex k1 1</code>获取下标为2的元素</li><li><code>llen keyname</code>获取keyname长度</li><li><code>linsert keyname before/after value newvalue</code>在keyname的value前/后插入newvalue</li><li><code>lrem keyname n value</code>删除n个从keyname的value左到右，</li><li><code>lset keyname n newvalue</code>用newvalue覆盖keyname的下标为n的元素</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  lpush k1 v1 v2 v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpush k2 v1 v2 v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k2 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpop k1
<span class="token string">"v3"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpop k1
<span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushdb
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lpush k1 v1 v2 v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpush k2 v11 v12 v13
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> rpoplpush k1 k2
<span class="token string">"v1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k2 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v11"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v12"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v13"</span>
kkk
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lindex k1 <span class="token number">1</span>
<span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> llen k1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert k1 before v3 newv3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"newv3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> linsert k1 after v3 newv4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"newv3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"newv4"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrem k1 <span class="token number">1</span> v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"newv3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"newv4"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lset k1 <span class="token number">1</span> newv33
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> lrange k1 <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"newv3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"newv33"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
</code></pre> 
<p>list<strong>数据结构</strong></p> 
<ul><li>将链表和ziplist结合起来组成quicklist，就是将多个ziplist使用双向指针穿起来使用</li></ul> 
<h6><a id="Set_419"></a>Set</h6> 
<blockquote> 
 <p>说明：</p> 
</blockquote> 
<ul><li>自动去重，底层是hash表，复杂度0（1），</li><li>其他就和List很像了</li></ul> 
<blockquote> 
 <p>底层数据结构</p> 
</blockquote> 
<ul><li>字典，dict,字典是哈希表实现的</li></ul> 
<blockquote> 
 <p>常用命令:</p> 
</blockquote> 
<ul><li><code>sadd key value1 value2....</code>添加值</li><li><code>smembers key</code>取出该集合所有值</li><li><code>sismember key value</code>判断key集合是否含有value</li><li><code>scard key</code>返回key的元素个数</li><li><code>srem k1 v1 v3</code>删除k1集合的v1 v3元素</li><li><code>spop k1</code>随机吐出k1集合一个元素，吐出同时删除了</li><li><code>srandmember k1 n</code>随机取出n个值，不会从集合删除</li><li><code>smove sourcekey destinationkey value</code>把sourcekey中value移到destinationkey</li><li><code>sinter k1 k2</code>返回交集</li><li><code>sunion k1 k2</code>返回并集</li><li><code>sdiff k1 k2</code>返回差集。包含k1不包含k2的</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> flushdb
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd k1 v1 v2 v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sismember k1 v2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sismember k1 v4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srem k1 v1 v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd k1 v3 v4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop k1
<span class="token string">"v4"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop k1
<span class="token string">"v3"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd k1 v1 v2 v3 v4 v5 v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v1"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"v5"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop k1
<span class="token string">"v1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> srandmember k1 <span class="token number">2</span> 
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> scard k1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v5"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> spop k1 
<span class="token string">"v5"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k1"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd k2 v21 v23 v24 v25
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smove k1 k2 v2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v25"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v21"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v24"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v23"</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sadd k1 v2 v23
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sinter k1 k2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v23"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v23"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> smembers k2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v21"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v25"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v23"</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"v24"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> sunion k1 k2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v25"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v21"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"v24"</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">"v23"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> disff k1 k2
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR unknown <span class="token builtin class-name">command</span> <span class="token variable"><span class="token variable">`</span>disff<span class="token variable">`</span></span>, with args beginning with: <span class="token variable"><span class="token variable">`</span>k1<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>k2<span class="token variable">`</span></span>, 
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">sdiff</span> k1 k2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v4"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v3"</span>

</code></pre> 
<h6><a id="Hash_552"></a>Hash</h6> 
<blockquote> 
 <p>说明</p> 
</blockquote> 
<ul><li>键值对集合</li><li>redis的hash是一个string类型的field和value的映射表，hash特别适合用于存储对象</li><li>类似java里边的map&lt;String,object&gt;</li><li>两种存储方式，一是IDkey，对映名字，年龄啦什么的，二是id+名字—对应值</li></ul> 
<blockquote> 
 <p>数据结构</p> 
</blockquote> 
<ul><li>两种，ziplist,hashtable</li><li>当field-value长度较短且个数较少，使用ziplist，否则使用hashtable</li></ul> 
<blockquote> 
 <p>常用命令</p> 
</blockquote> 
<ul><li> <p><code>hset key field value</code>key集合field键赋值value,例子<code>hset user:1001 name jingzhi</code></p> </li><li> <p><code>hget key field</code>从key集合filed取出value</p> </li><li> <p><code>hmset key field1 value1 field2 value2...</code>批量设置hash值</p> </li><li> <p><code>hexists key field</code>产看hash表key中，给定field是否存在</p> </li><li> <p><code>hkeys key</code>查看key的所有field</p> </li><li> <p><code>hvals key</code>查看key所有的value</p> </li><li> <p><code>hincrby key field n</code>key哈希表中field域值增n，n可以是负数</p> </li><li> <p><code>hsetnx key field value</code>当且仅当field不存在时候给field值设置为value</p> </li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset user:1000 <span class="token function">id</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hset user:1000 name jingzhi
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hget user:1000 name
<span class="token string">"jingzhi"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hmset user:1002 <span class="token function">id</span> <span class="token number">2</span> name lisi age <span class="token number">21</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hexists user:1000
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR wrong number of arguments <span class="token keyword">for</span> <span class="token string">'hexists'</span> <span class="token builtin class-name">command</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  hexists user:1000
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR wrong number of arguments <span class="token keyword">for</span> <span class="token string">'hexists'</span> <span class="token builtin class-name">command</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hexists user:1000 name
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hkeys user:1002
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"id"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"age"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hvals user:1002
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"2"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"lisi"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"21"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hincrby user:1002 age <span class="token number">7</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">28</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hsetnx user:1002 age <span class="token number">30</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hsetnx user:1002 gender <span class="token number">2</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> hkeys user:1002
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"id"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"name"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"age"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"gender"</span>
</code></pre> 
<hr> 
<h6><a id="Zset_618"></a>Zset有序集合</h6> 
<blockquote> 
 <p>说明</p> 
</blockquote> 
<ul><li>有序集合，没有重复元素</li><li>和set区别，都关联了一个score，根据评分，按章从低到高排序，成员唯一，评分可以重复</li><li>可以根据评分获取一个范围的元素</li></ul> 
<blockquote> 
 <p>数据结构</p> 
</blockquote> 
<ul><li>一方面等价于Map给每一个元素value赋予一个权重score，另一方面类似于TreeSet，内部元素按照权重score进行排序，得到每个元素的名次</li><li>底层两个数据结构 
  <ul><li>hash,hash的作用就是关联元素value和权重score，保证value的唯一性，</li><li>跳跃表，目的在于给value元素排序，根据score范围获取元素列表</li></ul> </li></ul> 
<blockquote> 
 <p>常用命令</p> 
</blockquote> 
<ul><li><code>zadd key score1 value1 score2 value2...</code>将一个或者多个value元素以及score添加集合到key</li><li><code>range rank 0 -1 withscores</code>查看所有元素及其分数，0和-1代表下标，0到-1是所有</li><li><code>zrangebyscore key n m[withscores]</code>从小到大显示，区间是n——m</li><li><code>zrevrangebyscore key m n[withscores]</code>从大到小显示，区间是m——n</li><li><code>zincrby key n value</code>给元素value添加n分</li><li><code>zrem key value</code>删除key集合value元素</li><li><code>zcount key n m</code>统计n 到 m区间的元素个数</li><li><code>zrank key value</code>查询该value元素在key集合的排名，排名从0开始</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zadd rank <span class="token number">99</span> bainiangudu <span class="token number">98</span> shuimiangeming <span class="token number">96</span> wenhuakulv <span class="token number">97</span> wangyuancheng
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange rank <span class="token number">0</span> -1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"wenhuakulv"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"wangyuancheng"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"shuimiangeming"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"bainiangudu"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange rank <span class="token number">0</span> -1 withscores
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"wenhuakulv"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"96"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"wangyuancheng"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"97"</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"shuimiangeming"</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"98"</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">"bainiangudu"</span>
<span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">"99"</span>
<span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrangebyscore rank <span class="token number">97</span> <span class="token number">99</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"wangyuancheng"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"shuimiangeming"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"bainiangudu"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrevrangebyscore rank <span class="token number">98</span> <span class="token number">96</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"shuimiangeming"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"wangyuancheng"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"wenhuakulv"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zincrby rank <span class="token number">9</span> shuimiangeming
<span class="token string">"107"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrem rank wangyuancheng
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zcount rank <span class="token number">1</span> <span class="token number">110</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrank rank bainiangudu
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange rank <span class="token number">0</span> -1 withscores
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"wenhuakulv"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"96"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"bainiangudu"</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"99"</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"shuimiangeming"</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"107"</span>
</code></pre> 
<p>配置文件(听了一边，没啥好说的)</p> 
<ul><li>只支持bytes，不支持bits</li></ul> 
<h5><a id="_693"></a>订阅发布</h5> 
<ul><li>pub/sub,发布订阅是一种消息通道模式</li><li><code>SUBSCRIBE channel1</code></li><li><code>publish channel1 hello</code></li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SUBSCRIBE channel1
Reading messages<span class="token punctuation">..</span>. <span class="token punctuation">(</span>press Ctrl-C to quit<span class="token punctuation">)</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"subscribe"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"channel1"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"channel1"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"hei"</span>

<span class="token comment">#另一个会话</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> publish channel1 hei
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 
</code></pre> 
<h5><a id="_715"></a>新特性</h5> 
<h6><a id="bitmaps_717"></a>bitmaps</h6> 
<ul><li>极大的节约空间，但是适合大量活跃用户，不适用用户少，和僵尸用户多的情况</li><li><code>setbit key 对象 偏移量</code></li><li><code>getbit key 对象</code></li><li><code>setbit unique:key 对象 偏移量</code></li><li><code>bitop and unique:users:and:20201104_03 unique:users:20201103 unique:users:20201104</code></li><li>and可以换为or表示并集，and表示交集</li></ul> 
<pre><code class="prism language-go"><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span>  setbit user<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">1</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span>  setbit user<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">6</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span>  setbit user<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">11</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span>  setbit user<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">16</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span>  setbit user<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">19</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> getbit users<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">6</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> getbit users<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> getbit user<span class="token punctuation">:</span><span class="token number">20210101</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>

<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201104</span> <span class="token number">1</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201104</span> <span class="token number">2</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201104</span> <span class="token number">5</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201104</span> <span class="token number">9</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201103</span> <span class="token number">0</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201103</span> <span class="token number">1</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201103</span> <span class="token number">4</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> setbit unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201103</span> <span class="token number">9</span> <span class="token number">1</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">6379</span><span class="token operator">&gt;</span> bitop and unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span>and<span class="token punctuation">:</span><span class="token number">20201104_03</span> unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201103</span> unique<span class="token punctuation">:</span>users<span class="token punctuation">:</span><span class="token number">20201104</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
</code></pre> 
<h6><a id="HyperLogLog_766"></a>HyperLogLog</h6> 
<ul><li>没几个命令，没有实际运用说实话感觉不出来它存在的意义</li><li>基数统计，比如数据集{1，3，5，7，5，7，8}，那么基数就是{1，3，5，7，8}，基数（不重复元素）为5</li><li>redis里面每个HyperLogLog键只需要12kB内存，就可以计算接近2^64个不同元素的基数</li><li><code>pfadd key 内容</code>添加</li><li><code>pfcount key</code>产看基数</li><li><code>pfmerge newkey k1 k2</code>把k1,k2合并到newkey</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd program <span class="token string">"java"</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd program <span class="token string">"c++"</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd program <span class="token string">"php"</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd program <span class="token string">"c++"</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount program
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token punctuation">(</span>i
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd k1 <span class="token string">"a"</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfmerge k100 k1 program
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount k100
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
</code></pre> 
<hr> 
<h6><a id="Geospatial_799"></a>Geospatial</h6> 
<ul><li>GEO类型，Geographic地理信息的缩写</li><li>经纬度，元素二维坐标</li><li>m 米 km 千米 mi英里 ft单位为英尺</li><li>有效经度-180到180，有效纬度 -85.05112878 到 85.05112878</li><li><code>geoadd key 经度 纬度 城市 经度 纬度 城市...</code>添加</li><li><code>geopos key 城市</code>获取经纬度</li><li><code>geodist key city1 city2 km</code>获取city1到city2的km</li><li><code>georadius key 经度 纬度 radius km</code>获取经纬度radius km范围有几个city</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">1.23</span> <span class="token number">2.23</span> shanghai <span class="token number">2.34</span> <span class="token number">3.34</span> chengdu <span class="token number">1.23456</span> <span class="token number">2.234</span> beijing 
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geopos china:city beijing
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1.23455911874771118"</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2.23400057363439686"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geodist china:city beijing shanghai km
<span class="token string">"0.6743"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">100</span> km
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km
<span class="token punctuation">(</span>empty array<span class="token punctuation">)</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">10</span> <span class="token number">2</span> <span class="token number">10000</span> km
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"shanghai"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"beijing"</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"chengdu"</span>
</code></pre> 
<p><strong>18——20，因为是走go，所以，jedis，用java操作redis我就跳过了</strong></p> 
<h5><a id="redis_836"></a>redis事务</h5> 
<h6><a id="_838"></a>使用</h6> 
<ul><li>单独隔离操作，所有命令都会序列化，按顺序执行，事务在执行的过程中，不会被其他客户端送来的命令所打断</li><li>就是串联多个命令，防止别的命令插队</li><li><code>multi </code>开启事务</li><li><code>事务...</code></li><li><code>exec</code>执行事务</li><li><code>discard</code>打断事务</li></ul> 
<pre><code class="prism language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k1 v1
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k2 v2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> get k2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> OK
<span class="token number">2</span><span class="token punctuation">)</span> OK
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> a1 v1
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> discard
OK

<span class="token comment">#失败情况</span>
<span class="token comment">#组队阶段错误</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k1 v1
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> get k2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k3
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR wrong number of arguments <span class="token keyword">for</span> <span class="token string">'set'</span> <span class="token builtin class-name">command</span>
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> EXECABORT Transaction discarded because of previous errors.
<span class="token comment">#exec阶段错误</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k2 v2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> incr k2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> OK
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR value is not an integer or out of range
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 

</code></pre> 
<h6><a id="_897"></a>解决事务冲突思路</h6> 
<ul><li>理解层次上的</li><li>悲观锁 
  <ul><li>谁用之前先上锁，别的账户就用不了了，用完之后再解锁</li></ul> </li><li>乐观锁 
  <ul><li>不上锁，但是类似有一种版本号，大家都能拿到数据，谁用到了就更新版本，其他用户用之前先匹配版本号一不一样，一样的话就用，不一样的话就更新</li></ul> </li><li>举个例子，火车高铁抢票软件，</li></ul> 
<h6><a id="_906"></a>乐观锁举例</h6> 
<ul><li><code>watch key</code></li></ul> 
<pre><code class="prism language-bash"><span class="token comment">#会话一</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> balance <span class="token number">100</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  <span class="token function">watch</span> balance
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> incrby balance <span class="token number">19</span>
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">119</span>
<span class="token comment">#会话二</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k2"</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"balance"</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">watch</span> balance
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> incrby balance <span class="token number">17</span>
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token punctuation">(</span>nil<span class="token punctuation">)</span>
</code></pre> 
<h6><a id="redis_938"></a>redis事务三特性</h6> 
<ul><li>单独的隔离操作 
  <ul><li>所有的命令被序列化，按顺序执行，不会被其他客户端发送来的命令请求打断</li></ul> </li><li>没有隔离级别的概念 
  <ul><li>队列中的命令没有提交之前都不会被实际执行，因为任何事务提交前都不会被实际执行</li></ul> </li><li>不保证原子性 
  <ul><li>当有一条命令执行失败，其后的命令仍然会被执行，没有回滚</li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/31fcac85ebf5d86c28068b9d094d4ae6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Comodo证书的价格</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/06bf4b8a1154d565dcaa42fc6e85fd2d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;读取，修改excel表格数据，重命名excel表格</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>