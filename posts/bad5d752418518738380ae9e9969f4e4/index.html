<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel-宏、VBA - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Excel-宏、VBA" />
<meta property="og:description" content="文章目录 1 什么是VBA2 宏2.1 打开Excel的开发工具功能2.2 初级宏2.3 使用相对引用2.4 制作工资条2.5 添加表单控件 3 VBA3.1 VBA编码语法3.2 变量3.2.1 定义变量3.2.2 变量名的命名规则3.2.3 变量的赋值 3.3 数据类型3.4 常量3.5 运算符3.5.1 算术操作符3.5.2 比较运算符3.5.3 逻辑运算符3.5.4 连接操作符3.5.5 运算符优先级 3.6 MsgBox3.7 获取要操作的数据表3.8 单元格的基本操作3.9 三大结构3.9.1 顺序结构3.9.2 选择结构3.9.3 循环结构 3.10 数组3.10.1 数组的创建3.10.2 数组元素的操作3.10.3 利用循环对数组元素进行赋值和遍历3.10.4 数组常用的方法3.10.5 多维数组 3.11 函数 1 什么是VBA VBA是一种编程语言，它依托于Office软件，不能独立运行，通过VBA可以实现各种Office软件操作的自动化。通俗易懂的来说就是在Excel中想实现什么功能，就可以通过VBA语言编写的程序区实现。
2 宏 2.1 打开Excel的开发工具功能 2.2 初级宏 给成绩不及格的单元格标红
录制宏：开发工具-录制宏-添加宏名“不及格的成绩”-快捷键（可以设置快捷键，这里没有设置）-保存在（一般选择当前工作簿）-说明（可以添加这个宏的说明信息）
录制宏开始，所有的操作都会被记录
点击一个空白单元格-条件格式-突出显示-小于
设定小于60分的用浅红色填充
停止录制红选中需要筛选不及格成绩的列-点击“宏”
结果
2.3 使用相对引用 给A列的单元个标红，并且每执行一次，选中的单元格下移一次 选中A1单元格-点击“使用相对引用”-录制宏
将A1单元格的改为红色文本-选中A2单元格
因为宏会记录鼠标的所有操作，所以如果想更改一个单元格后让选中的单元格下移一个，这一步就很关键
执行宏
执行结果：每标红一次，光标下移一行
2.4 制作工资条 源数据目标数据" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/bad5d752418518738380ae9e9969f4e4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-11T22:33:55+08:00" />
<meta property="article:modified_time" content="2019-04-11T22:33:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Excel-宏、VBA</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#1_VBA_1" rel="nofollow">1 什么是VBA</a></li><li><a href="#2__4" rel="nofollow">2 宏</a></li><li><ul><li><a href="#21_Excel_5" rel="nofollow">2.1 打开Excel的开发工具功能</a></li><li><a href="#22__7" rel="nofollow">2.2 初级宏</a></li><li><a href="#23__22" rel="nofollow">2.3 使用相对引用</a></li><li><a href="#24__33" rel="nofollow">2.4 制作工资条</a></li><li><a href="#25__53" rel="nofollow">2.5 添加表单控件</a></li></ul> 
    </li><li><a href="#3_VBA_67" rel="nofollow">3 VBA</a></li><li><ul><li><a href="#31_VBA_68" rel="nofollow">3.1 VBA编码语法</a></li><li><a href="#32__75" rel="nofollow">3.2 变量</a></li><li><ul><li><a href="#321__77" rel="nofollow">3.2.1 定义变量</a></li><li><a href="#322__92" rel="nofollow">3.2.2 变量名的命名规则</a></li><li><a href="#323__104" rel="nofollow">3.2.3 变量的赋值</a></li></ul> 
     </li><li><a href="#33__116" rel="nofollow">3.3 数据类型</a></li><li><a href="#34__129" rel="nofollow">3.4 常量</a></li><li><a href="#35___148" rel="nofollow">3.5 运算符</a></li><li><ul><li><a href="#351__149" rel="nofollow">3.5.1 算术操作符</a></li><li><a href="#352__156" rel="nofollow">3.5.2 比较运算符</a></li><li><a href="#353__163" rel="nofollow">3.5.3 逻辑运算符</a></li><li><a href="#354__175" rel="nofollow">3.5.4 连接操作符</a></li><li><a href="#355__180" rel="nofollow">3.5.5 运算符优先级</a></li></ul> 
     </li><li><a href="#36_MsgBox_182" rel="nofollow">3.6 MsgBox</a></li><li><a href="#37__206" rel="nofollow">3.7 获取要操作的数据表</a></li><li><a href="#38__216" rel="nofollow">3.8 单元格的基本操作</a></li><li><a href="#39__228" rel="nofollow">3.9 三大结构</a></li><li><ul><li><a href="#391__229" rel="nofollow">3.9.1 顺序结构</a></li><li><a href="#392__231" rel="nofollow">3.9.2 选择结构</a></li><li><a href="#393__301" rel="nofollow">3.9.3 循环结构</a></li></ul> 
     </li><li><a href="#310__461" rel="nofollow">3.10 数组</a></li><li><ul><li><a href="#3101__463" rel="nofollow">3.10.1 数组的创建</a></li><li><a href="#3102__467" rel="nofollow">3.10.2 数组元素的操作</a></li><li><a href="#3103__471" rel="nofollow">3.10.3 利用循环对数组元素进行赋值和遍历</a></li><li><a href="#3104__511" rel="nofollow">3.10.4 数组常用的方法</a></li><li><a href="#3105__527" rel="nofollow">3.10.5 多维数组</a></li></ul> 
     </li><li><a href="#311__590" rel="nofollow">3.11 函数</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="1_VBA_1"></a>1 什么是VBA</h4> 
<p>VBA是一种编程语言，它依托于Office软件，不能独立运行，通过VBA可以实现各种Office软件操作的自动化。通俗易懂的来说就是在Excel中想实现什么功能，就可以通过VBA语言编写的程序区实现。</p> 
<h4><a id="2__4"></a>2 宏</h4> 
<h5><a id="21_Excel_5"></a>2.1 打开Excel的开发工具功能</h5> 
<p><img src="https://images2.imgbox.com/82/49/MlUvlSZ6_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="22__7"></a>2.2 初级宏</h5> 
<ul><li>给成绩不及格的单元格标红<br> <img src="https://images2.imgbox.com/cd/c0/vs174JZA_o.png" alt="在这里插入图片描述"></li></ul> 
<ol><li>录制宏：开发工具-录制宏-添加宏名“不及格的成绩”-快捷键（可以设置快捷键，这里没有设置）-保存在（一般选择当前工作簿）-说明（可以添加这个宏的说明信息）<br> <img src="https://images2.imgbox.com/df/80/cbbdSgRA_o.png" alt="在这里插入图片描述"></li><li>录制宏开始，所有的操作都会被记录<br> 点击一个空白单元格-条件格式-突出显示-小于<br> <img src="https://images2.imgbox.com/23/a4/alYWbOn5_o.png" alt="在这里插入图片描述"><br> 设定小于60分的用浅红色填充<br> <img src="https://images2.imgbox.com/55/77/rrUmnwFF_o.png" alt="在这里插入图片描述"></li><li>停止录制红</li><li>选中需要筛选不及格成绩的列-点击“宏”<br> <img src="https://images2.imgbox.com/4d/47/Z8eOiWXa_o.png" alt="在这里插入图片描述"></li><li>结果<br> <img src="https://images2.imgbox.com/48/10/gQ2nQju6_o.png" alt="在这里插入图片描述"></li></ol> 
<h5><a id="23__22"></a>2.3 使用相对引用</h5> 
<ul><li>给A列的单元个标红，并且每执行一次，选中的单元格下移一次</li></ul> 
<ol><li>选中A1单元格-点击“使用相对引用”-录制宏<br> <img src="https://images2.imgbox.com/e1/3d/43AMi295_o.png" alt="在这里插入图片描述"></li><li>将A1单元格的改为红色文本-<strong>选中A2单元格</strong><br> <em>因为宏会记录鼠标的所有操作，所以如果想更改一个单元格后让选中的单元格下移一个，这一步就很关键</em><br> <img src="https://images2.imgbox.com/a8/d1/Smywr7ns_o.png" alt="在这里插入图片描述"></li><li>执行宏<br> <img src="https://images2.imgbox.com/09/e5/a4Vb7dkS_o.png" alt="在这里插入图片描述"></li><li>执行结果：每标红一次，光标下移一行<br> <img src="https://images2.imgbox.com/42/ec/M4VojDD5_o.png" alt="在这里插入图片描述"></li></ol> 
<h5><a id="24__33"></a>2.4 制作工资条</h5> 
<ul><li>源数据<img src="https://images2.imgbox.com/0c/a8/apbLfQW7_o.png" alt="在这里插入图片描述"></li><li>目标数据<br> <img src="https://images2.imgbox.com/1d/70/1Ylie2gx_o.png" alt="在这里插入图片描述"><br> 1.录制宏：<br> 选中A1单元格-使用相对引用-录制宏-宏名“制作工资条”<br> <img src="https://images2.imgbox.com/72/41/Fk0XHGry_o.png" alt="在这里插入图片描述"><br> 2.宏的内容<br> （1）选中第二和第三行-右键-插入-活动单元格下移</li></ul> 
<p><img src="https://images2.imgbox.com/4c/fb/23l6qmbY_o.png" alt="在这里插入图片描述"><br> （2）复制第一行工资条列头至第四行<br> <img src="https://images2.imgbox.com/d7/1d/2QuA6ozb_o.png" alt="在这里插入图片描述"><br> （3）选中第三行-右键-设置单元格格式-边框-取消左右竖线<br> <img src="https://images2.imgbox.com/2a/d7/YMym0udB_o.png" alt="在这里插入图片描述"><br> （4）将鼠标选中A4单元格-停止录制-取消使用相对引用<br> <img src="https://images2.imgbox.com/42/6f/xBzT67kt_o.png" alt="在这里插入图片描述"><br> 3. 执行<br> 选中A1单元格-制作工资条<br> <img src="https://images2.imgbox.com/a2/fb/gCcW0Ll6_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="25__53"></a>2.5 添加表单控件</h5> 
<p><img src="https://images2.imgbox.com/ea/61/ZEu4YBSy_o.png" alt="在这里插入图片描述"><br> 指定-制作工资条<br> <img src="https://images2.imgbox.com/39/87/kRKtF1Rk_o.png" alt="在这里插入图片描述"><br> 这样，点击按钮就会执行宏<br> <img src="https://images2.imgbox.com/b9/11/XuQSpG2Y_o.png" alt="在这里插入图片描述"><br> 但是这样还是点击一次，生成一行，如果想一键生成怎么办<br> 点击Visual Basic<br> <img src="https://images2.imgbox.com/45/35/UXgJ7TQb_o.png" alt="在这里插入图片描述"><br> 添加循环</p> 
<p><img src="https://images2.imgbox.com/b6/97/i6BH58Rs_o.png" alt="在这里插入图片描述"><br> 一键生成<br> <img src="https://images2.imgbox.com/4c/31/XsI1cVRB_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_VBA_67"></a>3 VBA</h4> 
<h5><a id="31_VBA_68"></a>3.1 VBA编码语法</h5> 
<ul><li>VBA的代码的开始和结束</li></ul> 
<p>Sub 代码名称()<br> 代码内容<br> End Sub</p> 
<h5><a id="32__75"></a>3.2 变量</h5> 
<p>所谓变量就是内存开辟出来的用于存储数据的存储单元</p> 
<h6><a id="321__77"></a>3.2.1 定义变量</h6> 
<p>方法1：dim 变量名 as 数据类型<br> 方法2：dim 变量名 as 数据类型，变量名 as 数据类型<br> 方法3：dim 变量名，变量名 as 数据类型 （）<br> 方法4：dim 变量名+数据类型符</p> 
<pre><code>Sub 变量测试()

Dim i As Integer
Dim i1 As Integer, str As String
Dim i2, i3 As Integer
Dim i4%

End Sub
</code></pre> 
<h6><a id="322__92"></a>3.2.2 变量名的命名规则</h6> 
<ul><li>由字母、数字、下划线以及汉字构成</li><li>只能以字母或汉字开头，不可以是数字或者下划线开头</li><li>长度不可以超过255个字符</li><li>不可以使用VBA中的关键字</li><li>见名知意</li><li>不建议使用汉字</li><li>变量名的后面可以添加一个符号，表示该变量盛装的数据的类型，常用符号：%、&amp;、#、$、！</li></ul> 
<p><strong>注意</strong></p> 
<ol><li>变量名字不要重复</li><li>VBA中变量可以不声明就使用，但是不建议，如果不声明就使用，那么该变量里面可以盛装任意类型的数据</li></ol> 
<h6><a id="323__104"></a>3.2.3 变量的赋值</h6> 
<ul><li>格式1：变量名 = 值</li><li>格式2：如果变量要盛装的是对象，如工作表，单元格，可以使用如下格式set 变量名 = 对象，如<br> 1.第一步：定义变量，存储对象：Dim 变量名 As WorkSheet<br> 2.第二步：为变量赋值一个工作表（被激活的工作表）：set sht = ActiveSheet</li><li>注意1：如果要将数据表对象赋值给一个变量，那么也可以使用如下格式<br> 1.set 变量名 = Sheets（数据表的编号）<br> 2.set 变量名 = Sheets（数据表的名称）</li><li>注意2：如果标量声明但是没有被赋值，那么默认情况下：<br> 1.整数默认值为0<br> 2.字符串为空串<br> 3.布尔值为false</li></ul> 
<h5><a id="33__116"></a>3.3 数据类型</h5> 
<table><thead><tr><th>数据类型</th><th>类型关键字</th><th>类型符</th><th>前缀</th><th>存储空间</th><th>取值范围</th></tr></thead><tbody><tr><td>字节型</td><td>Byte</td><td>无</td><td>Byt</td><td>1字节</td><td></td></tr><tr><td>整型</td><td>Integer</td><td>%</td><td>Int</td><td>2字节</td><td>-32768~32767</td></tr><tr><td>长整型</td><td>Long</td><td>&amp;</td><td>Lng</td><td>4字节</td><td>-2147483648~2147483647</td></tr><tr><td>单精度型</td><td>Single</td><td>！</td><td>Sng</td><td>4字节</td><td>负数-3.402823E38~-1.401298E-45正数1.401298E-45~3.402823E38</td></tr><tr><td>双精度型</td><td>Double</td><td>#</td><td>Dbl</td><td>8字节</td><td>负数-1.79769313486232E308~-4.9406545841247E-324正数4.9406545841247E-324~1.79769313486232E308</td></tr><tr><td>货币型</td><td>Currency</td><td>@</td><td>Cur</td><td>8字节</td><td>-922337203685477.5808~922337203685477.5808</td></tr><tr><td>字符串型</td><td>String</td><td>$</td><td>Str</td><td>暂不定</td><td>定长字符串可包含0个字符~2<sup>16</sup>个字符，变长字符串可包含0个字符~3<sup>31</sup>个字符</td></tr><tr><td>布尔型</td><td>Boolean</td><td>无</td><td>Bln</td><td>2字节</td><td>True或False</td></tr><tr><td>日期型</td><td>Date</td><td>无</td><td>Dtm</td><td>8字节</td><td>100年1月1日~9999年12月31日</td></tr></tbody></table> 
<h5><a id="34__129"></a>3.4 常量</h5> 
<p>所谓常量就是程序运行过程中值不可以改变的量，简单说常量就是程序中的具体数值</p> 
<p>注意事项如下</p> 
<ol><li>字符串：VBA中的字符串需要使用双引号包起来</li><li>日期/时间类型：</li></ol> 
<ul><li>日期型数据用8个字节来存储，日期数据要用#号括起来</li><li>允许用各种表示日期和时间的格式</li><li>日期可用“/”、“，”、“-”分隔，可以是年、月、日，也可以是月、日、年的顺序。时间必须用“：”分隔，顺序是：时、分、秒。</li></ul> 
<pre><code>#2009-08-11 10：25：00 PM#
#03/23/2019#
#03-25-2008 20：30：00#
</code></pre> 
<p>3）布尔型数据（Boolean）：</p> 
<ul><li>布尔型数据只有两个值：TRUE和False，用2个字节存储</li><li>布尔型数据转化为数值型时，False为0，True为-1</li><li>其他数据类型转换为逻辑型时，0转换为False，其他值均转换为True</li></ul> 
<h5><a id="35___148"></a>3.5 运算符</h5> 
<h6><a id="351__149"></a>3.5.1 算术操作符</h6> 
<ul><li>+ : 两个操作数相加</li><li>-: 两个操作数相减</li><li>*: 两个操作数相乘</li><li>/ : 两个操作数相除</li><li>mod: 模运算符，整数除法后的余数，结果的符号和被除数相同</li><li>^ : 指数运算符</li></ul> 
<h6><a id="352__156"></a>3.5.2 比较运算符</h6> 
<ul><li>= : 检查两个操作数的值是否相等。如果是，那么条件是真。</li><li>&lt;&gt; : 检查两个操作数的值是否不相等。如果值不相等，则条件为真。</li><li>&gt; : 检查左操作数的值是否大于右操作数的值。如果是，那么条件是真。</li><li>&lt; : 检查左操作数的值是否小于右操作数的值。如果是，那么条件是真。</li><li>&gt;= : 检查左操作数的值是否大于或等于右操作数的值。 如果是，那么条件是真。</li><li>&lt;= : 检查左操作数的值是否小于或等于右操作数的值。如果是，那么条件是真。</li></ul> 
<h6><a id="353__163"></a>3.5.3 逻辑运算符</h6> 
<ul><li>AND : 两个条件都为真，则表达式为真。（只要有一个操作数是假结果就是假）<br> 1.真 and 真 = 真<br> 2.真 and 假 = 假<br> 3.假 and 真 = 假<br> 4.假 and 假 = 假</li><li>OR : 如果两个条件中的任何一个为真，则条件为真。<br> 1.真 or 真 = 真<br> 2.真 or 假 = 真<br> 3.假 or 真 = 真<br> 4.假 or 假 = 假</li><li>NOT : 用于反转其操作数的逻辑状态。 如果条件成立，那么逻辑非运算符结果是条件不成立。</li></ul> 
<h6><a id="354__175"></a>3.5.4 连接操作符</h6> 
<ul><li>&amp; : 连接两个值<br> 示例1：1 &amp; 2 = 12<br> 示例2：“1” &amp; “2” = 12</li><li>+ : 将两个值添加为变量，其值是数字，注意如果+两侧的操作数都是字符类型的字符串，如”a”、”b”，那么+就具有连接功能，但是如果操作数中有数值类型的字符串，那么会有转型效果，即将字符串转换为数值在进行运算（注意操作数中有且只有一个数值构成的字符串，即如”1”+2，如果都是字符串，如”1”+”2”，那么也是直接拼接，结果为12）</li></ul> 
<h6><a id="355__180"></a>3.5.5 运算符优先级</h6> 
<p><strong>算术运算符&gt;连接运算符&gt;关系运算符&gt;逻辑运算符</strong></p> 
<h5><a id="36_MsgBox_182"></a>3.6 MsgBox</h5> 
<pre><code>Sub Text()
Dim i%
Dim bool As Boolean
bool = True
MsgBox bool + 1, vbOKCancel, "bool+1的值"
'      显示的内容，显示的按钮，标题
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/85/e8/j133cdYw_o.png" alt="在这里插入图片描述"></p> 
<pre><code>Sub Text()
Dim i%
Dim bool As Boolean
bool = True
'MsgBox bool + 1, vbOKCancel, "bool+1的值"
'      显示的内容，显示的按钮，标题
i = 2 + 9
MsgBox (i)
End Sub
</code></pre> 
<p>如果MsgBox里只填显示的内容，标题时默认的，按钮时默认的只显示“确定”<br> <img src="https://images2.imgbox.com/41/9d/UaDsUyp2_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="37__206"></a>3.7 获取要操作的数据表</h5> 
<ul><li>格式1：</li></ul> 
<ol><li>声明变量：dim 变量名 as Worksheet</li><li>为变量赋值：set 变量名 = Sheets（数据表编号），注意一个工作簿中的数据表时从1开始编号的</li></ol> 
<ul><li>格式2</li></ul> 
<ol><li>声明变量：dim 变量名 as Worksheet</li><li>为变量赋值：set 变量名 = Sheets（数据表名称），注意一个工作簿中的数据表时从1开始编号的</li></ol> 
<ul><li>格式</li></ul> 
<ol><li>声明变量：dim 变量名 as Worksheet</li><li>为变量赋值：set 变量名 = Activesheet</li></ol> 
<h5><a id="38__216"></a>3.8 单元格的基本操作</h5> 
<ul><li>获取单元格的值</li></ul> 
<ol><li>Sheets（表名/表的编号）.range(“单元格名称”)</li><li>Sheets（表名/表的编号）.[单元格名称]</li><li>Sheets（表名/表的编号）.Cells(行号，列号)</li></ol> 
<ul><li>为单元格赋值</li></ul> 
<ol><li>Sheets（表名/表的编号）.range(“单元格名称”).value = 值</li><li>Sheets（表名/表的编号）.[单元格名称] .value = 值</li><li>Sheets（表名/表的编号）.Cells(行号，列号) .value = 值</li></ol> 
<ul><li>为单元格设置颜色：Sheets（表名/表的编号）.range(“单元格名称”).interior.ColorIndex = 数值，数值范围为1-56</li><li>复制单元格中的内容：Sheets（表名/表的编号）.range(“单元格名称”).copy Range(要放置的位置)</li><li>剪切单元格中的内容：Sheets（表名/表的编号）.range(“单元格名称”).cut Range(要放置的位置)</li></ul> 
<h5><a id="39__228"></a>3.9 三大结构</h5> 
<h6><a id="391__229"></a>3.9.1 顺序结构</h6> 
<p>顺序结构就是指程序自上而下执行，不经任何跳转</p> 
<h6><a id="392__231"></a>3.9.2 选择结构</h6> 
<p>程序在执行前会判断条件是否成立，如果条件成立则执行某个语句段，如果条件不成立，可以执行其它的语句段<br> 包含两大语句if、select<br> (一) if语句</p> 
<ul><li>单分支：所谓单分支即只考虑条件成立时的情况</li></ul> 
<pre><code>Sub test1()
Dim i%
i = 5
If i &gt; 0 Then
    MsgBox ("i是正数")
End If
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/15/4b/2m8jiqLa_o.png" alt="在这里插入图片描述"></p> 
<ul><li>双分支</li></ul> 
<pre><code>Sub test1()
Dim i%
i = -5
If i &gt; 0 Then
    MsgBox ("i是正数")
Else
    MsgBox ("i是负数")
End If
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/4b/66/fi3WbXeF_o.png" alt="在这里插入图片描述"></p> 
<ul><li>多分支：注意else可以省略</li></ul> 
<pre><code>Sub test1()
Dim i%
i = 50
If i &gt; 90 Then
    MsgBox ("A")
ElseIf i &gt; 70 Then
    MsgBox ("B")
ElseIf i &gt; 60 Then
    MsgBox ("C")
Else
    MsgBox ("D")
End If
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/74/d7/pWievVfh_o.png" alt="在这里插入图片描述"></p> 
<ul><li>select语句</li></ul> 
<pre><code>Sub test1()
Dim i%
i = 1
Select Case i
    Case 1 To 5
        MsgBox ("weekday")
    Case 6, 7
        MsgBox ("weekend")
    Case Else
        MsgBox ("error!!!!!")
End Select
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/a9/ed/NLW4eMei_o.png" alt="在这里插入图片描述"><br> Case表达式可以是下列4种格式之一：</p> 
<ul><li>单一数值，如Case2</li><li>一行并列的数值，数值之间用逗号隔开。如Case 5，6，7</li><li>用关键字To分隔开两个数之或表达式之间的范围。如Case 1 To 10</li><li>用关键字ls连接关系运算符。如=、&lt;&gt;、&lt;、&lt;=、&gt;、&gt;=，后面跟变量或具体的值，ls&gt;=15</li></ul> 
<p>Case语句是依次测试的，并执行第一个符合Case条件的相关的程序代码，即使再有其它符合条件的分支也不会再执行。如果没有找到复合条件的，并且有Case Else语句，就会执行该语句后面的程序代码。</p> 
<h6><a id="393__301"></a>3.9.3 循环结构</h6> 
<ul><li>所谓循环结构就是指能够重复执行的代码段</li><li>格式<br> for 变量=起始值 to 终止值 step 步长值<br> 循环体<br> next 变量</li><li>注意事项</li></ul> 
<ol><li>step可以省略，如果省略，默认为步长为1</li><li>next后面的变量也可以省略，但是不建议，next的作用就是表示对next后面的变量做修正</li></ol> 
<ul><li>常用思想</li></ul> 
<ol><li>累加算法：sum sum = 0 sum = sum + i</li><li>累乘算法：p p = 1 p = p * i</li><li>计数器：count count = 0 count = count + 1</li></ol> 
<pre><code>1.打印1-10到a1-a10单元格
Sub text()
Dim i%
For i = 1 To 10
    Sheets("sheet2").Range("a" &amp; i).Value = i
Next i
End Sub


2.打印1-10间的偶数
Sub text()
Dim i%
For i = 1 To 10
	if (i mod 2)=0 then
    	Sheets("sheet2").Range("b" &amp; i/2).Value = i
    end if
Next i
End Sub



3.打印1-100间能被3和7同时整除的数
Sub text()
Dim i%
For i = 1 To 100
	if (i mod 3)=0 and (i mod 7)=0 then
    	msgbox(i)
    end if
Next i
End Sub



4.打印1-10的和
Sub text()
Dim i%
Dim s%
s = 0
For i = 1 To 10
	s = s + i
Next i
msgbox(s)
End Sub



5.打印1-10间偶数的和
Sub 打印1-10间偶数的和()
Dim i%
Dim s%
s = 0
For i = 1 To 10
    If (i Mod 2) = 0 Then
        s = s + i
    End If
Next i
MsgBox (s)
End Sub



6.打印5! = 5*4*3*2*1
Sub text()
Dim i%
Dim s%
s = 1
For i = 1 To 5
    s = s * i
Next i
MsgBox (s)
End Sub



7.计算1-10间偶数的个数
Sub text()
Dim i%
Dim c%
c = 0
For i = 1 To 10
    If (i Mod 2) = 0 Then
        c = c + 1
    End If
Next i
MsgBox (c)
End Sub


8.2-99之间能整除3的数字之和
Sub text()
Dim i%
Dim a%
a = 0
For i = 2 To 99
    If (i Mod 3) = 0 Then
        a = a + i
    End If
Next i
MsgBox (a)
End Sub


9.求1-10偶数的平均分
Sub text()
Dim i%
Dim c%
c = 0
s = 0
For i = 1 To 10
    If (i Mod 2) = 0 Then
        s = s + i
        c = c + 1
    End If
Next i
MsgBox (s / c)
End Sub



10.计算1*1 + 2*2 + 3*3 +4*4 + 5*5 +...+ 10*10的和
Sub text()
Dim i%
Dim j%
Dim s%
s = 0
For i = 1 To 10
    j = i
    s = s + i * j
Next i
MsgBox (s)
End Sub



11.实现九九乘法表
sub text()
For a = 1 To 9
    For b = 1 To 9
        If a &gt;= b Then
        Sheets("Sheet2").Cells(a, b).Value = (a &amp; "*" &amp; b &amp; "=" &amp; a * b)
        End If
    Next b
Next a
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/3e/7b/E2MlzuMX_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="310__461"></a>3.10 数组</h5> 
<p>数组就是用来存储大量的数据的存储空间，数组在存储数据时是有序存储。数组中的每一个值被称为数组元素，每一个数组元素都有一个编号（即索引，也可以称为下标），从0开始到数组长度-1为止</p> 
<h6><a id="3101__463"></a>3.10.1 数组的创建</h6> 
<ol><li>格式1：Dim 数组名（上界） as 数组中存储的数据的类型，示例：Dim arr(4) as Integer<br> <em>arr（4）里有5个数据，即a[0],a[1],…,a[4]</em></li><li>格式2：数组名 = Array(值1，值2，值3…)</li></ol> 
<h6><a id="3102__467"></a>3.10.2 数组元素的操作</h6> 
<ol><li>赋值：数组名(下标) = 值</li><li>修改：数组名（下标） = 值</li><li>获取值：数组名（下标）</li></ol> 
<h6><a id="3103__471"></a>3.10.3 利用循环对数组元素进行赋值和遍历</h6> 
<pre><code class="prism language-vb">Sub text()
'数组定义的第一种方法
'dim 数组名（数组长度） as 数据类型
'数组内的元素的数据类型必须相同
'Dim arr(3) As Integer
'Dim i%
'arr(0) = 1
'arr(1) = 2
'arr(2) = 3
'For i = 0 To 2
'    MsgBox (arr(i))
'Next i

'第二种定义方式
Dim i%
arr = Array(1, 2, 3)
'修改数组元素
arr(0) = 5
For i = 0 To 2
    MsgBox (arr(i))
Next i
End Sub
</code></pre> 
<pre><code class="prism language-vb">Sub text()
Dim arr(10) As Integer
Dim i%
'为数组赋值，将A1-A10单元格种的值赋给数组
For i = 0 To 9
    arr(i) = Cells(i + 1, 1)
Next i
'利用循环输出数组里面的值
'遍历数组
For i = 0 To 9
    MsgBox (arr(i))
Next i
End Sub
</code></pre> 
<h6><a id="3104__511"></a>3.10.4 数组常用的方法</h6> 
<ul><li>lbound</li></ul> 
<ol><li>格式：Lbound（数组名）</li><li>作用：返回数组的最小下标</li></ol> 
<ul><li>Ubound</li></ul> 
<ol><li>格式：Ubound（数组名）</li><li>作用：返回数组的最大下标，即上界</li></ol> 
<pre><code class="prism language-vb">Sub text()
Dim i%
arr = Array(1, 2, 4, 5, 8)
For i = LBound(arr) To UBound(arr)
    MsgBox (arr(i))
Next i
End Sub
</code></pre> 
<h6><a id="3105__527"></a>3.10.5 多维数组</h6> 
<p>定义格式：Dim 数组名（行数，列数） as 数据类型</p> 
<ul><li>二维数组元素的操作</li></ul> 
<p>格式：数组名(下标1，下标2)，注意：下标1表示行数，下标2表示列数，无论行还是列都是从0开始，到长度-1结束</p> 
<pre><code class="prism language-vb">Sub text()
'二维数组的定义方式
'dim 数组名（数组下标1，数组下标2） as 数据类型
Dim arr(3, 3) As Integer
Dim i%, j%
arr(0, 0) = 1
arr(1, 0) = 2
arr(2, 0) = 3
arr(0, 1) = 4
arr(1, 1) = 5
arr(2, 1) = 6
arr(0, 2) = 6
arr(1, 2) = 7
arr(2, 2) = 8
For i = 0 To 2
    For j = 0 To 2
        MsgBox (arr(i, j))
    Next j
Next i
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/79/4c/xE61OXDG_o.png" alt="在这里插入图片描述"></p> 
<ul><li>打印单元格里的数组的内容</li></ul> 
<pre><code class="prism language-vb">Sub text1()
    Dim arr(3, 3), i, j As Integer
    For i = 0 To 2
        For j = 0 To 2
            arr(i, j) = Cells((i + 1), (j + 1))
        Next j
    Next i
    
    For i = 0 To 2
        For j = 0 To 2
            MsgBox (arr(i, j))
        Next j
    Next i
End Sub
</code></pre> 
<ul><li>打印对角线<br> <img src="https://images2.imgbox.com/4c/0e/s7p7vn3z_o.png" alt="在这里插入图片描述"></li></ul> 
<pre><code class="prism language-vb">Sub text2()
    Dim arr(3, 3), i, j As Integer
    For i = 0 To 2
        For j = 0 To 2
            arr(i, j) = Cells((i + 1), (j + 1))
        Next j
    Next i
    
    For i = 0 To 2
        MsgBox (arr(i, i))
    Next i
End Sub
</code></pre> 
<h5><a id="311__590"></a>3.11 函数</h5> 
<ul><li>什么是函数：具有特定功能的模块</li><li>函数的分类：无参函数有返回值函数、有参函数有返回值函数</li><li>无参函数定义格式：<br> Function 函数名（） as 数据类型<br> 函数体<br> 函数名 = 函数运行后的结果<br> end Function</li><li>无参函数的调用：函数名（），调用语句可以写在excel表格内部，也可以在sub中调用</li></ul> 
<pre><code class="prism language-vb">Function fn()
    fn = "hello world"
End Function

Sub test1()
'调用fn种的内容
    MsgBox (fn())
End Sub
</code></pre> 
<ul><li>有参函数的定义格式：<br> function 函数名（形参1 as 数据类型，形参2 as 数据类型….） as 数据类型<br> 函数体<br> 函数名 = 结果<br> End Function</li><li>有参函数的调用：函数名（实参1，实参2…），调用语句可以写在excel表格内部，也可以在sub中调用</li></ul> 
<pre><code class="prism language-vb">Function fn() As String
    fn = "hello world"
End Function

Sub test1()
'调用fn中的内容
    MsgBox (fn())
End Sub
</code></pre> 
<ul><li>什么是实参和形参</li></ul> 
<ol><li> <p>形参：定义函数时所使用的参数被称为形参，形参的本质就是用来存储函数调用时传递过来的具体数据，简答说形参就是变量，定义格式：（形参名1 as 数据类型，形参名2 as 数据类型…. ）</p> </li><li> <p>实参：调用函数时传递过来的具体的数据被称为实参，格式：函数名（实参1，实参2…）</p> </li></ol> 
<pre><code class="prism language-VB">'                  形参
Function fn(num1, num2 As Integer) As Integer
    Dim sum%
    sum = num1 + num2
    fn = sum
End Function
Sub getSum()
'                  实参
    MsgBox (fn(1, 2))
End Sub
</code></pre> 
<p><em>在sheet中调用</em><br> <img src="https://images2.imgbox.com/00/5c/YGiXMlEG_o.png" alt="在这里插入图片描述"><br> <strong>注意：需要在Visual Basic中插入一个模块，将函数写在该模块中，就可以在单元格中直接调用自己写好的函数啦</strong></p> 
<ul><li>形参和实参的关系</li></ul> 
<ol><li>实参传递给形参，只能是单向传递</li><li>实参在传递时和形参是一一对应的关系</li></ol> 
<ul><li>计算单元格A1-A10的和和平均数<br> <img src="https://images2.imgbox.com/4c/7a/tOiNSVp0_o.png" alt="在这里插入图片描述"></li></ul> 
<pre><code class="prism language-vb">Function fn(arr)
    Dim i%, sum%, max%, min%, avg As Double
    sum = 0
    For i = 0 To UBound(arr)
        sum = arr(i) + sum
    Next i
    
    avg = sum / (UBound(arr) + 1)
    
    max = arr(0)
    For i = 0 To UBound(arr)
        If max &lt; arr(i) Then
            max = arr(i)
        End If
    Next i
    
    min = arr(0)
    For i = 0 To UBound(arr)
        If min &gt; arr(i) Then
            min = arr(i)
        End If
    Next i
    
    fn = "sum is :" &amp; sum &amp; "," &amp; "avg is " &amp; avg &amp; "," &amp; "max is :" &amp; max &amp; "," &amp; "min is :" &amp; min
    
End Function
Sub test2()
Dim my_arr(9), i As Integer
For i = 0 To UBound(my_arr)
    my_arr(i) = Cells(i + 1, 1)
Next i
MsgBox (fn(my_arr))
End Sub
</code></pre> 
<p><img src="https://images2.imgbox.com/1f/ca/n4i08zoC_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7eba29800dc533356468d5a73f49259e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">cuda9.0--cudnn7.1下载地址（百度云）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3275f37bb877c1a612bb61b3c708efb7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">设计模式怎样解决设计问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>