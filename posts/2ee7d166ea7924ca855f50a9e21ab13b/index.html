<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>批量归一化：彻底改变深度学习架构 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="批量归一化：彻底改变深度学习架构" />
<meta property="og:description" content="一、介绍 在深度学习的动态领域，批量归一化的引入标志着神经网络训练方法的关键转变。这项创新技术由 Sergey Ioffe 和 Christian Szegedy 在 2015 年提出，已成为现代神经网络架构的基石。它解决了训练深度网络的关键挑战，特别是处理臭名昭著的内部协变量偏移问题。本文旨在阐明批量归一化的概念、其对深度网络训练的深远影响及其在各种应用中的实际意义。
在神经计算领域，批量归一化类似于风暴中的指南针，可以稳定学习算法在内部协变量变化的汹涌海洋中的航行。
二、了解批量归一化 批量归一化的核心是一种用于标准化神经网络中某一层的输入的技术。它的工作原理是通过减去批次均值并将其除以批次标准差来标准化先前激活层的输出。因此，这种归一化过程确保后续层的输入具有稳定的分布，从而促进更平滑和更快的训练过程。
批量归一化是神经网络中使用的一种技术，用于标准化每个小批量的层输入。这具有稳定学习过程并显着减少训练深度网络所需的训练周期数的效果。
以下是其工作原理的更详细分解：
归一化：对于每个特征，均值和方差是在小批量上计算的。然后，根据该均值和方差对特征进行归一化。缩放和平移：归一化后，使用在训练过程中学习到的两个参数 γ（缩放）和 β（平移）对特征进行缩放和平移。此步骤至关重要，因为标准化过程有时会以网络无法学习的方式改变特征的表示。如果需要最大程度地减少损失，则缩放和移位允许网络撤消标准化。改进训练：批量归一化允许网络的每一层独立于其他层学习更多一点。它还有助于减少内部协变量偏移问题，即随着前一层参数的变化，每层输入的分布在训练过程中发生变化，这可能会因为需要较低的学习率和仔细的参数初始化而减慢训练速度。正则化效果：它还具有轻微的正则化效果，导致（但不能消除）dropout 的需要。实现：它通常在深度学习框架中的层中实现，并在卷积层或全连接层之后、非线性层（如 ReLU）之前使用。 人们发现批量归一化对于训练深度网络非常有效，特别是在计算机视觉和语音识别领域。
三、内部协变量偏移问题 在批量归一化出现之前，深度学习网络一直受到内部协变量偏移问题的困扰。这种现象是指训练过程中权重的不断更新导致网络激活分布发生变化，导致需要较低的学习率和谨慎的参数初始化。批量归一化的引入通过稳定每层输入的分布有效地缓解了这个问题。
3.1 批量归一化的优点 提高训练速度：通过稳定输入分布，批量归一化允许使用更高的学习率，显着加速深度网络的训练过程。减少对初始化的依赖：它降低了网络对初始权重的敏感性，为选择初始化方法提供了更大的灵活性。正则化效果：批量归一化本质上具有温和的正则化效果，可以减少过度拟合并通常减少对 dropout 层的需求。促进更深层次的网络：通过缓解梯度消失和爆炸问题，它可以构建和有效训练更深层次的网络。 3.2 挑战和限制 尽管批量归一化有很多优点，但它也并非没有局限性。一项重大挑战是它对小批量大小的依赖。小批量可能会导致均值和方差估计不准确，从而影响模型性能。此外，批量归一化假设训练和推理期间输入分布一致，但情况可能并非总是如此。
3.3 应用和影响 批量归一化的实际影响是巨大且多样的。它已成为计算机视觉、自然语言处理和语音识别领域最先进架构的基本组成部分。它在图像分类中的 ResNets 和语言模型中的 Transformer 等模型的成功中发挥的作用凸显了它在推进深度学习领域的重要性。
四、代码 使用批量归一化创建完整的示例涉及几个步骤：生成合成数据集、使用批量归一化构建神经网络模型、训练模型以及绘制结果。为此，我们将使用 Python 以及 TensorFlow（或 Keras）和 matplotlib 等流行库。
首先，我们概述一下步骤：
生成综合数据集：我们将创建一个适合分类或回归任务的简单数据集。构建神经网络模型：将批量归一化层合并到模型中。训练模型：使用合成数据集来训练模型。绘制结果：显示训练损失和准确性，以了解批量归一化的影响。 现在，让我们用代码来完成每个步骤。
import numpy as np import matplotlib.pyplot as plt import tensorflow as tf from tensorflow.keras.models import Sequential from tensorflow.keras.layers import Dense, BatchNormalization from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2ee7d166ea7924ca855f50a9e21ab13b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-07T12:15:56+08:00" />
<meta property="article:modified_time" content="2024-01-07T12:15:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">批量归一化：彻底改变深度学习架构</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <div> 
  <div style="margin-left:24px;"> 
   <div> 
    <h2 id="c6a4" style="margin-left:0;"></h2> 
    <div> 
     <div> 
      <div> 
       <div style="margin-left:0;"> 
        <div> 
         <div> 
          <div> 
           <div> 
            <div></div> 
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<div></div> 
<div> 
 <div> 
  <div style="margin-left:24px;"> 
   <h2 id="7cf4" style="margin-left:0px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">一、介绍</span></span></span></h2> 
   <p id="5036" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        在深度学习的动态领域，批量归一化的引入标志着神经网络训练方法的关键转变。这项创新技术由 Sergey Ioffe 和 Christian Szegedy 在 2015 年提出，已成为现代神经网络架构的基石。它解决了训练深度网络的关键挑战，特别是处理臭名昭著的内部协变量偏移问题。本文旨在阐明批量归一化的概念、其对深度网络训练的深远影响及其在各种应用中的实际意义。</span></span></span></p> 
   <div> 
    <div style="margin-left:auto;"> 
     <p class="img-center"><img alt="" class="bg c ku oa" height="369" src="https://images2.imgbox.com/aa/8d/Zn3ih59G_o.png" width="875"></p> 
    </div> 
   </div> 
   <blockquote> 
    <p id="502b" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;"><em>在神经计算领域，批量归一化类似于风暴中的指南针，可以稳定学习算法在内部协变量变化的汹涌海洋中的航行。</em></span></span></span></p> 
   </blockquote> 
   <h2 id="d623" style="margin-left:0px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">二、了解批量归一化</span></span></span></h2> 
   <p id="3e96" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        批量归一化的核心是一种用于标准化神经网络中某一层的输入的技术。它的工作原理是通过减去批次均值并将其除以批次标准差来标准化先前激活层的输出。因此，这种归一化过程确保后续层的输入具有稳定的分布，从而促进更平滑和更快的训练过程。</span></span></span></p> 
   <p id="6409" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        批量归一化是神经网络中使用的一种技术，用于标准化每个小批量的层输入。这具有稳定学习过程并显着减少训练深度网络所需的训练周期数的效果。</span></span></span></p> 
   <p id="1065" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">以下是其工作原理的更详细分解：</span></span></span></p> 
   <ol style="margin-left:0;"><li id="1af2" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>归一化</strong>：对于每个特征，均值和方差是在小批量上计算的。然后，根据该均值和方差对特征进行归一化。</span></span></li><li id="2dde" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>缩放和平移</strong>：归一化后，使用在训练过程中学习到的两个参数 γ（缩放）和 β（平移）对特征进行缩放和平移。此步骤至关重要，因为标准化过程有时会以网络无法学习的方式改变特征的表示。如果需要最大程度地减少损失，则缩放和移位允许网络撤消标准化。</span></span></li><li id="b7fc" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>改进训练：</strong>批量归一化允许网络的每一层独立于其他层学习更多一点。它还有助于减少内部协变量偏移问题，即随着前一层参数的变化，每层输入的分布在训练过程中发生变化，这可能会因为需要较低的学习率和仔细的参数初始化而减慢训练速度。</span></span></li><li id="34c5" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>正则化效果：</strong>它还具有轻微的正则化效果，导致（但不能消除）dropout 的需要。</span></span></li><li id="8f94" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>实现</strong>：它通常在深度学习框架中的层中实现，并在卷积层或全连接层之后、非线性层（如 ReLU）之前使用。</span></span></li></ol> 
   <p id="c315" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">人们发现批量归一化对于训练深度网络非常有效，特别是在计算机视觉和语音识别领域。</span></span></span></p> 
   <h2 id="728b" style="margin-left:0px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">三、内部协变量偏移问题</span></span></span></h2> 
   <p id="c02d" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        在批量归一化出现之前，深度学习网络一直受到内部协变量偏移问题的困扰。这种现象是指训练过程中权重的不断更新导致网络激活分布发生变化，导致需要较低的学习率和谨慎的参数初始化。批量归一化的引入通过稳定每层输入的分布有效地缓解了这个问题。</span></span></span></p> 
   <h3 id="725e" style="margin-left:0px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">3.1 批量归一化的优点</span></span></span></h3> 
   <ol style="margin-left:0;"><li id="ef84" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>提高训练速度：</strong>通过稳定输入分布，批量归一化允许使用更高的学习率，显着加速深度网络的训练过程。</span></span></li><li id="b559" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>减少对初始化的依赖：</strong>它降低了网络对初始权重的敏感性，为选择初始化方法提供了更大的灵活性。</span></span></li><li id="d8f1" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>正则化效果：</strong>批量归一化本质上具有温和的正则化效果，可以减少过度拟合并通常减少对 dropout 层的需求。</span></span></li><li id="55bf" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>促进更深层次的网络：</strong>通过缓解梯度消失和爆炸问题，它可以构建和有效训练更深层次的网络。</span></span></li></ol> 
   <h3 id="3483" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">3.2 挑战和限制</span></span></span></h3> 
   <p id="e60d" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        尽管批量归一化有很多优点，但它也并非没有局限性。一项重大挑战是它对小批量大小的依赖。小批量可能会导致均值和方差估计不准确，从而影响模型性能。此外，批量归一化假设训练和推理期间输入分布一致，但情况可能并非总是如此。</span></span></span></p> 
   <h3 id="616b" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">3.3 应用和影响</span></span></span></h3> 
   <p id="bee9" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        批量归一化的实际影响是巨大且多样的。它已成为计算机视觉、自然语言处理和语音识别领域最先进架构的基本组成部分。它在图像分类中的 ResNets 和语言模型中的 Transformer 等模型的成功中发挥的作用凸显了它在推进深度学习领域的重要性。</span></span></span></p> 
   <h2 id="4f5b" style="margin-left:0px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">四、代码</span></span></span></h2> 
   <p id="8508" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        使用批量归一化创建完整的示例涉及几个步骤：生成合成数据集、使用批量归一化构建神经网络模型、训练模型以及绘制结果。为此，我们将使用 Python 以及 TensorFlow（或 Keras）和 matplotlib 等流行库。</span></span></span></p> 
   <p id="5a60" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">首先，我们概述一下步骤：</span></span></span></p> 
   <ol style="margin-left:0;"><li id="026c" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>生成综合数据集</strong>：我们将创建一个适合分类或回归任务的简单数据集。</span></span></li><li id="719e" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>构建神经网络模型</strong>：将批量归一化层合并到模型中。</span></span></li><li id="d1b0" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>训练模型：</strong>使用合成数据集来训练模型。</span></span></li><li id="9eed" style="margin-left:30px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><strong>绘制结果：</strong>显示训练损失和准确性，以了解批量归一化的影响。</span></span></li></ol> 
   <p id="506f" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">现在，让我们用代码来完成每个步骤。</span></span></span></p> 
   <pre class="has" style="margin-left:0;"><code class="language-ba">import numpy as np
import matplotlib.pyplot as plt
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, BatchNormalization
from sklearn.datasets import make_classification

# Generate synthetic dataset
X, y = make_classification(n_samples=1000, n_features=20, n_classes=2, random_state=42)

# Split into training and testing sets
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Build the model
model = Sequential([
    Dense(64, input_dim=20, activation='relu'),
    BatchNormalization(),
    Dense(64, activation='relu'),
    BatchNormalization(),
    Dense(1, activation='sigmoid')
])

model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Train the model
history = model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=50, batch_size=32)

# Plot training &amp; validation accuracy values
plt.plot(history.history['accuracy'])
plt.plot(history.history['val_accuracy'])
plt.title('Model accuracy')
plt.ylabel('Accuracy')
plt.xlabel('Epoch')
plt.legend(['Train', 'Test'], loc='upper left')
plt.show()

# Plot training &amp; validation loss values
plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])
plt.title('Model loss')
plt.ylabel('Loss')
plt.xlabel('Epoch')
plt.legend(['Train', 'Test'], loc='upper left')
plt.show()</code></pre> 
   <div style="margin-left:auto;"> 
    <p class="img-center"><img alt="" class="bg c ku oa" height="455" src="https://images2.imgbox.com/56/fe/Y6A5fg4n_o.png" width="576"></p> 
   </div> 
   <div style="margin-left:auto;"> 
    <p class="img-center"><img alt="" class="bg c ku oa" height="455" src="https://images2.imgbox.com/19/de/Ohrx39Qd_o.png" width="567"></p> 
   </div> 
   <p id="3f78" style="margin-left:0;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        此代码提供了在具有合成数据集的神经网络中使用批量归一化的完整端到端示例。请记住，批量归一化的有效性可能会根据数据集和模型架构的不同而有所不同，因此尝试不同的配置总是好的。</span></span></span></p> 
   <h2 id="7c00" style="margin-left:0px;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">五、结论</span></span></span></h2> 
   <p id="07c7" style="margin-left:-.46em;"><span style="color:rgba(0,0,0,.8);"><span style="background-color:#ffffff;"><span style="color:#242424;">        批量归一化代表了神经网络训练发展中的一个重要里程碑。通过解决内部协变量偏移的关键挑战，它不仅简化而且增强了深度神经网络的训练过程。虽然它有其自身的一系列挑战和限制，但它在训练稳定性、速度和网络深度方面提供的好处是不可否认的。随着深度学习领域的不断发展和发展，批量归一化无疑仍将是神经网络架构中的关键工具。</span></span></span></p> 
  </div> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ff6547adf9027c58f1836ac2f9e5d21/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">力扣-367. 有效的完全平方数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6973668ef911012e6998fd5563ec8e17/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java 集合面试题真实场景还原</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>