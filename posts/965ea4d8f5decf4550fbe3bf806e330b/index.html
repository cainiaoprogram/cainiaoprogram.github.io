<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>opencv006图像处理之仿射变换（旋转，缩放，平移） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="opencv006图像处理之仿射变换（旋转，缩放，平移）" />
<meta property="og:description" content="空间变换中的仿射变换对应着五种变换，平移，缩放，旋转，翻转，错切。而这五种变化由原图像转变到变换图像的过程，可以用仿射变换矩阵进行描述。而这个变换过程可以用一个2*3的矩阵与原图进行相乘得到。关键就是这个矩阵M：
仿射变换的函数： 平移，旋转 cv2.warpAffine(scr, M, dsize, flags, mode, value) 透视
cv2.warpPerspective(img1, M, desize......) M: 变换矩阵desize: 输出图片大小flags：与resize中的插值算法一致mode：边界外推法标志(有默认值)value：填充边界值（有默认值） 平移 读入的是二维的图像，所以就不用写最后一行了
向右平移200 （向左就是负数，其他同理）
# 变换矩阵，最少是float32
M = np.float32([[1, 0, 200], [0, 1, 0]])
向下平移200
# 变换矩阵，最少是float32
M = np.float32([[1, 0, 0], [0, 1, 200]])
向右下平移
# 变换矩阵，最少是float32
M = np.float32([[1, 0, 200], [0, 1, 200]])
这个是向右平移的代码：
import cv2 import numpy as np img1 = cv2.imread(&#34;F:\est01\e1.jpg&#34;) h, w, ch = img1.shape # 变换矩阵，最少是float32 M = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/965ea4d8f5decf4550fbe3bf806e330b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-07T12:08:46+08:00" />
<meta property="article:modified_time" content="2024-01-07T12:08:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">opencv006图像处理之仿射变换（旋转，缩放，平移）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"><img alt="" height="300" src="https://images2.imgbox.com/6b/18/TMZLGgHY_o.jpg" width="300"></p> 
<p>空间变换中的仿射变换对应着五种变换，平移，缩放，旋转，翻转，错切。而这五种变化由原图像转变到变换图像的过程，可以用仿射变换矩阵进行描述。而这个变换过程可以用一个2*3的矩阵与原图进行相乘得到。关键就是这个矩阵M：</p> 
<h2>仿射变换的函数：</h2> 
<p> 平移，旋转 </p> 
<pre><code class="language-python">cv2.warpAffine(scr, M, dsize, flags, mode, value)</code></pre> 
<p> 透视</p> 
<pre><code class="language-python"> cv2.warpPerspective(img1, M, desize......)</code></pre> 
<blockquote> 
 <ul><li>M: 变换矩阵</li><li>desize: 输出图片大小</li><li>flags：与resize中的插值算法一致</li><li>mode：边界外推法标志(有默认值)</li><li>value：填充边界值（有默认值）</li></ul> 
</blockquote> 
<h2>平移</h2> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/b1/38/SVrh0z4Z_o.png"></p> 
<p>读入的是二维的图像，所以就不用写最后一行了</p> 
<hr> 
<p><strong>向右平移200 （向左就是负数，其他同理）</strong></p> 
<p># 变换矩阵，最少是float32<br> M = np.float32([[1, 0, 200], [0, 1, 0]])</p> 
<p><strong>向下平移200</strong></p> 
<p># 变换矩阵，最少是float32<br> M = np.float32([[1, 0,  0], [0, 1,  200]])</p> 
<p><strong>向右下平移</strong></p> 
<p># 变换矩阵，最少是float32<br> M = np.float32([[1, 0, 200], [0, 1, 200]])</p> 
<p><strong><span style="color:#ed7976;">这个是向右平移的代码：</span></strong></p> 
<pre><code class="language-python">import cv2
import numpy as np
img1 = cv2.imread("F:\est01\e1.jpg")
h, w, ch = img1.shape
# 变换矩阵，最少是float32
M = np.float32([[1, 0, 200], [0, 1, 0]])
# 平移操作
# 注意opencv中先宽后高
new_img1 = cv2.warpAffine(img1, M, dsize=(w, h))
cv2.imshow('img1', img1)
cv2.imshow('new_img1', new_img1)
cv2.waitKey(0)
cv2.destroyAllWindows()</code></pre> 
<p> </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/6e/60/KYs1nHjB_o.png" width="1200"> </p> 
<h2> 旋转</h2> 
<p>可以用opencv获取变换矩阵</p> 
<p>在进行旋转操作时，不方便手动 计算变换矩阵，opencv中提供了获取变换矩阵的api</p> 
<h3>方法1：</h3> 
<p>使用cv2.getRotationMatrix2D </p> 
<pre><code class="language-python">M = cv2.getRotationMatrix2D(center, angle, 缩放比例)</code></pre> 
<pre><code class="language-python">import cv2
import numpy as np
img1 = cv2.imread("F:\est01\e1.jpg")
h, w, ch = img1.shape
# 获取变换矩阵
M = cv2.getRotationMatrix2D((100, 100), 30, 1)
new_img1 = cv2.warpAffine(img1, M, (w, h))
cv2.imshow('img1', img1)
cv2.imshow('new_img1', new_img1)
cv2.waitKey(0)
cv2.destroyAllWindows()</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/a7/bb/wrIeSElq_o.png" width="1200"></p> 
<h3>另一种方法：</h3> 
<p> 使用cv2.getAffineTransform(src, dst)</p> 
<pre><code class="language-python">M = cv2.getAffineTransform(src, dst)</code></pre> 
<p> 可以通过三个点来确定变换后的位置，相当于解方程，三个点对应三个方程，解出偏移的参数，旋转的角度</p> 
<p><img alt="" height="365" src="https://images2.imgbox.com/e0/1b/SFwwvBI4_o.png" width="628"></p> 
<pre><code class="language-python">src = np.float32([[200, 100], [300, 100], [200, 300]])
dst = np.float32([[100, 150], [360, 200], [280, 120]])
M = cv2.getAffineTransform(src, dst)
new_img1 = cv2.warpAffine(img1, M, (w, h))</code></pre> 
<p>三个点是随便写的，所以有些许奇怪 哈哈哈 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f6/6b/14vbyMSV_o.png" width="1200"> 效果像把图片向某个方向拉</p> 
<h2>透视</h2> 
<p> 将一种坐标系变成另一种坐标系，可以把倾斜的图片变正</p> 
<p>函数：</p> 
<pre><code class="language-python">cv2.warpPerspective（img，M，desize.......）</code></pre> 
<p>对于透视变换来说，M是一个3*3的矩阵</p> 
<p>cv2.getPerspectiveTransform(src,dst)获取透视变换矩阵，需要4个点，即图片的四个角</p> 
<pre><code class="language-python">src = np.float32([[50, 50], [630, 0], [0, 640], [630, 630]])
dst = np.float32([[0, 0], [640, 0], [0, 640], [640, 640]])
M = cv2.getPerspectiveTransform(src, dst)
new_img1 = cv2.warpPerspective(img1, M, (640, 640))</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f2/29/SfCcJVcl_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9b1398b5be4a9ba8666a16e25788021a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【2023年度总结】多变的2023 | 成长的2023 | 蜕变的2023</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ff6547adf9027c58f1836ac2f9e5d21/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">力扣-367. 有效的完全平方数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>