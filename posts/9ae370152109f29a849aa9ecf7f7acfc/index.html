<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用devtools安装monocle3 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用devtools安装monocle3" />
<meta property="og:description" content="1. 源码编译R 环境：
module purge
module load compiler/gcc/7.3.1
源码编译R
./configure --with-pcre1 --prefix=/path/to/install-R
make
make install
vim env-R.sh
export PATH=/path/to/install-R/bin: $PATH
export LD_LIBRARY_PATH=/path/to/install-R/lib: $LD_LIBRARY_PATH
source env-R.sh
2. 安装devtools 在刚刚安装R的环境下
再module load compiler/cmake/3.23.1
（安装devtools下载的包需要高版本的cmake）
启动R，R
install.packages(“devtools”)
会下载下来很多包，然后依次安装这些包，有的包R下载一次不下来，如果是网络中断而出现的报错，重复这个命令。重复多次，有的包R还是下载不下来，复制网址wget到集群上指定 路径安装会比较方便。
例如stringi这个包，R下载不下来，后还报ICUDM的错，就可以install的时候指定包的位置和ICUDM的位置：
install.packages(“/work/home/xiaxx/packages/monocle3/stringi_1.7.8.tar.gz”,repo=NULL,type=“source”,configure.vars=“ICUDT_DIR=/work/home/xiaxx/packages/monocle3”)
3. 安装monocle3需要的依赖 devtools::install_github(‘cole-trapnell-lab/monocle3’)
（115个，好多依赖，好吓人）
静静等待，多次重复，最后还剩4个包没装好
依次查看每个包编不过的原因
（1）units报错解决办法 — 安装udunits-2.2.20 找不到libudunits2.so，百度搜下这个包
wget https://download-ib01.fedoraproject.org/pub/epel/7/SRPMS/Packages/u/udunits2-2.2.20-2.el7.src.rpm
集群的普通用户使用
rpm2cpio xxx.rpm |cpio -idvm后
是一个tar.gz安装包，解压进入目录
./configure --prefix=/work/home/xiaxx/packages/monocle3/udunits-2.2.20
make
make install
安装好后指定环境：
export UDUNITS2_INCLUDE=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/include
export UDUNITS2_LIBS=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/lib
export LD_LIBRARY_PATH=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/lib: $LD_LIBRARY_PATH" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9ae370152109f29a849aa9ecf7f7acfc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-14T12:33:08+08:00" />
<meta property="article:modified_time" content="2022-12-14T12:33:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用devtools安装monocle3</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="1__R_0"></a>1. 源码编译R</h4> 
<p>环境：<br> module purge<br> module load compiler/gcc/7.3.1</p> 
<p>源码编译R<br> ./configure --with-pcre1 --prefix=/path/to/install-R<br> make<br> make install</p> 
<p>vim env-R.sh<br> export PATH=/path/to/install-R/bin: $PATH<br> export LD_LIBRARY_PATH=/path/to/install-R/lib: $LD_LIBRARY_PATH<br> source env-R.sh</p> 
<h4><a id="2_devtools_18"></a>2. 安装devtools</h4> 
<p>在刚刚安装R的环境下<br> 再module load compiler/cmake/3.23.1<br> （安装devtools下载的包需要高版本的cmake）</p> 
<p>启动R，R</p> 
<p>install.packages(“devtools”)</p> 
<p>会下载下来很多包，然后依次安装这些包，有的包R下载一次不下来，如果是网络中断而出现的报错，重复这个命令。重复多次，有的包R还是下载不下来，复制网址wget到集群上指定 路径安装会比较方便。<br> 例如stringi这个包，R下载不下来，后还报ICUDM的错，就可以install的时候指定包的位置和ICUDM的位置：</p> 
<p>install.packages(“/work/home/xiaxx/packages/monocle3/stringi_1.7.8.tar.gz”,repo=NULL,type=“source”,configure.vars=“ICUDT_DIR=/work/home/xiaxx/packages/monocle3”)</p> 
<h4><a id="3_monocle3_35"></a>3. 安装monocle3需要的依赖</h4> 
<p>devtools::install_github(‘cole-trapnell-lab/monocle3’)<br> <img src="https://images2.imgbox.com/cc/2c/EWdkwVFe_o.png" alt="在这里插入图片描述"></p> 
<p>（115个，好多依赖，好吓人）<br> 静静等待，多次重复，最后还剩4个包没装好</p> 
<p>依次查看每个包编不过的原因<br> <img src="https://images2.imgbox.com/c4/a1/52SuNf6e_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="1units__udunits2220_46"></a>（1）units报错解决办法 — 安装udunits-2.2.20</h6> 
<p><img src="https://images2.imgbox.com/ad/3c/dhmQiKkT_o.png" alt="在这里插入图片描述"></p> 
<p>找不到libudunits2.so，百度搜下这个包<br> wget https://download-ib01.fedoraproject.org/pub/epel/7/SRPMS/Packages/u/udunits2-2.2.20-2.el7.src.rpm<br> 集群的普通用户使用<br> rpm2cpio xxx.rpm |cpio -idvm后<br> 是一个tar.gz安装包，解压进入目录</p> 
<p>./configure --prefix=/work/home/xiaxx/packages/monocle3/udunits-2.2.20<br> make<br> make install</p> 
<p>安装好后指定环境：<br> export UDUNITS2_INCLUDE=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/include<br> export UDUNITS2_LIBS=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/lib<br> export LD_LIBRARY_PATH=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/lib: $LD_LIBRARY_PATH<br> export PATH=/work/home/xiaxx/packages/monocle3/udunits-2.2.20/bin: $PATH</p> 
<h6><a id="2terra__gdal340proj630sqlite3400geos393_66"></a>（2）terra报错解决办法 ---- gdal3.4.0及其依赖（proj-6.3.0）及其依赖的依赖（sqlite3.40.0）的编译、和geos3.9.3编译</h6> 
<p><em><strong>版本很重要，不然后续编译sf会报错</strong></em></p> 
<p>编译terra发现缺少gdal环境和geos环境，而编译gdal需要proj，编译proj需要sqlite3。</p> 
<h6><a id="a_sqlite3_71"></a>a. 先编译sqlite3</h6> 
<p>在sqlite3.c里加上这一行<br> #define SQLITE_ENABLE_COLUMN_METADATA 1<br> <img src="https://images2.imgbox.com/4b/8c/zLfPOx76_o.png" alt="在这里插入图片描述"></p> 
<p>否则在后续编译gdal的时候会出现这个报错：</p> 
<blockquote> 
 <p>libgdal.so: undefined reference to ‘sqlite3_column_origin_name’<br> libgdal.so: undefined reference to ‘sqlite3_column_table_name’</p> 
</blockquote> 
<p>./configure --prefix=/work/home/xiaxx/packages/monocle3/sqlite-version-3.40.0 --disable-tcl<br> make<br> make install</p> 
<p>设置环境变量<br> export INCLUDE=/work/home/xiaxx/packages/monocle3/sqlite-version-3.40.0/bin: $INCLUDE<br> export LD_LIBRARY_PATH=/work/home/xiaxx/packages/monocle3/sqlite-version-3.40.0/lib: $LD_LIBRARY_PATH<br> export PATH=/work/home/ac947yas04/package/sqlite-version-3.40.0/bin: $PATH<br> export PKG_CONFIG_PATH=/work/home/xiaxx/packages/monocle3/sqlite-version-3.40.0/lib/pkgconfig: $PKG_CONFIG_PATH</p> 
<h6><a id="bproj_92"></a>b.再编译proj</h6> 
<p>./configure --prefix=/work/home/xiaxx/packages/monocle3/proj-6.3.0/build<br> make<br> make install<br> 设置环境变量：<br> export INCLUDE=/work/home/xiaxx/packages/monocle3/proj-6.3.0/build/include: $INCLUDE<br> export LD_LIBRARY_PATH=/work/home/xiaxx/packages/monocle3/proj-6.3.0/build/lib: $LD_LIBRARY_PATH<br> export PATH=/work/home/xiaxx/packages/monocle3/proj-6.3.0/build/bin: $PATH<br> export PKG_CONFIG_PATH=/work/home/xiaxx/packages/monocle3/proj-6.3.0/build/lib/pkgconfig: $PKG_CONFIG_PATH</p> 
<h6><a id="cgdal_103"></a>c.再编译gdal</h6> 
<p>./configure --prefix=/work/home/xiaxx/packages/monocle3/gdal-3.4.0/build --with-proj=/work/home/xiaxx/packages/monocle3/proj-6.3.0/build （指定下proj路径，只设置环境变量识别不到）<br> make<br> make install<br> 设置环境变量：<br> export INCLUDE=/work/home/xiaxx/packages/monocle3/gdal-3.4.0/buid/include: $INCLUDE<br> export LD_LIBRARY_PATH=/work/home/xiaxx/packages/monocle3/gdal-3.4.0/buid/lib: $LD_LIBRARY_PATH<br> export PATH=/work/home/xiaxx/packages/monocle3/gdal-3.4.0/buid/bin: $PATH<br> export PKG_CONFIG_PATH=/work/home/xiaxx/packages/monocle3/gdal-3.4.0/buid/lib/pkgconfig: $PKG_CONFIG_PATH</p> 
<h6><a id="dgeos_114"></a>d.编译geos</h6> 
<p>./configure --prefix=/work/home/xiaxx/packages/monocle3/geos-3.9.3/build<br> make<br> make install<br> 设置环境变量：<br> export INCLUDE=/work/home/xiaxx/packages/monocle3/geeos-3.9.3/build/include: $INCLUDE<br> export LD_LIBRARY_PATH=/work/home/xiaxx/packages/monocle3/geos-3.9.3/build/lib: $LD_LIBRARY_PATH<br> export PATH=/work/home/xiaxx/packages/monocle3/geos-3.9.3/build/bin: $PATH<br> export PKG_CONFIG_PATH=/work/home/xiaxx/packages/monocle3/geos-3.9.3/build/lib/pkgconfig: $PKG_CONFIG_PATH</p> 
<h6><a id="3sf__gdalgeos_124"></a>（3）sf – 也是缺少gdal库和geos库</h6> 
<h6><a id="4spdep__sf_125"></a>（4）spdep – 依赖于sf</h6> 
<h5><a id="4_monocles3_130"></a>4. 解决缺库问题后继续安装monocles3</h5> 
<p>启动R，R<br> devtools::install_github(‘cole-trapnell-lab/monocle3’)<br> <img src="https://images2.imgbox.com/69/5b/CKewv44k_o.png" alt="在这里插入图片描述"></p> 
<p>至此，安装完成</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b42913730a01d25a7f8ae3d8ed7915ec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【GPU高性能编程 CUDA实战】学习笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/19db334c970982685ac868045d56043a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android 开发viewBinding使用及其需要注意的事项（Activity做弹窗Dialog）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>