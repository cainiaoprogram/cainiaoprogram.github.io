<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>yocto：bitbake单独编译某个模块的方法 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="yocto：bitbake单独编译某个模块的方法" />
<meta property="og:description" content="在yocto编译环境中如果想单独编译某个模块
可以在已经搭建好的yocto编译环境中使用如下命令
Yocto中对于不同的Package，有不同的task，即可以执行不同的操作，有一些是所有包共通的，例如clean，build等。
我们可以使用下面命令来查看一个包都有哪些可执行的task：
bitbake Package -c listtasks 如：bitbake core-image-weston -c listtasks 有以下结果：
Initialising tasks: 100% |#################################################################################################################################################################| Time: 0:00:07 NOTE: Executing RunQueue Tasks do_build Default task for a recipe - depends on all other normal tasks required to &#39;build&#39; a recipe do_checkuri Validates the SRC_URI value do_checkuriall Validates the SRC_URI value for all recipes required to build a target do_clean Removes all output files for a target do_cleanall Removes all output files, shared state cache, and downloaded source files for a target do_cleansstate Removes all output files and shared state cache for a target do_compile Compiles the source in the compilation directory do_configure Configures the source by enabling and disabling any build-time and configuration options for the software being built do_devpyshell Starts an interactive Python shell for development/debugging do_devshell Starts a shell with the environment set up for development/debugging do_dtv_checking do_fetch Fetches the source code do_fetchall Fetches all remote sources required to build a target do_image do_image_complete do_image_complete_setscene (setscene version) do_image_ext4 do_image_qa do_image_qa_setscene (setscene version) do_image_tar do_install Copies files from the compilation directory to a holding area do_listtasks Lists all defined tasks for a target do_package Analyzes the content of the holding area and splits it into subsets based on available packages and files do_package_qa_setscene Runs QA checks on packaged files (setscene version) do_package_setscene Analyzes the content of the holding area and splits it into subsets based on available packages and files (setscene version) do_package_write_rpm Creates the actual RPM packages and places them in the Package Feed area do_package_write_rpm_setscene Creates the actual RPM packages and places them in the Package Feed area (setscene version) do_packagedata Creates package metadata used by the build system to generate the final packages do_packagedata_setscene Creates package metadata used by the build system to generate the final packages (setscene version) do_patch Locates patch files and applies them to the source code do_populate_lic Writes license information for the recipe that is collected later when the image is constructed do_populate_lic_setscene Writes license information for the recipe that is collected later when the image is constructed (setscene version) do_populate_sdk Creates the file and directory structure for an installable SDK do_populate_sdk_ext do_populate_sysroot_setscene Copies a subset of files installed by do_install into the sysroot in order to make them available to other recipes (setscene version) do_prepare_recipe_sysroot do_rootfs Creates the root filesystem (file and directory structure) for an image do_rootfs_wicenv do_sdk_depends do_unpack Unpacks the source code into a working directory do_vp9_checking NOTE: Tasks Summary: Attempted 1 tasks of which 0 didn&#39;t need to be rerun and all succeeded." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/a93ac59a3e16fe9f9c221ae7c77e7afd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-26T16:37:34+08:00" />
<meta property="article:modified_time" content="2019-10-26T16:37:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">yocto：bitbake单独编译某个模块的方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在yocto编译环境中如果想单独编译某个模块</p> 
<p>可以在已经搭建好的yocto编译环境中使用如下命令</p> 
<p>Yocto中对于不同的Package，有不同的task，即可以执行不同的操作，有一些是所有包共通的，例如clean，build等。</p> 
<p>我们可以使用下面命令来查看一个包都有哪些可执行的task：</p> 
<h2>bitbake Package -c listtasks</h2> 
<p> </p> 
<h4>如：<span style="color:#f33b45;">bitbake core-image-weston -c listtasks</span></h4> 
<p>有以下结果：</p> 
<pre class="has"><code>Initialising tasks: 100% |#################################################################################################################################################################| Time: 0:00:07
NOTE: Executing RunQueue Tasks
do_build                       Default task for a recipe - depends on all other normal tasks required to 'build' a recipe
do_checkuri                    Validates the SRC_URI value
do_checkuriall                 Validates the SRC_URI value for all recipes required to build a target
do_clean                       Removes all output files for a target
do_cleanall                    Removes all output files, shared state cache, and downloaded source files for a target
do_cleansstate                 Removes all output files and shared state cache for a target
do_compile                     Compiles the source in the compilation directory
do_configure                   Configures the source by enabling and disabling any build-time and configuration options for the software being built
do_devpyshell                  Starts an interactive Python shell for development/debugging
do_devshell                    Starts a shell with the environment set up for development/debugging
do_dtv_checking                
do_fetch                       Fetches the source code
do_fetchall                    Fetches all remote sources required to build a target
do_image                       
do_image_complete              
do_image_complete_setscene      (setscene version)
do_image_ext4                  
do_image_qa                    
do_image_qa_setscene            (setscene version)
do_image_tar                   
do_install                     Copies files from the compilation directory to a holding area
do_listtasks                   Lists all defined tasks for a target
do_package                     Analyzes the content of the holding area and splits it into subsets based on available packages and files
do_package_qa_setscene         Runs QA checks on packaged files (setscene version)
do_package_setscene            Analyzes the content of the holding area and splits it into subsets based on available packages and files (setscene version)
do_package_write_rpm           Creates the actual RPM packages and places them in the Package Feed area
do_package_write_rpm_setscene  Creates the actual RPM packages and places them in the Package Feed area (setscene version)
do_packagedata                 Creates package metadata used by the build system to generate the final packages
do_packagedata_setscene        Creates package metadata used by the build system to generate the final packages (setscene version)
do_patch                       Locates patch files and applies them to the source code
do_populate_lic                Writes license information for the recipe that is collected later when the image is constructed
do_populate_lic_setscene       Writes license information for the recipe that is collected later when the image is constructed (setscene version)
do_populate_sdk                Creates the file and directory structure for an installable SDK
do_populate_sdk_ext            
do_populate_sysroot_setscene   Copies a subset of files installed by do_install into the sysroot in order to make them available to other recipes (setscene version)
do_prepare_recipe_sysroot      
do_rootfs                      Creates the root filesystem (file and directory structure) for an image
do_rootfs_wicenv               
do_sdk_depends                 
do_unpack                      Unpacks the source code into a working directory
do_vp9_checking                
NOTE: Tasks Summary: Attempted 1 tasks of which 0 didn't need to be rerun and all succeeded.
</code></pre> 
<p>说明上面可以支持的CMD。</p> 
<p>接着使用如下命令：</p> 
<h4>bitbake  -b bbfile -c CMD（before list）</h4> 
<pre class="has"><code>bitbake  -b pulseaudio_10.0 -c compile

bitbake  -b pulseaudio_10.0 -c clean

bitbake -b pulseaudio_10.0 -c build

bitbake  -b pulseaudio_10.0 -c configure

bitbake  -b pulseaudio_10.0 -c compile

bitbake  -b pulseaudio_10.0 -c install</code></pre> 
<p>一般要在yocto的编译环境中打patch的方式如下：</p> 
<p>1，bbappend文件的编译方式</p> 
<p>在poky目录下的<strong><span style="color:#ffbb66;">meta/conf/</span></strong>有个layer.conf配置文件</p> 
<pre class="has"><code># We have a conf and classes directory, add to BBPATH
BBPATH .= ":${LAYERDIR}"
# We have recipes-* directories, add to BBFILES
BBFILES += "${LAYERDIR}/recipes-*/*/*.bb"

BBFILES += "${LAYERDIR}/recipes-*/*/*.bbappend"</code></pre> 
<p>其中BBFILES为需要参加编译的文件。</p> 
<p>2，基于模块的源码的patch</p> 
<p>把patch文件放在模块的放patch的目录下</p> 
<p>找到该模块的bb文件，参照已有的打patch的方式，添加自己的patch。</p> 
<p>比如：</p> 
<p>SRC_URI = "http://freedesktop.org/software/pulseaudio/releases/${BP}.tar.xz \</p> 
<p>           file://0001-padsp-Make-it-compile-on-musl.patch \</p> 
<p>           file://0001-client-conf-Add-allow-autospawn-for-root.patch \</p> 
<p>           file://pulseaudio-discuss-iochannel-don-t-use-variable-length-array-in-union.patch \</p> 
<p>           file://volatiles.04_pulse \</p> 
<h4>          <span style="color:#f33b45;"> file://fix-add-connectionid-in-simple.patch\（新增）</span></h4> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/22bcea59b6118c2cbaa20da667ff4d5a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Impala SQL语句 COMPUTE STATS</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4a29486b4329e527f3489e69711cba57/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">推荐大数据排名前六的公众号</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>