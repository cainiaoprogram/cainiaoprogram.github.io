<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习1一元线性回归 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习1一元线性回归" />
<meta property="og:description" content="机器学习1一元线性回归 前言一、回归概念高尔顿(达尔文表兄)提出 二、线性回归适用场景三、线性回归方程一元线性回归多元线性回归方程 拟合直线的原则梯度下降算法凸函数和非凸函数梯度下降学习率例如 代价函数一元函数梯度下降上代码实战（房价预测） 前言 本人是技术控所以先从应用开始，最后再进入科普机器学习历史环节
提示：以下是本篇文章正文内容，下面案例可供参考
一、回归概念 高尔顿(达尔文表兄)提出 研究父辈身高和字辈身高关系通过大量统计表明矮个子的父辈的子女平均身高高于父辈，高个子身高的父辈子女平均身高低于父辈。通俗的讲，姚明的孩子身高超过姚明的概率很低，潘长江的孩子超过潘长江的概率很高。大自然有种力量让物种趋于平均。这种现象就叫回归 二、线性回归适用场景 身高体重预测房价预测等等 三、线性回归方程 一元线性回归 f(x) = w1*x&#43;w0
多元线性回归方程 f(x1,x2…xn) = w0&#43;w1X1&#43;w2X2&#43;…wn*Xn 代码如下（示例）：
拟合直线的原则 最小二乘法
数学必备知识
导数概念
复合函数求导法则
偏导数
极大值，极小值概念
梯度概念 真实值和预测值的误差最小每个点和直线的距离平方和最小
梯度下降算法 凸函数和非凸函数 梯度下降学习率 梯度下降算法中被称作为学习率或者步长，意味着我们可以通过α来控制每一步走的距离
例如 代价函数 一元函数梯度下降 上代码实战（房价预测） import numpy as np import matplotlib.pyplot as plt data = np.genfromtxt(&#39;data.csv&#39;,delimiter=&#39;,&#39;) x_data = data[:,0] y_data = data[:,1] plt.scatter(x_data,y_data) plt.show() w = 0 b = 0 alf = 0.0001 counter = 100 def costFunc(w,b,x_data,y_data): totErr = 0; for i in range(len(x_data)): totErr &#43;= (y_data[i]-(w*x_data[i]&#43;b))**2 return totErr/float(len(x_data)) def gradient_decent(x_data,y_data,w,b,alf,counter): m = float(len(x_data)) for i in range(counter): w_temp = 0 b_temp = 0 for j in range(len(x_data)): w_temp &#43;= (1/m) * (w*x_data[j]&#43;b-y_data[j])*x_data[j] b_temp &#43;= (1/m) * (w*x_data[j]&#43;b-y_data[j]) w = w-alf*w_temp b = b-alf*b_temp if i%5==0: print(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/ac98b41348142448340eb90cd574b803/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-28T16:26:18+08:00" />
<meta property="article:modified_time" content="2023-11-28T16:26:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习1一元线性回归</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>机器学习1一元线性回归</h4> 
 <ul><li><a href="#_6" rel="nofollow">前言</a></li><li><a href="#_14" rel="nofollow">一、回归概念</a></li><li><ul><li><a href="#_16" rel="nofollow">高尔顿(达尔文表兄)提出</a></li></ul> 
  </li><li><a href="#_24" rel="nofollow">二、线性回归适用场景</a></li><li><a href="#_29" rel="nofollow">三、线性回归方程</a></li><li><ul><li><a href="#_30" rel="nofollow">一元线性回归</a></li><li><a href="#_34" rel="nofollow">多元线性回归方程</a></li></ul> 
  </li><li><a href="#_39" rel="nofollow">拟合直线的原则</a></li><li><a href="#_55" rel="nofollow">梯度下降算法</a></li><li><ul><li><a href="#_58" rel="nofollow">凸函数和非凸函数</a></li><li><a href="#_61" rel="nofollow">梯度下降学习率</a></li><li><a href="#_64" rel="nofollow">例如</a></li></ul> 
  </li><li><a href="#_69" rel="nofollow">代价函数</a></li><li><a href="#_71" rel="nofollow">一元函数梯度下降</a></li><li><a href="#_76" rel="nofollow">上代码实战（房价预测）</a></li></ul> 
</div> 
<p></p> 
<hr size='1"' color="#000000"> 
<h2><a id="_6"></a>前言</h2> 
<p><font color="#999AAA">本人是技术控所以先从应用开始，最后再进入科普机器学习历史环节</font></p> 
<hr size='1"' color="#000000"> 
<p><font color="#999AAA">提示：以下是本篇文章正文内容，下面案例可供参考</font></p> 
<h2><a id="_14"></a>一、回归概念</h2> 
<h3><a id="_16"></a>高尔顿(达尔文表兄)提出</h3> 
<ul><li>研究父辈身高和字辈身高关系</li><li>通过大量统计表明矮个子的父辈的子女平均身高高于父辈，高个子身高的父辈子女平均身高低于父辈。</li><li>通俗的讲，姚明的孩子身高超过姚明的概率很低，潘长江的孩子超过潘长江的概率很高。</li><li>大自然有种力量让物种趋于平均。这种现象就叫回归</li></ul> 
<h2><a id="_24"></a>二、线性回归适用场景</h2> 
<ul><li>身高体重预测</li><li>房价预测</li><li>等等</li></ul> 
<h2><a id="_29"></a>三、线性回归方程</h2> 
<h3><a id="_30"></a>一元线性回归</h3> 
<ul><li>f(x) = w1*x+w0<br> <img src="https://images2.imgbox.com/d0/c6/0MNt8yl1_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="_34"></a>多元线性回归方程</h3> 
<ul><li>f(x1,x2…xn) = w0+w1<em>X1+w2</em>X2+…wn*Xn</li></ul> 
<p><font color="#999AAA">代码如下（示例）：</font></p> 
<h2><a id="_39"></a>拟合直线的原则</h2> 
<ul><li>最小二乘法<br> 数学必备知识<br> 导数概念<br> 复合函数求导法则<br> 偏导数<br> 极大值，极小值概念<br> 梯度概念</li></ul> 
<p><img src="https://images2.imgbox.com/99/be/M2zctNuL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b2/ff/81Yl8m3h_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/87/6e/DOe2u0JX_o.png" alt="在这里插入图片描述"></p> 
<ul><li>真实值和预测值的误差最小</li><li>每个点和直线的距离平方和最小<br> <img src="https://images2.imgbox.com/be/fe/FZ8DbCCu_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="_55"></a>梯度下降算法</h2> 
<p><img src="https://images2.imgbox.com/4b/4c/h6KKKwW0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d1/ef/ewtk5juw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_58"></a>凸函数和非凸函数</h3> 
<p><img src="https://images2.imgbox.com/52/44/X16dLxCz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/bd/0f/o8Kjf0dd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_61"></a>梯度下降学习率</h3> 
<p>梯度下降算法中被称作为学习率或者步长，意味着我们可以通过α来控制每一步走的距离<br> <img src="https://images2.imgbox.com/39/51/fXKtNuny_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_64"></a>例如</h3> 
<p><img src="https://images2.imgbox.com/dd/f9/UbuXoQPo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d0/d5/7Hfxdlkl_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_69"></a>代价函数</h2> 
<p><img src="https://images2.imgbox.com/55/a9/EqKGhDmE_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_71"></a>一元函数梯度下降</h2> 
<p><img src="https://images2.imgbox.com/1a/b0/7lUK3StU_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/f6/14/5bpiSffZ_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/26/b4/PxKN90Gr_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_76"></a>上代码实战（房价预测）</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

data <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span>delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>

x_data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
y_data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span>y_data<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

w <span class="token operator">=</span> <span class="token number">0</span>
b <span class="token operator">=</span> <span class="token number">0</span>
alf <span class="token operator">=</span> <span class="token number">0.0001</span>
counter <span class="token operator">=</span> <span class="token number">100</span>

<span class="token keyword">def</span> <span class="token function">costFunc</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span>b<span class="token punctuation">,</span>x_data<span class="token punctuation">,</span>y_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    totErr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        totErr <span class="token operator">+=</span> <span class="token punctuation">(</span>y_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>w<span class="token operator">*</span>x_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span>
    <span class="token keyword">return</span> totErr<span class="token operator">/</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x_data<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">gradient_decent</span><span class="token punctuation">(</span>x_data<span class="token punctuation">,</span>y_data<span class="token punctuation">,</span>w<span class="token punctuation">,</span>b<span class="token punctuation">,</span>alf<span class="token punctuation">,</span>counter<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x_data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">:</span>
        w_temp <span class="token operator">=</span> <span class="token number">0</span>
        b_temp <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            w_temp <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>m<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>w<span class="token operator">*</span>x_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span>b<span class="token operator">-</span>y_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span>x_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            b_temp <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>m<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>w<span class="token operator">*</span>x_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span>b<span class="token operator">-</span>y_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>

        w <span class="token operator">=</span> w<span class="token operator">-</span>alf<span class="token operator">*</span>w_temp
        b <span class="token operator">=</span> b<span class="token operator">-</span>alf<span class="token operator">*</span>b_temp

        <span class="token keyword">if</span> i<span class="token operator">%</span><span class="token number">5</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"count="</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
            plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span>y_data<span class="token punctuation">,</span><span class="token string">'b.'</span><span class="token punctuation">)</span>
            plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span>w<span class="token operator">*</span>x_data<span class="token operator">+</span>b<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span>
            plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'b={},w={},costErr={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>w<span class="token punctuation">,</span>costFunc<span class="token punctuation">(</span>w<span class="token punctuation">,</span>b<span class="token punctuation">,</span>x_data<span class="token punctuation">,</span>y_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span>  w<span class="token punctuation">,</span>b

w<span class="token punctuation">,</span>b <span class="token operator">=</span> gradient_decent<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span>y_data<span class="token punctuation">,</span>w<span class="token punctuation">,</span>b<span class="token punctuation">,</span>alf<span class="token punctuation">,</span>counter<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/be/cb/nH1V6xo4_o.png" alt="在这里插入图片描述"><br> 100次之后<br> <img src="https://images2.imgbox.com/de/dc/eC4BELzE_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02db8b01e8e5af7e284e5e47831d09b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">eNSP防火墙USG6000V使用Web界面登入教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7443ca1605c37ba5108605d40c977797/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于单片机环境监测温湿度PM2.5系统设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>