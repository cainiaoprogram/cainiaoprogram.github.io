<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>R(rstudio)语言协方差分析 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="R(rstudio)语言协方差分析" />
<meta property="og:description" content="使用不同剂量的药物对小鼠进行处理怀孕时间对产下小鼠体重的影响协方差分析 1.载入multcomp包
&gt; library(multcomp)
载入需要的程辑包：mvtnorm
载入需要的程辑包：survival
载入需要的程辑包：TH.data
载入需要的程辑包：MASS
载入程辑包：‘TH.data’
The following object is masked from ‘package:MASS’:
geyser
2.使用multcomp包中的litter数据集
&gt; litter
3.统计分组情况
&gt; table(litter$dose)
4.分组统计平均数
&gt; attach(litter)
&gt; aggregate(weight, by=list(dose), FUN=mean)
结果分析：不同处理组体重不同
5.定义fit变量进行方差分析
&gt; fit &lt;- aov(weight ~gesttime&#43;dose,data=litter) #gesttime为协变量
&gt; summary(fit)
Df Sum Sq Mean Sq F value Pr(&gt;F) gesttime 1 134.3 134.30 8.049 0.00597 **
dose 3 137.1 45.71 2.739 0.04988 * Residuals 69 1151.3 16.69 ---
Signif. codes: 0 ‘***’ 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/8d5f07a26894d4150b30df6e8e06e521/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-24T14:49:24+08:00" />
<meta property="article:modified_time" content="2021-12-24T14:49:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R(rstudio)语言协方差分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 style="margin-left:.0001pt;text-align:justify;"><span style="color:#ffd900;"><strong>使用不同剂量的药物对小鼠进行处理怀孕时间对产下小鼠体重的影响协方差分析</strong></span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#fe2c24;">1.载入multcomp包</span></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#956fe7;">&gt; library(multcomp)</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">载入需要的程辑包：mvtnorm</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">载入需要的程辑包：survival</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">载入需要的程辑包：TH.data</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">载入需要的程辑包：MASS</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">载入程辑包：‘TH.data’</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">The following object is masked from ‘package:MASS’:</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">    geyser</span></p> 
</blockquote> 
<p> <img alt="" height="97" src="https://images2.imgbox.com/95/f2/rvQHZrrU_o.png" width="692"></p> 
<p> <span style="color:#fe2c24;">2.使用multcomp包中的litter数据集</span></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">&gt; litter</span></p> 
</blockquote> 
<p> <img alt="" height="389" src="https://images2.imgbox.com/ad/e4/BgUPL7FX_o.png" width="692"><span style="color:#fe2c24;"> 3.统计分组情况</span></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">&gt; table(litter$dose)</span></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="56" src="https://images2.imgbox.com/27/d9/kNQgFguv_o.png" width="692"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#fe2c24;">4.分组统计平均数</span></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#956fe7;">&gt; attach(litter)</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#956fe7;">&gt; aggregate(weight, by=list(dose), FUN=mean)</span></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="75" src="https://images2.imgbox.com/6a/5b/CRV2HX5b_o.png" width="692"></p> 
<p> <span style="color:#0070c0;">结果分析：不同处理组体重不同</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#fe2c24;">5.定义fit变量进行方差分析</span></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#956fe7;">&gt; fit &lt;- aov(weight ~gesttime+dose,data=litter)  #gesttime为协变量</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#956fe7;">&gt; summary(fit)</span></p> 
 <p style="margin-left:.0001pt;text-align:left;">         <span style="color:#4da8ee;">   Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">gesttime     1  134.3  134.30   8.049 0.00597 **</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">dose         3  137.1   45.71   2.739 0.04988 * </span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">Residuals   69 1151.3   16.69                   </span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">---</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></p> 
</blockquote> 
<p> <img alt="" height="118" src="https://images2.imgbox.com/80/bd/FFQgqgXJ_o.png" width="692"></p> 
<p> <span style="color:#0070c0;">结果分析：小鼠怀孕时间与小鼠体重相关    药物剂量对小鼠体重有影响</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#fe2c24;">6.plot绘制方差结果</span></p> 
<blockquote> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#956fe7;">&gt; plot(fit)</span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">Hit &lt;Return&gt; to see next plot: </span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">Hit &lt;Return&gt; to see next plot: </span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">Hit &lt;Return&gt; to see next plot: </span></p> 
 <p style="margin-left:.0001pt;text-align:left;"><span style="color:#4da8ee;">Hit &lt;Return&gt; to see next plot: </span></p> 
 <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#ff0000;">&gt;</span></p> 
</blockquote> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="389" src="https://images2.imgbox.com/c9/52/MzaGKQei_o.png" width="692"></p> 
<p><img alt="" height="389" src="https://images2.imgbox.com/f4/88/n2TOsQsh_o.png" width="692"></p> 
<p> <img alt="" height="389" src="https://images2.imgbox.com/1d/8e/4V13467f_o.png" width="692"></p> 
<p> <img alt="" height="389" src="https://images2.imgbox.com/99/b3/P6zLhUri_o.png" width="692"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8658d264b114fdf91f356eee0bf130e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">画流程图、类图开源神器：draw.io</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ceb94922d91c8de3f4fba8fddbee879/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">R(rstudio)语言主成分分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>