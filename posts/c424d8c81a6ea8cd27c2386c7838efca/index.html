<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Cookie 与 Session - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Cookie 与 Session" />
<meta property="og:description" content="Cookie 与 Session 一、Cookie 详解1.Cookie 是什么？2.为什么使用Cookie？3.Cookie 产生时间4.Cookie 生存周期5.Cookie 缺陷6.Cookie 使用场景 二、Session 详解1.什么是 Session2.Session 生命周期 三、涉及核心方法四、代码示例（用户登陆）五、小结 一、Cookie 详解 1.Cookie 是什么？ Cookie，是某些网站为了辨别用户身份，进行session跟踪而储存在用户本地终端上的数据，由用户客户端计算机暂时或永久保存的信息；
2.为什么使用Cookie？ 由于 web 程序是使用HTTP传输协议的，而HTTP协议属于无状态的协议，对于事务处理没有记忆能力；因此当后续处理需要前面的信息时就需要重新上传，这样就会导致每次连接传送的数据量增大了；
Cookie的出现就可以解决这一问题：
原理：
第一次登录后服务器返回一些数据（cookie）给浏览器，然后浏览器将其保存在本地，当该用户发送第二次请求时 就会把上次请求存储的cookie数据自动的携带给服务器，服务器通过浏览器携带的数据就能判断当前用户是那个了；
简单来讲cookie的工作原理就是：
给每个用户发放一个通行证，这样服务器就能通过通行证确认用户身份了；
3.Cookie 产生时间 Cookie 的使用首先取决于用户（原因：浏览器可以禁用Cookie，同时服务端也可以不set-cookie；Cookie的两种保存方式：其1为浏览器将Cookie保存在内存中，其2为保存在客户端的硬盘上，之后每次HTTP请求浏览器都会将Cookie 发送给服务端； 4.Cookie 生存周期 Cookie 在生成时就会被指定一个Expire值，这就是Cookie的生存周期，在这个周期内Cookie有效，超出周期就会被清除；
5.Cookie 缺陷 数量受限制 表现在：
一个浏览器能创建的 Cookie 数量最多不超过300个，且每个不能超过4KB，每个web站点能设置的Cookie 总数不能超过20个；
安全性得不到保障： 表现在：存在跨站点脚本攻击
浏览器可以设置禁用Cookie： 6.Cookie 使用场景 基于Cookie 的缺陷，因此一般使用在：
对安全性要求不高；不需要存储大量的数据；主要用于客户端与服务器之间的状态保持； 二、Session 详解 1.什么是 Session Session 也称为会话机制，那什么是会话呢？
会话的本质：就是一个&#34;哈希表&#34;, 存储了一些键值对结构，其中 key 就是令牌的 ID(token/sessionId), value 就是用户信息(用户信息可以根据需求灵活设计)；
sessionId 和 token 就可以理解成是同一个东西的不同叫法；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/c424d8c81a6ea8cd27c2386c7838efca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-18T10:20:22+08:00" />
<meta property="article:modified_time" content="2022-03-18T10:20:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Cookie 与 Session</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Cookie 与 Session</h4> 
 <ul><li><a href="#Cookie__4" rel="nofollow">一、Cookie 详解</a></li><li><ul><li><ul><li><a href="#1Cookie__8" rel="nofollow">1.Cookie 是什么？</a></li><li><a href="#2Cookie_12" rel="nofollow">2.为什么使用Cookie？</a></li><li><a href="#3Cookie__21" rel="nofollow">3.Cookie 产生时间</a></li><li><a href="#4Cookie__27" rel="nofollow">4.Cookie 生存周期</a></li><li><a href="#5Cookie__31" rel="nofollow">5.Cookie 缺陷</a></li><li><a href="#6Cookie__48" rel="nofollow">6.Cookie 使用场景</a></li></ul> 
  </li></ul> 
  </li><li><a href="#Session__58" rel="nofollow">二、Session 详解</a></li><li><ul><li><ul><li><a href="#1_Session_60" rel="nofollow">1.什么是 Session</a></li><li><a href="#2Session__73" rel="nofollow">2.Session 生命周期</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_83" rel="nofollow">三、涉及核心方法</a></li><li><a href="#_115" rel="nofollow">四、代码示例（用户登陆）</a></li><li><a href="#_251" rel="nofollow">五、小结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="Cookie__4"></a>一、Cookie 详解</h2> 
<h4><a id="1Cookie__8"></a>1.Cookie 是什么？</h4> 
<blockquote> 
 <p><code>Cookie</code>，是某些网站为了辨别用户身份，进行<code>session</code>跟踪而储存在用户本地终端上的数据，由用户客户端计算机暂时或永久保存的信息；</p> 
</blockquote> 
<h4><a id="2Cookie_12"></a>2.为什么使用Cookie？</h4> 
<blockquote> 
 <p>由于 <code>web</code> 程序是使用<code>HTTP</code>传输协议的，而<code>HTTP</code>协议属于无状态的协议，对于事务处理没有记忆能力；因此当后续处理需要前面的信息时就需要重新上传，这样就会导致每次连接传送的数据量增大了；<br> <strong><code>Cookie</code>的出现就可以解决这一问题</strong>：<br> <mark>原理</mark>：<br> 第一次登录后服务器返回一些数据<code>（cookie）</code>给浏览器，然后浏览器将其保存在本地，当该用户发送第二次请求时 就会把上次请求存储的<code>cookie</code>数据自动的携带给服务器，服务器通过浏览器携带的数据就能判断当前用户是那个了；<br> <strong>简单来讲<code>cookie</code>的工作原理就是</strong>：<br> 给每个用户发放一个通行证，这样服务器就能通过通行证确认用户身份了；</p> 
</blockquote> 
<h4><a id="3Cookie__21"></a>3.Cookie 产生时间</h4> 
<ul><li><code>Cookie</code> 的使用首先取决于用户（原因：浏览器可以禁用<code>Cookie</code>，同时服务端也可以不<code>set-cookie</code>；</li><li><code>Cookie</code>的两种保存方式：<code>其1为浏览器将Cookie保存在内存中，其2为保存在客户端的硬盘上</code>，之后每次<code>HTTP</code>请求浏览器都会将<code>Cookie</code> 发送给服务端；</li></ul> 
<h4><a id="4Cookie__27"></a>4.Cookie 生存周期</h4> 
<blockquote> 
 <p><code>Cookie</code> 在生成时就会被指定一个<code>Expire</code>值，这就是<code>Cookie</code>的生存周期，在这个周期内<code>Cookie</code>有效，超出周期就会被清除；</p> 
</blockquote> 
<h4><a id="5Cookie__31"></a>5.Cookie 缺陷</h4> 
<ul><li><code>数量受限制</code></li></ul> 
<p><strong>表现在</strong>：</p> 
<blockquote> 
 <p>一个浏览器能创建的 <code>Cookie</code> 数量最多不超过<code>300</code>个，且每个不能超过<code>4KB</code>，每个<code>web</code>站点能设置的<code>Cookie</code> 总数不能超过<code>20</code>个；</p> 
</blockquote> 
<ul><li><code>安全性得不到保障</code>：</li></ul> 
<p><strong>表现在</strong>：存在跨站点脚本攻击</p> 
<ul><li><code>浏览器可以设置禁用Cookie</code>：</li></ul> 
<h4><a id="6Cookie__48"></a>6.Cookie 使用场景</h4> 
<p>基于<code>Cookie</code> 的缺陷，因此一般使用在：</p> 
<ul><li>对安全性要求不高；</li><li>不需要存储大量的数据；</li><li>主要用于客户端与服务器之间的状态保持；</li></ul> 
<hr> 
<h2><a id="Session__58"></a>二、Session 详解</h2> 
<h4><a id="1_Session_60"></a>1.什么是 Session</h4> 
<blockquote> 
 <p><code>Session</code> 也称为会话机制，那什么是会话呢？<br> <mark>会话的本质</mark>：就是一个"哈希表", 存储了一些键值对结构，其中 <code>key</code> 就是令牌的 <code>ID</code>(<code>token/sessionId</code>), <code>value</code> 就是用户信息(用户信息可以根据需求灵活设计)；<br> <strong><code>sessionId 和 token 就可以理解成是同一个东西的不同叫法；</code></strong></p> 
</blockquote> 
<p><strong><mark>流程为</mark></strong>：</p> 
<ul><li>当用户登陆的时候, 服务器在 <code>Session</code> 中新增一个新记录, 并把 <code>sessionId / token</code> 返回给客户端(例如通过 <code>HTTP</code> 响应中的 <code>Set-Cookie</code> 字段返回)；</li><li>客户端后续再给服务器发送请求的时候, 需要在请求中带上 <code>sessionId/ token</code> (例如通过 <code>HTTP</code> 请求中的 <code>Cookie</code> 字段带上)；</li><li>服务器收到请求之后, 根据请求中的 <code>sessionId / token</code> 在 <code>Session</code> 信息中获取到对应的用户信息, 再进行后续操作；</li></ul> 
<h4><a id="2Session__73"></a>2.Session 生命周期</h4> 
<blockquote> 
 <p><code>根据需求设定，一般为半个小时</code>（当你登陆一个服务器时，服务器返回给你一个<code>sessionID</code> ，登陆成功后的半个小时之内没有对该服务器进行任何的<code>HTTP</code>请求，半个小时之后进行一次<code>HTTP</code>请求，就会提示你重新登陆）；</p> 
</blockquote> 
<hr> 
<h2><a id="_83"></a>三、涉及核心方法</h2> 
<p><strong><code>HttpServletRequest</code> 类中的相关方法</strong>：</p> 
<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>HttpSession getSession()</td><td>在服务器中获取会话,参数为<code>true</code>，当会话不存在时，新建会话；参数为<code>false</code>时，会话不存在返回<code>null</code></td></tr><tr><td>Cookie[] getCookies()</td><td>返回一个数组，包含客户端发送请求的所有<code>Cookie</code>对象，会自动把<code>Cookie</code>中的格式解析成键值对</td></tr></tbody></table> 
<p><strong><code>HttpServletResponse</code> 类中的相关方法</strong>：</p> 
<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>void addCookie(Cookie cookie)</td><td>把指定的<code>Cookie</code> 添加到响应中</td></tr></tbody></table> 
<p><strong><code>HttpSession</code> 类中的相关方法</strong>：</p> 
<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>Object getAttribute(String name)</td><td>该方法返回在该 <code>session</code> 会话中具有指定名称的对象,没有返回<code>null</code></td></tr><tr><td>void setAttribute(String name, Object value)</td><td>该方法使用指定的名称绑定一个对象到该 <code>session</code> 会话</td></tr><tr><td>boolean isNew()</td><td>判定当前是否是新创建出的会话</td></tr></tbody></table> 
<p><strong><code>Cookie</code> 类中的相关方法</strong>：</p> 
<table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>String getName()</td><td>返回 <code>cookie</code> 的名称 ，名称在创建后不能改变，(这个值是 <code>Set-Cooke</code> 字段设置给浏览器的)</td></tr><tr><td>String getValue()</td><td>获取与 <code>cookie</code> 关联的值</td></tr><tr><td>void setValue(String newValue)</td><td>设置与 <code>cookie</code> 关联的值</td></tr></tbody></table> 
<h2><a id="_115"></a>四、代码示例（用户登陆）</h2> 
<p><strong><code>简单实现用户登陆，登陆成功后允许访问敏感资源</code></strong>：</p> 
<p><strong>前端代码</strong>：请求方法为 <code>post</code></p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>用户登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入用户名<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入密码<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>后端代码</strong>：</p> 
<ul><li>创建一个 <code>LoginServlet</code></li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> session<span class="token punctuation">;</span>


<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletException<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebServlet<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpSession<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>


<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest req<span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//body:username=xxx&amp;password=xxx</span>
        <span class="token comment">//登陆成功：跳转到request.html,此时允许访问敏感资源(/sensitive)</span>
        <span class="token comment">//登陆失败：返回错误信息，此时不允许访问敏感资源</span>
        String username <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String password <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//模拟数据库进行账号密码登陆</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"123"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//登陆成功</span>
            <span class="token comment">//为登陆成功的用户创建一个session</span>

            <span class="token comment">//tomcat启动时维护了一个数据结Map&lt;String,Session&gt;</span>
            <span class="token comment">//用来保存多个用户的会话信息，键为sessionID的值（随机字符串）</span>
            <span class="token comment">//获取当前请求的session，如果没有获取到就重新创建一个放在Map结构中</span>
            HttpSession session <span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//session对象本身也是一个Map结构，可以保存多组键值对的信息</span>
            session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">,</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//以上代码会设置一个set-cookie,jsessionid=随机字符串</span>
            <span class="token comment">//跳转到登录后的页面</span>
            resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">"request.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//登陆失败，返回错误信息</span>
            resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"登陆失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<ul><li>创建一个 <code>SensitiveServlet</code></li></ul> 
<pre><code class="prism language-java"><span class="token keyword">package</span> session<span class="token punctuation">;</span>

<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletException<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebServlet<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpSession<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/sensitive"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SensitiveServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest req<span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{<!-- --></span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取当次请求的session(此时可能登陆，也可能没有登陆)</span>
        <span class="token comment">//如果没有获取到，就返回null</span>
        HttpSession session <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>session <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//session 不为空</span>
            String username <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>username <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">//session设置的数据也不为空</span>
                resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"用户已登陆，允许访问"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

            resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"用户未登录，不允许访问"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>运行 <code>tomcat</code>,三种情况如下所示</strong>：</p> 
<ul><li>（1）当没有登陆时就访问<code>sensitive</code>，此时出现如下界面所示内容：</li></ul> 
<p><img src="https://images2.imgbox.com/82/e1/X1DZ5sHC_o.png" alt="在这里插入图片描述"></p> 
<ul><li>（2）当访问登陆页面时，输入错误的账号密码时，如下所示：<br> <img src="https://images2.imgbox.com/39/ba/cHLsixeE_o.png" alt="在这里插入图片描述"><br> 当点击提交时，也面会发生跳转，但会显示如下登陆失败页面：<br> <img src="https://images2.imgbox.com/7d/05/wvJnS0AZ_o.png" alt="在这里插入图片描述"></li><li>(3）只有输入正确的账号密码时，页面才会跳转到<code>request.html</code> 中，显示：<br> <img src="https://images2.imgbox.com/81/7a/hYHCpazL_o.png" alt="在这里插入图片描述"></li></ul> 
<p>服务器会给当前用户设置一个<code>set-cookie</code>,<code>jsessionid</code>=随机字符串：<br> <img src="https://images2.imgbox.com/16/6a/EZJzz08v_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_251"></a>五、小结</h2> 
<blockquote> 
 <ul><li><code>Cookie</code> 是客户端的机制，它可以存储在浏览器，也可以存储在本地；<code>Session</code> 是服务器端的机制，只能存储在服务器；</li><li><code>session</code>能够存储任意的<code>Java</code>对象，但<code>cookie</code>只能存储<code>string</code>类型的对象；</li><li><code>session</code>占用服务器性能，<code>session</code>越多就会增加服务器压力；</li><li><code>cookie</code>没有<code>session</code>安全性高；</li><li>单个<code>cookie</code>保存的数据不能超过<code>4KB</code>，而<code>session</code>的大小限制与服务器本身的内存大小相关；</li></ul> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7b57c98716f79c7cef885dfc72fbbcc0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【学】Maven 笔记 | 不食花生的猫</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/982f4367ac72ae8710f4cd2d08f64cfa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Jmeter使用教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>