<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>opencv学习笔记——2.0 - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="opencv学习笔记——2.0" />
<meta property="og:description" content="绘图功能 首先需要创建一个背景来承接绘制的图像
img = np.zeros((512, 512, 3), np.uint8) # 创建黑色的图像 画线
此处img表示绘制的图像，(0, 0)和(511, 511)是线段的两点坐标，(255, 0, 0)为BGR颜色表示法，5表示厚度 cv.line(img, (0, 0), (511, 511), (255, 0, 0), 5) # 绘制一条厚度为5的蓝色对角线 画矩形
(384, 0)和(510, 128)是矩形两对角坐标，BGR，厚度cv.rectangle(img, (384, 0), (510, 128), (0, 255, 0), 3) # 画矩形 画圆圈
(447, 63)为圆中心坐标, 63为半径，(0, 0, 255)BGR，-1表示填充而非线的厚度cv.circle(img, (447, 63), 63, (0, 0, 255), -1) # 画圆圈 画椭圆
(256, 256)为中心坐标, (100, 50)长轴和短轴长度, 0为图像逆时针旋转的角度angle, 0和180表示图像从主轴顺时针方向的开始角度和结束角度，这里的从0到180即表示椭圆的下半圆, 255也可以和前面一样用BGR表示, -1表示填充cv.ellipse(img, (256, 256), (100, 50), 0, 0, 180, 255, -1) # 画椭圆 画多边形# 画多边形，需要包含了顶点坐标的顶点集数据 pts = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/9d3cce930b8144c7323d6b2b2a907496/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-28T15:32:36+08:00" />
<meta property="article:modified_time" content="2023-06-28T15:32:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">opencv学习笔记——2.0</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>绘图功能</h4> 
<p>首先需要创建一个背景来承接绘制的图像</p> 
<pre><code>img = np.zeros((512, 512, 3), np.uint8)     # 创建黑色的图像
</code></pre> 
<ol><li>画线<br> 此处img表示绘制的图像，(0, 0)和(511, 511)是线段的两点坐标，(255, 0, 0)为BGR颜色表示法，5表示厚度<pre><code> cv.line(img, (0, 0), (511, 511), (255, 0, 0), 5)    # 绘制一条厚度为5的蓝色对角线
</code></pre> </li><li>画矩形<br> (384, 0)和(510, 128)是矩形两对角坐标，BGR，厚度<pre><code>cv.rectangle(img, (384, 0), (510, 128), (0, 255, 0), 3)      # 画矩形
</code></pre> </li><li>画圆圈<br> (447, 63)为圆中心坐标, 63为半径，(0, 0, 255)BGR，-1表示填充而非线的厚度<pre><code>cv.circle(img, (447, 63), 63, (0, 0, 255), -1)      # 画圆圈
</code></pre> </li><li>画椭圆<br> (256, 256)为中心坐标, (100, 50)长轴和短轴长度, 0为图像逆时针旋转的角度angle, 0和180表示图像从主轴顺时针方向的开始角度和结束角度，这里的从0到180即表示椭圆的下半圆, 255也可以和前面一样用BGR表示, -1表示填充<pre><code>cv.ellipse(img, (256, 256), (100, 50), 0, 0, 180, 255, -1)  # 画椭圆
</code></pre> </li><li>画多边形<pre><code># 画多边形，需要包含了顶点坐标的顶点集数据
 pts = np.array([[10, 5], [20, 30], [70, 20], [50, 10]], np.int32)
 pts = pts.reshape((-1, 1, 2))       # 从-1开始，步长为1， 到2结束
 cv.polylines(img, [pts], True, (0, 255, 255))   # 绘制多条线，true/false表示是否为闭合图像
</code></pre> </li><li>添加文字<pre><code># 向图像添加文本，参数为：文字数据、位置坐标、字体类型、字体比例、常规内容LINE_AA
 font = cv.FONT_HERSHEY_SIMPLEX
 cv.putText(img, 'OpenCV', (10, 500), font, 4, (255, 255, 255), 2, cv.LINE_AA)
 plt.imshow(img, cmap='gray', interpolation='bicubic')
 plt.show()
</code></pre> </li></ol> 
<p>最终结果如下：<br> <img src="https://images2.imgbox.com/4c/f1/0G5OKOg6_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_44"></a>读取鼠标操作</h4> 
<p>可以使用一下代码查看可用的鼠标事件</p> 
<pre><code>    events = [i for i in dir(cv) if 'EVENT' in i]
    print(events)
</code></pre> 
<p>整理的结果为：</p> 
<pre><code>（1）event:
EVENT_MOUSEMOVE 0 #滑动
EVENT_LBUTTONDOWN 1 #左键点击
EVENT_RBUTTONDOWN 2 #右键点击
EVENT_MBUTTONDOWN 3 #中键点击
EVENT_LBUTTONUP 4 #左键放开
EVENT_RBUTTONUP 5 #右键放开
EVENT_MBUTTONUP 6 #中键放开
EVENT_LBUTTONDBLCLK 7 #左键双击
EVENT_RBUTTONDBLCLK 8 #右键双击
EVENT_MBUTTONDBLCLK 9 #中键双击
（2）x,y:
x,y，代表鼠标位于窗口的（x，y）坐标位置
（3）flags:
代表鼠标的拖拽事件，以及键盘鼠标联合事件
EVENT_FLAG_LBUTTON 1 #左鍵拖曳
EVENT_FLAG_RBUTTON 2 #右鍵拖曳
EVENT_FLAG_MBUTTON 4 #中鍵拖曳
EVENT_FLAG_CTRLKEY 8 #(8~15)按Ctrl不放事件
EVENT_FLAG_SHIFTKEY 16 #(16~31)按Shift不放事件
EVENT_FLAG_ALTKEY 32 #(32~39)按Alt不放事件
</code></pre> 
<p>鼠标回调函数有特定的格式，在所有地方使用都相同。这里简单实现一个鼠标双击画圆的鼠标回调函数：</p> 
<pre><code>    def draw_circle(event, x, y, flags, param):
        if event == cv.EVENT_LBUTTONDBLCLK:     # 双击
            cv.circle(img, (x, y), 100, (255, 255, 255), -1)
</code></pre> 
<p>创建一个背景，并设置鼠标回调</p> 
<pre><code>    img = np.zeros((512, 512, 3), np.uint8)     # 创建一个黑色的图像
    cv.namedWindow('image')
    cv.setMouseCallback('image', draw_circle)
    while True:
        cv.imshow('image', img)
        if cv.waitKey(20) &amp; 0xFF == 27:
            break
    cv.destroyAllWindows()
</code></pre> 
<p>效果如下：<br> <img src="https://images2.imgbox.com/2e/da/TERVoSxO_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_94"></a>更进一步的实现</h4> 
<p>可以考虑多加入鼠标的判断调用来实现更复杂的操作</p> 
<pre><code>drawing = False     # 是否画图的标志
mode = True        # 画矩形/圆形
ix, iy = -1, -1     # 当前鼠标的位置


def draw_circle(event, x, y, flags, param):
    global ix, iy, drawing, mode
    if event == cv.EVENT_LBUTTONDOWN:   # 按下鼠标
        drawing = True
        ix, iy = x, y       # 获取鼠标位置
    elif event == cv.EVENT_MOUSEMOVE:   # 移动鼠标
        if drawing:
            if mode:
                cv.rectangle(img, (ix, iy), (x, y), (255, 255, 255), 1)
            else:
                r = int(math.sqrt((x-ix)**2 + (y-iy)**2))
                cv.circle(img, (ix, iy), r, (0, 0, 255), 1)
    elif event == cv.EVENT_LBUTTONUP:   # 放开鼠标
        drawing = False
        if mode:
            cv.rectangle(img, (ix, iy), (x, y), (255, 255, 255), -1)
        else:
            r = int(math.sqrt((x - ix) ** 2 + (y - iy) ** 2))
            cv.circle(img, (ix, iy), r, (0, 0, 255), -1)


img = np.zeros((512, 512, 3), np.uint8)  # 创建一个黑色的图像
cv.namedWindow('image')
cv.setMouseCallback('image', draw_circle)
while True:
    cv.imshow('image', img)
    if cv.waitKey(20) &amp; 0xFF == 27:
        break
cv.destroyAllWindows()
</code></pre> 
<p>注意，这里我对画圆函数进行了修改，是根据鼠标拖动距离作为半径来画圆，而不是像画笔一样每次都画圆点，效果如下：<br> <img src="https://images2.imgbox.com/bc/7c/k3GpyG1O_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/1a/90/y9c6TNZG_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ac5ba3a161e1e87166f90f2b87c2e26c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何利用python处理excel</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0d6a5b79947d003476681e99a8ba9546/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">opencv学习笔记——3.0</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>