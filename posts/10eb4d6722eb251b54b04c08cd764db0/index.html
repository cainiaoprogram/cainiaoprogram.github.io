<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【操作系统】安全审计-audit - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【操作系统】安全审计-audit" />
<meta property="og:description" content="文章目录 一、audit简介二、开启auditd服务三、相关文件3.1应用配置文件 四、审计规则五、审计日志查询及分析附录1：auditctl -h附录2：systemcall 类型 参考文章：
1、安全-linux audit审计使用入门
2、audit详细使用配置
3、Linux-有哪些常见的System Call？
写在前面：
1.写博客，做日常工作记录，好记性不如烂笔头嘛；
2.内容非原创，参考的文章已上文列出；
3.如有错误，欢迎指正。
一、audit简介 audit是Linux内核提供的一种审计机制，由于audit是内核提供的，因此，在使用audit的过程中就包含内核空间和用户空间部分：
auditctl：用户态程序，用于审计规则配置和配置变更
kaudit：内核空间程序，根据配置好的审计规则记录发生的事件
auditd：用户态程序，通过netlink获取审计日志
通常的使用流程
用户通过auditctl配置审计规则
内核的kauditd程序获取到审计规则后，记录对应的审计日志
用户态的auditd获取审计日志并写入日志文件
二、开启auditd服务 systemctl status auditd.service systemctl start auditd.service 三、相关文件 # 1.应用配置文件 /etc/audit/auditd.conf # 2.添加规则的文件 /etc/audit/rules.d/audit.rules # 3.日志所在目录 /var/log/audit/ 3.1应用配置文件 举例：
# 配置项解析，只列举了一部分 1.log_file：审计日志文件的完整路径； 2.log_format：写日志时使用的格式； 3.flush：多长时间向日志文件中写一次数据。（值可以是NONE、INCREMENTAL、DATA和SYNC之一。如果设置为NONE，则不需要做特殊努力来将数据刷新到日志文件中。如果设置为INCREMENTAL，则用freq选项的值确定多长时间发生一次向磁盘的刷新。如果设置为DATA，则审计数据和日志文件一直是同步的。如果设置为SYNC，则每次写到日志文件时，数据和元数据是同步的。） 4.freq：如果flush设置为INCREMETNAL，审计守护进程在写到日志文件中前 从内核中接收的记录数。 5.num_logs：max_log_file_action：如果没有设置num_logs值，它就默认为0，意味着从来不循环日志文件。设置为ROTATE时要保存的日志文件数目。必须是0~99之间的数。如果设置为小于2，则不会循环日志。如果递增了日志文件的数目，就可能有必要递增/etc/audit/audit.rules中的内核backlog设置值，以便留出日志循环的时间。 6.space_left：以兆字节表示的磁盘空间数量。当达到这个水平时，会采取space_left_action参数中的动作。 7.space_left_action：当磁盘空间量达到space_left中的值时，采取这个动作。有效值为IGNORE、SYSLOG、EMAIL、SUSPEND、SINGLE和 HALT。 7.1如果设置为IGNORE，则不采取动作。 7.2如果设置为SYSLOG，则向系统日志/var/log/messages写一条警告消息。 7.3如果设置为 EMAIL，则从action_mail_acct向这个地址发送一封电子邮件，并向/var/log/messages中写一条警告消息。 7.4如果设置为 SUSPEND，则不再向审计日志文件中写警告消息。 7.5如果设置为SINGLE，则系统将在单用户模式下。如果设置为SALT，则系统会关闭。 8.action_mail_acct：负责维护审计守护进程和日志的管理员的电子邮件地址。如果地址没有主机名，则假定主机名为本地地址，比如root。必须安装sendmail并配置为向指定电子邮件地址发送电子邮件。 9.admin_space_left：以兆字节表示的磁盘空间数量。这个值应小于space_left。如果达到这个水平，则会采取admin_space_left_ action所指定的动作。(用这个选项设置比space_left更多的主动性动作，以防万一space_left_action没有让管理员释放任何磁盘空间。) 10.admin_space_left_action：当自由磁盘空间量达到admin_space_left指定的值时，则采取动作。有效值为IGNORE、SYSLOG、EMAIL、SUSPEND、SINGLE和HALT。与这些值关联的动作与space_left_action中的相同。 11.disk_full_action：如果含有审计文件的分区已满，则采取这个动作。可能值为IGNORE、SYSLOG、SUSPEND、SINGLE和HALT。与这些值关联的动作与space_left _action中的相同。（提示：如果不循环审计日志文件，则含有/var/log/audit/的分区可能变满并引起系统错误。因此，建议让/var/log/audit/位于一个单独的专用分区。） 12.disk_error_action：如果在写审计日志或循环日志文件时检测到错误时采取的动作。值必须是IGNORE、SYSLOG、SUSPEND、SINGLE和HALT之一。与这些值关的动作与space_left_action中的相同。 四、审计规则 控制规则：用于更改审计系统本身的配置和设置。 auditctl -b 8192	# 配置buffer大小为8M auditctl -e 0 auditctl -f 2 auditctl -s 文件系统规则：审核对特定文件或目录的任何类型的访问（比较常见） # 项太多了，举例一个，监控针对/etc/passwd文件的读、写、执行和属性改变，关键字为change_passwd auditctl -w /etc/passwd -p rwxa -k change_passwd # 如果要查询， ausearch -i -k change_passwd 详见附录 auditctl -h" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/10eb4d6722eb251b54b04c08cd764db0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-02T15:06:56+08:00" />
<meta property="article:modified_time" content="2024-01-02T15:06:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【操作系统】安全审计-audit</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#audit_13" rel="nofollow">一、audit简介</a></li><li><a href="#auditd_27" rel="nofollow">二、开启auditd服务</a></li><li><a href="#_34" rel="nofollow">三、相关文件</a></li><li><ul><li><a href="#31_44" rel="nofollow">3.1应用配置文件</a></li></ul> 
  </li><li><a href="#_72" rel="nofollow">四、审计规则</a></li><li><a href="#_100" rel="nofollow">五、审计日志查询及分析</a></li><li><a href="#1auditctl_h_132" rel="nofollow">附录1：auditctl -h</a></li><li><a href="#2systemcall__173" rel="nofollow">附录2：systemcall 类型</a></li></ul> 
</div> 
<p></p> 
<p>参考文章：</p> 
<p><a href="https://blog.csdn.net/luofengmacheng/article/details/133776770?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-133776770-blog-130580625.235%5Ev38%5Epc_relevant_anti_vip&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">1、安全-linux audit审计使用入门</a><br> <a href="https://blog.csdn.net/qq_39586877/article/details/130580625">2、audit详细使用配置</a><br> <a href="https://www.cnblogs.com/Skybiubiu/p/17315060.html" rel="nofollow">3、Linux-有哪些常见的System Call？</a></p> 
<p>写在前面：<br> 1.写博客，做日常工作记录，好记性不如烂笔头嘛；<br> 2.内容非原创，参考的文章已上文列出；<br> 3.如有错误，欢迎指正。</p> 
<h2><a id="audit_13"></a>一、audit简介</h2> 
<p>audit是Linux内核提供的一种审计机制，由于audit是内核提供的，因此，在<font color="red">使用audit的过程中就包含内核空间和用户空间部分</font>：</p> 
<p><code>auditctl</code>：用户态程序，用于审计规则配置和配置变更<br> kaudit：内核空间程序，根据配置好的审计规则记录发生的事件<br> auditd：用户态程序，通过netlink获取审计日志</p> 
<blockquote> 
 <p>通常的使用流程</p> 
</blockquote> 
<p>用户通过auditctl配置审计规则<br> 内核的kauditd程序获取到审计规则后，记录对应的审计日志<br> 用户态的auditd获取审计日志并写入日志文件</p> 
<h2><a id="auditd_27"></a>二、开启auditd服务</h2> 
<pre><code class="prism language-bash">systemctl status auditd.service
systemctl start auditd.service
</code></pre> 
<p><img src="https://images2.imgbox.com/54/f7/H9MM3a9k_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_34"></a>三、相关文件</h2> 
<pre><code class="prism language-bash"><span class="token comment"># 1.应用配置文件</span>
/etc/audit/auditd.conf
<span class="token comment"># 2.添加规则的文件</span>
/etc/audit/rules.d/audit.rules
<span class="token comment"># 3.日志所在目录</span>
/var/log/audit/
</code></pre> 
<h3><a id="31_44"></a>3.1应用配置文件</h3> 
<p>举例：<br> <img src="https://images2.imgbox.com/26/aa/mZWT5JCd_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token comment"># 配置项解析，只列举了一部分</span>
<span class="token number">1</span>.log_file：审计日志文件的完整路径；
<span class="token number">2</span>.log_format：写日志时使用的格式；
<span class="token number">3</span>.flush：多长时间向日志文件中写一次数据。（值可以是NONE、INCREMENTAL、DATA和SYNC之一。如果设置为NONE，则不需要做特殊努力来将数据刷新到日志文件中。如果设置为INCREMENTAL，则用freq选项的值确定多长时间发生一次向磁盘的刷新。如果设置为DATA，则审计数据和日志文件一直是同步的。如果设置为SYNC，则每次写到日志文件时，数据和元数据是同步的。）
<span class="token number">4</span>.freq：如果flush设置为INCREMETNAL，审计守护进程在写到日志文件中前 从内核中接收的记录数。
<span class="token number">5</span>.num_logs：max_log_file_action：如果没有设置num_logs值，它就默认为0，意味着从来不循环日志文件。设置为ROTATE时要保存的日志文件数目。必须是0~99之间的数。如果设置为小于2，则不会循环日志。如果递增了日志文件的数目，就可能有必要递增/etc/audit/audit.rules中的内核backlog设置值，以便留出日志循环的时间。
<span class="token number">6</span>.space_left：以兆字节表示的磁盘空间数量。当达到这个水平时，会采取space_left_action参数中的动作。
<span class="token number">7</span>.space_left_action：当磁盘空间量达到space_left中的值时，采取这个动作。有效值为IGNORE、SYSLOG、EMAIL、SUSPEND、SINGLE和 HALT。
	<span class="token number">7.1</span>如果设置为IGNORE，则不采取动作。
	<span class="token number">7.2</span>如果设置为SYSLOG，则向系统日志/var/log/messages写一条警告消息。
	<span class="token number">7.3</span>如果设置为 EMAIL，则从action_mail_acct向这个地址发送一封电子邮件，并向/var/log/messages中写一条警告消息。
	<span class="token number">7.4</span>如果设置为 SUSPEND，则不再向审计日志文件中写警告消息。
	<span class="token number">7.5</span>如果设置为SINGLE，则系统将在单用户模式下。如果设置为SALT，则系统会关闭。
<span class="token number">8</span>.action_mail_acct：负责维护审计守护进程和日志的管理员的电子邮件地址。如果地址没有主机名，则假定主机名为本地地址，比如root。必须安装sendmail并配置为向指定电子邮件地址发送电子邮件。
<span class="token number">9</span>.admin_space_left：以兆字节表示的磁盘空间数量。这个值应小于space_left。如果达到这个水平，则会采取admin_space_left_ action所指定的动作。<span class="token punctuation">(</span>用这个选项设置比space_left更多的主动性动作，以防万一space_left_action没有让管理员释放任何磁盘空间。<span class="token punctuation">)</span>
<span class="token number">10</span>.admin_space_left_action：当自由磁盘空间量达到admin_space_left指定的值时，则采取动作。有效值为IGNORE、SYSLOG、EMAIL、SUSPEND、SINGLE和HALT。与这些值关联的动作与space_left_action中的相同。
<span class="token number">11</span>.disk_full_action：如果含有审计文件的分区已满，则采取这个动作。可能值为IGNORE、SYSLOG、SUSPEND、SINGLE和HALT。与这些值关联的动作与space_left _action中的相同。（提示：如果不循环审计日志文件，则含有/var/log/audit/的分区可能变满并引起系统错误。因此，建议让/var/log/audit/位于一个单独的专用分区。）
<span class="token number">12</span>.disk_error_action：如果在写审计日志或循环日志文件时检测到错误时采取的动作。值必须是IGNORE、SYSLOG、SUSPEND、SINGLE和HALT之一。与这些值关的动作与space_left_action中的相同。
</code></pre> 
<h2><a id="_72"></a>四、审计规则</h2> 
<ol><li>控制规则：用于更改审计系统本身的配置和设置。</li></ol> 
<pre><code class="prism language-bash">auditctl <span class="token parameter variable">-b</span> <span class="token number">8192</span>	<span class="token comment"># 配置buffer大小为8M</span>
auditctl <span class="token parameter variable">-e</span> <span class="token number">0</span>
auditctl <span class="token parameter variable">-f</span> <span class="token number">2</span>
auditctl <span class="token parameter variable">-s</span>
</code></pre> 
<ol start="2"><li><strong>文件系统规则：审核对特定文件或目录的任何类型的访问（比较常见）</strong></li></ol> 
<pre><code class="prism language-bash"><span class="token comment"># 项太多了，举例一个，监控针对/etc/passwd文件的读、写、执行和属性改变，关键字为change_passwd</span>
auditctl <span class="token parameter variable">-w</span> /etc/passwd <span class="token parameter variable">-p</span> rwxa <span class="token parameter variable">-k</span> change_passwd
<span class="token comment"># 如果要查询，</span>
ausearch <span class="token parameter variable">-i</span> <span class="token parameter variable">-k</span> change_passwd
</code></pre> 
<p>详见附录 <code>auditctl -h</code></p> 
<ol start="3"><li>系统调用规则：用于监视由任何进程或特定用户进行的系统调用</li></ol> 
<pre><code class="prism language-bash"><span class="token comment"># -S 设置要监控的系统调用名或者系统调用号，下述命令仅作举例</span>
需要补充例子
</code></pre> 
<p>同样：详见附录 <code>auditctl -h</code></p> 
<h2><a id="_100"></a>五、审计日志查询及分析</h2> 
<pre><code class="prism language-bash"><span class="token comment"># 仅列举比较常用的方式，-k后面跟创建审计规则时设置的关键字</span>
ausearch <span class="token parameter variable">-i</span> <span class="token parameter variable">-k</span> ***
</code></pre> 
<p>审计日志类似：<font color="grey" size="2">（各个系统可不同）</font><br> <img src="https://images2.imgbox.com/55/47/cQeY5umt_o.png" alt="在这里插入图片描述"><br> <strong>审计日志-字段分析</strong></p> 
<ul><li> <p>type：audit消息类型，消息类型有100多种（具体查看请点击：<a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-audit_record_types" rel="nofollow">audit消息类型</a>）<br> <font size="2">比较常见有SYSCALL：代表这条记录是向内核的系统调用触发产生的．</font></p> </li><li> <p>msg：消息的ID， 它有两个部分组成， 分号之前的是Unix的时间戳，分号之后的是真正的event ID（同一个应用程序的相同system call拥有相同的event ID， 同一个应用的不同system call则不同。）</p> </li><li> <p>arch: 调用system call的CPU构架</p> </li><li> <p>syscall：system call的类型（可使用<code>ausyscall --dump</code>来显示所有的系统调用）</p> </li><li> <p>success：system call是成功或者失败</p> </li><li> <p>comm: 出现在任务列表中，应用程序的名称。</p> </li><li> <p>exe： 二进制程序的解析路径。</p> </li><li> <p>ses： 用户登录的session ID.</p> </li><li> <p>auid： audit ID， 针对某一用户,一个进程会被分配一个audit ID， 该audit ID会被传递给子进程，尽管在系统中用户切换，该audit ID将始终保持一致。 这样我们可以针对对某一用户进行trace。</p> </li><li> <p><font color="grey" size="2"> a0 to a3： 系统调用的前四个参数的数字化，可以通过ausearch解码查看</font></p> </li><li> <p><font color="grey" size="2">items： 传递到应用程序的字符串数量</font></p> </li><li> <p><font color="grey" size="2">ppid：父进程的PID</font></p> </li><li> <p><font color="grey" size="2">pid：该进程的PID</font></p> </li><li> <p><font color="grey" size="2">uid： user ID。</font></p> </li><li> <p><font color="grey" size="2">gid: group ID。</font></p> </li><li> <p><font color="grey" size="2">euid, suid, fsuid: Effective user ID, set user ID, and file system user ID.</font></p> </li><li> <p><font color="grey" size="2">egid, sgid, fsgid: Effective group ID, set group ID, and file system group ID.</font></p> </li><li> <p><font color="grey" size="2">tty: 应用程序开启的终端，这种情况下pseudo-terminal used in an SSH session.</font></p> </li></ul> 
<h2><a id="1auditctl_h_132"></a>附录1：auditctl -h</h2> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>auditadm@localhost ~<span class="token punctuation">]</span>$ auditctl <span class="token parameter variable">-h</span>
usage: auditctl <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
    <span class="token parameter variable">-a</span> <span class="token operator">&lt;</span>l,a<span class="token operator">&gt;</span>                          Append rule to end of <span class="token operator">&lt;</span>l<span class="token operator">&gt;</span>ist with <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span>ction
    <span class="token parameter variable">-A</span> <span class="token operator">&lt;</span>l,a<span class="token operator">&gt;</span>                          Add rule at beginning of <span class="token operator">&lt;</span>l<span class="token operator">&gt;</span>ist with <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span>ction
    <span class="token parameter variable">-b</span> <span class="token operator">&lt;</span>backlog<span class="token operator">&gt;</span>                      Set max number of outstanding audit buffers
                                      allowed <span class="token assign-left variable">Default</span><span class="token operator">=</span><span class="token number">64</span>
    <span class="token parameter variable">-c</span>                                Continue through errors <span class="token keyword">in</span> rules
    <span class="token parameter variable">-C</span> <span class="token assign-left variable">f</span><span class="token operator">=</span>f                            Compare collected fields <span class="token keyword">if</span> available:
                                      Field name, operator<span class="token punctuation">(</span><span class="token operator">=</span>,<span class="token operator">!=</span><span class="token punctuation">)</span>, field name
    <span class="token parameter variable">-d</span> <span class="token operator">&lt;</span>l,a<span class="token operator">&gt;</span>                          Delete rule from <span class="token operator">&lt;</span>l<span class="token operator">&gt;</span>ist with <span class="token operator">&lt;</span>a<span class="token operator">&gt;</span>ction
                                      <span class="token assign-left variable">l</span><span class="token operator">=</span>task,exit,user,exclude
                                      <span class="token assign-left variable">a</span><span class="token operator">=</span>never,always
    <span class="token parameter variable">-D</span>                                Delete all rules and watches
    <span class="token parameter variable">-e</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span>                         Set enabled flag
    <span class="token parameter variable">-f</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span>                         Set failure flag
                                      <span class="token assign-left variable">0</span><span class="token operator">=</span>silent <span class="token assign-left variable">1</span><span class="token operator">=</span>printk <span class="token assign-left variable">2</span><span class="token operator">=</span>panic
    <span class="token parameter variable">-F</span> <span class="token assign-left variable">f</span><span class="token operator">=</span>v                            Build rule: field name, operator<span class="token punctuation">(</span><span class="token operator">=</span>,<span class="token operator">!=</span>,<span class="token operator">&lt;</span>,<span class="token operator">&gt;</span>,<span class="token operator">&lt;=</span>,
                                      <span class="token operator">&gt;=</span>,<span class="token operator">&amp;</span>,<span class="token operator">&amp;</span><span class="token operator">=</span><span class="token punctuation">)</span> value
    <span class="token parameter variable">-h</span>                                Help
    <span class="token parameter variable">-i</span>                                Ignore errors when reading rules from <span class="token function">file</span>
    <span class="token parameter variable">-k</span> <span class="token operator">&lt;</span>key<span class="token operator">&gt;</span>                          Set filter key on audit rule
    <span class="token parameter variable">-l</span>                                List rules
    <span class="token parameter variable">-m</span> text                           Send a user-space message
    <span class="token parameter variable">-p</span> <span class="token punctuation">[</span>r<span class="token operator">|</span>w<span class="token operator">|</span>x<span class="token operator">|</span>a<span class="token punctuation">]</span>                      Set permissions filter on <span class="token function">watch</span>
                                      <span class="token assign-left variable">r</span><span class="token operator">=</span>read, <span class="token assign-left variable">w</span><span class="token operator">=</span>write, <span class="token assign-left variable">x</span><span class="token operator">=</span>execute, <span class="token assign-left variable">a</span><span class="token operator">=</span>attribute
    <span class="token parameter variable">-q</span> <span class="token operator">&lt;</span>mount,subtree<span class="token operator">&gt;</span>                <span class="token function">make</span> subtree part of <span class="token function">mount</span> point's <span class="token function">dir</span> watches
    <span class="token parameter variable">-r</span> <span class="token operator">&lt;</span>rate<span class="token operator">&gt;</span>                         Set limit <span class="token keyword">in</span> messages/sec <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">=</span>none<span class="token punctuation">)</span>
    <span class="token parameter variable">-R</span> <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>                         <span class="token builtin class-name">read</span> rules from <span class="token function">file</span>
    <span class="token parameter variable">-s</span>                                Report status
    <span class="token parameter variable">-S</span> syscall                        Build rule: syscall name or number
    <span class="token parameter variable">--signal</span> <span class="token operator">&lt;</span>signal<span class="token operator">&gt;</span>                 Send the specified signal to the daemon    <span class="token parameter variable">-t</span>                                Trim directory watches
    <span class="token parameter variable">-v</span>                                Version
    <span class="token parameter variable">-w</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>                         Insert <span class="token function">watch</span> at <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>
    <span class="token parameter variable">-W</span> <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>                         Remove <span class="token function">watch</span> at <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span>
    --loginuid-immutable              Make loginuids unchangeable once <span class="token builtin class-name">set</span>
    <span class="token parameter variable">--backlog_wait_time</span>               Set the kernel backlog_wait_time
    --reset-lost                      Reset the lost record counter
</code></pre> 
<h2><a id="2systemcall__173"></a>附录2：systemcall 类型</h2> 
<p>网上查询的，好多说是看这个文件https://github.com/torvalds/linux/blob/master/arch/sh/include/asm/unistd.h</p> 
<pre><code class="prism language-bash"><span class="token comment"># 不同系统间存在差距</span>
<span class="token comment"># 下文只做简单举例，编号代表 类型值 </span>
$ ausyscall <span class="token parameter variable">--dump</span>
Using aarch64 syscall table:
<span class="token number">0</span>	io_setup
<span class="token number">1</span>	io_destroy
<span class="token number">2</span>	io_submit
<span class="token number">3</span>	io_cancel
<span class="token number">4</span>	io_getevents
<span class="token number">5</span>	setxattr
<span class="token number">6</span>	lsetxattr
<span class="token number">7</span>	fsetxattr
<span class="token number">8</span>	getxattr
<span class="token number">9</span>	lgetxattr
<span class="token number">10</span>	fgetxattr
<span class="token number">11</span>	listxattr
<span class="token number">12</span>	llistxattr
<span class="token number">13</span>	flistxattr
<span class="token number">14</span>	removexattr
<span class="token number">15</span>	lremovexattr
<span class="token number">16</span>	fremovexattr
<span class="token number">17</span>	getcwd
<span class="token number">18</span>	lookup_dcookie
<span class="token number">19</span>	eventfd2
<span class="token number">20</span>	epoll_create1
<span class="token number">21</span>	epoll_ctl
<span class="token number">22</span>	epoll_pwait
<span class="token number">23</span>	dup
<span class="token number">24</span>	dup3
<span class="token number">25</span>	fcntl
<span class="token number">26</span>	inotify_init1
<span class="token number">27</span>	inotify_add_watch
<span class="token number">28</span>	inotify_rm_watch
<span class="token number">29</span>	ioctl
<span class="token number">30</span>	ioprio_set
<span class="token number">31</span>	ioprio_get
<span class="token number">32</span>	flock
<span class="token number">33</span>	mknodat
<span class="token number">34</span>	mkdirat
<span class="token number">35</span>	unlinkat
<span class="token number">36</span>	symlinkat
<span class="token number">37</span>	linkat
<span class="token number">38</span>	renameat
<span class="token number">39</span>	umount2
<span class="token number">40</span>	<span class="token function">mount</span>
<span class="token number">41</span>	pivot_root
<span class="token number">42</span>	nfsservctl
<span class="token number">43</span>	statfs
<span class="token number">44</span>	fstatfs
<span class="token number">45</span>	truncate
<span class="token number">46</span>	ftruncate
<span class="token number">47</span>	fallocate
<span class="token number">48</span>	faccessat
<span class="token number">49</span>	chdir
<span class="token number">50</span>	fchdir
<span class="token number">51</span>	<span class="token function">chroot</span>
<span class="token number">52</span>	fchmod
<span class="token number">53</span>	fchmodat
<span class="token number">54</span>	fchownat
<span class="token number">55</span>	fchown
<span class="token number">56</span>	openat
<span class="token number">57</span>	close
<span class="token number">58</span>	vhangup
<span class="token number">59</span>	pipe2
<span class="token number">60</span>	<span class="token function">quotactl</span>
<span class="token number">61</span>	getdents
<span class="token number">62</span>	lseek
<span class="token number">63</span>	<span class="token builtin class-name">read</span>
<span class="token number">64</span>	<span class="token function">write</span>
<span class="token number">65</span>	readv
<span class="token number">66</span>	writev
<span class="token number">67</span>	pread
<span class="token number">68</span>	pwrite
<span class="token number">69</span>	preadv
<span class="token number">70</span>	pwritev
<span class="token number">71</span>	sendfile
<span class="token number">72</span>	pselect6
<span class="token number">73</span>	ppoll
<span class="token number">74</span>	signalfd4
<span class="token number">75</span>	vmsplice
<span class="token number">76</span>	splice
<span class="token number">77</span>	<span class="token function">tee</span>
<span class="token number">78</span>	readlinkat
<span class="token number">79</span>	newfstatat
<span class="token number">80</span>	newfstat
<span class="token number">81</span>	<span class="token function">sync</span>
<span class="token number">82</span>	fsync
<span class="token number">83</span>	fdatasync
<span class="token number">84</span>	sync_file_range
<span class="token number">85</span>	timerfd_create
<span class="token number">86</span>	timerfd_settime
<span class="token number">87</span>	timerfd_gettime
<span class="token number">88</span>	utimensat
<span class="token number">89</span>	acct
<span class="token number">90</span>	capget
<span class="token number">91</span>	capset
<span class="token number">92</span>	personality
<span class="token number">93</span>	<span class="token builtin class-name">exit</span>
<span class="token number">94</span>	exit_group
<span class="token number">95</span>	waitid
<span class="token number">96</span>	set_tid_address
<span class="token number">97</span>	unshare
<span class="token number">98</span>	futex
<span class="token number">99</span>	set_robust_list
<span class="token number">100</span>	get_robust_list
<span class="token number">101</span>	nanosleep
<span class="token number">102</span>	getitimer
<span class="token number">103</span>	setitimer
<span class="token number">104</span>	kexec_load
<span class="token number">105</span>	init_module
<span class="token number">106</span>	delete_module
<span class="token number">107</span>	timer_create
<span class="token number">108</span>	timer_gettime
<span class="token number">109</span>	timer_getoverrun
<span class="token number">110</span>	timer_settime
<span class="token number">111</span>	timer_delete
<span class="token number">112</span>	clock_settime
<span class="token number">113</span>	clock_gettime
<span class="token number">114</span>	clock_getres
<span class="token number">115</span>	clock_nanosleep
<span class="token number">116</span>	syslog
<span class="token number">117</span>	ptrace
<span class="token number">118</span>	sched_setparam
<span class="token number">119</span>	sched_setscheduler
<span class="token number">120</span>	sched_getscheduler
<span class="token number">121</span>	sched_getparam
<span class="token number">122</span>	sched_setaffinity
<span class="token number">123</span>	sched_getaffinity
<span class="token number">124</span>	sched_yield
<span class="token number">125</span>	sched_get_priority_max
<span class="token number">126</span>	sched_get_priority_min
<span class="token number">127</span>	sched_rr_get_interval
<span class="token number">128</span>	restart_syscall
<span class="token number">129</span>	<span class="token function">kill</span>
<span class="token number">130</span>	tkill
<span class="token number">131</span>	tgkill
<span class="token number">132</span>	sigaltstack
<span class="token number">133</span>	rt_sigsuspend
<span class="token number">134</span>	rt_sigaction
<span class="token number">135</span>	rt_sigprocmask
<span class="token number">136</span>	rt_sigpending
<span class="token number">137</span>	rt_sigtimedwait
<span class="token number">138</span>	rt_sigqueueinfo
<span class="token number">139</span>	rt_sigreturn
<span class="token number">140</span>	setpriority
<span class="token number">141</span>	getpriority
<span class="token number">142</span>	<span class="token function">reboot</span>
<span class="token number">143</span>	setregid
<span class="token number">144</span>	setgid
<span class="token number">145</span>	setreuid
<span class="token number">146</span>	setuid
<span class="token number">147</span>	setresuid
<span class="token number">148</span>	getresuid
<span class="token number">149</span>	setresgid
<span class="token number">150</span>	getresgid
<span class="token number">151</span>	setfsuid
<span class="token number">152</span>	setfsgid
<span class="token number">153</span>	<span class="token builtin class-name">times</span>
<span class="token number">154</span>	setpgid
<span class="token number">155</span>	getpgid
<span class="token number">156</span>	getsid
<span class="token number">157</span>	setsid
<span class="token number">158</span>	getgroups
<span class="token number">159</span>	setgroups
<span class="token number">160</span>	<span class="token function">uname</span>
<span class="token number">161</span>	sethostname
<span class="token number">162</span>	setdomainname
<span class="token number">163</span>	getrlimit
<span class="token number">164</span>	setrlimit
<span class="token number">165</span>	getrusage
<span class="token number">166</span>	<span class="token builtin class-name">umask</span>
<span class="token number">167</span>	prctl
<span class="token number">168</span>	getcpu
<span class="token number">169</span>	gettimeofday
<span class="token number">170</span>	settimeofday
<span class="token number">171</span>	adjtimex
<span class="token number">172</span>	getpid
<span class="token number">173</span>	getppid
<span class="token number">174</span>	getuid
<span class="token number">175</span>	geteuid
<span class="token number">176</span>	getgid
<span class="token number">177</span>	getegid
<span class="token number">178</span>	gettid
<span class="token number">179</span>	sysinfo
<span class="token number">180</span>	mq_open
<span class="token number">181</span>	mq_unlink
<span class="token number">182</span>	mq_timedsend
<span class="token number">183</span>	mq_timedreceive
<span class="token number">184</span>	mq_notify
<span class="token number">185</span>	mq_getsetattr
<span class="token number">186</span>	msgget
<span class="token number">187</span>	msgctl
<span class="token number">188</span>	msgrcv
<span class="token number">189</span>	msgsnd
<span class="token number">190</span>	semget
<span class="token number">191</span>	semctl
<span class="token number">192</span>	semtimedop
<span class="token number">193</span>	semop
<span class="token number">194</span>	shmget
<span class="token number">195</span>	shmctl
<span class="token number">196</span>	shmat
<span class="token number">197</span>	shmdt
<span class="token number">198</span>	socket
<span class="token number">199</span>	socketpair
<span class="token number">200</span>	<span class="token builtin class-name">bind</span>
<span class="token number">201</span>	listen
<span class="token number">202</span>	accept
<span class="token number">203</span>	connect
<span class="token number">204</span>	getsockname
<span class="token number">205</span>	getpeername
<span class="token number">206</span>	sendto
<span class="token number">207</span>	recvfrom
<span class="token number">208</span>	setsockopt
<span class="token number">209</span>	getsockopt
<span class="token number">210</span>	<span class="token function">shutdown</span>
<span class="token number">211</span>	sendmsg
<span class="token number">212</span>	recvmsg
<span class="token number">213</span>	readahead
<span class="token number">214</span>	brk
<span class="token number">215</span>	munmap
<span class="token number">216</span>	mremap
<span class="token number">217</span>	add_key
<span class="token number">218</span>	request_key
<span class="token number">219</span>	keyctl
<span class="token number">220</span>	clone
<span class="token number">221</span>	execve
<span class="token number">222</span>	mmap
<span class="token number">223</span>	fadvise64
<span class="token number">224</span>	<span class="token function">swapon</span>
<span class="token number">225</span>	swapoff
<span class="token number">226</span>	mprotect
<span class="token number">227</span>	msync
<span class="token number">228</span>	mlock
<span class="token number">229</span>	munlock
<span class="token number">230</span>	mlockall
<span class="token number">231</span>	munlockall
<span class="token number">232</span>	mincore
<span class="token number">233</span>	madvise
<span class="token number">234</span>	remap_file_pages
<span class="token number">235</span>	mbind
<span class="token number">236</span>	get_mempolicy
<span class="token number">237</span>	set_mempolicy
<span class="token number">238</span>	migrate_pages
<span class="token number">239</span>	move_pages
<span class="token number">240</span>	rt_tgsigqueueinfo
<span class="token number">241</span>	perf_event_open
<span class="token number">242</span>	accept4
<span class="token number">243</span>	recvmmsg
<span class="token number">260</span>	wait4
<span class="token number">261</span>	prlimit64
<span class="token number">262</span>	fanotify_init
<span class="token number">263</span>	fanotify_mark
<span class="token number">264</span>	name_to_handle_at
<span class="token number">265</span>	open_by_handle_at
<span class="token number">266</span>	clock_adjtime
<span class="token number">267</span>	syncfs
<span class="token number">268</span>	setns
<span class="token number">269</span>	sendmmsg
<span class="token number">270</span>	process_vm_readv
<span class="token number">271</span>	process_vm_writev
<span class="token number">272</span>	kcmp
<span class="token number">273</span>	finit_module
<span class="token number">274</span>	sched_setattr
<span class="token number">275</span>	sched_getattr
<span class="token number">276</span>	renameat2
<span class="token number">277</span>	seccomp
<span class="token number">278</span>	getrandom
<span class="token number">279</span>	memfd_create
<span class="token number">280</span>	bpf
<span class="token number">281</span>	execveat
<span class="token number">282</span>	userfaultfd
<span class="token number">283</span>	membarrier
<span class="token number">284</span>	mlock2
<span class="token number">285</span>	copy_file_range
<span class="token number">286</span>	preadv2
<span class="token number">287</span>	pwritev2
<span class="token number">288</span>	pkey_mprotect
<span class="token number">289</span>	pkey_alloc
<span class="token number">290</span>	pkey_free
<span class="token number">291</span>	statx
<span class="token number">292</span>	io_pgetevents
<span class="token number">293</span>	rseq
<span class="token number">294</span>	kexec_file_load
<span class="token number">424</span>	pidfd_send_signal
<span class="token number">425</span>	io_uring_setup
<span class="token number">426</span>	io_uring_enter
<span class="token number">427</span>	io_uring_register
<span class="token number">428</span>	open_tree
<span class="token number">429</span>	move_mount
<span class="token number">430</span>	fsopen
<span class="token number">431</span>	fsconfig
<span class="token number">432</span>	fsmount
<span class="token number">433</span>	fspick
<span class="token number">434</span>	pidfd_open
<span class="token number">435</span>	clone3
<span class="token number">1024</span>	<span class="token function">open</span>
<span class="token number">1025</span>	<span class="token function">link</span>
<span class="token number">1026</span>	unlink
<span class="token number">1027</span>	<span class="token function">mknod</span>
<span class="token number">1028</span>	<span class="token function">chmod</span>
<span class="token number">1029</span>	<span class="token function">chown</span>
<span class="token number">1030</span>	<span class="token function">mkdir</span>
<span class="token number">1031</span>	<span class="token function">rmdir</span>
<span class="token number">1032</span>	lchown
<span class="token number">1033</span>	access
<span class="token number">1034</span>	<span class="token function">rename</span>
<span class="token number">1035</span>	readlink
<span class="token number">1036</span>	symlink
<span class="token number">1037</span>	utimes
<span class="token number">1038</span>	stat64
<span class="token number">1039</span>	lstat64
<span class="token number">1040</span>	pipe
<span class="token number">1041</span>	dup2
<span class="token number">1042</span>	epoll_create
<span class="token number">1043</span>	inotify_init
<span class="token number">1044</span>	eventfd
<span class="token number">1045</span>	signalfd
<span class="token number">1049</span>	newstat
<span class="token number">1050</span>	newlstat
<span class="token number">1059</span>	alarm
<span class="token number">1060</span>	getpgrp
<span class="token number">1061</span>	pause
<span class="token number">1062</span>	<span class="token function">time</span>
<span class="token number">1063</span>	utime
<span class="token number">1064</span>	creat
<span class="token number">1066</span>	futimesat
<span class="token number">1067</span>	<span class="token keyword">select</span>
<span class="token number">1068</span>	poll
<span class="token number">1069</span>	epoll_wait
<span class="token number">1070</span>	ustat
<span class="token number">1071</span>	vfork
<span class="token number">1073</span>	recv
<span class="token number">1074</span>	send
<span class="token number">1075</span>	bdflush
<span class="token number">1076</span>	oldumount
<span class="token number">1077</span>	uselib
<span class="token number">1078</span>	<span class="token function">sysctl</span>
<span class="token number">1079</span>	fork
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/261c1e829c0806b1aef0c51d8db161a2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Flutter 中使用 ICON</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b739f05a433612ca43337c151870d754/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实验4.4 动态路由OSPF协议的配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>