<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>轻量级网络模型MobileNet发展脉络（V1-V2-V3） - 菜鸟程序员博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="轻量级网络模型MobileNet发展脉络（V1-V2-V3）" />
<meta property="og:description" content="卷积神经网络发展 卷积神经网络被广泛应用在图像分类、目标检测等视觉任务中，并取得了巨大的成功。然而，卷积神经网络通常需要较大的运算量和内存占用，在移动端以及嵌入式设备等资源受限的环境中受到限制，因此需要进行网络压缩。从2012年AlexNet网络提出获得image net分类任务第一名后，深度学习模型迅速发展，网络层数不断加深，2015年提出的ResNet的准确率首次超越人类，但同时网络层数也达到了152层。
MobileNet系列是谷歌推出的轻量级网络模型，旨在不过多牺牲模型性能的同时大幅度减小模型的尺寸和加快模型的运算速度。
MobileNet V1 MobileNet V1基于一种流线型结构使用深度可分离卷积来构造轻型权重深度神经网络。主要用于移动端以及嵌入式设备。模型包含两个权衡延迟和准确率的全局超参数-宽度乘法器(width multiplier)和分辨率乘法器(resolution multiplier),允许模型构造器能够根据特定问题选择合适大小的模型。
深度可分离卷积 深度可分离卷积是一种将标准卷积分解成深度卷积以及一个1x1的卷积即逐点卷积。能够有效减少计算量以及模型的大小。如图所示，一个标准的卷积(a)被分解成深度卷积(b)以及1x1的逐点卷积(c)。 一个 3x3 Conv 被拆分成了 3x3 Depthwise Conv和 1x1 Conv
常规卷积操作 假设输入特征图的尺寸（H, W, D）是
DF⋅DF⋅M ，可以得到：
- 输入特征图尺寸：DF⋅DF⋅M
- 卷积核尺寸： DK * DK * M * N
- 输出特征图尺寸：DF⋅DF⋅ N
- 运算量为： DK⋅DK⋅M⋅N⋅DF⋅DF
有 N 个卷积核，每个大小为 DK⋅DK⋅M ，每个卷积核作用于 M 个通道。也就是1个 Filter 连接 3 个 input channels。
深度卷积 深度卷积每个卷积核只处理1个输入特征通道，而不是M个输入特征通道，这样大大减少了运算量。输入特征图的尺寸（H, W, D）是 DF⋅DF⋅M ，可以得到如下公式：
- 输入特征图尺寸：DF⋅DF⋅M
- 卷积核尺寸： DK⋅DK⋅1⋅M
- 输出特征图尺寸：DF⋅DF⋅M" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cainiaoprogram.github.io/posts/2c54571761227edf7faa1624b7651b5e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-21T16:02:42+08:00" />
<meta property="article:modified_time" content="2023-12-21T16:02:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="菜鸟程序员博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">菜鸟程序员博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">轻量级网络模型MobileNet发展脉络（V1-V2-V3）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="265" src="https://images2.imgbox.com/2d/53/lauHfiNG_o.png" width="478"></p> 
<p><img alt="" height="266" src="https://images2.imgbox.com/a4/e0/54eDMGcN_o.png" width="561"></p> 
<h2> 卷积神经网络发展</h2> 
<p style="margin-left:0in;text-align:left;">        卷积神经网络被广泛应用在图像分类、目标检测等视觉任务中，并取得了巨大的成功。然而，卷积神经网络通常需要较大的运算量和内存占用，在移动端以及嵌入式设备等资源受限的环境中受到限制，因此需要进行网络压缩。从2012年AlexNet网络提出获得image net分类任务第一名后，深度学习模型迅速发展，网络层数不断加深，2015年提出的ResNet的准确率首次超越人类，但同时网络层数也达到了152层。</p> 
<p style="margin-left:0in;text-align:left;">        MobileNet系列是谷歌推出的轻量级网络模型，旨在不过多牺牲模型性能的同时大幅度减小模型的尺寸和加快模型的运算速度。</p> 
<h2 style="margin-left:0in;text-align:left;">MobileNet V1</h2> 
<p style="margin-left:0in;text-align:left;">        MobileNet V1基于一种流线型结构使用深度可分离卷积来构造轻型权重深度神经网络。主要用于移动端以及嵌入式设备。模型包含两个权衡延迟和准确率的全局超参数-宽度乘法器(width multiplier)和分辨率乘法器(resolution multiplier),允许模型构造器能够根据特定问题选择合适大小的模型。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="301" src="https://images2.imgbox.com/1a/42/4HXbcSY9_o.png" width="752"></p> 
<h3>深度可分离卷积</h3> 
<p>        深度可分离卷积是一种将标准卷积分解成深度卷积以及一个1x1的卷积即逐点卷积。能够有效减少计算量以及模型的大小。如图所示，一个标准的卷积(a)被分解成深度卷积(b)以及1x1的逐点卷积(c)。 </p> 
<p><img alt="" height="491" src="https://images2.imgbox.com/b1/1c/MFeYD3xo_o.png" width="391"></p> 
<p><img alt="" height="247" src="https://images2.imgbox.com/5c/3c/kAltrXZH_o.png" width="398"></p> 
<p> 一个 3x3 Conv 被拆分成了 3x3 Depthwise Conv和 1x1 Conv</p> 
<h4 style="margin-left:0in;text-align:justify;">常规卷积操作</h4> 
<p style="margin-left:0in;text-align:justify;">假设输入特征图的尺寸（H, W, D）是</p> 
<p style="margin-left:0in;text-align:justify;">DF⋅DF⋅M ，可以得到：</p> 
<p style="margin-left:0in;text-align:justify;">  - 输入特征图尺寸：DF⋅DF⋅M</p> 
<p style="margin-left:0in;text-align:justify;">  - 卷积核尺寸： DK * DK * M * N</p> 
<p style="margin-left:0in;text-align:justify;">  - 输出特征图尺寸：DF⋅DF⋅ N</p> 
<p style="margin-left:0in;text-align:justify;">  - 运算量为： DK⋅DK⋅M⋅N⋅DF⋅DF</p> 
<p style="margin-left:0in;text-align:justify;">有 N 个卷积核，每个大小为 DK⋅DK⋅M ，每个卷积核作用于 M 个通道。也就是1个 Filter 连接 3 个 input channels。</p> 
<p style="margin-left:0in;text-align:justify;"><img alt="" height="285" src="https://images2.imgbox.com/78/07/jKw8N06N_o.png" width="570"></p> 
<h4 style="margin-left:0in;text-align:left;">深度卷积</h4> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="264" src="https://images2.imgbox.com/39/56/q5a0mIxl_o.png" width="640"></p> 
<p style="margin-left:0in;text-align:left;">深度卷积每个卷积核只处理1个输入特征通道，而不是M个输入特征通道，这样大大减少了运算量。输入特征图的尺寸（H, W, D）是 DF⋅DF⋅M ，可以得到如下公式：</p> 
<p style="margin-left:.5in;text-align:left;">- 输入特征图尺寸：DF⋅DF⋅M</p> 
<p style="margin-left:.5in;text-align:left;">- 卷积核尺寸： DK⋅DK⋅1⋅M</p> 
<p style="margin-left:.5in;text-align:left;">- 输出特征图尺寸：DF⋅DF⋅M</p> 
<p style="margin-left:.5in;text-align:left;">- 运算量为：DK⋅DK⋅1⋅M⋅DF⋅DF</p> 
<p style="margin-left:0in;text-align:left;">有M个卷积核，每个大小为DK⋅DK⋅1 ，每个卷积核作用于1个通道。也就是1个 Filter 连接1个 input channel。</p> 
<h4 style="margin-left:0in;text-align:left;"> 逐点卷积</h4> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="230" src="https://images2.imgbox.com/20/28/PRUEGKcw_o.png" width="577"></p> 
<p>假设深度卷积层输出的特征图的尺寸（H, W, D）是DF⋅DF⋅M ，</p> 
<p style="margin-left:0in;text-align:left;">- 输入特征图尺寸：DF⋅DF⋅M</p> 
<p style="margin-left:.5in;text-align:left;">- 卷积核尺寸：1⋅1⋅M⋅N</p> 
<p style="margin-left:.5in;text-align:left;">- 输出特征图尺寸：DF⋅DF⋅N</p> 
<p style="margin-left:.5in;text-align:left;">- 运算量为：1⋅1⋅M⋅N⋅DF⋅DF</p> 
<p style="margin-left:0in;text-align:left;">有 N 个卷积核，每个大小为1⋅1⋅M ，每个卷积核作用于M个通道。也就是1个 Filter 连接M个input channels。</p> 
<p style="margin-left:0in;text-align:left;">        深度卷积每个卷积核只处理1个输入特征通道，而不是M个输入特征通道，这样大大减少了运算量。但是在这个过程中通道与通道之间的联系被切断，所以后面需要再用 1x1 大小的逐点卷积层来处理M个特征通道之间的信息。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="256" src="https://images2.imgbox.com/d9/08/IUUcbRy3_o.png" width="1033"></p> 
<h4 style="margin-left:0in;text-align:left;">常规卷积VS深度可分离卷积计算量</h4> 
<p style="margin-left:0in;text-align:left;">  - 常规卷积运算量：</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="35" src="https://images2.imgbox.com/2c/0d/vxPxNuFX_o.png" width="501"></p> 
<p style="margin-left:0in;text-align:left;">  - 深度可分离卷积运算量：</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="31" src="https://images2.imgbox.com/39/33/qxIKwCf9_o.png" width="661"></p> 
<p style="margin-left:0in;text-align:left;">  - 运算量对比： </p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="64" src="https://images2.imgbox.com/dc/7f/xv31pWWj_o.png" width="300"></p> 
<p style="margin-left:0in;text-align:left;">        MobileNet V1使用3x3的深度可分离卷积将卷积分为滤波和组合两个过程相较于标准卷积少了8到9倍的计算量，只有极小准确率的下降。</p> 
<h3 style="margin-left:0in;text-align:left;">网络结构</h3> 
<p style="margin-left:0in;text-align:left;">        MobileNet一共有28层，13组深度可分离卷积，除第一层为全卷积其他全由深度可分离卷积构成。所有的层都跟着一个BN以及ReLU非线性激活函数，除最后一层全连接层没有非线性激活函数直接送入softmax层进行分类。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="507" src="https://images2.imgbox.com/f3/05/oyhZO7rt_o.png" width="456"></p> 
<p style="margin-left:0in;text-align:left;">        MobileNet在1×1卷积中花费了95%的计算时间，大约占有75%的参数，几乎所有的附加参数都在全连接层中。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="167" src="https://images2.imgbox.com/d4/fe/r96c5loo_o.png" width="453"></p> 
<h3 style="margin-left:0in;text-align:left;">宽度乘法器-Width Multiplier</h3> 
<p style="margin-left:0in;text-align:left;">        宽度乘法器的作用就是对每一层均匀薄化。给定一个层以及宽度乘法器，输入通道数M变成了α* M，输出通道数N变成α* N。深度可分离卷积运算量变为：</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="50" src="https://images2.imgbox.com/c1/99/jpCKnROW_o.png" width="471"></p> 
<p style="margin-left:0in;text-align:left;">        其中α一般设置为<span style="background-color:#ffff00;">1\0.75\0.5\0.25</span>。当α=1时，是最基本的MobileNet，当时α&lt;1时就是薄化的MobileNet。宽度乘法器对计算量和参数量的减少大约α^2倍。宽度乘法器可以合理的权衡精度和延迟的大小。</p> 
<p style="margin-left:0in;text-align:left;">注：宽度乘法器常用来薄化一个新的需要从头开始训练的网络结构。</p> 
<h3 style="margin-left:0in;text-align:left;">分辨率乘法器-Resolution Multiplier</h3> 
<p style="margin-left:0in;text-align:left;">        第二个减少神经网络计算量的超参数是ρ-分辨率乘法器。对特征图进行下采样的 Resolution Multiplier ρ（0&lt;ρ&lt;1）： </p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="35" src="https://images2.imgbox.com/eb/26/MolmBu4Q_o.png" width="452"></p> 
<p style="margin-left:0in;text-align:left;">        其中图像分辨率一般设置为<span style="background-color:#ffff00;">224\192\160\128</span>等。当ρ=1时为最基本的MobileNet，当ρ&lt;1时为薄化的MobileNet。分辨率乘法器对网络约化大约ρ^2倍。</p> 
<h3 style="margin-left:0in;text-align:left;">实验对比</h3> 
<p style="margin-left:0in;text-align:left;">a.深度可分离卷积与全卷积对比</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="86" src="https://images2.imgbox.com/12/cf/izG2jH7U_o.png" width="350"></p> 
<p style="margin-left:0in;text-align:left;">    精度只下降1%，参数减少7倍。</p> 
<p style="margin-left:0in;text-align:left;">b.宽度乘法器α不同系数对比</p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;">    准确率直到宽度乘法器α下降到0.25才显示下降很多。</p> 
<p style="margin-left:0in;text-align:left;">c.分辨率乘法器ρ不同参数对比</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="124" src="https://images2.imgbox.com/30/fd/mmmzCbAC_o.png" width="419"></p> 
<p style="margin-left:0in;text-align:left;">    准确率随着分辨率下降而平滑减小</p> 
<p style="margin-left:0in;text-align:left;">d.MobileNet V1与其他模型对比</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="124" src="https://images2.imgbox.com/7a/4e/h4ZJoOt4_o.png" width="424"></p> 
<p><img alt="" height="122" src="https://images2.imgbox.com/2d/84/rz5niTvW_o.png" width="418"></p> 
<p>        MobileNet和VGG16准确率几乎一样，但是参数量少了32倍，计算量少了27倍。相较于GoogleNet准确率更高，且参数量和计算量都少了2.5倍。</p> 
<p style="margin-left:0in;text-align:left;">约化后MobileNet(α=0.5，分辨率为160x160)相较于这两个模型，准确率都高且计算量相较于AlexNet少了9.4倍,比SqueezeNet少了22倍。</p> 
<h2> MobileNet V2</h2> 
<p style="margin-left:0in;text-align:left;">        MobileNetV2网络设计基于MobileNet V1，它保留了其简单性且不需任何特殊的运算符，同时显着提高了其准确性，从而实现了针对移动应用程序的图像分类和检测任务等。网络中的亮点是 Inverted Residuals （倒残差结构 ）和 Linear Bottlenecks（线性瓶颈）。</p> 
<p style="margin-left:0in;text-align:left;">        模型主要贡献是提出了具有线性瓶颈的倒置残差块-Bottleneck Residual Block。该模块将低维压缩表示作为输入，首先将其扩展到高维，然后使用的深度可分离卷积进行提取特征。随后将特征投影回具有线性卷积的低维表示。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="214" src="https://images2.imgbox.com/66/13/5jCoE7kt_o.png" width="852"></p> 
<p></p> 
<h3 style="margin-left:0in;text-align:left;">具有线性瓶颈的倒置残差块-Bottleneck Residual Block</h3> 
<h3 style="margin-left:0in;text-align:left;"><img alt="" height="549" src="https://images2.imgbox.com/a4/a1/mDp84WDi_o.png" width="481"></h3> 
<p style="margin-left:0in;text-align:left;">a.扩展卷积-Expansion Convolution</p> 
<p style="margin-left:0in;text-align:left;">使用1x1大小卷积核增加输入特征图的通道数（升维）。让Depthwise Convolution有更多机会获取有效信息。</p> 
<p style="margin-left:0in;text-align:left;">b.深度可分离卷积-Depthwise Convolution</p> 
<p style="margin-left:0in;text-align:left;">和MobileNetV1一致。</p> 
<p style="margin-left:0in;text-align:left;">c.投影卷积-Projection Convolution</p> 
<p style="margin-left:0in;text-align:left;">Projection Convolution是大小为1x1的卷积核（降维），输出通道数远小于输入通道数，从而达到限制模型大小的目的。</p> 
<p style="margin-left:0in;text-align:left;">d.残差连接-Residual Connection</p> 
<p style="margin-left:0in;text-align:left;">借鉴了ResNet的理念，插入"short-cut"的目的是为了帮助梯度在不同网络层间的传播。使用Residual connection要满足条件：输入特征图尺寸等于输出特征图尺寸。</p> 
<p style="margin-left:0in;text-align:left;">MobileNetV1网络模块结构：</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="283" src="https://images2.imgbox.com/cb/7b/aDe5QNGx_o.png" width="548"></p> 
<p>MobileNet V2 网络结构：</p> 
<p><img alt="" height="292" src="https://images2.imgbox.com/87/03/uqUFAFW8_o.png" width="670"></p> 
<h3> 线性瓶颈-Linear Bottlenecks</h3> 
<p> <img alt="" height="146" src="https://images2.imgbox.com/72/4c/iEU6pKyo_o.png" width="627"></p> 
<p style="margin-left:0in;text-align:left;">        Input是一个2维数据，其中兴趣流形是其中的蓝色螺旋线。使用矩阵T将数据嵌入到n维空间中（升维），后接ReLU，再使用 T的转置矩阵将其投影回2维平面（降维）：</p> 
<div style="margin-left:.31in;text-align:left;"> 
 •维度越高，降维后保留的兴趣流形就越完整，信息丢失就越少。 
</div> 
<div style="margin-left:.31in;text-align:left;"> 
 •想要减少运算量，就需要尽可能将网络维度设计的低一些，但是维度如果低的话，激活函数 ReLU 可能会滤除很多有用信息。 
</div> 
<div style="margin-left:.31in;text-align:left;"></div> 
<p style="margin-left:0in;text-align:left;">        兴趣流形-manifold of interest：</p> 
<div style="margin-left:.31in;text-align:left;"> 
 •深度神经网络一连串的卷积和激活层形成一个兴趣流形（manifold of interest，感兴趣、有用的数据信息） 
</div> 
<div style="margin-left:.31in;text-align:left;"> 
 •兴趣流形可以通过数据降维被嵌入到低维空间（如MobileNetV1的α乘法因子，1x1卷积） 
</div> 
<p style="margin-left:0in;text-align:left;"></p> 
<h3 style="margin-left:0in;text-align:left;">倒置残差-Inverted residuals</h3> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="240" src="https://images2.imgbox.com/f7/6a/jJd5MoNg_o.png" width="773"></p> 
<p>        在之前的ResNet残差结构是先用1x1的卷积降维，再升维的操作。而在MobileNetV2中，是先升维再降维。所以ResNet残差结构是两头大中间小。</p> 
<p style="margin-left:0in;text-align:justify;">        MobileNetV2结构是中间大两头小。并且采用了新的激活函数：ReLU6，它与低精度计算一起使用时具有鲁棒性。</p> 
<p style="margin-left:0in;text-align:justify;"><img alt="" height="308" src="https://images2.imgbox.com/bb/dd/FG9Hrx2v_o.png" width="441"></p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="207" src="https://images2.imgbox.com/b5/b5/RLian9km_o.png" width="702"></p> 
<h3 style="margin-left:0in;text-align:left;">网络结构</h3> 
<p style="margin-left:0in;text-align:left;">        基本构建块是一个具有残差的瓶颈深度可分离卷积。包含具有32个通道的初始全卷积层，然后是下表中所述的19个残差瓶颈层。将ReLU6用作非线性函数，因为它与低精度计算一起使用时具有鲁棒性。始终使用3×3的内核大小，并在训练过程中利用dropout和BN.</p> 
<p style="margin-left:0in;text-align:left;">        使用与Mobilenets v1中一样的输入图像分辨率和宽度乘数作为可调超参数来针对不同的性能点调整体系结构。输入分辨率参数为96-224，宽度乘数为0.35-1.4。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="393" src="https://images2.imgbox.com/8e/39/y1d4uMjI_o.png" width="415"></p> 
<h3 style="margin-left:0in;text-align:left;">实验对比</h3> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="222" src="https://images2.imgbox.com/73/6f/YaucJCae_o.png" width="522"></p> 
<p> 在ImageNet上的性能，不同网络的比较。</p> 
<p><img alt="" height="222" src="https://images2.imgbox.com/67/12/EjBbVJdw_o.png" width="572"></p> 
<p> SSD和SSDLite配置的大小和计算成本的比较MobileNetV2和对80个类进行预测.</p> 
<h2>MnasNet</h2> 
<p>MnasNet介于V2和V3之间，主要有两个亮点</p> 
<h3 style="margin-left:0in;text-align:left;">多目标优化函数：准确度性能+真实手机推理时间</h3> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="551" src="https://images2.imgbox.com/0a/eb/HIalLA46_o.png" width="850"></p> 
<h3 style="margin-left:0in;text-align:left;">分层的神经架构搜索空间</h3> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="389" src="https://images2.imgbox.com/5c/46/YqhZ44QY_o.png" width="1160"></p> 
<h3 style="margin-left:0in;text-align:left;">网络思想</h3> 
<p style="margin-left:0in;text-align:left;">        使用多目标优化的目标函数，兼顾速度和精度，其中速度用真实手机推断时间衡量提出分层的神经网络架构搜索空间，将卷积神经网络分解为若干block，分别搜索各自基本模块，保证层结构多样性。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="392" src="https://images2.imgbox.com/1f/80/AYtDPBTr_o.png" width="736"></p> 
<h3>网络结构</h3> 
<p><img alt="" height="516" src="https://images2.imgbox.com/5d/9f/XA8u7lnw_o.png" width="488"></p> 
<h2><img alt="" height="381" src="https://images2.imgbox.com/60/27/a8w67GIj_o.png" width="691">MobileNetV3</h2> 
<p style="margin-left:0in;text-align:justify;">        MobileNetV3综合了三种模型的思想：MobileNetV1的深度可分离卷积（depthwise separable convolutions）、MobileNetV2的具有线性瓶颈的倒残差结构(the inverted residual with linear bottleneck)和MnasNet的基于squeeze and excitation结构的轻量级注意力模型。模型引入了以下几个设计：</p> 
<p style="margin-left:0in;text-align:justify;">1.互补搜索技术</p> 
<p style="margin-left:0in;text-align:justify;">        •资源受限的NAS：计算和参数量受限前提下搜索网络的各个模块</p> 
<p style="margin-left:0in;text-align:justify;">        •NetAdapt：用于对NAS搜索的各个模块网络层的微调。</p> 
<p style="margin-left:0in;text-align:justify;">2.适用于移动环境的新的高效非线性版本：</p> 
<p style="margin-left:0in;text-align:justify;">        •重新设计的激活函数hard-swish()</p> 
<p style="margin-left:0in;text-align:justify;">3.新的高效网络设计:       </p> 
<p style="margin-left:0in;text-align:justify;">        •降低卷积核数量并用不同的激活方式降低冗余</p> 
<p style="margin-left:0in;text-align:justify;">        •精简Last Stage</p> 
<p style="margin-left:0in;text-align:justify;">4.新的高效分割解码器：</p> 
<p style="margin-left:0in;text-align:justify;">        •MobileNetV3-Large</p> 
<p style="margin-left:0in;text-align:justify;">        •MobileNetV3-Small</p> 
<h3 style="margin-left:0in;text-align:left;">更新Block</h3> 
<p style="margin-left:0in;text-align:left;">1.加入SE模块</p> 
<p style="margin-left:0in;text-align:left;">在V3中使用(squeeze-and-excite,SE) 模块，将 expansion layer的channel变为原来的1/4，即提高了精度，也没有增加时间消耗。并且SE结构放在了depthwise 之后。实质为引入了一个 channel 注意力机制。</p> 
<p style="margin-left:0in;text-align:left;">2.更新了激活函数</p> 
<p style="margin-left:0in;text-align:left;">hard-swish()</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="421" src="https://images2.imgbox.com/28/b9/hapKuQOi_o.png" width="1146"></p> 
<h3 style="margin-left:0in;text-align:left;">重新设计计算复杂的层</h3> 
<p style="margin-left:0in;text-align:left;">1.降低卷积核数量并用不同的激活方式降低冗余</p> 
<p style="margin-left:0in;text-align:left;">        减少了第一个卷积层的卷积核个数（32—&gt;16），并使用hard-swish 非线性激活，在减少卷积核个数同时保持准确率(和使用 32 个卷积核并在该层使用 ReLU 是的效果比)，计算量降低200W，时间节省2ms。</p> 
<p style="margin-left:0in;text-align:left;">2.精简Last Stage</p> 
<p style="margin-left:0in;text-align:left;">        时间节省7ms,约占总体运行时间的11%，计算量减少3000w,准确率几乎没有下降。</p> 
<p style="margin-left:0in;text-align:left;"><img alt="" height="283" src="https://images2.imgbox.com/d5/b7/lJ6717UR_o.png" width="666"></p> 
<h3>重新设计激活函数</h3> 
<p><img alt="" height="362" src="https://images2.imgbox.com/46/d9/3ExfiZh6_o.png" width="420"></p> 
<p> <img alt="" height="554" src="https://images2.imgbox.com/4d/7e/E2ZNma77_o.png" width="519"></p> 
<h3 style="margin-left:0in;text-align:left;">不同大小的模型设计</h3> 
<p style="margin-left:0in;text-align:left;">        V3设计了两种体量的模型，Large和Small，都是经过 NAS和优化后的。SE: 该块中是否存在挤压和激发。NL表示所使用的非线性类型。HS: h-swish, RE: ReLU。NBN:无批处理归一化, S: 步幅, exp size:第一个1x1升维维数。</p> 
<p><img alt="" height="435" src="https://images2.imgbox.com/7e/42/S7bbAXHJ_o.png" width="1078"></p> 
<h3> 实验结果<img alt="" height="328" src="https://images2.imgbox.com/c7/e5/IAjiEyOa_o.png" width="1182"></h3> 
<p></p> 
<h2 style="margin-left:0in;text-align:left;">MobileNet模型总结</h2> 
<div style="margin-left:.31in;text-align:left;"> 
 •MobileNet v1：提出了 Depthwise Separable Convolutions（深度可分离卷积） 
</div> 
<div style="margin-left:.31in;text-align:left;"> 
 •MobileNet v2：在MobileNet V1深度可分离卷积的基础上提出了 Bottleneck Residual Block（瓶颈残差模块） 
</div> 
<div style="margin-left:.31in;text-align:left;"> 
 •MobileNet v3：使用了 NAS 和 NetAdapt 算法搜索最优的模型结构，同时对模型一些结构进行了改进，在 MobileNet_V2的Bottleneck Residual Block基础上引入MnasNet的Squeeze-and-Excitation注意力机制。 
</div> 
<p></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p></p> 
<p></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p style="margin-left:0in;text-align:left;"></p> 
<p></p> 
<p style="margin-left:0in;text-align:justify;"></p> 
<p style="margin-left:0in;text-align:left;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb0e38525a7b7a6133b56ca4c261ccb7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">移动端深度学习部署：TFlite</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f4919f769e329c1c6c13a84bb693b9f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Transformer研究综述（BERT，GPT-3，ViT，DETR...）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 菜鸟程序员博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>